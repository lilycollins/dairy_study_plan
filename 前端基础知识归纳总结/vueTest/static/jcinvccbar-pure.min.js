var application=null,g_consoleFlag=0;function applicationLoad(a,b){null==application&&(8==arguments.length&&(a=arguments[5],b=arguments[6]),"undefined"==typeof a&&(a=""),application=new JApplication(a),application.OnLoad=b,setTimeout(createAppBar,1E3))}function applicationUnLoad(){null!=application&&(null!=application.oJVccBar&&application.oJVccBar.UnInitial(),null!=application.oJMonitor&&(delete application.oJMonitor,application.oJMonitor=null),null!=application.oJBarDisplayer&&(delete application.oJBarDisplayer,application.oJBarDisplayer=null),delete application,application=null)}function createAppBar(){application.oJVccBar=new JVccBar(null);application.InitAssist();application.OnLoad&&application.OnLoad()}function JApplication(a){this.oBrowserSys=this.onLoad=this.oVccBarAssist=this.oWechatManager=this.oJMonitorData=this.oWecharCtrl=this.oJBarDisplayer=this.oJMonitor=this.oJVccBar=null;this.RelationPath=a;this.oALog=new CJVccLog;this.surpportWebsocket=!1;this._contentWindow=window;this.InitAssist=function(){this.oWechatManager=new JWechChatManager;this.oVccBarAssist=new JVccBarAssist};this.InitMonitorDataManager=function(){this.oJMonitorData=new JcmMonitorManager(application.oJVccBar)};this.BindMonitorBarToEachOther=function(b){try{b="undefined"==typeof b?this.oJMonitor:b,null==b?alert("\u76d1\u63a7\u63a7\u4ef6\u6ca1\u6709\u521d\u59cb\u5316!"):(b.SetVccBarCtrl(this.oJVccBar),this.oJVccBar.SetMonitorCtrl(b))}catch(a){alert(a.message)}};this.GetRelationPath=function(){return this.RelationPath};this.IsSurpportWebSocket=function(){return this.surpportWebsocket};this.Log=function(b){this.OnDebug(b);this.Info(b)};this.Info=function(b){this.oALog.Insert(b)};this.GetLogText=function(b){return this.oALog.GetLogText(b)};this.SaveLog=function(b){b=getDefaultParam(b);""==b&&(b="cinvccbar_pure_"+getAcpTimeString(!1)+".txt");var a=this.GetLogText(!0),a=new Blob([a],{type:"text/plain;charset\x3dutf-8"});saveFileAs(a,b)};this.DislayLog=function(b,a){g_DebugFlag=g_consoleFlag=getDefaultParamValue(a,0);0!=g_DebugFlag&&(g_DebugFlag=1);gLogType=getDefaultParamValue(b,VccBar_Log_None)};this.OnDebug=function(b){};this.OnLoad=function(){};this._Create=function(){this.surpportWebsocket=IsWebSocketValid();this.oBrowserSys=this._GetBrowerSys()};this._GetBrowerSys=function(){this.version=this.os="";var b=navigator.userAgent.toLowerCase();0<b.indexOf("msie")?(this.os="msie",this.version=b.match(/msie ([\d.]+)/)[1]):0<b.lastIndexOf("firefox")?(this.os="firefox",this.version=b.match(/firefox\/([\d.]+)/)[1]):0<b.lastIndexOf("chrome")?(this.os="chrome",this.version=b.match(/chrome\/([\d.]+)/)[1]):0<b.lastIndexOf("trident")?(this.os="msie",this.version=b.match(/rv:([\d.]+)/)[1]):0<b.lastIndexOf("safari")?(this.os="safari",this.version=b.match(/safari\/([\d.]+)/)[1]):isIE()?(this.os="msie",this.version="11.0"):(this.os=b,this.version="");getLocalLanguage()==lg_zhcn?this.expression="ua:\u3010"+b+"\u3011\r\nos:\u3010"+this.os+"\u3011 version:\u3010"+this.version+"\u3011\r\nwebsocket:\u3010"+(1==this.surpportWebsocket?"\u652f\u6301":"\u4e0d\u652f\u6301")+"\u3011":this.expression="ua:["+b+"]\r\nos:["+this.os+"] version:["+this.version+"]\r\nwebsocket:["+(1==this.surpportWebsocket?"surpport":"unsurpport")+"]";return this};this._Create()}function sipLogConsole(a){var b="";6==a.length?(b=a[0],b=b.replace(/%s/,a[3]),b=b.replace(/%s/,a[4])):b=a[0];b=b.replace(/%c/g,"");"function"===typeof OnSimulatorSip&&OnSimulatorSip(b);null!=application&&(b="[SIP]["+getTimeString()+"] "+b,application.Log(b))}function loadJsFile(a){var b=document.getElementsByTagName("HEAD").item(0),c=document.createElement("script");c.type="text/javascript";c.src=a;b.appendChild(c)}function IsWebSocketValid(){!window.WebSocket&&window.MozWebSocket&&(window.WebSocket=window.MozWebSocket);return window.WebSocket?!0:!1}function isIE(){try{return window.ActiveXObject||"ActiveXObject"in window?!0:!1}catch(a){return!1}}function isUnderIe8(){var a=navigator.userAgent.toLowerCase();return 0<a.indexOf("msie")&&"8.0"==a.match(/msie ([\d.]+)/)[1]?!0:!1}function getLocalLanguage(){var a="",a="Netscape"==navigator.appName?navigator.language:navigator.userLanguage;return a.toLowerCase()}function SetSipResourcePath(a){g_resPath=a}var WS_EVENT_ONOPEN=0,WS_EVENT_ONMESSAGE=1,WS_EVENT_ONCLOSE=2,WS_EVENT_ONERROR=3,WS_STATUS_NULL=-1,WS_STATUS_CONNECTING=0,WS_STATUS_OPEN=1,WS_STATUS_CLOSING=2,WS_STATUS_CLOSE=3;function JACPWebSocket(a){this._msgCallback=this._ws=null;this._appName=a;this.WSConnect=function(b,a,d){try{this._ws=0==d?new WebSocket("ws://"+b+":"+a):new WebSocket("wss://"+b+":"+a)}catch(e){g_DebugFlag&&console.error(e,"WebSocket::WSConnect("+this._appName+")");try{this._ws=0==d?new MozWebSocket("ws://"+b+":"+a):new MozWebSocket("wss://"+b+":"+a)}catch(f){return g_DebugFlag&&console.error(f,"WebSocket::WSConnect("+this._appName+")"),this._ws=null,!1}}0==d?DisplayLog(VccBar_Log_Info,"WebSocket::Connect(ws:"+b+":"+a+") By "+this._appName):DisplayLog(VccBar_Log_Info,"WebSocket::Connect(wss:"+b+":"+a+") By "+this._appName);this._ws.onopen=this._WSonOpen;this._ws.onmessage=this._WSonMessage;this._ws.onclose=this._WSonClose;this._ws.onerror=this._WSonError;this._ws.oParent=this;return!0};this.WSDisconnect=function(){null!=this._ws&&(this._ws.readyState!=WS_STATUS_CONNECTING&&this._ws.readyState!=WS_STATUS_OPEN||this._ws.close())};this.WSSendMsg=function(b){return null==this._ws||""==b?!1:this._ws.readyState==WS_STATUS_OPEN?(DisplayLog(VccBar_Log_Protocol,stringFormat("Sen{0}:{1}",this._appName,b)),this._ws.send(b),!0):!1};this.WSIsConnect=function(){return null==this._ws?!1:this._ws.readyState==WS_STATUS_OPEN};this.WSGetConnectStatus=function(){return null!=this._ws?this._ws.readyState:WS_STATUS_NULL};this.SetMsgCallBack=function(b){this._msgCallback=b};this._WSonOpen=function(){DisplayLog(VccBar_Log_Info,"WebSocket::WSonOpen("+this.oParent._appName+")");this.oParent._invokeCallBack(WS_EVENT_ONOPEN,"")};this._WSonMessage=function(b){DisplayLog(VccBar_Log_Protocol,stringFormat("Rec{0}:{1}",this.oParent._appName,b.data));this.oParent._invokeCallBack(WS_EVENT_ONMESSAGE,b.data)};this._WSonClose=function(){DisplayLog(VccBar_Log_Error,"WebSocket::WSonClose("+this.oParent._appName+")");this.oParent._invokeCallBack(WS_EVENT_ONCLOSE,"")};this._WSonError=function(b){DisplayLog(VccBar_Log_Error,"WebSocket::WSonError("+this.oParent._appName+")");this.oParent._invokeCallBack(WS_EVENT_ONERROR,"")};this._invokeCallBack=function(b,a){null!=this._msgCallback&&this._msgCallback(b,a)};this._APSPInit=function(){};this._APSPInit();return this}function JACPSocketIO(a){this._msgCallback=this._ws=null;this._appName=a;this._ReconnectTimerInterVal=30;this._bgnTimer="";this.WSConnect=function(b,a,d,e,f){try{var g;g=0==e?{transports:["websocket"],directory:f}:{transports:["polling"],directory:f};var h;h=0==d?"http://"+b+":"+a:"https://"+b+":"+a;0==e?DisplayLog(VccBar_Log_Info,"SocketIO::transport(websocket,"+f+") By "+this._appName):DisplayLog(VccBar_Log_Info,"SocketIO::transport(polling,"+f+") By "+this._appName);DisplayLog(VccBar_Log_Info,"SocketIO::Connect("+h+") By "+this._appName);this._ws=io.connect(h,g);this._bgnTimer=this.GetCurrentTime();this._ws.on("message",function(b){this.oParent._WSonMessage(b);DisplayLog(VccBar_Log_Info,stringFormat("message {0}:{1}",this.oParent._appName,b))});this._ws.on("connect",function(){this.oParent._WSonOpen();DisplayLog(VccBar_Log_Info,stringFormat("[{0}] Connected to Server",this.oParent._appName));this.oParent._bgnTimer=""});this._ws.on("disconnect",function(){this.oParent._WSonClose();DisplayLog(VccBar_Log_Info,stringFormat("[{0}] Disconnected from Server",this.oParent._appName))});this._ws.on("reconnect",function(){DisplayLog(VccBar_Log_Info,stringFormat("[{0}] Reconnected to Server",this.oParent._appName))});this._ws.on("reconnecting",function(b){DisplayLog(VccBar_Log_Info,stringFormat("[{0}] Reconnecting {1} time",this.oParent._appName,b));b=this.oParent.GetCurrentTime();getStringTimerInterval(this.oParent._bgnTimer,b)>=this.oParent._ReconnectTimerInterVal&&(this.oParent._ws.disconnect(),this.oParent._WSonError(),this.oParent._WSonClose(),this.oParent._bgnTimer="")});this._ws.on("reconnect_failed",function(){this.oParent._WSonError();DisplayLog(VccBar_Log_Info,stringFormat("[{0}] Reconnect Failed",this._appName))});this._ws.on("Response",function(b){this.oParent._WSonMessage(b.msg)});this._ws.oParent=this}catch(k){return DisplayLog(VccBar_Log_Error,stringFormat("Connect SocketIO {0}:{1}",this._appName,k)),!1}return!0};this.WSDisconnect=function(){null!=this._ws&&(DisplayLog(VccBar_Log_Info,"SocketIO::DisConnect By "+this._appName),this._ws.disconnect())};this.WSSendMsg=function(b){return null==this._ws||""==b?!1:1==this._ws.connected?(DisplayLog(VccBar_Log_Protocol,stringFormat("Sen{0}:{1}",this._appName,b)),this._ws.emit("Request",{msg:b}),!0):!1};this.WSIsConnect=function(){return null==this._ws?!1:1==this._ws.connected};this.WSGetConnectStatus=function(){return null!=this._ws?this._ws.connected?WS_STATUS_OPEN:WS_STATUS_CLOSE:WS_STATUS_NULL};this.SetMsgCallBack=function(b){this._msgCallback=b};this.GetCurrentTime=function(){var b=new Date,a=b.getFullYear(),d=b.getMonth()+1,d=10>d?"0"+d:d,e=b.getDate(),e=10>e?"0"+e:e,f=b.getHours(),f=10>f?"0"+f:f,g=b.getMinutes(),g=10>g?"0"+g:g,b=b.getSeconds();return a.toString()+d.toString()+e.toString()+f.toString()+g.toString()+(10>b?"0"+b:b).toString()};this._WSonOpen=function(){DisplayLog(VccBar_Log_Info,"SocketIO::WSonOpen("+this._appName+")");this._invokeCallBack(WS_EVENT_ONOPEN,"")};this._WSonMessage=function(b){DisplayLog(VccBar_Log_Protocol,stringFormat("Rec{0}:",this._appName)+b);this._invokeCallBack(WS_EVENT_ONMESSAGE,b)};this._WSonClose=function(){DisplayLog(VccBar_Log_Error,"SocketIO::WSonClose("+this._appName+")");this._invokeCallBack(WS_EVENT_ONCLOSE,"");this._ws=null};this._WSonError=function(b){DisplayLog(VccBar_Log_Error,"SocketIO::WSonError("+this._appName+")");this._invokeCallBack(WS_EVENT_ONERROR,"")};this._invokeCallBack=function(b,a){null!=this._msgCallback&&this._msgCallback(b,a)};this._APSPInit=function(){};this._APSPInit();return this}var ACPI_SUCCESS=0,ACPI_FAILURE=1,ACPI_UNKNOWN=2;function JAcpAPI(){this._SocketCallback=this._oAcpSocket=null;this.g_ctiEvent=this.g_timeStamp=this.g_serialID=this.g_sessionID="";this.g_sessionCode=0;this.g_agent=new JAgent;this._createObject=function(){this._oAcpParse=new JACPParse;this._oAcpSocket=new JACPSocketIO("ACP");this._oAcpSocket.oParent=this;this._oAcpSocket.SetMsgCallBack(this._SocketCallBack)};this._SocketCallBack=function(a,b){this.oParent._SocketCallback&&this.oParent._SocketCallback(a,b)};this._SendMsg=function(a,b){return this._oAcpSocket.WSIsConnect()?this._oAcpSocket.WSSendMsg(a)?ACPI_SUCCESS:ACPI_FAILURE:ACPI_FAILURE};this._GetCmdNum=function(a){var b=1E3;if("SendDTMF"==a||"CallInside"==a||"Consultation"==a||"CallOutside"==a||"SingleStepTransfer"==a||"Transfer"==a||"SetTransfer"==a||"Hold"==a||"RetrieveHold"==a||"Conference"==a||"Alternate"==a||"DoReplyMultimeAndHangUpCall"==a||"Bridge"==a||"SMMsgReq"==a||"Answer"==a)b=1001;if("ReleaseCall"==a||"ReleaseCallByCallID"==a||"StopInsert"==a||"BeginRecord"==a||"StopRecord"==a||"Intercept"==a||"Insert"==a||"Listen"==a||"Help"==a||"BeginPlay"==a||"StopPlay"==a||"BeginCollect"==a||"StopCollect"==a)b=1011;if("ForceIdle"==a||"ForceBusy"==a||"ForceOut"==a||"Lock"==a||"UnLock"==a)b=1010;if("SetCTIParam"==a||"GetCTIParam"==a||"ChangeCallQueue"==a)b=1020;if("QueryTotalQueueWaitNum"==a||"QueryAgentStatus"==a||"QuerySpAgentList"==a||"QueryCallQueue"==a)b=1030;if("GetLog"==a||"OnUploadedLog"==a)b=1040;return b};this._GetCTIEventID=function(a){var b=1E3;return b="AgentReconnect"==a||"SignIn"==a?1E3:"SendWeiboMsg"==a||"SendWeChatMsg"==a||"QueryWeChatSessionIDs"==a||"GetWeChatParam"==a?1012:""==this.g_ctiEvent?this._GetCmdNum(a):stringToInt(this.g_ctiEvent,-1)};this.SetSocketCallBack=function(a){this._SocketCallback=a};this.IsSoceketConnect=function(){return this._oAcpSocket.WSIsConnect()};this.GetSoceketStatus=function(){return this._oAcpSocket.WSGetConnectStatus()};this.acpSetStreamParam=function(a,b,c,d){this.g_agent.agentID=c;this.g_agent.type=a;this.g_agent.vccID=b;this.g_agent.deviceID=d};this.acpSetCtiEvent=function(a,b){this.g_ctiEvent=a;this.g_timeStamp=b;return ACPI_SUCCESS};this.acpSetSession=function(a,b){this.g_sessionID=a;this.g_serialID=b};this.acpOpenStream=function(a,b,c,d,e){return this._oAcpSocket.WSConnect(a,b,c,d,e)?ACPI_SUCCESS:ACPI_FAILURE};this.acpCloseStream=function(){this._oAcpSocket.WSDisconnect()};this.acpHeartBeat=function(){var a=stringFormat('1000 off heartBeat \x3cacpMessage ver\x3d"2.0.0"\x3e\x3cheader\x3e\x3csessionID\x3e{0}\x3c/sessionID\x3e\x3cserialID\x3e{1}\x3c/serialID\x3e\x3c/header\x3e\x3cbody type\x3d"response" name\x3d"heartBeat"/\x3e\x3c/acpMessage\x3e\x00',this.g_sessionID,this.g_serialID);return this._oAcpSocket.WSIsConnect()&&this._oAcpSocket.WSSendMsg(a)?ACPI_SUCCESS:ACPI_FAILURE};this.acpAgentReconnect=function(a,b,c,d){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"AgentReconnect"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter agentStatus\x3d"{7}" phonestatus \x3d"{8}" passwd\x3d"{9}" master\x3d "{10}"/\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,b,c,d);return this._SendMsg(a,"AgentReconnect")};this.acpInitial=function(a){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0"\x3e\x3cheader\x3e\x3csessionID\x3e\x3c/sessionID\x3e\x3cserialID\x3e\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"Initial"\x3e\x3cparameter vccID\x3d"{0}"  /\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',a);return this._SendMsg(a,"Initial")};this.acpSignIn=function(a,b,c,d,e,f){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0"\x3e\x3cheader\x3e\x3csessionID\x3e{0}\x3c/sessionID\x3e\x3cserialID\x3e{1}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{2}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"SignIn"\x3e\x3cagent vccID\x3d"{3}" agentID\x3d"{4}" deviceID\x3d"{5}"/\x3e\x3cparameter deviceID\x3d"{6}" passwd\x3d"{7}" cryptType\x3d"{8}" ready\x3d"{9}" taskId\x3d"{10}" macAddress\x3d"{11}" connectType\x3d"{12}" /\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,a,a,b,c,d,e,"",f);return this._SendMsg(a,"SignIn")};this.acpSignOut=function(a,b,c){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"SignOut"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter code\x3d"{7}" /\x3e\x3ctime signin\x3d"{8}" signout \x3d"{9}"/\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,b,c);return this._SendMsg(a,"SignOut")};this.acpSetBusy=function(a,b){var c=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"SetBusy"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter subStatus\x3d"{7}" taskId\x3d"{8}" /\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,b);return this._SendMsg(c,"SetBusy")};this.acpSetIdle=function(a){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"SetIdle"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter  taskId\x3d"{7}" /\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a);return this._SendMsg(a,"SetIdle")};this.acpSetAgentAutoEnterIdle=function(){var a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"SetAgentAutoEnterIdle"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter /\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID);return this._SendMsg(a,"SetAgentAutoEnterIdle")};this.acpAgentEnterIdle=function(){var a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"AgentEnterIdle"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter /\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID);return this._SendMsg(a,"AgentEnterIdle")};this.acpSetWrapUp=function(){var a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"SetWrapUp"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter /\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID);return this._SendMsg(a,"SetWrapUp")};this.acpAgentReport=function(a,b){var c=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"AgentReport"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter agentStatus\x3d"{7}" phoneStatus \x3d"{8}"/\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,b);return this._SendMsg(c,"AgentReport")};this.acpReleaseCall=function(a){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"ReleaseCall"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter destAgentID\x3d"{7}" /\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a);return this._SendMsg(a,"ReleaseCall")};this.acpReleaseCallbyCallID=function(a,b){var c=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"ReleaseCallByCallID"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter destAgentID\x3d"{7}" destDeviceID\x3d"{8}"/\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,b);return this._SendMsg(c,"ReleaseCallByCallID")};this.acpSendDTMF=function(a,b){var c=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"SendDTMF"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter DTMFDigits \x3d"{7}" destDeviceID\x3d"{8}"/\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,b);return this._SendMsg(c,"SendDTMF")};this.acpCallInside=function(a,b,c,d){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e{3}\x3c/serviceID\x3e\x3ctimeStamp\x3e{4}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"CallInside"\x3e\x3cagent vccID\x3d"{5}" agentID\x3d"{6}" deviceID\x3d"{7}"/\x3e\x3cparameter destAgentID\x3d"{8}" taskID\x3d"{9}" transParentParamet\x3d"{10}"/\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,d,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,b,c);return this._SendMsg(a,"CallInside")};this.acpConsultation=function(a,b,c){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"Consultation"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter destDeviceID\x3d"{7}"  consultType\x3d"{8}" callingDeviceID\x3d"{9}" /\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,b,c);return this._SendMsg(a,"Consultation")};this.acpCallOutside=function(a,b,c,d,e,f,g,h,k){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e{3}\x3c/serviceID\x3e\x3ctimeStamp\x3e{4}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"CallOutside"\x3e\x3cagent vccID\x3d"{5}" agentID\x3d"{6}" deviceID\x3d"{7}"/\x3e\x3cparameter destDeviceID\x3d"{8}" callingDeviceID\x3d"{9}" taskID\x3d"{10}" transParentParamet\x3d"{11}" phoneID\x3d"{12}" projectID\x3d"{13}" encryptType\x3d"{14}" chargeNumer\x3d"{15}" /\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,f,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,b,c,d,e,g,h,k);return this._SendMsg(a,"CallOutside")};this.acpSingleStepTransfer=function(a,b,c){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"SingleStepTransfer"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter destDeviceID\x3d"{7}"  transferType\x3d"{8}" callingDeviceID\x3d"{9}" /\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,b,c);return this._SendMsg(a,"SingleStepTransfer")};this.acpTransfer=function(a,b){var c=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"Transfer"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter destDeviceID\x3d"{7}" callingDeviceID\x3d"{8}" /\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,b);return this._SendMsg(c,"Transfer")};this.acpSetTransfer=function(){return-1};this.acpHold=function(a){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"Hold"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter destDeviceID\x3d"{7}"/\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a);return this._SendMsg(a,"Hold")};this.acpRetrieveHold=function(a){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"RetrieveHold"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter destDeviceID\x3d"{7}"/\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a);return this._SendMsg(a,"RetrieveHold")};this.acpConference=function(a){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"Conference"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter destDeviceID\x3d"{7}"/\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a);return this._SendMsg(a,"Conference")};this.acpBridge=function(a,b){var c=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"Bridge"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter destID \x3d"{7}"  callingDeviceID\x3d"{8}" /\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,b);return this._SendMsg(c,"Bridge")};this.acpAnswer=function(a,b,c){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"Answer"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter destDeviceID\x3d"{7}" recordFlag\x3d"{8}" phoneType\x3d"{9}" /\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,b,c);return this._SendMsg(a,"Answer")};this.acpSetCTIParam=function(a,b,c,d){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{6}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"SetCTIParam"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter destAgentID\x3d"{7}" codeType\x3d"{8}" type\x3d"{9}" param \x3d"{10}"/\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,d,b,c);return this._SendMsg(a,"SetCTIParam")};this.acpGetCTIParam=function(a,b,c,d){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"GetCTIParam"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter destAgentID\x3d"{7}" codeType\x3d"{8}" type\x3d"{9}" param \x3d"{10}"/\x3e\x3c/body\x3e\x3c/acpMessage\x3e\x00',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,d,b,c);return this._SendMsg(a,"GetCTIParam")};this.acpChangeCallQueue=function(a,b,c){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"ChangeCallQueue"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter calling\x3d"{7}" queuekey \x3d"{8}" orderid\x3d"{9}"/\x3e\x3c/body\x3e\x3c/acpMessage\x3e',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,b,c);return this._SendMsg(a,"ChangeCallQueue")};this.acpCallQueueQuery=function(a){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"QueryCallQueue"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter serviceId\x3d"{7}" /\x3e\x3c/body\x3e\x3c/acpMessage\x3e',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a);return this._SendMsg(a,"QueryCallQueue")};this.acpTransferCallQueue=function(a,b,c){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"TransferCallQueue"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter queuekey\x3d"{7}" transferType \x3d"{8}" destNum\x3d"{9}"/\x3e\x3c/body\x3e\x3c/acpMessage\x3e',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,b,c);return this._SendMsg(a,"TransferCallQueue")};this.acpSendMessage=function(a,b,c,d,e,f){d=1==d?"and":"or";a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"SendMessage"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3ctarget opType \x3d"{7}"\x3e\x3cdestTarget targetType \x3d"0"\x3e{8}\x3c/destTarget\x3e\x3cdestTarget targetType \x3d"1"\x3e{9}\x3c/destTarget\x3e\x3cdestTarget targetType \x3d"2"\x3e{10}\x3c/destTarget\x3e\x3c/target\x3e\x3cmessage msgtype\x3d"{11}"\x3e{12}\x3c/message\x3e\x3c/body\x3e\x3c/acpMessage\x3e',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,d,a,b,c,e,f);return this._SendMsg(a,"SendMessage")};this.acpForceReleaseCall=function(a,b){var c=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"ForceReleaseCall"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter destNum \x3d"{7}" type\x3d"{8}"/\x3e\x3c/body\x3e\x3c/acpMessage\x3e',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,b);return this._SendMsg(c,"ForceReleaseCall")};this.acpInsert=function(a,b,c,d,e){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"Insert"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter bgnStatus \x3d"{7}" endStatus \x3d"{8}" destNum \x3d"{9}" type\x3d"{10}"/\x3e\x3c/body\x3e\x3c/acpMessage\x3e',getAcpTimeString(),e,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,b,c,d);return this._SendMsg(a,"Insert")};this.acpListen=function(a,b,c,d,e){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"Listen"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter bgnStatus \x3d"{7}" endStatus \x3d"{8}" destNum \x3d"{9}" type\x3d"{10}"/\x3e\x3c/body\x3e\x3c/acpMessage\x3e',getAcpTimeString(),e,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,b,c,d);return this._SendMsg(a,"Listen")};this.acpIntercept=function(a,b,c,d,e){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"Intercept"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter bgnStatus \x3d"{7}" endStatus \x3d"{8}" destNum \x3d"{9}" type\x3d"{10}"/\x3e\x3c/body\x3e\x3c/acpMessage\x3e',getAcpTimeString(),e,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,b,c,d);return this._SendMsg(a,"Intercept")};this.acpHelp=function(a,b,c,d,e){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"Help"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter bgnStatus \x3d"{7}" endStatus \x3d"{8}" destNum \x3d"{9}" type\x3d"{10}"/\x3e\x3c/body\x3e\x3c/acpMessage\x3e',getAcpTimeString(),e,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a,b,c,d);return this._SendMsg(a,"Help")};this.acpLock=function(a){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"Lock"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter destAgentID \x3d"{7}" /\x3e\x3c/body\x3e\x3c/acpMessage\x3e',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a);return this._SendMsg(a,"Lock")};this.acpUnLock=function(a){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"UnLock"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter destAgentID \x3d"{7}" /\x3e\x3c/body\x3e\x3c/acpMessage\x3e',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a);return this._SendMsg(a,"UnLock")};this.acpForceIdle=function(a){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"ForceIdle"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter destAgentID \x3d"{7}" /\x3e\x3c/body\x3e\x3c/acpMessage\x3e',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a);return this._SendMsg(a,"ForceIdle")};this.acpForceBusy=function(a){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"ForceBusy"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter destAgentID \x3d"{7}" /\x3e\x3c/body\x3e\x3c/acpMessage\x3e',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a);return this._SendMsg(a,"ForceBusy")};this.acpForceOut=function(a){a=stringFormat('\x3cacpMessage ver\x3d"2.0.0" time\x3d"{0}"\x3e\x3cheader\x3e\x3csessionID\x3e{1}\x3c/sessionID\x3e\x3cserialID\x3e{2}\x3c/serialID\x3e\x3cserviceID\x3e\x3c/serviceID\x3e\x3ctimeStamp\x3e{3}\x3c/timeStamp\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"ForceOut"\x3e\x3cagent vccID\x3d"{4}" agentID\x3d"{5}" deviceID\x3d"{6}"/\x3e\x3cparameter destAgentID \x3d"{7}" /\x3e\x3c/body\x3e\x3c/acpMessage\x3e',getAcpTimeString(),this.g_sessionID,this.g_serialID,this.g_timeStamp,this.g_agent.vccID,this.g_agent.agentID,this.g_agent.deviceID,a);return this._SendMsg(a,"ForceOut")};this.acpEmptyHeartBeat=function(){return this._oAcpSocket.WSIsConnect()&&this._oAcpSocket.WSSendMsg("\x3cacpMessage\x3ealivecheck\x3c/acpMessage\x3e")?ACPI_SUCCESS:ACPI_FAILURE};this._createObject()}var MSG_NONE=0,MSG_READY=1,MSG_SUCCESS=2,MSG_FAILURE=3,MSG_OUTOFTIME=4,MSG_EXPECTION=5,MSG_QUIT=6,CST_NULL=-1,CST_ONE=0,CST_IVR=1,CST_INVITED=2,CST_MAKECALL=3,CST_HOLD=4,CST_CONSULT=5,CST_CONSULTBEFORE=6,CST_CONFERENCE=7,Notify_MSG=0,Notify_OUTOFTIME=1,Notify_INVOKE=2;function JAcpCall(){this._acpEvent=new JAcpEvent;this._requestType=ACP_UNKNOWN;this._errorCode=this._msgReceived=-1;this._errorDes="";this.ReleaseCall=function(){this._acpEvent.body.callinfo.callingDevice="";this._acpEvent.body.callinfo.calledDevice="";this._acpEvent.body.callinfo.orgCalledDevice="";this._acpEvent.body.callinfo.orgCallingDevice="";this._acpEvent.body.callinfo.callBackDevice="";this._acpEvent.body.callinfo.callData="";this._acpEvent.body.callinfo.callingDevice="";this._acpEvent.body.callinfo.callingDevice="";this._acpEvent.body.callinfo.count=0};this.RefreshCTIParam=function(a){this._acpEvent.body.datas[0]=a.datas[0];this._acpEvent.body.datas[1]=a.datas[1];this._acpEvent.body.datas[2]=a.datas[2]};this.RefreshHeaderInfo=function(a){this._acpEvent.head.curtime=a.curtime;this._acpEvent.head.sessionID=a.sessionID;this._acpEvent.head.serialID=a.serialID;this._acpEvent.head.serviceID=a.serviceID};this.RefressAgentInfo=function(a){this._acpEvent.body.agent.vccID=a.vccID;this._acpEvent.body.agent.agentID=a.agentID;this._acpEvent.body.agent.deviceID=a.deviceID;this._acpEvent.body.agent.agentStatus=a.agentStatus;this._acpEvent.body.agent.phoneStatus=a.phoneStatus;this._acpEvent.body.agent.master=a.master};this.RefressCauseInfo=function(a){this._acpEvent.body.cause.code=a.code;this._acpEvent.body.cause.desc=a.desc};this.RefressServiceDirect=function(a){this._acpEvent.head.serviceID=a};this.SetAgentStatus=function(a){this._acpEvent.body.agent.agentStatus=a};this.RefressDirection=function(a){this._acpEvent.head.direction=a};this.RefreshBody=function(a){this._acpEvent.body.eventClass=a.eventClass;this._acpEvent.body.eventType=a.eventType;this._acpEvent.body.datas_count=a.datas_count;this._acpEvent.body.eventTypeName=a.eventTypeName;for(var b=0;b<a.datas_count;b++)this._acpEvent.body.datas[b]=a.datas[b]};this.RefreshCallinfo=function(a,b){b&&(this._acpEvent.body.callinfo.callingDevice=a.callingDevice,this._acpEvent.body.callinfo.calledDevice=a.calledDevice,this._acpEvent.body.callinfo.orgCalledDevice=a.orgCalledDevice,this._acpEvent.body.callinfo.orgCallingDevice=a.orgCallingDevice,this._acpEvent.body.callinfo.callBackDevice=a.callBackDevice,this._acpEvent.body.callinfo.callData=a.callData);this._acpEvent.body.callinfo.count=a.count;if(!(0>=this._acpEvent.body.callinfo.count))for(var c=0;c<this._acpEvent.body.callinfo.count;++c)this._acpEvent.body.callinfo.device[c].deviceID=a.device[c].deviceID,this._acpEvent.body.callinfo.device[c].legID=a.device[c].legID,this._acpEvent.body.callinfo.device[c].phonestatus=a.device[c].phonestatus};this.RefreshCallReport=function(a,b){1==b?(this._acpEvent.body.reportinfo.callid="",this._acpEvent.body.reportinfo.sid="",this._acpEvent.body.reportinfo.usernumber="",this._acpEvent.body.reportinfo.direction="",this._acpEvent.body.reportinfo.serviceid="",this._acpEvent.body.reportinfo.detail="",this._acpEvent.body.reportinfo.starttime="",this._acpEvent.body.reportinfo.ringtime="",this._acpEvent.body.reportinfo.answertime="",this._acpEvent.body.reportinfo.endtime="",this._acpEvent.body.reportinfo.ringseconds="",this._acpEvent.body.reportinfo.answerseconds="",this._acpEvent.body.reportinfo.answerflag="",this._acpEvent.body.reportinfo.srfmsgid="",this._acpEvent.body.reportinfo.msserver="",this._acpEvent.body.reportinfo.callrescode=""):(this._acpEvent.body.reportinfo.callid=a.callid,this._acpEvent.body.reportinfo.sid=a.sid,this._acpEvent.body.reportinfo.usernumber=a.usernumber,this._acpEvent.body.reportinfo.direction=a.direction,this._acpEvent.body.reportinfo.serviceid=a.serviceid,this._acpEvent.body.reportinfo.detail=a.detail,this._acpEvent.body.reportinfo.starttime=a.starttime,this._acpEvent.body.reportinfo.ringtime=a.ringtime,this._acpEvent.body.reportinfo.answertime=a.answertime,this._acpEvent.body.reportinfo.endtime=a.endtime,this._acpEvent.body.reportinfo.ringseconds=a.ringseconds,this._acpEvent.body.reportinfo.answerseconds=a.answerseconds,this._acpEvent.body.reportinfo.answerflag=a.answerflag,this._acpEvent.body.reportinfo.srfmsgid=a.srfmsgid,this._acpEvent.body.reportinfo.msserver=a.msserver,this._acpEvent.body.reportinfo.callrescode=a.callrescode)};this.GetAlertDevice=function(){for(var a=0;a<this._acpEvent.body.callinfo.count;a++)if(this._acpEvent.body.callinfo.device[a].phonestatus==CS_ALERTING)return this._acpEvent.body.callinfo.device[a];return 0};this.GetHoldDevice=function(){for(var a=0;a<this._acpEvent.body.callinfo.count;a++)if(this._acpEvent.body.callinfo.device[a].phonestatus==CS_HELD)return this._acpEvent.body.callinfo.device[a];return 0};this.GetDeviceByDeviceID=function(a){for(var b=0;b<this._acpEvent.body.callinfo.count;b++)if(this._acpEvent.body.callinfo.device[b].deviceID==a)return this._acpEvent.body.callinfo.device[b];return 0};this.GetIndexByDeviceID=function(a){for(var b=0;b<this._acpEvent.body.callinfo.count;b++)if(this._acpEvent.body.callinfo.device[b].deviceID==a)return b;return-1};this.GetCallInfoString=function(){for(var a="",b="",c=0;c<this._acpEvent.body.callinfo.count;c++)a=this._acpEvent.body.callinfo.device[c],a=stringFormat("{0}|{1}|{2}",a.legID,a.deviceID,a.phonestatus),b=0==c?a:b+"$"+a;return b};this.GetDeviceCount=function(){return this._acpEvent.body.callinfo.count};this.GetCallScene=function(){var a;switch(this.GetDeviceCount()){case 1:a=CST_ONE;break;case 2:a=this._acpEvent.body.agent.deviceID!=this._acpEvent.body.callinfo.callingDevice?0==this._acpEvent.body.agent.master?CST_INVITED:CST_IVR:CST_MAKECALL;break;case 3:case 4:case 5:case 6:a=0!=this.GetHoldDevice()?0!=this.GetAlertDevice()?CST_CONSULTBEFORE:CST_CONSULT:CST_CONFERENCE;break;default:a=CST_NULL}return a};this.GetUserDevice=function(){if(2!=this.GetDeviceCount())return 0;for(var a=0;a<this._acpEvent.body.callinfo.count;a++)if(this._acpEvent.body.callinfo.device[a].deviceID!=this._acpEvent.body.agent.deviceID)return this._acpEvent.body.callinfo.device[a];return 0};this.GetUserNo=function(){return this._acpEvent.body.callinfo.callingDevice==this._acpEvent.body.agent.deviceID?this._acpEvent.body.callinfo.orgCalledDevice:this._acpEvent.body.callinfo.callingDevice};this.GetPartenerNum=function(){switch(this._acpEvent.head.serviceID){case CD_IVR_CALLIN:case CD_SERVRE_EXACT_CALLOUT:case CD_SINGLE_CALLOUT:case CD_STEPBYSTEP_CALLOUT:case CD_FORECAST_CALLOUT:case CD_CONSULT_CALLOUT:return this._acpEvent.body.callinfo.callingDevice;case CD_PREVIEW_CALLOUT:case CD_AGENT_OUTSIDE_CALLOUT:case CD_AGENT_INSIDE_CALLOUT:case CD_EXACT_PREVIEW_CALLOUT:case CD_MONITOR_CALLIN:case CD_INTERCEPT_CALLIN:case CD_INSERT_CALLIN:return this._acpEvent.body.callinfo.orgCalledDevice;case CD_HELP_CALLIN:return this._acpEvent.body.callinfo.orgCalledDevice;case CD_IVR_CALLOUT:case CD_BRIDGE_CALLOUT:return this._acpEvent.body.callinfo.callingDevice;default:return this._acpEvent.body.callinfo.callingDevice}};this.GetDirection=function(){return this._acpEvent.head.direction};this.GetServiceDirect=function(){return this._acpEvent.head.serviceID};this.DeleteDeviceByID=function(a){a=this.GetIndexByDeviceID(a);if(-1!=a){for(;a<this._acpEvent.body.callinfo.count;++a)this._acpEvent.body.callinfo.device[a].deviceID=this._acpEvent.body.callinfo.device[a+1].deviceID,this._acpEvent.body.callinfo.device[a].legID=this._acpEvent.body.callinfo.device[a+1].legID,this._acpEvent.body.callinfo.device[a].phonestatus=this._acpEvent.body.callinfo.device[a+1].phonestatus;--this._acpEvent.body.callinfo.count}};return this}function JACPParse(){this.m_arrCmd=[];this.m_arrCmdIndex=[];this._oParse=new CXmlParse;this._oAcpEvent=new JAcpEvent;this._Init=function(){0<this.m_arrCmd.length||(this.m_arrCmd.push("heartBeat"),this.m_arrCmdIndex.push(ACP_HEART_BEAT),this.m_arrCmd.push("Initial"),this.m_arrCmdIndex.push(ACP_Initial_CONF),this.m_arrCmd.push("SignIn"),this.m_arrCmdIndex.push(ACP_SignIn_CONF),this.m_arrCmd.push("SignOut"),this.m_arrCmdIndex.push(ACP_SignOut_CONF),this.m_arrCmd.push("SetBusy"),this.m_arrCmdIndex.push(ACP_SetBusy_CONF),this.m_arrCmd.push("SetIdle"),this.m_arrCmdIndex.push(ACP_SetIdle_CONF),this.m_arrCmd.push("AgentReport"),this.m_arrCmdIndex.push(ACP_AgentReport_CONF),this.m_arrCmd.push("SetAgentAutoEnterIdle"),this.m_arrCmdIndex.push(ACP_SetAgentAutoEnterIdle_CONF),this.m_arrCmd.push("AgentEnterIdle"),this.m_arrCmdIndex.push(ACP_AgentEnterIdle_CONF),this.m_arrCmd.push("SetWrapUp"),this.m_arrCmdIndex.push(ACP_SetWrapUp_CONF),this.m_arrCmd.push("ForceIdle"),this.m_arrCmdIndex.push(ACP_ForceIdle_CONF),this.m_arrCmd.push("ForceBusy"),this.m_arrCmdIndex.push(ACP_ForceBusy_CONF),this.m_arrCmd.push("ForceOut"),this.m_arrCmdIndex.push(ACP_ForceOut_CONF),this.m_arrCmd.push("Lock"),this.m_arrCmdIndex.push(ACP_Lock_CONF),this.m_arrCmd.push("UnLock"),this.m_arrCmdIndex.push(ACP_UnLock_CONF),this.m_arrCmd.push("ReleaseCall"),this.m_arrCmdIndex.push(ACP_ReleaseCall_CONF),this.m_arrCmd.push("ReleaseCallByCallID"),this.m_arrCmdIndex.push(ACP_ReleaseCallByCallID_CONF),this.m_arrCmd.push("SendDTMF"),this.m_arrCmdIndex.push(ACP_SendDTMF_CONF),this.m_arrCmd.push("CallInside"),this.m_arrCmdIndex.push(ACP_CallInside_CONF),this.m_arrCmd.push("Consultation"),this.m_arrCmdIndex.push(ACP_Consultation_CONF),this.m_arrCmd.push("CallOutside"),this.m_arrCmdIndex.push(ACP_CallOutside_CONF),this.m_arrCmd.push("SingleStepTransfer"),this.m_arrCmdIndex.push(ACP_SingleStepTransfer_CONF),this.m_arrCmd.push("Transfer"),this.m_arrCmdIndex.push(ACP_Transfer_CONF),this.m_arrCmd.push("SetTransfer"),this.m_arrCmdIndex.push(ACP_SetTransfer_CONF),this.m_arrCmd.push("Hold"),this.m_arrCmdIndex.push(ACP_Hold_CONF),this.m_arrCmd.push("RetrieveHold"),this.m_arrCmdIndex.push(ACP_RetrieveHold_CONF),this.m_arrCmd.push("Conference"),this.m_arrCmdIndex.push(ACP_Conference_CONF),this.m_arrCmd.push("Alternate"),this.m_arrCmdIndex.push(ACP_Alternate_CONF),this.m_arrCmd.push("DoReplyMultimeAndHangUpCall"),this.m_arrCmdIndex.push(ACP_DoReplyMultimeAndHangUpCall_CONF),this.m_arrCmd.push("Listen"),this.m_arrCmdIndex.push(ACP_Listen_CONF),this.m_arrCmd.push("Help"),this.m_arrCmdIndex.push(ACP_Help_CONF),this.m_arrCmd.push("Intercept"),this.m_arrCmdIndex.push(ACP_Intercept_CONF),this.m_arrCmd.push("Insert"),this.m_arrCmdIndex.push(ACP_Insert_CONF),this.m_arrCmd.push("StopInsert"),this.m_arrCmdIndex.push(ACP_StopInsert_CONF),this.m_arrCmd.push("BeginRecord"),this.m_arrCmdIndex.push(ACP_BeginRecord_CONF),this.m_arrCmd.push("StopRecord"),this.m_arrCmdIndex.push(ACP_StopRecord_CONF),this.m_arrCmd.push("BeginPlay"),this.m_arrCmdIndex.push(ACP_BeginPlay_CONF),this.m_arrCmd.push("StopPlay"),this.m_arrCmdIndex.push(ACP_StopPlay_CONF),this.m_arrCmd.push("BeginCollect"),this.m_arrCmdIndex.push(ACP_BeginCollect_CONF),this.m_arrCmd.push("StopCollect"),this.m_arrCmdIndex.push(ACP_StopCollect_CONF),this.m_arrCmd.push("Bridge"),this.m_arrCmdIndex.push(ACP_Bridge_CONF),this.m_arrCmd.push("SMMsgReq"),this.m_arrCmdIndex.push(ACP_SMMsg_CONF),this.m_arrCmd.push("Answer"),this.m_arrCmdIndex.push(ACP_Answer_CONF),this.m_arrCmd.push("Mute"),this.m_arrCmdIndex.push(ACP_Mute_CONF),this.m_arrCmd.push("SetCallData"),this.m_arrCmdIndex.push(ACP_SetCallData_CONF),this.m_arrCmd.push("GetCallData"),this.m_arrCmdIndex.push(ACP_GetCallData_CONF),this.m_arrCmd.push("QueryTotalQueueWaitNum"),this.m_arrCmdIndex.push(ACP_QueryTotalQueueWaitNum_CONF),this.m_arrCmd.push("QueryQueueWaitNum"),this.m_arrCmdIndex.push(ACP_QueryQueueWaitNum_CONF),this.m_arrCmd.push("QueryAgentStatus"),this.m_arrCmdIndex.push(ACP_QueryAgentStatus_CONF),this.m_arrCmd.push("GetAccessNo"),this.m_arrCmdIndex.push(ACP_GetAccessNo_CONF),this.m_arrCmd.push("QueryAgentCallInfo"),this.m_arrCmdIndex.push(ACP_QueryAgentCallInfo_CONF),this.m_arrCmd.push("SetCTIParam"),this.m_arrCmdIndex.push(ACP_SetCTIParam_CONF),this.m_arrCmd.push("GetCTIParam"),this.m_arrCmdIndex.push(ACP_GetCTIParam_CONF),this.m_arrCmd.push("GetCTITime"),this.m_arrCmdIndex.push(ACP_GetCTITime_CONF),this.m_arrCmd.push("QuerySpAgentList"),this.m_arrCmdIndex.push(ACP_QuerySpAgentList_CONF),this.m_arrCmd.push("ChangeCallQueue"),this.m_arrCmdIndex.push(ACP_ChangeCallQueue_CONF),this.m_arrCmd.push("AgentReconnect"),this.m_arrCmdIndex.push(ACP_AgentReconnect_CONF),this.m_arrCmd.push("WorkReport"),this.m_arrCmdIndex.push(ACP_WorkReport_CONF),this.m_arrCmd.push("SendWeiboMsg"),this.m_arrCmdIndex.push(ACP_SendWeiboMsg_CONF),this.m_arrCmd.push("SendMessage"),this.m_arrCmdIndex.push(ACP_SendMessage_CONF),this.m_arrCmd.push("SendWeChatMsg"),this.m_arrCmdIndex.push(ACP_SendWeChatMsg_CONF),this.m_arrCmd.push("QueryWeChatSessionIDs"),this.m_arrCmdIndex.push(ACP_QueryWeChatSessionIDs_CONF),this.m_arrCmd.push("GetWeChatParam"),this.m_arrCmdIndex.push(ACP_GetWeChatParam_CONF),this.m_arrCmd.push("TransferCallQueue"),this.m_arrCmdIndex.push(ACP_TransferCallQueue_CONF),this.m_arrCmd.push("ForceReleaseCall"),this.m_arrCmdIndex.push(ACP_ForceReleaseCall_CONF),this.m_arrCmd.push("OnOrigated"),this.m_arrCmdIndex.push(ACP_OnOrigated),this.m_arrCmd.push("OnAnswerRequest"),this.m_arrCmdIndex.push(ACP_OnAnswerRequest),this.m_arrCmd.push("OnAnswerSuccess"),this.m_arrCmdIndex.push(ACP_OnAnswerSuccess),this.m_arrCmd.push("OnAnswerFailure"),this.m_arrCmdIndex.push(ACP_OnAnswerFailure),this.m_arrCmd.push("OnUserHangupBeforeResponse"),this.m_arrCmdIndex.push(ACP_OnUserHangupBeforeResponse),this.m_arrCmd.push("OnRequestRelease"),this.m_arrCmdIndex.push(ACP_OnRequestRelease),this.m_arrCmd.push("OnReleaseSuccess"),this.m_arrCmdIndex.push(ACP_OnReleaseSuccess),this.m_arrCmd.push("OnReleaseFailure"),this.m_arrCmdIndex.push(ACP_OnReleaseFailure),this.m_arrCmd.push("OnLongNoAnswer"),this.m_arrCmdIndex.push(ACP_OnLongNoAnswer),this.m_arrCmd.push("OnConsultationBack"),this.m_arrCmdIndex.push(ACP_OnConsultationBack),this.m_arrCmd.push("OnConsultationSuccess"),this.m_arrCmdIndex.push(ACP_OnConsultationSuccess),this.m_arrCmd.push("OnConsultationFailure"),this.m_arrCmdIndex.push(ACP_OnConsultationFailure),this.m_arrCmd.push("OnTransSuccess"),this.m_arrCmdIndex.push(ACP_OnTransSuccess),this.m_arrCmd.push("OnTransFailure"),this.m_arrCmdIndex.push(ACP_OnTransFailure),this.m_arrCmd.push("OnTransferred"),this.m_arrCmdIndex.push(ACP_OnTransferred),this.m_arrCmd.push("OnReturnFromIVR"),this.m_arrCmdIndex.push(ACP_OnReturnFromIVR),this.m_arrCmd.push("OnReturnFromPhone"),this.m_arrCmdIndex.push(ACP_OnReturnFromPhone),this.m_arrCmd.push("OnBridgeSuccess"),this.m_arrCmdIndex.push(ACP_OnBridgeSuccess),this.m_arrCmd.push("OnBridgeFailure"),this.m_arrCmdIndex.push(ACP_OnBridgeFailure),this.m_arrCmd.push("OnBeginSendDTMFSuccess"),this.m_arrCmdIndex.push(ACP_OnBeginSendDTMFSuccess),this.m_arrCmd.push("OnBeginSendDTMFFailure"),this.m_arrCmdIndex.push(ACP_OnBeginSendDTMFFailure),this.m_arrCmd.push("OnStopSendDTMFSuccess"),this.m_arrCmdIndex.push(ACP_OnStopSendDTMFSuccess),this.m_arrCmd.push("OnStopSendDTMFFailure"),this.m_arrCmdIndex.push(ACP_OnStopSendDTMFFailure),this.m_arrCmd.push("OnSingleTransferSuccess"),this.m_arrCmdIndex.push(ACP_OnSingleTransferSuccess),this.m_arrCmd.push("OnSingleTransferFailure"),this.m_arrCmdIndex.push(ACP_OnSingleTransferFailure),this.m_arrCmd.push("OnCallInsideSuccess"),this.m_arrCmdIndex.push(ACP_OnCallInsideSuccess),this.m_arrCmd.push("OnCallInsideFailure"),this.m_arrCmdIndex.push(ACP_OnCallInsideFailure),this.m_arrCmd.push("OnCallInsideSuccTalk"),this.m_arrCmdIndex.push(ACP_OnCallInsideSuccTalk),this.m_arrCmd.push("OnCallOutsideSuccess"),this.m_arrCmdIndex.push(ACP_OnCallOutsideSuccess),this.m_arrCmd.push("OnCallOutsideFailure"),this.m_arrCmdIndex.push(ACP_OnCallOutsideFailure),this.m_arrCmd.push("OnCallOutsideSuccTalk"),this.m_arrCmdIndex.push(ACP_OnCallOutsideSuccTalk),this.m_arrCmd.push("OnHoldSuccess"),this.m_arrCmdIndex.push(ACP_OnHoldSuccess),this.m_arrCmd.push("OnHoldFailure"),this.m_arrCmdIndex.push(ACP_OnHoldFailure),this.m_arrCmd.push("OnRetrieveHoldSuccess"),this.m_arrCmdIndex.push(ACP_OnRetrieveHoldSuccess),this.m_arrCmd.push("OnRetrieveHoldFailure"),this.m_arrCmdIndex.push(ACP_OnRetrieveHoldFailure),this.m_arrCmd.push("OnHoldCallRelease"),this.m_arrCmdIndex.push(ACP_OnHoldCallRelease),this.m_arrCmd.push("OnConferenceSuccess"),this.m_arrCmdIndex.push(ACP_OnConferenceSuccess),this.m_arrCmd.push("OnConferenceFailure"),this.m_arrCmdIndex.push(ACP_OnConferenceFailure),this.m_arrCmd.push("OnConferenceSucTalk"),this.m_arrCmdIndex.push(ACP_OnConferenceSucTalk),this.m_arrCmd.push("OnHangupCallInConf"),this.m_arrCmdIndex.push(ACP_OnHangupCallInConf),this.m_arrCmd.push("OnAlternateSuccess"),this.m_arrCmdIndex.push(ACP_OnAlternateSuccess),this.m_arrCmd.push("OnAlternated"),this.m_arrCmdIndex.push(ACP_OnAlternated),this.m_arrCmd.push("OnAlternateFailure"),this.m_arrCmdIndex.push(ACP_OnAlternateFailure),this.m_arrCmd.push("OnListenSuccess"),this.m_arrCmdIndex.push(ACP_OnListenSuccess),this.m_arrCmd.push("OnListenFailure"),this.m_arrCmdIndex.push(ACP_OnListenFailure),this.m_arrCmd.push("OnHelpSuccess"),this.m_arrCmdIndex.push(ACP_OnHelpSuccess),this.m_arrCmd.push("OnHelpFailure"),this.m_arrCmdIndex.push(ACP_OnHelpFailure),this.m_arrCmd.push("OnInsertSuccess"),this.m_arrCmdIndex.push(ACP_OnInsertSuccess),this.m_arrCmd.push("OnInsertFailure"),this.m_arrCmdIndex.push(ACP_OnInsertFailure),this.m_arrCmd.push("OnStopInsertSuccess"),this.m_arrCmdIndex.push(ACP_OnStopInsertSuccess),this.m_arrCmd.push("OnStopInsertFailure"),this.m_arrCmdIndex.push(ACP_OnStopInsertFailure),this.m_arrCmd.push("OnInterceptSuccess"),this.m_arrCmdIndex.push(ACP_OnInterceptSuccess),this.m_arrCmd.push("OnInterceptFailure"),this.m_arrCmdIndex.push(ACP_OnInterceptFailure),this.m_arrCmd.push("OnForceIdleSuccess"),this.m_arrCmdIndex.push(ACP_OnForceIdleSuccess),this.m_arrCmd.push("OnForceIdleFailure"),this.m_arrCmdIndex.push(ACP_OnForceIdleFailure),this.m_arrCmd.push("OnForceBusySuccess"),this.m_arrCmdIndex.push(ACP_OnForceBusySuccess),this.m_arrCmd.push("OnForceBusyFailure"),this.m_arrCmdIndex.push(ACP_OnForceBusyFailure),this.m_arrCmd.push("OnForceOutSuccess"),this.m_arrCmdIndex.push(ACP_OnForceOutSuccess),this.m_arrCmd.push("OnForceOutFailure"),this.m_arrCmdIndex.push(ACP_OnForceOutFailure),this.m_arrCmd.push("OnBeginRecordSuccess"),this.m_arrCmdIndex.push(ACP_OnBeginRecordSuccess),this.m_arrCmd.push("OnBeginRecordFailure"),this.m_arrCmdIndex.push(ACP_OnBeginRecordFailure),this.m_arrCmd.push("OnStopRecordSuccess"),this.m_arrCmdIndex.push(ACP_OnStopRecordSuccess),this.m_arrCmd.push("OnStopRecordFailure"),this.m_arrCmdIndex.push(ACP_OnStopRecordFailure),this.m_arrCmd.push("OnForceIdle"),this.m_arrCmdIndex.push(ACP_OnForceIdle),this.m_arrCmd.push("OnForceBusy"),this.m_arrCmdIndex.push(ACP_OnForceBusy),this.m_arrCmd.push("OnForceOut"),this.m_arrCmdIndex.push(ACP_OnForceOut),this.m_arrCmd.push("OnSignOuted"),this.m_arrCmdIndex.push(ACP_OnSignOuted),this.m_arrCmd.push("OnSystemIdle"),this.m_arrCmdIndex.push(ACP_OnSystemIdle),this.m_arrCmd.push("OnLocked"),this.m_arrCmdIndex.push(ACP_OnLocked),this.m_arrCmd.push("OnUnLocked"),this.m_arrCmdIndex.push(ACP_OnUnLocked),this.m_arrCmd.push("OnForceRelease"),this.m_arrCmdIndex.push(ACP_OnForceRelease),this.m_arrCmd.push("OnAgentAllBusy"),this.m_arrCmdIndex.push(ACP_OnAgentAllBusy),this.m_arrCmd.push("OnIntercepted"),this.m_arrCmdIndex.push(ACP_OnIntercepted),this.m_arrCmd.push("OnInserted"),this.m_arrCmdIndex.push(ACP_OnInserted),this.m_arrCmd.push("OnStopListenSuccess"),this.m_arrCmdIndex.push(ACP_OnStopListenSuccess),this.m_arrCmd.push("OnStopListenFailure"),this.m_arrCmdIndex.push(ACP_OnStopListenFailure),this.m_arrCmd.push("OnListened"),this.m_arrCmdIndex.push(ACP_OnListened),this.m_arrCmd.push("OnBeginPlaySuccess"),this.m_arrCmdIndex.push(ACP_OnBeginPlaySuccess),this.m_arrCmd.push("OnBeginPlayFailure"),this.m_arrCmdIndex.push(ACP_OnBeginPlayFailure),this.m_arrCmd.push("OnStopPlaySuccess"),this.m_arrCmdIndex.push(ACP_OnStopPlaySuccess),this.m_arrCmd.push("OnStopPlayFailure"),this.m_arrCmdIndex.push(ACP_OnStopPlayFailure),this.m_arrCmd.push("OnBeginCollectSuccess"),this.m_arrCmdIndex.push(ACP_OnBeginCollectSuccess),this.m_arrCmd.push("OnBeginCollectFailure"),this.m_arrCmdIndex.push(ACP_OnBeginCollectFailure),this.m_arrCmd.push("OnStopCollectSuccess"),this.m_arrCmdIndex.push(ACP_OnStopCollectSuccess),this.m_arrCmd.push("OnStopcollectFailure"),this.m_arrCmdIndex.push(ACP_OnStopcollectFailure),this.m_arrCmd.push("GetLog"),this.m_arrCmdIndex.push(ACP_GetLog),this.m_arrCmd.push("OnCallQueueQuery"),this.m_arrCmdIndex.push(ACP_OnCallQueueQuery),this.m_arrCmd.push("OnQueueReport"),this.m_arrCmdIndex.push(ACP_OnQueueReport),this.m_arrCmd.push("OnSystemMessage"),this.m_arrCmdIndex.push(ACP_OnSystemMessage),this.m_arrCmd.push("OnRecvWeiboMsg"),this.m_arrCmdIndex.push(ACP_OnRecvWeiboMsg),this.m_arrCmd.push("OnStaticInfoReport"),this.m_arrCmdIndex.push(ACP_OnStaticInfoReport),this.m_arrCmd.push("OnRecvWeChatMsg"),this.m_arrCmdIndex.push(ACP_OnRecvWeChatMsg),this.m_arrCmd.push("OnWeChatEventReport"),this.m_arrCmdIndex.push(ACP_OnWeChatEventReport),this.m_arrCmd.push("OnForceReleaseCallSuccess"),this.m_arrCmdIndex.push(ACP_OnForceReleaseCallSuccess),this.m_arrCmd.push("OnForceReleaseCallFailure"),this.m_arrCmdIndex.push(ACP_OnForceReleaseCallFailure),this.m_arrCmd.push("OnAgentBusyReason"),this.m_arrCmdIndex.push(ACP_OnAgentBusyReason),this.m_arrCmd.push("OnAsrEventReport"),this.m_arrCmdIndex.push(ACP_OnAsrEventReport),this.m_arrCmd.push("OnStopSmSuccess"),this.m_arrCmdIndex.push(ACP_OnStopSmSuccess))};this._BuildGeneralConf=function(a,b){this._BuildAgentInfo(a.body.agent,b);this._BuildCauseInfo(a.body.cause,b)};this._BuildAgentInfo=function(a,b){var c=b.nType==xmlForIE?b.queryNode("acpMessage/body/agent"):b.queryNode("agent");null!=c&&(a.agentID=b.queryNodeAttribute(c,"agentID"),a.vccID=b.queryNodeAttribute(c,"vccID"),a.deviceID=b.queryNodeAttribute(c,"deviceID"),a.agentStatus=stringToInt(b.queryNodeAttribute(c,"agentStatus"),0),a.phoneStatus=stringToInt(b.queryNodeAttribute(c,"phoneStatus"),0),a.master=stringToInt(b.queryNodeAttribute(c,"master"),0))};this._BuildCauseInfo=function(a,b){var c=b.nType==xmlForIE?b.queryNode("acpMessage/body/cause"):b.queryNode("cause");null!=c&&(a.desc=b.queryNodeAttribute(c,"desc"),a.code=stringToInt(b.queryNodeAttribute(c,"code"),0))};this._BuildCallinfo=function(a,b){if(b.nType==xmlForIE){var c=b.queryNode("acpMessage/body/callinfo");if(null!=c&&(a.calledDevice=b.queryNodeAttribute(c,"calledDevice"),a.orgCalledDevice=b.queryNodeAttribute(c,"origCalledDevice"),a.callingDevice=b.queryNodeAttribute(c,"origCallingDevice"),a.orgCallingDevice=b.queryNodeAttribute(c,"callingDevice"),a.opAgentID=b.queryNodeAttribute(c,"opAgentID"),a.callBackDevice=b.queryNodeAttribute(c,"callBackDevice"),a.callData=b.queryNodeAttribute(c,"callData"),c=b.queryNodes("acpMessage/body/callinfo/device"),null!=c)){var d=c.length+1;a.count=d;if(!(0>=a.count)){var e=b.queryNode("acpMessage/body/agent");null!=e&&(a.device[0].legID=4,a.device[0].deviceID=b.queryNodeAttribute(e,"deviceID"),a.device[0].phonestatus=stringToInt(b.queryNodeAttribute(e,"phoneStatus"),0));for(e=1;e<d;++e)a.device[e].deviceID=this._GetSourceDevice(b.queryNodeAttribute(c[e-1],"deviceID")),a.device[e].legID=stringToInt(b.queryNodeAttribute(c[e-1],"legID"),0),a.device[e].phonestatus=stringToInt(b.queryNodeAttribute(c[e-1],"phonestatus"),0)}}}else if(c=b.queryNode("callinfo"),null!=c&&(a.calledDevice=b.queryNodeAttribute(c,"calledDevice"),a.orgCalledDevice=b.queryNodeAttribute(c,"origCalledDevice"),a.callingDevice=b.queryNodeAttribute(c,"origCallingDevice"),a.orgCallingDevice=b.queryNodeAttribute(c,"callingDevice"),a.opAgentID=b.queryNodeAttribute(c,"opAgentID"),a.callBackDevice=b.queryNodeAttribute(c,"callBackDevice"),a.callData=b.queryNodeAttribute(c,"callData"),c=b.queryNodes("device"),null!=c&&(d=c.length+1,a.count=d,!(0>=a.count))))for(e=b.queryNode("agent"),null!=e&&(a.device[0].legID=4,a.device[0].deviceID=b.queryNodeAttribute(e,"deviceID"),a.device[0].phonestatus=stringToInt(b.queryNodeAttribute(e,"phoneStatus"),0)),e=1;e<d;++e)a.device[e].deviceID=this._GetSourceDevice(b.queryNodeAttribute(c[e-1],"deviceID")),a.device[e].legID=stringToInt(b.queryNodeAttribute(c[e-1],"legID"),0),a.device[e].phonestatus=stringToInt(b.queryNodeAttribute(c[e-1],"phonestatus"),0)};this._BuildAnswerRequestEventReport=function(a,b){this._BuildGeneralConf(a,b);var c=b.queryNode("autoStatusInteval");null!=c&&(a.body.datas[0]=stringCopy(b.queryNodeValue(c),""),a.body.datas[1]=stringCopy(b.queryNodeAttribute(c,"idleStatus"),""),a.body.datas[2]=stringCopy(b.queryNodeAttribute(c,"idleSubStatus"),""));a.body.datas[3]=stringCopy(this._oParse.queryNodeValueByPath("alertingDevice"),"");a.body.datas[4]=stringCopy(this._oParse.queryNodeValueByPath("taskID"),"");a.body.datas[5]=stringCopy(this._oParse.queryNodeValueByPath("transParentParamet"),"");a.body.datas[6]=stringCopy(this._oParse.queryNodeValueByPath("authority"),"");a.body.datas[7]=stringCopy(this._oParse.queryNodeValueByPath("areaCode"),"");a.body.datas[8]=stringCopy(this._oParse.queryNodeValueByPath("fileName"),"");a.body.datas[9]=stringCopy(this._oParse.queryNodeValueByPath("networkInfo"),"");a.body.datas[10]=stringCopy(this._oParse.queryNodeValueByPath("queueTime"),"");a.body.datas[11]=stringCopy(this._oParse.queryNodeValueByPath("autoAnswer"),"");a.body.datas[12]=stringCopy(this._oParse.queryNodeValueByPath("projectID"),"");a.body.datas_count=13;this._BuildCallinfo(a.body.callinfo,b)};this._BuildCallReportInfo=function(a,b){var c=b.nType==xmlForIE?b.queryNode("acpMessage/body/reportinfo"):b.queryNode("reportinfo");null!=c&&(a.callid=b.queryNodeAttribute(c,"callid"),a.sid=b.queryNodeAttribute(c,"sid"),a.usernumber=b.queryNodeAttribute(c,"usernumber"),a.direction=b.queryNodeAttribute(c,"direction"),a.serviceid=b.queryNodeAttribute(c,"serviceid"),a.detail=b.queryNodeAttribute(c,"detail"),a.starttime=b.queryNodeAttribute(c,"starttime"),a.ringtime=b.queryNodeAttribute(c,"ringtime"),a.answertime=b.queryNodeAttribute(c,"answertime"),a.endtime=b.queryNodeAttribute(c,"endtime"),a.ringseconds=b.queryNodeAttribute(c,"ringseconds"),a.answerseconds=b.queryNodeAttribute(c,"answerseconds"),a.answerflag=b.queryNodeAttribute(c,"answerflag"),a.srfmsgid=b.queryNodeAttribute(c,"srfmsgid"),a.msserver=b.queryNodeAttribute(c,"msserver"),a.callrescode=b.queryNodeAttribute(c,"callrescode"))};this._GetSourceDevice=function(a){return 0==a||null==a||"undefined"==typeof a?"":8<=a.length&&"cinss10"==a.substr(0,7)?a.substr(7,a.length):a};this.ParseMsg=function(a){var b=!0;try{var c="\x3cacpMessage"+getSubString(a,"\x3cacpMessage","\x3c/acpMessage\x3e")+"\x3c/acpMessage\x3e";if(!this._oParse.loadXml(c))return!1;this._oAcpEvent.acpMessage=c;if(this._oParse.nType==xmlForIE)this._oAcpEvent.head.curtime=this._oParse.queryNodeAttributeByPath("acpMessage","time"),this._oAcpEvent.head.sessionID=this._oParse.queryNodeValueByPath("acpMessage/header/sessionID"),this._oAcpEvent.head.serialID=this._oParse.queryNodeValueByPath("acpMessage/header/serialID"),this._oAcpEvent.head.direction=stringToInt(this._oParse.queryNodeAttributeByPath("acpMessage/header/serviceID","direction"),-1),this._oAcpEvent.head.serviceID=stringToInt(this._oParse.queryNodeValueByPath("acpMessage/header/serviceID"),0),this._oAcpEvent.head.timeStamp=this._oParse.queryNodeValueByPath("acpMessage/header/timeStamp"),this._oAcpEvent.body.eventTypeName=this._oParse.queryNodeAttributeByPath("acpMessage/body","name");else{this._oAcpEvent.head.curtime=this._oParse.queryNodeAttributeByPath("acpMessage","time");this._oAcpEvent.head.sessionID=this._oParse.queryNodeValueByPath("sessionID");this._oAcpEvent.head.serialID=this._oParse.queryNodeValueByPath("serialID");this._oAcpEvent.head.direction=stringToInt(this._oParse.queryNodeAttributeByPath("serviceID","direction"),-1);this._oAcpEvent.head.serviceID=stringToInt(this._oParse.queryNodeValueByPath("serviceID"),0);this._oAcpEvent.head.timeStamp=this._oParse.queryNodeValueByPath("timeStamp");this._oAcpEvent.body.eventTypeName=this._oParse.queryNodeAttributeByPath("body","name");var d=this._oParse.queryNodeAttributeByPath("body","type");"request"==d?this._oAcpEvent.body.eventClass=EC_REQUEST:"response"==d?this._oAcpEvent.body.eventClass=EC_CONFIRMATION:"event"==d&&(this._oAcpEvent.body.eventClass=EC_UNSOLICITED)}this._oAcpEvent.body.eventType=this.GetCmdIndex(this._oAcpEvent.body.eventTypeName);switch(this._oAcpEvent.body.eventType){case ACP_Initial_CONF:this._oAcpEvent.body.datas[0]=stringCopy(this._oParse.queryNodeAttributeByPath("parameter","code"),"0");this._oAcpEvent.body.datas[1]=stringCopy(this._oParse.queryNodeAttributeByPath("parameter","desc"),"");this._oAcpEvent.body.datas[2]=stringCopy(this._oParse.queryNodeAttributeByPath("parameter","ip"),"");this._oAcpEvent.body.datas[3]=stringCopy(this._oParse.queryNodeAttributeByPath("parameter","port"),"");this._oAcpEvent.body.datas[4]=stringCopy(this._oParse.queryNodeAttributeByPath("parameter","param"),"");this._oAcpEvent.body.datas_count=5;break;case ACP_SignIn_CONF:this._BuildGeneralConf(this._oAcpEvent,this._oParse);this._oAcpEvent.body.datas[0]=stringCopy(this._oParse.queryNodeAttributeByPath("agentParam","idleStatus"),"");this._oAcpEvent.body.datas[1]=stringCopy(this._oParse.queryNodeAttributeByPath("agentParam","idleSubStatus"),"");this._oAcpEvent.body.datas[2]=stringCopy(this._oParse.queryNodeAttributeByPath("agentParam","groupID"),"");this._oAcpEvent.body.datas[3]=stringCopy(this._oParse.queryNodeAttributeByPath("agentParam","agentType"),"");this._oAcpEvent.body.datas[4]=stringCopy(this._oParse.queryNodeAttributeByPath("agentParam","locked"),"");this._oAcpEvent.body.datas[5]=stringCopy(this._oParse.queryNodeAttributeByPath("agentParam","allTimeRecord"),"");this._oAcpEvent.body.datas[6]=stringCopy(this._oParse.queryNodeAttributeByPath("agentParam","deviceType"),"");this._oAcpEvent.body.datas[7]=stringCopy(this._oParse.queryNodeAttributeByPath("agentParam","forwardID"),"");this._oAcpEvent.body.datas[8]=stringCopy(this._oParse.queryNodeAttributeByPath("agentParam","forwardState"),"");this._oAcpEvent.body.datas[9]=stringCopy(this._oParse.queryNodeAttributeByPath("agentParam","answerType"),"");this._oAcpEvent.body.datas[10]=stringCopy(this._oParse.queryNodeAttributeByPath("agentParam","ctiEvent"),"");this._oAcpEvent.body.datas[11]=stringCopy(this._oParse.queryNodeAttributeByPath("agentParam","av"),"");this._oAcpEvent.body.datas[12]=stringCopy(this._oParse.queryNodeAttributeByPath("agentParam","substatus"),"");this._oAcpEvent.body.datas[13]=stringCopy(this._oParse.queryNodeAttributeByPath("agentParam","loginmode"),"");this._oAcpEvent.body.datas[14]=stringCopy(this._oParse.queryNodeAttributeByPath("agentParam","autoStatusInteval"),"");this._oAcpEvent.body.datas[15]=stringCopy(this._oParse.queryNodeAttributeByPath("agentParam","autoAnswer"),"");this._oAcpEvent.body.datas[16]=stringCopy(this._oParse.queryNodeAttributeByPath("agentParam","exitCause"),"");this._oAcpEvent.body.datas[17]=stringCopy(this._oParse.queryNodeAttributeByPath("agentParam","ctiVersion"),"");this._oAcpEvent.body.datas[18]=stringCopy(this._oParse.queryNodeAttributeByPath("agentParam","agentName"),"");this._oAcpEvent.body.datas_count=19;break;case ACP_SignOut_CONF:case ACP_SetBusy_CONF:case ACP_SetIdle_CONF:case ACP_AgentReport_CONF:case ACP_SetAgentAutoEnterIdle_CONF:case ACP_AgentEnterIdle_CONF:case ACP_SetWrapUp_CONF:case ACP_ForceIdle_CONF:case ACP_ForceBusy_CONF:case ACP_ForceOut_CONF:case ACP_Lock_CONF:case ACP_UnLock_CONF:case ACP_ReleaseCall_CONF:case ACP_ReleaseCallByCallID_CONF:case ACP_SendDTMF_CONF:case ACP_CallInside_CONF:case ACP_Consultation_CONF:case ACP_CallOutside_CONF:case ACP_SingleStepTransfer_CONF:case ACP_Transfer_CONF:case ACP_SetTransfer_CONF:case ACP_Hold_CONF:case ACP_RetrieveHold_CONF:case ACP_Conference_CONF:case ACP_Alternate_CONF:case ACP_DoReplyMultimeAndHangUpCall_CONF:case ACP_Listen_CONF:case ACP_Help_CONF:case ACP_Intercept_CONF:case ACP_Insert_CONF:case ACP_StopInsert_CONF:case ACP_BeginRecord_CONF:case ACP_StopRecord_CONF:case ACP_BeginPlay_CONF:case ACP_StopPlay_CONF:case ACP_BeginCollect_CONF:case ACP_StopCollect_CONF:case ACP_Bridge_CONF:case ACP_SMMsg_CONF:case ACP_Answer_CONF:case ACP_Mute_CONF:case ACP_SetCallData_CONF:case ACP_ChangeCallQueue_CONF:case ACP_TransferCallQueue_CONF:case ACP_ForceReleaseCall_CONF:case ACP_WorkReport_CONF:case ACP_SendWeiboMsg_CONF:case ACP_SendMessage_CONF:this._BuildGeneralConf(this._oAcpEvent,this._oParse);break;case ACP_AgentReconnect_CONF:this._BuildGeneralConf(this._oAcpEvent,this._oParse);this._oAcpEvent.body.datas[0]=stringCopy(this._oParse.queryNodeAttributeByPath("agentParam","ctiEvent"),"");this._oAcpEvent.body.datas_count=1;break;case ACP_SetCTIParam_CONF:case ACP_GetCTIParam_CONF:this._BuildGeneralConf(this._oAcpEvent,this._oParse);this._oAcpEvent.body.datas[0]=stringCopy(this._oParse.queryNodeAttributeByPath("parameter","destAgentID"),"");this._oAcpEvent.body.datas[1]=stringCopy(this._oParse.queryNodeAttributeByPath("parameter","type"),"0");this._oAcpEvent.body.datas[2]=stringCopy(this._oParse.queryNodeAttributeByPath("parameter","param"),"");this._oAcpEvent.body.datas[3]=stringCopy(this._oParse.queryNodeAttributeByPath("parameter","codeType"),"0");this._oAcpEvent.body.datas_count=4;break;case ACP_GetWeChatParam_CONF:this._BuildGeneralConf(this._oAcpEvent,this._oParse);break;case ACP_QueryAgentStatus_CONF:this._BuildGeneralConf(this._oAcpEvent,this._oParse);break;case ACP_QueryAgentCallInfo_CONF:this._BuildGeneralConf(this._oAcpEvent,this._oParse);break;case ACP_GetCTITime_CONF:this._BuildGeneralConf(this._oAcpEvent,this._oParse);this._oAcpEvent.body.datas[0]=stringCopy(this._oParse.queryNodeValueByPath("ctiTime"),"");this._oAcpEvent.body.datas_count=1;break;case ACP_QueryWeChatSessionIDs_CONF:this._BuildGeneralConf(this._oAcpEvent,this._oParse);break;case ACP_SendWeChatMsg_CONF:this._BuildGeneralConf(this._oAcpEvent,this._oParse);break;case ACP_QuerySpAgentList_CONF:this._BuildGeneralConf(this._oAcpEvent,this._oParse);break;case ACP_OnOrigated:this._BuildGeneralConf(this._oAcpEvent,this._oParse);this._BuildCallinfo(this._oAcpEvent.body.callinfo,this._oParse);break;case ACP_OnAnswerRequest:this._BuildAnswerRequestEventReport(this._oAcpEvent,this._oParse);break;case ACP_OnHangupCallInConf:this._BuildGeneralConf(this._oAcpEvent,this._oParse);break;case ACP_OnBeginSendDTMFSuccess:case ACP_OnBeginSendDTMFFailure:case ACP_OnStopSendDTMFSuccess:case ACP_OnStopSendDTMFFailure:case ACP_OnBeginPlaySuccess:case ACP_OnBeginPlayFailure:case ACP_OnStopPlaySuccess:case ACP_OnStopPlayFailure:case ACP_OnBeginCollectSuccess:case ACP_OnBeginCollectFailure:case ACP_OnStopCollectSuccess:case ACP_OnStopcollectFailure:this._BuildGeneralConf(this._oAcpEvent,this._oParse);this._oAcpEvent.body.datas[0]=stringCopy(this._oParse.queryNodeValueByPath("fileName"),"");this._oAcpEvent.body.datas_count=1;break;case ACP_GetLog:break;case ACP_OnBeginRecordSuccess:this._BuildGeneralConf(this._oAcpEvent,this._oParse);this._oAcpEvent.body.datas[0]=stringCopy(this._oParse.queryNodeValueByPath("fileName"),"");this._oAcpEvent.body.datas[1]=stringCopy(this._oParse.queryNodeValueByPath("serverName"),"");this._oAcpEvent.body.datas[2]=stringCopy(this._oParse.queryNodeValueByPath("networkInfo"),"");this._oAcpEvent.body.datas_count=3;break;case ACP_GetCallData_CONF:break;case ACP_OnRequestRelease:case ACP_OnHoldCallRelease:this._BuildGeneralConf(this._oAcpEvent,this._oParse);break;case ACP_OnReturnFromIVR:case ACP_OnConsultationBack:case ACP_OnReturnFromPhone:case ACP_OnReleaseSuccess:this._BuildGeneralConf(this._oAcpEvent,this._oParse);this._BuildCallinfo(this._oAcpEvent.body.callinfo,this._oParse);this._oAcpEvent.body.datas[0]=stringCopy(this._oParse.queryNodeValueByPath("releaseDevice"),"");this._oAcpEvent.body.datas[1]=stringCopy(this._oParse.queryNodeAttributeByPath("releaseDevice","legID"),"");this._oAcpEvent.body.datas_count=2;this._oAcpEvent.body.eventType==ACP_OnReleaseSuccess&&this._BuildCallReportInfo(this._oAcpEvent.body.reportinfo,this._oParse);break;case ACP_OnAnswerSuccess:case ACP_OnConsultationSuccess:case ACP_OnCallInsideSuccTalk:case ACP_OnCallOutsideSuccTalk:case ACP_OnHoldSuccess:case ACP_OnRetrieveHoldSuccess:case ACP_OnConferenceSuccess:case ACP_OnConferenceSucTalk:case ACP_OnTransferred:case ACP_OnAlternateSuccess:case ACP_OnAlternated:case ACP_OnListenSuccess:case ACP_OnHelpSuccess:case ACP_OnInsertSuccess:case ACP_OnInterceptSuccess:case ACP_OnInserted:case ACP_OnLocked:case ACP_OnUnLocked:case ACP_OnBridgeSuccess:this._BuildGeneralConf(this._oAcpEvent,this._oParse);this._BuildCallinfo(this._oAcpEvent.body.callinfo,this._oParse);this._oAcpEvent.body.eventType==ACP_OnAnswerSuccess&&(this._oAcpEvent.body.datas[0]=stringCopy(this._oParse.queryNodeValueByPath("taskID"),""),this._oAcpEvent.body.datas[1]=stringCopy(this._oParse.queryNodeValueByPath("transParentParamet"),""),this._oAcpEvent.body.datas[2]=stringCopy(this._oParse.queryNodeValueByPath("authority"),""),this._oAcpEvent.body.datas_count=3);break;case ACP_OnAnswerFailure:case ACP_OnUserHangupBeforeResponse:case ACP_OnReleaseFailure:case ACP_OnLongNoAnswer:case ACP_OnConsultationFailure:case ACP_OnTransSuccess:case ACP_OnTransFailure:case ACP_OnSingleTransferSuccess:case ACP_OnSingleTransferFailure:case ACP_OnCallInsideSuccess:case ACP_OnCallInsideFailure:case ACP_OnCallOutsideSuccess:case ACP_OnCallOutsideFailure:case ACP_OnHoldFailure:case ACP_OnRetrieveHoldFailure:case ACP_OnConferenceFailure:case ACP_OnAlternateFailure:case ACP_OnListenFailure:case ACP_OnHelpFailure:case ACP_OnInsertFailure:case ACP_OnStopInsertSuccess:case ACP_OnStopInsertFailure:case ACP_OnInterceptFailure:case ACP_OnForceIdleSuccess:case ACP_OnForceIdleFailure:case ACP_OnForceBusySuccess:case ACP_OnForceBusyFailure:case ACP_OnForceOutSuccess:case ACP_OnForceOutFailure:case ACP_OnBeginRecordFailure:case ACP_OnStopRecordSuccess:case ACP_OnStopRecordFailure:case ACP_OnForceRelease:case ACP_OnForceIdle:case ACP_OnForceBusy:case ACP_OnForceOut:case ACP_OnAgentAllBusy:case ACP_OnStopListenSuccess:case ACP_OnStopListenFailure:case ACP_OnListened:case ACP_OnSignOuted:case ACP_OnIntercepted:case ACP_OnBridgeFailure:case ACP_OnSystemIdle:case ACP_OnForceReleaseCallSuccess:case ACP_OnForceReleaseCallFailure:this._BuildGeneralConf(this._oAcpEvent,this._oParse);this._oAcpEvent.body.eventType==ACP_OnSystemIdle&&(this._oAcpEvent.body.agent.agentSubStatus=stringToInt(this._oParse.queryNodeValueByPath("agentSubStatus"),0));this._oAcpEvent.body.eventType!=ACP_OnAnswerFailure&&this._oAcpEvent.body.eventType!=ACP_OnForceRelease&&this._oAcpEvent.body.eventType!=ACP_OnTransSuccess&&this._oAcpEvent.body.eventType!=ACP_OnSingleTransferSuccess||this._BuildCallReportInfo(this._oAcpEvent.body.reportinfo,this._oParse);break;case ACP_OnCallQueueQuery:case ACP_OnQueueReport:case ACP_OnRecvWeiboMsg:case ACP_OnStaticInfoReport:this._BuildGeneralConf(this._oAcpEvent,this._oParse);this._oAcpEvent.body.datas[0]=getSubString(c,"\x3c/cause\x3e","\x3c/body\x3e");this._oAcpEvent.body.datas_count=1;break;case ACP_OnRecvWeChatMsg:this._BuildGeneralConf(this._oAcpEvent,this._oParse);break;case ACP_OnWeChatEventReport:this._BuildGeneralConf(this._oAcpEvent,this._oParse);break;case ACP_OnSystemMessage:this._BuildGeneralConf(this._oAcpEvent,this._oParse);this._oParse.nType==xmlForIE?(this._oAcpEvent.body.datas[0]=stringCopy(this._oParse.queryNodeAttributeByPath("systemMessage","msgType"),"-1"),this._oAcpEvent.body.datas[1]=stringCopy(this._oParse.queryNodeAttributeByPath("systemMessage","codeType"),"0"),this._oAcpEvent.body.datas[2]=stringCopy(this._oParse.queryNodeValueByPath("systemMessage"),""),this._oAcpEvent.body.datas[3]=stringCopy(this._oParse.queryNodeAttributeByPath("formateMessage",""),""),""==this._oAcpEvent.body.datas[3]&&(this._oAcpEvent.body.datas[3]=stringCopy(this._oParse.queryNodeAttributeByPath("formatMessage",""),""))):(this._oAcpEvent.body.datas[0]=stringCopy(this._oParse.queryNodeAttributeByPath("systemMessage","msgType"),"-1"),this._oAcpEvent.body.datas[1]=stringCopy(this._oParse.queryNodeAttributeByPath("systemMessage","codeType"),"0"),this._oAcpEvent.body.datas[2]=stringCopy(this._oParse.queryNodeValueByPath("systemMessage"),""),this._oAcpEvent.body.datas[3]=stringCopy(this._oParse.queryNodeValueByPath("formateMessage",""),""),""==this._oAcpEvent.body.datas[3]&&(this._oAcpEvent.body.datas[3]=stringCopy(this._oParse.queryNodeValueByPath("formatMessage",""),"")));this._oAcpEvent.body.datas_count=4;break;case ACP_OnAgentBusyReason:this._BuildGeneralConf(this._oAcpEvent,this._oParse);this._oAcpEvent.body.datas[0]=stringCopy(this._oParse.queryNodeAttributeByPath("agentSubStatus","value"),"");this._oAcpEvent.body.datas[1]=stringCopy(this._oParse.queryNodeAttributeByPath("agentSubStatus","desc"),"");this._oAcpEvent.body.datas_count=2;break;case ACP_OnAsrEventReport:this._BuildGeneralConf(this._oAcpEvent,this._oParse);this._oAcpEvent.body.datas[0]=stringCopy(this._oParse.queryNodeValueByPath("acpMessage/asrEvent/seq"),"");this._oAcpEvent.body.datas[1]=stringCopy(this._oParse.queryNodeValueByPath("acpMessage/asrEvent/asrTimeStamp"),"");this._oAcpEvent.body.datas[2]=stringCopy(this._oParse.queryNodeAttributeByPath("acpMessage/asrEvent/line","state"),"");this._oAcpEvent.body.datas[3]=stringCopy(this._oParse.queryNodeAttributeByPath("acpMessage/asrEvent/line","id"),"");this._oAcpEvent.body.datas[4]=stringCopy(this._oParse.queryNodeValueByPath("acpMessage/asrEvent/line"),"");this._oAcpEvent.body.datas[5]=stringCopy(this._oParse.queryNodeValueByPath("acpMessage/asrEvent/asrtext"),"");this._oAcpEvent.body.datas_count=6;break;case ACP_OnStopSmSuccess:this._BuildGeneralConf(this._oAcpEvent,this._oParse);this._oAcpEvent.body.datas[0]=stringCopy(this._oParse.queryNodeValueByPath("fileName"),"");this._oAcpEvent.body.datas[1]=stringCopy(this._oParse.queryNodeValueByPath("smRescode"),"");this._oAcpEvent.body.datas_count=2;break;case ACP_HEART_BEAT:break;default:b=!1}}catch(e){return alert(e.message),!1}return b};this.GetCmdName=function(a){for(var b=0;b<this.m_arrCmd.length;b++)if(this.m_arrCmdIndex[b]==a)return this.m_arrCmd[b];return""};this.GetCmdIndex=function(a){for(var b=0;b<this.m_arrCmd.length;b++)if(this.m_arrCmd[b]==a)return this.m_arrCmdIndex[b];return-1};this._Init();return this}var Device_Status_NULL=0,Device_Status_UC=1,Device_Status_CTI=2;function JAcpDevice(a){this._oVccBarCenter=a;this._oAcpAPI=this._oAcpParse=null;this.m_lMsgReceived=MSG_READY;this._oAcpCall=null;this._thisSubBusyStatus=-1;this._connectStatus=Device_Status_NULL;this._createObject=function(){this._oAcpParse=new JACPParse;this._oAcpAPI=new JAcpAPI;this._oAcpAPI.oParent=this;this._oAcpAPI.SetSocketCallBack(this._SocketCallBack);this._oAcpCall=new JAcpCall};this._IsProssing=function(){return this.m_lMsgReceived==MSG_NONE};this._WaitingForResult=function(b){if(this.m_lMsgReceived==MSG_NONE)return!1;this.m_lMsgReceived=MSG_NONE;this._oAcpCall.requestType=b;this._oVccBarCenter._oTimer.SetTimer(CINNGCCA_METHOD_ID,1E3*CINNGCCA_METHOD_INTERVAL);return!0};this._SocketCallBack=function(b,a){var d=this.oParent;b==WS_EVENT_ONOPEN?(d._oVccBarCenter._oTimer.KillTimer(CINNGCCA_OPENSOCKET_ID),d._oVccBarCenter._oTimer.SetTimer(CINNGCCA_EMPTYHEARTBEAT_ID,1E3*CINNGCCA_EMPTYHEARTBEAT_INTERVAL),d._SignInCTI(),d._OnAcpErrorNotify(b)):b==WS_EVENT_ONCLOSE?(d._oVccBarCenter._oTimer.KillTimer(CINNGCCA_OPENSOCKET_ID),d._oVccBarCenter._oTimer.KillTimer(CINNGCCA_EMPTYHEARTBEAT_ID),d._connectStatus==Device_Status_UC?d._oVccBarCenter._oTimer.SetTimer(CINNGCCA_REDIRECTSOCKET_ID,1E3*CINNGCCA_REDIRECTSOCKET_INTERVAL):d._OnAcpErrorNotify(b)):b==WS_EVENT_ONERROR?(d._oVccBarCenter._oTimer.KillTimer(CINNGCCA_OPENSOCKET_ID),d._OnAcpErrorNotify(b)):b==WS_EVENT_ONMESSAGE&&d._OnAcpNotify(a)};this._SignInCTI=function(){0==this._oVccBarCenter._oAgentInfo._isSignIn?(this._oAcpAPI.acpSetStreamParam(this._oVccBarCenter._oAgentInfo._agentType,this._oVccBarCenter._oAgentInfo._vccID,this._oVccBarCenter._oAgentInfo._agentID,this._oVccBarCenter._oAgentInfo._dN),this._connectStatus==Device_Status_NULL?this.Initial():this.SignIn()):this.AgentReconnect()};this._NotifyCmdResult=function(b){this._oAcpCall._msgReceived=b;this.m_lMsgReceived=MSG_READY;this._oVccBarCenter.OnNotify(this._oAcpCall,Notify_MSG)};this._NotifyEventResult=function(b){this._oVccBarCenter.OnNotify(this._oAcpCall,b)};this._IsCurrentAgent=function(b){return b.vccID==this._oVccBarCenter._oAgentInfo._vccID&&b.agentID==this._oVccBarCenter._oAgentInfo._agentID&&b.deviceID==this._oVccBarCenter._oAgentInfo._dN?!0:!1};this._UpdateSession=function(b){this._oAcpCall.RefreshHeaderInfo(b);this._oAcpAPI.acpSetSession(b.sessionID,b.serialID)};this._OnAcpErrorNotify=function(b){DisplayLog(VccBar_Log_Info,"JAcpDevice:SocketStatus("+this._oAcpAPI.GetSoceketStatus()+")");this._oVccBarCenter.OnAcpSocketNotify(b)};this._OnCmdConf=function(b){DisplayLog(VccBar_Log_Debug,stringFormat("AgentInfo({0},{1},{2})",b.body.agent.vccID,b.body.agent.agentID,b.body.agent.deviceID));if(this._IsCurrentAgent(b.body.agent)){var a=!0;b.body.eventType!=ACP_ReleaseCall_CONF&&b.body.eventType!=ACP_CallOutside_CONF||0!=b.body.agent.agentStatus||(a=!1);a&&(this._oAcpCall.RefressAgentInfo(b.body.agent),this._oAcpCall.RefressCauseInfo(b.body.cause));switch(b.body.eventType){case ACP_SignIn_CONF:this._oAcpAPI.acpSetCtiEvent(b.body.datas[10],b.head.timeStamp);0==b.body.cause.code&&(this._connectStatus=Device_Status_CTI,this._oVccBarCenter._oTimer.SetTimer(CINNGCCA_AGENTREPORT_ID,1E3*CINNGCCA_AGENTREPORT_INTERVAL),this._oVccBarCenter._oTimer.SetTimer(CINNGCCA_AGENTRECONNECT_ID,1E3*CINNGCCA_AGENTRECONNECT_INTERVAL));break;case ACP_SignOut_CONF:0==b.body.cause.code&&(this._oVccBarCenter._oTimer.KillTimer(CINNGCCA_AGENTREPORT_ID),this._oVccBarCenter._oTimer.KillTimer(CINNGCCA_AGENTRECONNECT_ID));break;case ACP_SetBusy_CONF:this._oAcpCall._acpEvent.body.agent.agentSubStatus=this._thisSubBusyStatus;-1==b.body.cause.code&&(this._oAcpCall._acpEvent.body.agent.agentStatus=1);break;case ACP_AgentReport_CONF:this._oVccBarCenter._oTimer.Reset(CINNGCCA_AGENTREPORT_ID);break;case ACP_AgentReconnect_CONF:0==b.body.cause.code&&this._oAcpAPI.acpSetCtiEvent(b.body.datas[0],b.head.timeStamp)}0==b.body.cause.code?this._NotifyCmdResult(MSG_SUCCESS):this._NotifyCmdResult(MSG_FAILURE)}};this._OnEventCommon=function(b){if(this._IsCurrentAgent(b.body.agent)){this._oAcpCall.RefressAgentInfo(b.body.agent);this._oAcpCall.RefressCauseInfo(b.body.cause);switch(b.body.eventType){case ACP_OnAnswerFailure:case ACP_OnUserHangupBeforeResponse:case ACP_OnReleaseFailure:case ACP_OnLongNoAnswer:case ACP_OnTransSuccess:case ACP_OnTransFailure:case ACP_OnSingleTransferSuccess:case ACP_OnSingleTransferFailure:case ACP_OnForceRelease:case ACP_OnCallInsideFailure:this._UpdateSession(b.head);this._oAcpCall.ReleaseCall();b.body.eventType!=ACP_OnAnswerFailure&&b.body.eventType!=ACP_OnForceRelease&&b.body.eventType!=ACP_OnTransSuccess&&b.body.eventType!=ACP_OnSingleTransferSuccess||this._oAcpCall.RefreshCallReport(b.body.reportinfo);break;case ACP_OnSystemIdle:this._oAcpCall._acpEvent.body.agent.agentSubStatus=b.body.agent.agentSubStatus;break;case ACP_OnForceOut:this._oVccBarCenter._oTimer.KillTimer(CINNGCCA_AGENTREPORT_ID);this._oVccBarCenter._oTimer.KillTimer(CINNGCCA_AGENTRECONNECT_ID);break;case ACP_OnSignOuted:this._oVccBarCenter._oTimer.KillTimer(CINNGCCA_AGENTREPORT_ID),this._oVccBarCenter._oTimer.KillTimer(CINNGCCA_AGENTRECONNECT_ID)}this._NotifyEventResult(Notify_MSG)}};this._OnEventCallInfo=function(b){if(this._IsCurrentAgent(b.body.agent)){this._oAcpCall.RefressAgentInfo(b.body.agent);this._oAcpCall.RefressCauseInfo(b.body.cause);b.body.eventType!=ACP_OnAnswerSuccess?this._oAcpCall.RefreshCallinfo(b.body.callinfo,!1):this._oAcpCall.RefreshCallinfo(b.body.callinfo,!0);switch(b.body.eventType){case ACP_OnAnswerSuccess:this._UpdateSession(b.head);break;case ACP_OnCallInsideSuccTalk:case ACP_OnCallOutsideSuccTalk:this._UpdateSession(b.head)}this._NotifyEventResult(Notify_MSG)}};this._OnEventRelease=function(b){if(this._IsCurrentAgent(b.body.agent)){var a=b.body.datas[0];this._oAcpCall.RefressAgentInfo(b.body.agent);this._oAcpCall.RefressCauseInfo(b.body.cause);this._oAcpCall.RefreshCallReport(b.body.reportinfo);this._oVccBarCenter._oAgentInfo._dN==a?(this._oAcpCall.ReleaseCall(),this._UpdateSession(b.head)):this._oAcpCall.RefreshCallinfo(b.body.callinfo,!1);this._NotifyEventResult(Notify_MSG)}};this._OnAcpNotify=function(b){if(this._oAcpParse.ParseMsg(b))switch(b=this._oAcpParse._oAcpEvent,DisplayLog(VccBar_Log_Debug,stringFormat("JAcpDevice:_OnAcpNotify({0},{1})",b.body.eventType,b.body.eventTypeName)),b.body.eventType!=ACP_HEART_BEAT&&this._oAcpCall.RefreshBody(b.body),b.body.eventClass==EC_CONFIRMATION&&b.body.eventType!=ACP_HEART_BEAT&&this._oVccBarCenter._oTimer.KillTimer(CINNGCCA_METHOD_ID),this._oVccBarCenter._oTimer.Reset(CINNGCCA_AGENTRECONNECT_ID),b.body.eventType){case ACP_HEART_BEAT:this._oAcpAPI.acpHeartBeat();break;case ACP_Initial_CONF:this._NotifyCmdResult(MSG_SUCCESS);"2"==b.body.datas[0]?(this._connectStatus=Device_Status_UC,this.CloseStream()):(this._connectStatus=Device_Status_CTI,this._SignInCTI());break;case ACP_SignIn_CONF:case ACP_SignOut_CONF:case ACP_SetBusy_CONF:case ACP_SetIdle_CONF:case ACP_AgentReport_CONF:case ACP_SetAgentAutoEnterIdle_CONF:case ACP_AgentEnterIdle_CONF:case ACP_SetWrapUp_CONF:case ACP_ForceIdle_CONF:case ACP_ForceBusy_CONF:case ACP_ForceOut_CONF:case ACP_Lock_CONF:case ACP_UnLock_CONF:case ACP_ReleaseCall_CONF:case ACP_ReleaseCallByCallID_CONF:case ACP_SendDTMF_CONF:case ACP_CallInside_CONF:case ACP_Consultation_CONF:case ACP_CallOutside_CONF:case ACP_SingleStepTransfer_CONF:case ACP_Transfer_CONF:case ACP_SetTransfer_CONF:case ACP_Hold_CONF:case ACP_RetrieveHold_CONF:case ACP_Conference_CONF:case ACP_Alternate_CONF:case ACP_DoReplyMultimeAndHangUpCall_CONF:case ACP_Listen_CONF:case ACP_Help_CONF:case ACP_Intercept_CONF:case ACP_Insert_CONF:case ACP_StopInsert_CONF:case ACP_BeginRecord_CONF:case ACP_StopRecord_CONF:case ACP_BeginPlay_CONF:case ACP_StopPlay_CONF:case ACP_BeginCollect_CONF:case ACP_StopCollect_CONF:case ACP_Bridge_CONF:case ACP_SMMsg_CONF:case ACP_Answer_CONF:case ACP_Mute_CONF:case ACP_SetCallData_CONF:case ACP_ChangeCallQueue_CONF:case ACP_TransferCallQueue_CONF:case ACP_ForceReleaseCall_CONF:case ACP_AgentReconnect_CONF:case ACP_WorkReport_CONF:case ACP_SendWeiboMsg_CONF:case ACP_SendMessage_CONF:this._OnCmdConf(b);break;case ACP_SetCTIParam_CONF:case ACP_GetCTIParam_CONF:this._oAcpCall.RefreshCTIParam(b.body);0==b.body.cause.code?this._NotifyCmdResult(MSG_SUCCESS):this._NotifyCmdResult(MSG_FAILURE);break;case ACP_QueryAgentStatus_CONF:case ACP_QuerySpAgentList_CONF:case ACP_GetCallData_CONF:case ACP_QueryAgentCallInfo_CONF:case ACP_GetCTITime_CONF:0==b.body.cause.code?this._NotifyCmdResult(MSG_SUCCESS):this._NotifyCmdResult(MSG_FAILURE);break;case ACP_OnAnswerFailure:case ACP_OnUserHangupBeforeResponse:case ACP_OnReleaseFailure:case ACP_OnLongNoAnswer:case ACP_OnConsultationFailure:case ACP_OnTransSuccess:case ACP_OnTransFailure:case ACP_OnSingleTransferSuccess:case ACP_OnSingleTransferFailure:case ACP_OnCallInsideSuccess:case ACP_OnCallInsideFailure:case ACP_OnCallOutsideSuccess:case ACP_OnCallOutsideFailure:case ACP_OnHoldFailure:case ACP_OnRetrieveHoldFailure:case ACP_OnConferenceFailure:case ACP_OnAlternateFailure:case ACP_OnListenFailure:case ACP_OnHelpFailure:case ACP_OnInsertFailure:case ACP_OnStopInsertSuccess:case ACP_OnStopInsertFailure:case ACP_OnInterceptFailure:case ACP_OnBeginRecordFailure:case ACP_OnStopRecordSuccess:case ACP_OnStopRecordFailure:case ACP_OnForceRelease:case ACP_OnForceIdle:case ACP_OnForceBusy:case ACP_OnForceOut:case ACP_OnAgentAllBusy:case ACP_OnStopListenSuccess:case ACP_OnStopListenFailure:case ACP_OnListened:case ACP_OnIntercepted:case ACP_OnSignOuted:case ACP_OnLocked:case ACP_OnUnLocked:case ACP_OnBridgeFailure:case ACP_OnSystemIdle:this._OnEventCommon(b);break;case ACP_OnAnswerSuccess:case ACP_OnCallInsideSuccTalk:case ACP_OnCallOutsideSuccTalk:case ACP_OnConsultationSuccess:case ACP_OnHoldSuccess:case ACP_OnRetrieveHoldSuccess:case ACP_OnConferenceSuccess:case ACP_OnConferenceSucTalk:case ACP_OnAlternateSuccess:case ACP_OnAlternated:case ACP_OnListenSuccess:case ACP_OnHelpSuccess:case ACP_OnInsertSuccess:case ACP_OnInterceptSuccess:case ACP_OnInserted:case ACP_OnBridgeSuccess:case ACP_OnTransferred:this._OnEventCallInfo(b);break;case ACP_OnOrigated:this._IsCurrentAgent(b.body.agent)&&(this._oAcpCall.RefressAgentInfo(b.body.agent),this._oAcpCall.RefressCauseInfo(b.body.cause),this._oAcpCall.RefreshCallinfo(b.body.callinfo,!0),this._oAcpCall.RefressDirection(b.head.direction),this._UpdateSession(b.head),this._NotifyEventResult(Notify_MSG));break;case ACP_OnAnswerRequest:this._IsCurrentAgent(b.body.agent)&&(this._oAcpCall.RefressAgentInfo(b.body.agent),this._oAcpCall.RefressCauseInfo(b.body.cause),b.body.datas[3]==this._oVccBarCenter._oAgentInfo._dN?this._oAcpCall.RefreshCallinfo(b.body.callinfo,!0):this._oAcpCall.RefreshCallinfo(b.body.callinfo,!1),this._oAcpCall.RefreshCallReport(null,!0),this._UpdateSession(b.head),this._oAcpCall.RefressDirection(b.head.direction),this._NotifyEventResult(Notify_MSG));break;case ACP_OnConsultationBack:case ACP_OnReturnFromPhone:case ACP_OnReturnFromIVR:this._OnEventRelease(b);break;case ACP_OnReleaseSuccess:this._OnEventRelease(b);break;case ACP_OnBeginRecordSuccess:this._IsCurrentAgent(b.body.agent)&&(this._oAcpCall.RefressAgentInfo(b.body.agent),this._NotifyEventResult(Notify_MSG));break;case ACP_OnHangupCallInConf:case ACP_OnBeginSendDTMFSuccess:case ACP_OnBeginSendDTMFFailure:case ACP_OnStopSendDTMFSuccess:case ACP_OnStopSendDTMFFailure:case ACP_OnBeginPlaySuccess:case ACP_OnBeginPlayFailure:case ACP_OnStopPlaySuccess:case ACP_OnStopPlayFailure:case ACP_OnBeginCollectSuccess:case ACP_OnBeginCollectFailure:case ACP_OnStopCollectSuccess:case ACP_OnStopcollectFailure:case ACP_OnCallQueueQuery:case ACP_OnQueueReport:case ACP_OnSystemMessage:case ACP_OnAsrEventReport:case ACP_OnStopSmSuccess:case ACP_OnAgentBusyReason:b.body.eventType==ACP_OnAgentBusyReason&&this._oAcpCall.RefressAgentInfo(b.body.agent);this._NotifyEventResult(Notify_MSG);break;case ACP_OnRecvWeiboMsg:case ACP_OnWeChatEventReport:case ACP_OnStaticInfoReport:this._IsCurrentAgent(b.body.agent)&&this._NotifyEventResult(Notify_MSG)}};this.OnTimerEvent=function(b){b==CINNGCCA_METHOD_ID?(this._oVccBarCenter._oTimer.KillTimer(b),this.m_lMsgReceived==MSG_NONE&&(this.m_lMsgReceived=MSG_READY,this._oVccBarCenter.OnNotify(this._oAcpCall,Notify_OUTOFTIME))):b==CINNGCCA_AGENTREPORT_ID?(DisplayLog(VccBar_Log_Info,"TAcpDevice:onTimer(CINNGCCA_AGENTREPORT)"),this._oVccBarCenter._oTimer.Reset(b),this._oAcpAPI.acpAgentReport(this._oAcpCall._acpEvent.body.agent.agentStatus,this._oAcpCall._acpEvent.body.agent.phoneStatus)):b==CINNGCCA_AGENTRECONNECT_ID?this.AgentReconnect():b==CINNGCCA_EMPTYHEARTBEAT_ID?this._oAcpAPI.acpEmptyHeartBeat():b==CINNGCCA_OPENSOCKET_ID?(this._oVccBarCenter._oTimer.KillTimer(CINNGCCA_OPENSOCKET_ID),this._oAcpAPI.GetSoceketStatus()==WS_STATUS_CONNECTING&&this.CloseStream()):b==CINNGCCA_REDIRECTSOCKET_ID&&(this._oVccBarCenter._oTimer.KillTimer(CINNGCCA_REDIRECTSOCKET_ID),DisplayLog(VccBar_Log_Info,"JAcpDevice:redirect to("+this._oVccBarCenter._oAgentInfo._mainIP+":"+this._oVccBarCenter._oAgentInfo._mainPortID+")"),this.OpenStream(this._oVccBarCenter._oAgentInfo._mainIP,this._oVccBarCenter._oAgentInfo._mainPortID,!1))};this.OpenStream=function(b,a,d){var e=-1;d&&(this._connectStatus=Device_Status_NULL);if(this._oVccBarCenter._oAgentInfo._devConnectStatus==emCenterOpStatusConnecting)return e;this.CloseStream();this._oVccBarCenter._oTimer.SetTimer(CINNGCCA_OPENSOCKET_ID,1E3*CINNGCCA_OPENSOCKET_INTERVAL);this._oVccBarCenter._oAgentInfo._devConnectStatus=emCenterOpStatusConnecting;e=this._oAcpAPI.acpOpenStream(b,a,this._oVccBarCenter._oAgentInfo._protocolCryptType,this._oVccBarCenter._oAgentInfo._proTransportType,this._oVccBarCenter._oAgentInfo._mainXPath);e==ACPI_FAILURE&&(this._oVccBarCenter._oAgentInfo._devConnectStatus=emCenterOpStatusInitial,e=4002);return e};this.CloseStream=function(){this._oAcpAPI.acpCloseStream();this._oVccBarCenter._oTimer.KillTimer(CINNGCCA_EMPTYHEARTBEAT_ID)};this.Initial=function(){return!this._IsProssing()&&this._oAcpAPI.acpInitial(this._oVccBarCenter._oAgentInfo._vccID)==ACPI_SUCCESS&&this._WaitingForResult(ACP_Initial_CONF)?!0:!1};this.SignIn=function(){return!this._IsProssing()&&this._oAcpAPI.acpSignIn(this._oVccBarCenter._oAgentInfo._dN,this._oVccBarCenter._oAgentInfo._passWord,this._oVccBarCenter._oAgentInfo._passWdCryptType,this._oVccBarCenter._oAgentInfo._isInitialReady,this._oVccBarCenter._oAgentInfo._taskID,this._oVccBarCenter._oAgentInfo._connectType)==ACPI_SUCCESS&&this._WaitingForResult(ACP_SignIn_CONF)?!0:!1};this.SignOut=function(b){return!this._IsProssing()&&this._oAcpAPI.acpSignOut(b,"","")==ACPI_SUCCESS&&this._WaitingForResult(ACP_SignOut_CONF)?!0:!1};this.SetBusy=function(b){return!this._IsProssing()&&(this._thisSubBusyStatus=b,this._oAcpAPI.acpSetBusy(b,this._oVccBarCenter._oAgentInfo._taskID)==ACPI_SUCCESS&&this._WaitingForResult(ACP_SetBusy_CONF))?!0:!1};this.SetIdle=function(){return!this._IsProssing()&&this._oAcpAPI.acpSetIdle(this._oVccBarCenter._oAgentInfo._taskID)==ACPI_SUCCESS&&this._WaitingForResult(ACP_SetIdle_CONF)?!0:!1};this.SetWrapUp=function(){return!this._IsProssing()&&this._oAcpAPI.acpSetWrapUp()==ACPI_SUCCESS&&this._WaitingForResult(ACP_SetWrapUp_CONF)?!0:!1};this.CallInside=function(b,a,d,e){return!this._IsProssing()&&this._oAcpAPI.acpCallInside(b,a,d,e)==ACPI_SUCCESS&&this._WaitingForResult(ACP_CallInside_CONF)?!0:!1};this.CallOutside=function(b,a,d,e,f,g,h,k,l){return!this._IsProssing()&&this._oAcpAPI.acpCallOutside(b,a,d,e,f,g,h,k,l)==ACPI_SUCCESS&&this._WaitingForResult(ACP_CallOutside_CONF)?!0:!1};this.SingleStepTransfer=function(b,a,d){return!this._IsProssing()&&this._oAcpAPI.acpSingleStepTransfer(b,a,d)==ACPI_SUCCESS&&this._WaitingForResult(ACP_SingleStepTransfer_CONF)?!0:!1};this.Hold=function(b){return!this._IsProssing()&&this._oAcpAPI.acpHold(b)==ACPI_SUCCESS&&this._WaitingForResult(ACP_Hold_CONF)?!0:!1};this.RetrieveHold=function(b){return!this._IsProssing()&&this._oAcpAPI.acpRetrieveHold(b)==ACPI_SUCCESS&&this._WaitingForResult(ACP_RetrieveHold_CONF)?!0:!1};this.ReleaseCall=function(b){return!this._IsProssing()&&this._oAcpAPI.acpReleaseCall(b)==ACPI_SUCCESS&&this._WaitingForResult(ACP_ReleaseCall_CONF)?!0:!1};this.ReleaseCallbyCallID=function(b,a){return!this._IsProssing()&&this._oAcpAPI.acpReleaseCallbyCallID(b,a)==ACPI_SUCCESS&&this._WaitingForResult(ACP_ReleaseCallByCallID_CONF)?!0:!1};this.Answer=function(b,a,d){return!this._IsProssing()&&this._oAcpAPI.acpAnswer(b,a,d)==ACPI_SUCCESS&&this._WaitingForResult(ACP_Answer_CONF)?!0:!1};this.Consultation=function(b,a,d){return!this._IsProssing()&&this._oAcpAPI.acpConsultation(b,a,d)==ACPI_SUCCESS&&this._WaitingForResult(ACP_Consultation_CONF)?!0:!1};this.Transfer=function(b,a){return!this._IsProssing()&&this._oAcpAPI.acpTransfer(b,a)==ACPI_SUCCESS&&this._WaitingForResult(ACP_Transfer_CONF)?!0:!1};this.Conference=function(b){return!this._IsProssing()&&this._oAcpAPI.acpConference(b)==ACPI_SUCCESS&&this._WaitingForResult(ACP_Conference_CONF)?!0:!1};this.SendDTMF=function(b,a){return!this._IsProssing()&&this._oAcpAPI.acpSendDTMF(b,a)==ACPI_SUCCESS&&this._WaitingForResult(ACP_SendDTMF_CONF)?!0:!1};this.Bridge=function(b,a){return!this._IsProssing()&&this._oAcpAPI.acpBridge(b,a)==ACPI_SUCCESS&&this._WaitingForResult(ACP_Bridge_CONF)?!0:!1};this.SetCTIParam=function(b,a,d,e){"undefined"==typeof e&&(e=0);return this._oAcpAPI.acpSetCTIParam(b,a,d,e)==ACPI_SUCCESS?!0:!1};this.GetCTIParam=function(b,a,d,e){return this._IsProssing()||("undefined"==typeof e&&(e=0),this._oAcpAPI.acpGetCTIParam(b,a,d,e)!=ACPI_SUCCESS)?!1:!0};this.AgentReconnect=function(){DisplayLog(VccBar_Log_Info,"TAcpDevice::AgentReconnect");return this._oAcpAPI.IsSoceketConnect()?this._oAcpAPI.acpAgentReconnect(this._oAcpCall._acpEvent.body.agent.agentStatus,this._oAcpCall._acpEvent.body.agent.phoneStatus,this._oVccBarCenter._oAgentInfo._passWord,this._oAcpCall._acpEvent.body.agent.master)==ACPI_SUCCESS&&this._WaitingForResult(ACP_AgentReconnect_CONF)?!0:!1:this.OpenStream(this._oVccBarCenter._oAgentInfo._mainIP,this._oVccBarCenter._oAgentInfo._mainPortID,!1)==ACPI_SUCCESS?(this._oAcpAPI.acpSetStreamParam(this._oVccBarCenter._oAgentInfo._agentType,this._oVccBarCenter._oAgentInfo._vccID,this._oVccBarCenter._oAgentInfo._agentID,this._oVccBarCenter._oAgentInfo._dN),!0):!1};this.ChangeCallQueue=function(b,a,d){return this._oAcpAPI.acpChangeCallQueue(b,a,d)==ACPI_SUCCESS?!0:!1};this.CallQueueQuery=function(b){return this._oAcpAPI.acpCallQueueQuery(b)==ACPI_SUCCESS?!0:!1};this.TransferCallQueue=function(b,a,d){return this._oAcpAPI.acpTransferCallQueue(b,a,d)==ACPI_SUCCESS?!0:!1};this.SendMessage=function(b,a,d,e,f,g){return this._oAcpAPI.acpSendMessage(b,a,d,e,f,g)==ACPI_SUCCESS?!0:!1};this.ForceReleaseCall=function(b,a){return!this._IsProssing()&&this._oAcpAPI.acpForceReleaseCall(b,a)==ACPI_SUCCESS&&this._WaitingForResult(ACP_ForceReleaseCall_CONF)?!0:!1};this.Insert=function(b,a,d,e,f){return!this._IsProssing()&&this._oAcpAPI.acpInsert(b,a,d,e,f)==ACPI_SUCCESS&&this._WaitingForResult(ACP_Insert_CONF)?!0:!1};this.Listen=function(b,a,d,e,f){return!this._IsProssing()&&this._oAcpAPI.acpListen(b,a,d,e,f)==ACPI_SUCCESS&&this._WaitingForResult(ACP_Listen_CONF)?!0:!1};this.Intercept=function(b,a,d,e,f){return!this._IsProssing()&&this._oAcpAPI.acpIntercept(b,a,d,e,f)==ACPI_SUCCESS&&this._WaitingForResult(ACP_Intercept_CONF)?!0:!1};this.Help=function(b,a,d,e,f){return!this._IsProssing()&&this._oAcpAPI.acpHelp(b,a,d,e,f)==ACPI_SUCCESS&&this._WaitingForResult(ACP_Help_CONF)?!0:!1};this.Lock=function(b){return!this._IsProssing()&&this._oAcpAPI.acpLock(b)==ACPI_SUCCESS&&this._WaitingForResult(ACP_Lock_CONF)?!0:!1};this.UnLock=function(b){return!this._IsProssing()&&this._oAcpAPI.acpUnLock(b)==ACPI_SUCCESS&&this._WaitingForResult(ACP_UnLock_CONF)?!0:!1};this.ForceIdle=function(b){return this._oAcpAPI.acpForceIdle(b)==ACPI_SUCCESS?!0:!1};this.ForceBusy=function(b){return this._oAcpAPI.acpForceBusy(b)==ACPI_SUCCESS?!0:!1};this.ForceOut=function(b){return this._oAcpAPI.acpForceOut(b)==ACPI_SUCCESS?!0:!1};this._createObject();return this}function JAMPParse(){this.m_arrCmd=[];this.m_arrCmdIndex=[];this._oParse=new CXmlParse;this._oAmpEvent=new AMPBody_t;this._Init=function(){0<this.m_arrCmd.length||(this.m_arrCmd.push("heartBeat"),this.m_arrCmdIndex.push(AMP_HEART_BEAT),this.m_arrCmd.push("Initial"),this.m_arrCmdIndex.push(AMP_Initial_CONF),this.m_arrCmd.push("login"),this.m_arrCmdIndex.push(AMP_Login_CONF),this.m_arrCmd.push("logout"),this.m_arrCmdIndex.push(AMP_LogOut_CONF),this.m_arrCmd.push("setQueueType"),this.m_arrCmdIndex.push(AMP_SetQueueType_CONF),this.m_arrCmd.push("setMsgFlag"),this.m_arrCmdIndex.push(AMP_SetMsgFlag_CONF),this.m_arrCmd.push("agentReport"),this.m_arrCmdIndex.push(AMP_AgentReport_CONF),this.m_arrCmd.push("queryMonitorGroup"),this.m_arrCmdIndex.push(AMP_QueryMonitorGroup_CONF),this.m_arrCmd.push("queryAgentState"),this.m_arrCmdIndex.push(AMP_QueryAgentState_CONF),this.m_arrCmd.push("queryQueueStatus"),this.m_arrCmdIndex.push(AMP_QueryQueueStatus_CONF),this.m_arrCmd.push("queryIvrStatus"),this.m_arrCmdIndex.push(AMP_QueryIvrStatus_CONF),this.m_arrCmd.push("agentReconnect"),this.m_arrCmdIndex.push(AMP_AgentReconnect_CONF),this.m_arrCmd.push("telephoneStatusReport"),this.m_arrCmdIndex.push(AMP_telephoneStatusReport),this.m_arrCmd.push("agentStatusReport"),this.m_arrCmdIndex.push(AMP_agentStatusReport),this.m_arrCmd.push("lockStatusReport"),this.m_arrCmdIndex.push(AMP_lockStatusReport),this.m_arrCmd.push("queueStatusReport"),this.m_arrCmdIndex.push(AMP_queueStatusReport),this.m_arrCmd.push("ivrStatusReport"),this.m_arrCmdIndex.push(AMP_ivrStatusReport),this.m_arrCmd.push("AgentReport"),this.m_arrCmdIndex.push(AMP_AgentReport),this.m_arrCmd.push("IvrReport"),this.m_arrCmdIndex.push(AMP_IvrReport),this.m_arrCmd.push("TrunkReport"),this.m_arrCmdIndex.push(AMP_TrunkReport),this.m_arrCmd.push("TrunkSumReport"),this.m_arrCmdIndex.push(AMP_TrunkSumReport),this.m_arrCmd.push("TelReport"),this.m_arrCmdIndex.push(AMP_TelReport),this.m_arrCmd.push("ServiceReport"),this.m_arrCmdIndex.push(AMP_ServiceReport),this.m_arrCmd.push("TaskReport"),this.m_arrCmdIndex.push(AMP_TaskReport),this.m_arrCmd.push("OutboundReport"),this.m_arrCmdIndex.push(AMP_OutboundReport),this.m_arrCmd.push("CallReportReport"),this.m_arrCmdIndex.push(AMP_CallReportReport),this.m_arrCmd.push("M4WallServiceReport"),this.m_arrCmdIndex.push(AMP_M4WallServiceReport),this.m_arrCmd.push("M4WallQueueReport"),this.m_arrCmdIndex.push(AMP_M4WallQueueReport),this.m_arrCmd.push("M4AgentSumReport"),this.m_arrCmdIndex.push(AMP_M4AgentSumReport),this.m_arrCmd.push("M4ServiceSumReport"),this.m_arrCmdIndex.push(AMP_M4ServiceSumReport),this.m_arrCmd.push("M4IvrServiceReport"),this.m_arrCmdIndex.push(AMP_M4IvrServiceReport),this.m_arrCmd.push("OnSignOuted"),this.m_arrCmdIndex.push(AMP_OnSignOuted),this.m_arrCmd.push("M4WallTrunkReport"),this.m_arrCmdIndex.push(AMP_TrunkReport),this.m_arrCmd.push("M4TrunkSumReport"),this.m_arrCmdIndex.push(AMP_TrunkSumReport),this.m_arrCmd.push("InitialState"),this.m_arrCmdIndex.push(AMP_InitialState_CONF),this.m_arrCmd.push("AgentQuery"),this.m_arrCmdIndex.push(AMP_AgentQuery_CONF),this.m_arrCmd.push("IvrQuery"),this.m_arrCmdIndex.push(AMP_IvrQuery_CONF),this.m_arrCmd.push("TelQuery"),this.m_arrCmdIndex.push(AMP_TelQuery_CONF),this.m_arrCmd.push("ServiceQuerySummary"),this.m_arrCmdIndex.push(AMP_ServiceQuerySummary_CONF),this.m_arrCmd.push("IvrSumQuery"),this.m_arrCmdIndex.push(AMP_IvrSumQuery_CONF),this.m_arrCmd.push("TaskQuerySummary"),this.m_arrCmdIndex.push(AMP_TaskQuerySummary_CONF),this.m_arrCmd.push("StartNotification"),this.m_arrCmdIndex.push(AMP_StartNotification_CONF),this.m_arrCmd.push("EndNotification"),this.m_arrCmdIndex.push(AMP_EndNotification_CONF),this.m_arrCmd.push("CallReportQuery"),this.m_arrCmdIndex.push(AMP_CallReportQuery_CONF),this.m_arrCmd.push("AgentSumQuery"),this.m_arrCmdIndex.push(AMP_AgentSumQuery_CONF),this.m_arrCmd.push("AgentWorkSumQuery"),this.m_arrCmdIndex.push(AMP_AgentWorkSumQuery_CONF),this.m_arrCmd.push("ServiceSumQueryByHour"),this.m_arrCmdIndex.push(AMP_ServiceSumQueryByHour_CONF),this.m_arrCmd.push("TaskSumQueryByHour"),this.m_arrCmdIndex.push(AMP_TaskSumQueryByHour_CONF),this.m_arrCmd.push("QueryActiveTask"),this.m_arrCmdIndex.push(AMP_QueryActiveTask_CONF),this.m_arrCmd.push("M4AgentSumQuery"),this.m_arrCmdIndex.push(AMP_M4AgentSumQuery_CONF),this.m_arrCmd.push("M4ServiceSumQuery"),this.m_arrCmdIndex.push(AMP_M4ServiceSumQuery_CONF),this.m_arrCmd.push("M4IvrServiceQuery"),this.m_arrCmdIndex.push(AMP_M4IvrServiceQuery_CONF),this.m_arrCmd.push("M4TrunkSumQuery"),this.m_arrCmdIndex.push(AMP_M4TrunkSumQuery_CONF))};this.ParseMsg=function(a){var b=!0;try{var c=getSubString(a,"\x3campMessage","\x3c/ampMessage\x3e"),d=stringFormat("\x3campMessage{0}\x3c/ampMessage\x3e",c);if(!this._oParse.loadXml(d))return!1;this._oAmpEvent.ampMessage=d;a="";this._oParse.nType==xmlForIE?(this._oAmpEvent.sessionID=this._oParse.queryNodeValueByPath("ampMessage/header/sessionID"),this._oAmpEvent.version=this._oParse.queryNodeAttributeByPath("ampMessage","ver"),this._oAmpEvent.currentTime=this._oParse.queryNodeAttributeByPath("ampMessage","time"),this._oAmpEvent.eventTypeName=this._oParse.queryNodeAttributeByPath("ampMessage/body","name")):(this._oAmpEvent.sessionID=this._oParse.queryNodeValueByPath("sessionID"),this._oAmpEvent.version=this._oParse.queryNodeAttributeByPath("ampMessage","ver"),this._oAmpEvent.currentTime=this._oParse.queryNodeAttributeByPath("ampMessage","time"),this._oAmpEvent.eventTypeName=this._oParse.queryNodeAttributeByPath("body","name"),a=this._oParse.queryNodeAttributeByPath("body","type"));"request"==a?this._oAmpEvent.eventClass=EC_REQUEST:"response"==a?this._oAmpEvent.eventClass=EC_CONFIRMATION:"event"==a&&(this._oAmpEvent.eventClass=EC_UNSOLICITED);this._oAmpEvent.eventType=this.GetCmdIndex(this._oAmpEvent.eventTypeName);switch(this._oAmpEvent.eventType){case AMP_InitialState_CONF:case AMP_AgentQuery_CONF:case AMP_IvrQuery_CONF:case AMP_TelQuery_CONF:case AMP_ServiceQuerySummary_CONF:case AMP_IvrSumQuery_CONF:case AMP_TaskQuerySummary_CONF:case AMP_StartNotification_CONF:case AMP_EndNotification_CONF:case AMP_CallReportQuery_CONF:case AMP_AgentSumQuery_CONF:case AMP_AgentWorkSumQuery_CONF:case AMP_ServiceSumQueryByHour_CONF:case AMP_TaskSumQueryByHour_CONF:case AMP_QueryActiveTask_CONF:case AMP_M4AgentSumQuery_CONF:case AMP_M4ServiceSumQuery_CONF:case AMP_M4IvrServiceQuery_CONF:case AMP_M4TrunkSumQuery_CONF:if(this._oParse.nType==xmlForIE){var e=oXml.queryNode("ampMessage/body/cause");null!=e&&(this._oAmpEvent.description=oXml.queryNodeAttribute(e,"desc"),this._oAmpEvent.code=stringToInt(oXml.queryNodeAttribute(e,"code"),0))}else e=this._oParse.queryNode("cause"),null!=e&&(this._oAmpEvent.description=this._oParse.queryNodeAttribute(e,"desc"),this._oAmpEvent.code=stringToInt(this._oParse.queryNodeAttribute(e,"code"),0));this._oAmpEvent.data=this._oAmpEvent.eventType==AMP_StartNotification_CONF?this._oParse.queryNodeValueByPath("expires"):getSubString(d,"\x3c/cause\x3e","\x3c/body\x3e");break;case AMP_AgentReport:case AMP_IvrReport:case AMP_TrunkReport:case AMP_TrunkSumReport:case AMP_TelReport:case AMP_ServiceReport:case AMP_TaskReport:case AMP_OutboundReport:case AMP_CallReportReport:case AMP_M4WallServiceReport:case AMP_M4WallQueueReport:case AMP_M4AgentSumReport:case AMP_M4ServiceSumReport:case AMP_M4IvrServiceReport:case AMP_OnSignOuted:case AMP_TrunkReport:case AMP_TrunkSumReport:this._oAmpEvent.data=getSubString(d,'"'+this._oAmpEvent.eventTypeName+'"\x3e',"\x3c/body\x3e");break;default:b=!1}}catch(f){return alert(f.message),!1}return b};this.GetCmdName=function(a){for(var b=0;b<this.m_arrCmd.length;b++)if(this.m_arrCmdIndex[b]==a)return this.m_arrCmd[b];return""};this.GetCmdIndex=function(a){for(var b=0;b<this.m_arrCmd.length;b++)if(this.m_arrCmd[b]==a)return this.m_arrCmdIndex[b];return-1};this._Init();return this}function JAmpAPI(){this._SocketCallback=this._oAmpSocket=null;this._Create=function(){this._oAmpSocket=new JAMPParse;this._oAmpSocket=new JACPSocketIO("AMP");this._oAmpSocket.oParent=this;this._oAmpSocket.SetMsgCallBack(this._SocketCallBack)};this._SocketCallBack=function(a,b){this.oParent._SocketCallback&&this.oParent._SocketCallback(a,b)};this._SendAmpMessage=function(a,b){return this._oAmpSocket.WSIsConnect()?this._oAmpSocket.WSSendMsg("heartBeat"==a?"1000 off "+a+" "+b:"2000 off "+a+" "+b)?ACPI_SUCCESS:ACPI_FAILURE:ACPI_FAILURE};this._TaskQuerySummary=function(a,b,c){a=stringFormat('\x3campMessage ver\x3d"3.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionid\x3e{0}\x3c/sessionid\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"TaskQuerySummary"\x3e\x3cvccid\x3e{1}\x3c/vccid\x3e\x3cmonitorid\x3e{2}\x3c/monitorid\x3e\x3ctaskid\x3e{3}\x3c/taskid\x3e\x3c/body\x3e\x3c/ampMessage\x3e',"",a,b,c);return this._SendAmpMessage("TaskQuerySummary",a)};this._QueryActiveTask=function(a,b){var c=stringFormat('\x3campMessage ver\x3d"3.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionid\x3e{0}\x3c/sessionid\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"QueryActiveTask"\x3e\x3cvccid\x3e{1}\x3c/vccid\x3e\x3cagentid\x3e{2}\x3c/agentid\x3e\x3c/body\x3e\x3c/ampMessage\x3e\x00',"",a,agentID);return this._SendAmpMessage("QueryActiveTask",c)};this._ServiceQuerySummary=function(a,b,c){a=stringFormat('\x3campMessage ver\x3d"3.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionid\x3e{0}\x3c/sessionid\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"ServiceQuerySummary"\x3e\x3cvccid\x3e{1}\x3c/vccid\x3e\x3cmonitorid\x3e{2}\x3c/monitorid\x3e\x3cserviceid\x3e{3}\x3c/serviceid\x3e\x3c/body\x3e\x3c/ampMessage\x3e\x00',"",a,b,c);return this._SendAmpMessage("ServiceQuerySummary",a)};this._AgentSumQuery=function(a,b,c){a=stringFormat('\x3campMessage ver\x3d"3.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionid\x3e{0}\x3c/sessionid\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"AgentSumQuery"\x3e\x3cvccid\x3e{1}\x3c/vccid\x3e\x3cmonitorid\x3e{2}\x3c/monitorid\x3e\x3cserviceid\x3e{3}\x3c/serviceid\x3e\x3c/body\x3e\x3c/ampMessage\x3e\x00',"",a,b,c);return this._SendAmpMessage("AgentSumQuery",a)};this._IvrSumQuery=function(a,b,c){a=stringFormat('\x3campMessage ver\x3d"3.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionid\x3e{0}\x3c/sessionid\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"IvrSumQuery"\x3e\x3cvccid\x3e{1}\x3c/vccid\x3e\x3cmonitorid\x3e{2}\x3c/monitorid\x3e\x3cserviceid\x3e{3}\x3c/serviceid\x3e\x3c/body\x3e\x3c/ampMessage\x3e\x00',"",a,b,c);return this._SendAmpMessage("IvrSumQuery",a)};this._AgentWorkSumQuery=function(a,b,c){a=stringFormat('\x3campMessage ver\x3d"3.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionid\x3e{0}\x3c/sessionid\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"AgentWorkSumQuery"\x3e\x3cvccid\x3e{1}\x3c/vccid\x3e\x3cmonitorid\x3e{2}\x3c/monitorid\x3e\x3cserviceid\x3e{3}\x3c/serviceid\x3e\x3c/body\x3e\x3c/ampMessage\x3e\x00',"",a,b,c);return this._SendAmpMessage("AgentWorkSumQuery",a)};this._ServiceSumQueryByHour=function(a,b,c){a=stringFormat('\x3campMessage ver\x3d"3.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionid\x3e{0}\x3c/sessionid\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"ServiceSumQueryByHour"\x3e\x3cvccid\x3e{1}\x3c/vccid\x3e\x3cmonitorid\x3e{2}\x3c/monitorid\x3e\x3cserviceid\x3e{3}\x3c/serviceid\x3e\x3c/body\x3e\x3c/ampMessage\x3e\x00',"",a,b,c);return this._SendAmpMessage("ServiceSumQueryByHour",a)};this._TaskSumQueryByHour=function(a,b,c){a=stringFormat('\x3campMessage ver\x3d"3.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionid\x3e{0}\x3c/sessionid\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"TaskSumQueryByHour"\x3e\x3cvccid\x3e{1}\x3c/vccid\x3e\x3cmonitorid\x3e{2}\x3c/monitorid\x3e\x3cserviceid\x3e{3}\x3c/serviceid\x3e\x3c/body\x3e\x3c/ampMessage\x3e\x00',"",a,b,c);return this._SendAmpMessage("TaskSumQueryByHour",a)};this.ampOpenStream=function(a,b,c,d,e){return this._oAmpSocket.WSConnect(a,b,c,d,e)?ACPI_SUCCESS:ACPI_FAILURE};this.ampCloseStream=function(){this._oAmpSocket.WSDisconnect()};this.ampEmptyHeartBear=function(){return this._oAmpSocket.WSSendMsg("\x3campMessage\x3ealivecheck\x3c/ampMessage\x3e")?ACPI_SUCCESS:ACPI_FAILURE};this.ampInitialState=function(a,b,c){a=stringFormat('\x3campMessage ver\x3d"3.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionid\x3e{0}\x3c/sessionid\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"InitialState"\x3e\x3cvccid\x3e{1}\x3c/vccid\x3e\x3cagentid\x3e{2}\x3c/agentid\x3e\x3cagentpasswd\x3e{3}\x3c/agentpasswd\x3e\x3c/body\x3e\x3c/ampMessage\x3e',"",a,b,c);return this._SendAmpMessage("InitialState",a)};this.ampAgentQuery=function(a,b,c){a=stringFormat('\x3campMessage ver\x3d"3.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionid\x3e{0}\x3c/sessionid\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"AgentQuery"\x3e\x3cvccid\x3e{1}\x3c/vccid\x3e\x3cmonitorid\x3e{2}\x3c/monitorid\x3e\x3ccurpos\x3e{3}\x3c/curpos\x3e\x3c/body\x3e\x3c/ampMessage\x3e',"",a,b,c);return this._SendAmpMessage("AgentQuery",a)};this.ampTelQuery=function(a,b,c){a=stringFormat('\x3campMessage ver\x3d"3.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionid\x3e{0}\x3c/sessionid\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"TelQuery"\x3e\x3cvccid\x3e{1}\x3c/vccid\x3e\x3cmonitorid\x3e{2}\x3c/monitorid\x3e\x3ccurpos\x3e{3}\x3c/curpos\x3e\x3c/body\x3e\x3c/ampMessage\x3e',"",a,b,c);return this._SendAmpMessage("TelQuery",a)};this.ampIvrQuery=function(a,b,c){a=stringFormat('\x3campMessage ver\x3d"3.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionid\x3e{0}\x3c/sessionid\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"IvrQuery"\x3e\x3cvccid\x3e{1}\x3c/vccid\x3e\x3cmonitorid\x3e{2}\x3c/monitorid\x3e\x3ccurpos\x3e{3}\x3c/curpos\x3e\x3c/body\x3e\x3c/ampMessage\x3e\x00',"",a,b,c);return this._SendAmpMessage("IvrQuery",a)};this.ampM4IvrServiceQuery=function(a,b,c){a=stringFormat('\x3campMessage ver\x3d"4.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionid\x3e{0}\x3c/sessionid\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"M4IvrServiceQuery"\x3e\x3cvccid\x3e{1}\x3c/vccid\x3e\x3cmonitorid\x3e{2}\x3c/monitorid\x3e\x3c/body\x3e\x3c/ampMessage\x3e\x00',"",a,b);return this._SendAmpMessage("M4IvrServiceQuery",a)};this.ampTrunkQuery=function(a,b,c){a=stringFormat('\x3campMessage ver\x3d"4.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionid\x3e{0}\x3c/sessionid\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"M4TrunkSumQuery"\x3e\x3cvccid\x3e{1}\x3c/vccid\x3e\x3cmonitorid\x3e{2}\x3c/monitorid\x3e\x3ccurpos\x3e{3}\x3c/curpos\x3e\x3c/body\x3e\x3c/ampMessage\x3e\x00',"",a,b,c);return this._SendAmpMessage("M4TrunkSumQuery",a)};this.ampServiceQuery=function(a,b,c){a=stringFormat('\x3campMessage ver\x3d"3.0.0" time\x3d"'+GetCurrentTime()+'"\x3e\x3cheader\x3e\x3csessionid\x3e{0}\x3c/sessionid\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"ServiceQuerySummary"\x3e\x3cvccid\x3e{1}\x3c/vccid\x3e\x3cmonitorid\x3e{2}\x3c/monitorid\x3e\x3cserviceid\x3e{3}\x3c/serviceid\x3e\x3c/body\x3e\x3c/ampMessage\x3e\x00',"",a,b,c);return this._SendAmpMessage("ServiceQuerySummary",a)};this.ampM4ServiceSumQuery=function(a,b){var c=stringFormat('\x3campMessage ver\x3d"4.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionid\x3e{0}\x3c/sessionid\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"M4ServiceSumQuery"\x3e\x3cvccid\x3e{1}\x3c/vccid\x3e\x3cmonitorid\x3e{2}\x3c/monitorid\x3e\x3c/body\x3e\x3c/ampMessage\x3e\x00',"",a,b);return this._SendAmpMessage("ServiceQuerySummary",c)};this.ampTaskQuery=function(a,b,c){a=stringFormat('\x3campMessage ver\x3d"4.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionid\x3e{0}\x3c/sessionid\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"TaskQuery"\x3e\x3cvccid\x3e{1}\x3c/vccid\x3e\x3cmonitorid\x3e{2}\x3c/monitorid\x3e\x3c/body\x3e\x3c/ampMessage\x3e\x00',"",a,b);return this._SendAmpMessage("TaskQuery",a)};this.ampCallReportQuery=function(a,b,c,d,e){a=stringFormat('\x3campMessage ver\x3d"3.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionid\x3e{0}\x3c/sessionid\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"CallReportQuery"\x3e\x3cvccid\x3e{1}\x3c/vccid\x3e\x3cmonitorid\x3e{2}\x3c/monitorid\x3e\x3cserviceid\x3e{3}\x3c/serviceid\x3e\x3cmtype\x3e{4}\x3c/mtype\x3e\x3ccurpos\x3e{5}\x3c/curpos\x3e\x3c/body\x3e\x3c/ampMessage\x3e\x00',"",a,b,c,d,e);return this._SendAmpMessage("CallReportQuery",a)};this.ampM4AgentSumQuery=function(a,b,c){a=stringFormat('\x3campMessage ver\x3d"4.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionid\x3e{0}\x3c/sessionid\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"M4AgentSumQuery"\x3e\x3cvccid\x3e{1}\x3c/vccid\x3e\x3cmonitorid\x3e{2}\x3c/monitorid\x3e\x3ccurpos\x3e{3}\x3c/curpos\x3e\x3c/body\x3e\x3c/ampMessage\x3e\x00',"",a,b,c);return this._SendAmpMessage("M4AgentSumQuery",a)};this.ampGetTaskSummary=function(a,b,c){a=stringFormat('\x3campMessage ver\x3d"3.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionid\x3e{0}\x3c/sessionid\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"GetTaskSummary"\x3e\x3cvccid\x3e{1}\x3c/vccid\x3e\x3cmonitorid\x3e{2}\x3c/monitorid\x3e\x3ctaskid\x3e{3}\x3c/taskid\x3e\x3c/body\x3e\x3c/ampMessage\x3e\x00',"",a,b,c);return this._SendAmpMessage("GetTaskSummary",a)};this.ampTaskQuerySummary=function(a,b,c){a=stringFormat('\x3campMessage ver\x3d"4.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionid\x3e{0}\x3c/sessionid\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"TaskQuerySummary"\x3e\x3cvccid\x3e{1}\x3c/vccid\x3e\x3cmonitorid\x3e{2}\x3c/monitorid\x3e\x3ctaskid\x3e{3}\x3c/taskid\x3e\x3c/body\x3e\x3c/ampMessage\x3e\x00',"",a,b,c);return this._SendAmpMessage("TaskQuerySummary",a)};this.ampQueryMonitorSumInfo=function(a,b,c,d){return"TaskQuerySummary"==a?this._TaskQuerySummary(b,c,d):"QueryActiveTask"==a?this._QueryActiveTask(b,d):"ServiceQuerySummary"==a?this._ServiceQuerySummary(b,c,d):"AgentSumQuery"==a?this._AgentSumQuery(b,c,d):"IvrSumQuery"==a?this._IvrSumQuery(b,c,d):"AgentWorkSumQuery"==a?this._AgentWorkSumQuery(b,c,d):"ServiceSumQueryByHour"==a?this._ServiceSumQueryByHour(b,c,d):"TaskSumQueryByHour"==a?this._TaskSumQueryByHour(b,c,d):CINVccBar_FAILURE};this.ampStartNotification=function(a,b,c,d,e){if(""==c)return!1;c=c.split(",");d=d.split(",");e=Math.min(c.length,d.length);a=stringFormat('\x3cmonitorInfo vccid\x3d"{0}" agentid\x3d"{1}" count\x3d"{2}"\x3e',a,b,e);b="";for(var f=0;f<e;f++)b+=stringFormat('\x3cmonitor id\x3d"{0}" type\x3d"{1}" flag\x3d"" /\x3e',c[f],d[f]);c=stringFormat('\x3campMessage ver\x3d"3.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionID\x3e{0}\x3c/sessionID\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"StartNotification"\x3e{1}{2}\x3c/monitorInfo\x3e\x3c/body\x3e\x3c/ampMessage\x3e\x00',"",a,b);return this._SendAmpMessage("StartNotification",c)};this.ampEndNotification=function(a,b,c){c=c.split(",");var d=c.length;a=stringFormat('\x3cmonitorInfo vccid\x3d"{0}" agentid\x3d"{1}" count\x3d"{2}"\x3e',a,b,d);b="";for(var e=0;e<d;e++)b+=stringFormat('\x3cmonitor id\x3d"{0}"/\x3e',c[e]);c=stringFormat('\x3campMessage ver\x3d"3.0.0" time\x3d"'+getAcpTimeString()+'"\x3e\x3cheader\x3e\x3csessionID\x3e{0}\x3c/sessionID\x3e\x3c/header\x3e\x3cbody type\x3d"request" name\x3d"EndNotification"\x3e{1}{2}\x3c/monitorInfo\x3e\x3c/body\x3e\x3c/ampMessage\x3e\x00',"",a,b);return this._SendAmpMessage("EndNotification",c)};this.SetSocketCallBack=function(a){this._SocketCallback=a};this.IsSoceketConnect=function(){return this._oAmpSocket.WSIsConnect()};this.GetSoceketStatus=function(){return this._oAmpSocket.WSGetConnectStatus()};this._Create();return this}function JQueryMonitorSumInfo(){this._baseTimerID=500;this._timerIds=[];this._cmdNames=[];this._monitorIds=[];this._serviceIds=[];this._IsTimerIDExist=function(a){for(var b=0;b<this._timerIds.length;b++)if(this._timerIds[b]==a)return!0;return!1};this._GetTimerID=function(){for(var a=0;a<this._timerIds.length;a++)if(!this._IsTimerIDExist(this._baseTimerID+a))return this._baseTimerID+a;return this._baseTimerID+this._timerIds.length};this.AddItem=function(a,b,c){if(-1!=this.GetItemIndex(a,b,c))return-1;this._timerIds.push(this._GetTimerID());this._cmdNames.push(a);this._monitorIds.push(b);this._serviceIds.push(c);return this._timerIds.length-1};this.RemoveItem=function(a,b,c){a=this.GetItemIndex(a,b,c);-1!=a&&(this._timerIds.splice(a,1),this._cmdNames.splice(a,1),this._monitorIds.splice(a,1),this._serviceIds.splice(a,1))};this.GetItemByTimerID=function(a){for(var b=0;b<this._timerIds.length;b++)if(this._timerIds[b]==a)return b;return-1};this.GetItemIndex=function(a,b,c){for(var d=0;d<this._monitorIds.length;d++)if(this._cmdNames[d]==a&&this._monitorIds[d]==b&&this._serviceIds[d]==c)return d;return-1};return this}function JMonitorInfo(){this._bTimerStart=!1;this._arrMIdS=[];this._arrMTypeS=[];this._arrMFlagS=[];this.Add=function(a,b,c){for(var d=0;d<this._arrMIdS.length;d++)if(a==this._arrMIdS[d]){this._arrMTypeS[d]=b;this._arrMFlagS[d]=c;return}this._arrMIdS.push(a);this._arrMTypeS.push(b);this._arrMFlagS.push(c)};this.Del=function(a){for(var b=0;b<this._arrMIdS.length;b++)if(a==this._arrMIdS[b]){this._arrMIdS.splice(b,1);this._arrMTypeS.splice(b,1);this._arrMFlagS.splice(b,1);break}};this.Merge=function(a,b,c){a=a.split(",");b=b.split(",");if(""==c){c=[];for(var d=0;d<a.length;d++)c.push("")}else c=c.split(",");if(a.length==b.length&&c.length==b.length)for(d=0;d<a.length;d++)this.Add(a[d],b[d],c[d])};this.Leafout=function(a){a=a.split(",");for(var b=0;b<a.length;b++)this.Del(a[b])};this.GetIds=function(){for(var a="",b=0;b<this._arrMIdS.length;b++)a=0==b?this._arrMIdS[b]:a+","+this._arrMIdS[b];return a};this.GetTypes=function(){for(var a="",b=0;b<this._arrMTypeS.length;b++)a=0==b?this._arrMTypeS[b]:a+","+this._arrMTypeS[b];return a};this.GetFlags=function(){for(var a="",b=0;b<this._arrMFlagS.length;b++)a=0==b?this._arrMFlagS[b]:a+","+this._arrMFlagS[b];return a};this.SetTimerStart=function(a){this._bTimerStart=a};this.GetTimerStart=function(){return this._bTimerStart};return this}function JAmpDevice(a){this._oVccBarCenter=a;this._oAmpAPI=this._oMonitorInfo=this._oQueryMonitorSumInfo=this._oAmpParse=null;this.m_lMsgReceived=MSG_READY;this._oAcpCall=null;this._thisSubBusyStatus=-1;this._AmpSocketReconnectTimer=0;this._createObject=function(){this._oAmpParse=new JAMPParse;this._oAmpAPI=new JAmpAPI;this._oAmpAPI.oParent=this;this._oAmpAPI.SetSocketCallBack(this._SocketCallBack);this._oQueryMonitorSumInfo=new JQueryMonitorSumInfo;this._oMonitorInfo=new JMonitorInfo};this._LogInMonitor=function(){this.InitialState()};this._SocketCallBack=function(b,a){b==WS_EVENT_ONOPEN?(this.oParent._LogInMonitor(),this.oParent._oVccBarCenter._oTimer.SetTimer(AMP_EMPTYHEARTBEAT_ID,1E3*AMP_EMPTYHEARTBEAT_INTERVAL),this.oParent._oVccBarCenter._oTimer.KillTimer(AMP_OPENSOCKET_ID)):b==WS_EVENT_ONCLOSE?(this.oParent._oVccBarCenter._oTimer.KillTimer(AMP_EMPTYHEARTBEAT_ID),this.oParent._oVccBarCenter._oTimer.KillTimer(AMP_OPENSOCKET_ID),this.oParent._oVccBarCenter._oAgentInfo._isMonitorLogin&&(this.oParent._AmpSocketReconnectTimer=0,this.oParent._oVccBarCenter._oTimer.SetTimer(AMP_AGENTRECONNECT_ID,1E3*AMP_AGENTRECONNECT_INTERVAL))):b==WS_EVENT_ONERROR?(this.oParent._oVccBarCenter._oAgentInfo._isMonitorLogin=!1,this.oParent._oVccBarCenter._oTimer.KillTimer(AMP_OPENSOCKET_ID)):b==WS_EVENT_ONMESSAGE&&this.oParent._OmAmpNotify(a)};this._OmAmpNotify=function(b){this._oAmpParse.ParseMsg(b)&&(this._oAmpParse._oAmpEvent.eventType==AMP_StartNotification_CONF&&(0==this._oMonitorInfo.GetTimerStart()?(b=stringToInt(this._oAmpParse._oAmpEvent.data,0),0<b&&(this._oVccBarCenter._oTimer.SetTimer(AMP_STARTNOTIFICATION_ID,b/2*1E3),this._oMonitorInfo.SetTimerStart(!0))):this._oVccBarCenter._oTimer.Reset(AMP_STARTNOTIFICATION_ID)),this._oAmpParse._oAmpEvent.eventType==AMP_OnSignOuted&&this.CloseStream(),this._oVccBarCenter.OnMonitorNotify(this._oAmpParse._oAmpEvent,Notify_MSG))};this.OnTimerEvent=function(b){if(b==AMP_EMPTYHEARTBEAT_ID)this._oVccBarCenter._oTimer.Reset(b),this._oAmpAPI.ampEmptyHeartBear();else if(b==AMP_AGENTRECONNECT_ID)DisplayLog(VccBar_Log_Debug,"JAmpDevice:onTimer(AMP_AGENTRECONNECT_ID)"),this._AmpSocketReconnectTimer>=TIMER_RECONNECT_TIME?(this._oVccBarCenter._oTimer.KillTimer(AMP_AGENTRECONNECT_ID),this._oVccBarCenter._FireOnPrompt(4607)):(this._AmpSocketReconnectTimer++,this._oAmpAPI.ampOpenStream(this._oVccBarCenter._oAgentInfo._monitorIP,this._oVccBarCenter._oAgentInfo._monitorPort,this._oVccBarCenter._oAgentInfo._protocolCryptType,this._oVccBarCenter._oAgentInfo._proTransportType,this._oVccBarCenter._oAgentInfo._monitorXPath)==ACPI_SUCCESS&&(this._AmpSocketReconnectTimer=0,this._oVccBarCenter._oTimer.KillTimer(AMP_AGENTRECONNECT_ID)));else if(b==AMP_STARTNOTIFICATION_ID){var a=this._oMonitorInfo.GetIds();""!=a?this._oAmpAPI.ampStartNotification(this._oVccBarCenter._oAgentInfo._vccID,this._oVccBarCenter._oAgentInfo._agentID,a,this._oMonitorInfo.GetTypes(),this._oMonitorInfo.GetFlags()):this._oVccBarCenter._oTimer.KillTimer(b)}else b==AMP_OPENSOCKET_ID&&(DisplayLog(VccBar_Log_Debug,"JAmpDevice:onTimer(AMP_OPENSOCKET_ID)"),this._oVccBarCenter._oTimer.KillTimer(AMP_OPENSOCKET_ID),this._oAmpAPI.GetSoceketStatus()==WS_STATUS_CONNECTING&&this._oAmpAPI.acpCloseStream());b>=this._oQueryMonitorSumInfo._baseTimerID&&b<this._oQueryMonitorSumInfo._baseTimerID+100&&(b=this._oQueryMonitorSumInfo.GetItemByTimerID(b),-1<b&&(lReturn=this._oAmpAPI.ampQueryMonitorSumInfo(this._oQueryMonitorSumInfo._cmdNames[b],this._oVccBarCenter._oAgentInfo._vccID,this._oQueryMonitorSumInfo._monitorIds[b],this._oQueryMonitorSumInfo._serviceIds[b]),lReturn==ACPI_SUCCESS&&this._oVccBarCenter._oTimer.Reset(this._oQueryMonitorSumInfo._timerIds[b])))};this.OpenStream=function(b,a){this.CloseStream();this._oVccBarCenter._oTimer.SetTimer(AMP_OPENSOCKET_ID,1E3*CINNGCCA_OPENSOCKET_INTERVAL);return this._oAmpAPI.ampOpenStream(b,a,this._oVccBarCenter._oAgentInfo._protocolCryptType,this._oVccBarCenter._oAgentInfo._proTransportType,this._oVccBarCenter._oAgentInfo._monitorXPath)};this.CloseStream=function(){this._bLogin=!1;this._oVccBarCenter._oTimer.KillTimer(AMP_EMPTYHEARTBEAT_ID);this._oVccBarCenter._oTimer.KillTimer(AMP_OPENSOCKET_ID);this._oAmpAPI.ampCloseStream()};this.InitialState=function(){return this._oAmpAPI.ampInitialState(this._oVccBarCenter._oAgentInfo._vccID,this._oVccBarCenter._oAgentInfo._agentID,this._oVccBarCenter._oAgentInfo._passWord)};this.AgentQuery=function(b,a){return this._oAmpAPI.ampAgentQuery(this._oVccBarCenter._oAgentInfo._vccID,b,a)};this.TelQuery=function(b,a){return this._oAmpAPI.ampTelQuery(this._oVccBarCenter._oAgentInfo._vccID,b,a)};this.IvrQuery=function(b,a){return"4.0"==this._oVccBarCenter._oAgentInfo._monitorVersion?this._oAmpAPI.ampM4IvrServiceQuery(this._oVccBarCenter._oAgentInfo._vccID,b,a):this._oAmpAPI.ampIvrQuery(this._oVccBarCenter._oAgentInfo._vccID,b,a)};this.TrunkQuery=function(b,a){return this._oAmpAPI.ampTrunkQuery(this._oVccBarCenter._oAgentInfo._vccID,b,a)};this.ServiceQuery=function(b,a){return"4.0"==this._oVccBarCenter._oAgentInfo._monitorVersion?this._oAmpAPI.ampM4ServiceSumQuery(this._oVccBarCenter._oAgentInfo._vccID,b):this._oAmpAPI.ampServiceQuery(this._oVccBarCenter._oAgentInfo._vccID,b,"")};this.TaskQuery=function(b,a){return this._oAmpAPI.ampTaskQuery(this._oVccBarCenter._oAgentInfo._vccID,b,a)};this.CallReportQuery=function(b,a){return"4.0"==this._oVccBarCenter._oAgentInfo._monitorVersion?this._oAmpAPI.ampM4AgentSumQuery(this._oVccBarCenter._oAgentInfo._vccID,b,a):this._oAmpAPI.ampCallReportQuery(this._oVccBarCenter._oAgentInfo._vccID,b,"",0,a)};this.GetTaskSummary=function(b,a){return"4.0"==this._oVccBarCenter._oAgentInfo._monitorVersion?this._oAmpAPI.ampTaskQuerySummary(this._oVccBarCenter._oAgentInfo._vccID,b,a):this._oAmpAPI.ampGetTaskSummary(this._oVccBarCenter._oAgentInfo._vccID,b,a)};this.QueryMonitorSumInfo=function(b,a){var d=a.split("|"),e=0;if("4.0"==this._oVccBarCenter._oAgentInfo._monitorVersion&&"TaskQuerySummary"==b)return-1;"QueryActiveTask"==b&&this._oAmpAPI.ampQueryMonitorSumInfo(b,this._oVccBarCenter._oAgentInfo._vccID,"","");if(3==d.length){var f=stringToInt(d[2],0);if(0<f){var g=this._oQueryMonitorSumInfo.AddItem(b,d[0],d[1]);-1<g&&(e=this._oAmpAPI.ampQueryMonitorSumInfo(b,this._oVccBarCenter._oAgentInfo._vccID,d[0],d[1]),e==ACPI_SUCCESS&&this._oVccBarCenter._oTimer.SetTimer(this._oQueryMonitorSumInfo._timerIds[g],1E3*f))}else g=this._oQueryMonitorSumInfo.GetItemIndex(b,d[0],d[1]),-1<g&&this._oVccBarCenter._oTimer.KillTimer(this._oQueryMonitorSumInfo._timerIds[g])}return CINVccBar_FAILURE};this.StartNotification=function(b,a,d){this._oMonitorInfo.Merge(b,a,d);b=this._oMonitorInfo.GetIds();return""!=b?this._oAmpAPI.ampStartNotification(this._oVccBarCenter._oAgentInfo._vccID,this._oVccBarCenter._oAgentInfo._agentID,b,this._oMonitorInfo.GetTypes(),this._oMonitorInfo.GetFlags()):CINVccBar_FAILURE};this.EndNotification=function(b){return this._oAmpAPI.ampEndNotification(this._oVccBarCenter._oAgentInfo._vccID,this._oVccBarCenter._oAgentInfo._agentID,b)};this._createObject();return this}function JVccBarAssist(){this.oBarBtnControl=new JBarBtnControl;this.oBarAgentStatus=new JBarAgentStatus;return this}function JBarBtnControl(){this._arrCmd=[];this._arrCmdIndex=[];this._type=0;this._getCmdID=function(a){for(var b=0;b<this._arrCmdIndex.length;b++)if(this._arrCmdIndex[b]==a)return this._arrCmd[b];return""};this._ChangeObject=function(a,b){1==a?0==this._type?b.disabled=!1:b.style.display="":0==this._type?b.disabled=!0:b.style.display="none"};this.AttachBtnByUIID=function(a,b){this._arrCmd.push(a);this._arrCmdIndex.push(b)};this.UpdateUI=function(a){a=a.split("|");for(var b=0;b<this._arrCmdIndex.length;b++){for(var c=this._arrCmdIndex[b],d=!1,e=0;e<a.length;e++)if(parseInt(a[e])==c){d=!0;break}c=this._getCmdID(c);""!=c&&(c=document.getElementById(c),null!=c&&this._ChangeObject(d,c))}};this.SetUpdateType=function(a){this._type=a};return this}function BarBeginAgentStatusTimer(){null==application.oVccBarAssist.oBarAgentStatus._timer&&(application.oVccBarAssist.oBarAgentStatus._timer=setInterval(BarAgentStatusTimeSum,1E3))}function BarStopAgentStatusTimer(){null!=application.oVccBarAssist.oBarAgentStatus._timer&&(clearInterval(application.oVccBarAssist.oBarAgentStatus._timer),application.oVccBarAssist.oBarAgentStatus._timer=null)}function BarAgentStatusTimeSum(){application.oVccBarAssist.oBarAgentStatus.AgentStatusTimeSum()}function JBarAgentStatus(){this._busySubStatusSelectedItem="";this._agentStatus=0;this._ring=!1;this._timerCount=0;this._timer=null;this._arrSubBusyIndex=[];this._arrSubBusyText=[];this.SetSubBusyStatus=function(a){this._arrSubBusyIndex.length=0;this._arrSubBusyText.length=0;a=a.split("$");for(var b=0;b<a.length;b++){var c=a[b].split("|");2==c.length&&(this._arrSubBusyIndex.push(parseInt(c[0])),this._arrSubBusyText.push(c[1]))}};this.SetRingFlag=function(a){this._ring=a};this.SetAgentStatus=function(a){if(this._agentStatus!=a||3==this._agentStatus)this._agentStatus=a,this._timerCount=0,0<this._agentStatus?BarBeginAgentStatusTimer():(BarStopAgentStatusTimer(),setTimeout(function(){BarAgentStatusTimeSum()},1E3))};this.OnAgentStatusTime=function(a,b,c){};this.AgentStatusTimeSum=function(){this._timerCount+=1;-1==this._agentStatus&&(this._timerCount=0);this._showAgentStatusTimer()};this._getSubStatusText=function(){var a=application.oJVccBar.GetAgentSubBusyStatus();if(-1==a)this._busySubStatusSelectedItem="";else for(var b=0;b<this._arrSubBusyIndex.length;b++)if(this._arrSubBusyIndex[b]==a){this._busySubStatusSelectedItem=this._arrSubBusyText[b];break}};this._getTimerString=function(a){if(0==a)return"";var b=parseInt(a/3600),b=10>b?"0"+b:b,b="00"==b?"":b+":",c=parseInt(a%3600/60);a%=60;return b.toString()+(10>c?"0"+c:c).toString()+":"+(10>a?"0"+a:a).toString()};this._getTextByStatus=function(){return 1==this._agentStatus?(this._getSubStatusText(),""!=this._busySubStatusSelectedItem?this._busySubStatusSelectedItem:"\u5fd9\u788c"):2==this._agentStatus?"\u5c31\u7eea":3==this._agentStatus?this._ring?"\u632f\u94c3\u4e2d":"\u901a\u8bdd\u4e2d":4==this._agentStatus?"\u540e\u7eed\u6001":"\u672a\u767b\u5f55"};this._showAgentStatusTimer=function(){this.OnAgentStatusTime(this._agentStatus,this._getTextByStatus(),this._getTimerString(this._timerCount))};return this}function JWeChatMessageItem(){this.direction=0;this.msgseq=-1;this.timeStamp=this.data=this.title=this.eventKey=this.Event=this.recongnition=this.sessionUrl=this.content=this.msgType="";this.code=this.needMmcOpenData=0;this.sender=this.des="";return this}function JWechChatSession(){this.type="00";this.userNickName=this.sessionId="";this.sex="0";this.vccName=this.vccPublicId=this.userId=this.country=this.city=this.province="";this.msgSession=[];this.status=1;this.AddMessageItem=function(a,b,c,d,e,f,g,h,k,l,n,p){var m=this.GetMessageIndex(b);return-1==m?(m=new JWeChatMessageItem,m.sender=a,m.direction=m.sender==this.userId?0:1,m.msgseq=b,m.msgType=c,m.content=d,m.sessionUrl=e,m.recongnition=f,m.Event=g,m.eventKey=h,m.title=k,m.data=l,m.timeStamp=n,m.needMmcOpenData=p,this.msgSession.push(m),m):this.msgSession[m]};this.GetMessageCount=function(){return this.msgSession.length};this.GetMessageItemByIndex=function(a){return 0>a||a>=this.msgSession.length?null:this.msgSession[a]};this.GetMessageItem=function(a){a=this.GetMessageIndex(a);return-1==a?null:this.msgSession[a]};this.GetLastSendItem=function(){for(var a=this.msgSession.length-1;0<a;a--)if(this.msgSession[a].sender==this.vccPublicId&&1==this.msgSession[a].direction)return this.msgSession[a];return null};this.GetMessageIndex=function(a){for(var b=0;b<this.msgSession.length;b++)if(this.msgSession[b].msgseq==a)return b;return-1}}function JWechChatManager(){this._currentSession="";this.weChatSessions=[];this.arrSendFileName=[];this.arrSendFileSessionID=[];this.arrRecvFileName=[];this.arrRecvFileSessionID=[];this.arrRecvFileMsgseq=[];this.GetSessionIndexBySessionID=function(a){for(var b=0;b<this.weChatSessions.length;b++)if(this.weChatSessions[b].sessionId==a)return b;return-1};this.GetSessionIndexByUserId=function(a){for(var b=0;b<this.weChatSessions.length;b++)if(this.weChatSessions[b].userId==a)return b;return-1};this.SetUserInfo=function(a){a=a.split("|");if(6==a.length){var b=this.GetSessionItemByUserId(a[0]);null!=b&&(b.userNickName=GetGBKFromBase64(a[1]),b.sex=a[2],b.province=GetGBKFromBase64(a[3]),b.city=GetGBKFromBase64(a[4]),b.country=GetGBKFromBase64(a[5]),this.OnBeginSession(b.sessionId))}};this.GetSessionItemByUserId=function(a){a=this.GetSessionIndexByUserId(a);return-1==a?null:this.weChatSessions[a]};this.AddSessionItem=function(a,b,c,d){if(-1==this.GetSessionIndexBySessionID(a,c,d)){var e=new JWechChatSession;e.type=b;e.sessionId=a;e.userId=c;e.vccPublicId=d;this.weChatSessions.push(e);return e}return null};this.OnSaveRecvMessageReport=function(a,b,c,d,e,f,g,h,k,l,n,p,m,q){l=this.GetSessionItemBySessionID(a);null==l&&(this._currentSession=a,l=this.AddSessionItem(a,c,d,e));null!=l&&(l.AddMessageItem(d,b,f,g,h,k,Event,n,p,m,q,0),"begin"==f?application.oJVccBar.GetWeChatParam(d):"end"==f?this.OnEndSession(a):this.OnRecvMessage(a,b))};this.OnSaveSendMessageReport=function(a,b,c,d,e,f){a=this.GetSessionItemBySessionID(b);null!=a&&(a=a.GetLastSendItem(),null!=a&&(a.code=d,a.des=e,a.timeStamp=f,a.msgseq=c,this.OnSendMessageReport(b,c)))};this.SaveSendMessage=function(a,b,c,d,e,f,g,h,k,l){a=this.GetSessionItemBySessionID(a);null!=a&&a.AddMessageItem(d,-1,e,f,g,"","","",h,k,"",l)};this.OnInvokeUploadFileToMMSReport=function(a,b,c){if(1==b||2==b)for(var d=0;d<this.arrSendFileName.length;d++)if(this.arrSendFileName[d]==a){this.OnUploadFileStatus(this.arrSendFileSessionID[d],b,c);this.arrSendFileSessionID.splice(d,1);this.arrSendFileName.splice(d,1);break}};this.OnInvokeDownFileFromMMSReport=function(a,b,c,d){if(1==b||2==b)for(var e=0;e<this.arrRecvFileName.length;e++)if(this.arrRecvFileName[e]==a&&this.arrRecvFileMsgseq[e]==d){this.OnDowndFileStatus(this.arrRecvFileSessionID[e],this.arrRecvFileMsgseq[e],b,c);this.arrRecvFileSessionID.splice(e,1);this.arrRecvFileName.splice(e,1);this.arrRecvFileMsgseq.splice(e,1);break}};this.SendTextMessage=function(a,b){""==a&&(a=this._currentSession);var c=this.GetSessionItemBySessionID(a);null!=c&&application.oJVccBar.SendWeChatMsg(a,c.type,c.userId,c.vccPublicId,"text",b,"","","",0)};this.SendImageMessage=function(a,b){""==a&&(a=this._currentSession);var c=this.GetSessionItemBySessionID(a);null!=c&&application.oJVccBar.SendWeChatMsg(a,c.type,c.userId,c.vccPublicId,"image","",b,"","",0)};this.SendVoiceMessage=function(a,b){""==a&&(a=this._currentSession);var c=this.GetSessionItemBySessionID(a);null!=c&&application.oJVccBar.SendWeChatMsg(a,c.type,c.userId,c.vccPublicId,"voice","",b,"","",0)};this.SendVedioMessage=function(a,b,c){""==a&&(a=this._currentSession);var d=this.GetSessionItemBySessionID(a);null!=d&&application.oJVccBar.SendWeChatMsg(a,d.type,d.userId,d.vccPublicId,"vedio","",b,c,"",0)};this.SendFormatMessage=function(a,b,c,d){""==a&&(a=this._currentSession);var e=this.GetSessionItemBySessionID(a);null!=e&&application.oJVccBar.SendWeChatMsg(a,e.type,e.userId,e.vccPublicId,"notice","","",b,c,d)};this.EndMessage=function(a){""==a&&(a=this._currentSession);var b=this.GetSessionItemBySessionID(a);null!=b&&application.oJVccBar.SendWeChatMsg(a,b.type,b.userId,b.vccPublicId,"end","","","","",0)};this.UploadFileToMMS=function(a,b){if(""==b)return 0;""==a&&(a=this._currentSession);var c=this.GetSessionItemBySessionID(a);null!=c&&(this.arrSendFileName.push(b),this.arrSendFileSessionID.push(a),application.oJVccBar.UploadFileToMMS(b,c.userId,c.vccPublicId));return 0};this.DownFileFromMMS=function(a,b,c){if(""==c)return 0;""==a&&(a=this._currentSession);var d=this.GetSessionItemBySessionID(a);null!=d&&(this.arrRecvFileName.push(c),this.arrRecvFileSessionID.push(a),this.arrRecvFileMsgseq.push(b),application.oJVccBar.DownFileFromMMS(c,d.userId,d.vccPublicId,a,b));return 0};this.GetSessionItemBySessionID=function(a){a=this.GetSessionIndexBySessionID(a);return-1==a?null:this.weChatSessions[a]};this.GetSessionItem=function(a,b){var c=this.GetSessionItemBySessionID(a);if(null!=c)for(var d=0;d<c.GetMessageCount();d++){var e=c.GetMessageItemByIndex(d);if(e.msgseq==b)return e}return null};this.OnBeginSession=function(a){};this.OnEndSession=function(a){};this.OnRecvMessage=function(a,b){};this.OnSendMessageReport=function(a,b){};this.OnUploadFileStatus=function(a,b,c){};this.OnDowndFileStatus=function(a,b,c,d){}}function JVccBarCtrl(){this._methodCallBackFunction=this._eventCallBackFunction=this.oJVccBarCenter=null;this._createObject=function(){this.oJVccBarCenter=new JVccBarCenter;this.oJVccBarCenter.oParent=this;this.oJVccBarCenter.attachEventfun(this._eventCallBackFunctionCtrl);this.oJVccBarCenter.attachResponsefun(this._methodCallBackFunctionCtrl)};this._methodCallBackFunctionCtrl=function(a,b){this.oParent._methodCallBackFunction&&this.oParent._methodCallBackFunction(a,b)};this._eventCallBackFunctionCtrl=function(a,b){this.oParent._eventCallBackFunction&&this.oParent._eventCallBackFunction(a,b)};this.Initial=function(){return this.oJVccBarCenter.Initial()};this.SerialBtn=function(a,b){return this.oJVccBarCenter.SerialBtn(a,b)};this.GetBtnStatus=function(a){return this.oJVccBarCenter.GetBtnStatus(a)};this.Configurate=function(a){return this.oJVccBarCenter.Configurate(a)};this.GetConfiguration=function(){return this.oJVccBarCenter.GetConfiguration()};this.UnInitial=function(a){return this.oJVccBarCenter.UnInitial(a)};this.SetUIStyle=function(a){return this.oJVccBarCenter.SetUIStyle(a)};this.GetVersion=function(){return this.oJVccBarCenter.GetVersion()};this.SetBusy=function(a){return this.oJVccBarCenter.SetBusy(a)};this.SetIdle=function(){return this.oJVccBarCenter.SetIdle()};this.SetWrapUp=function(){return this.oJVccBarCenter.SetWrapUp()};this.SetCTICalloutTask=function(a){return this.oJVccBarCenter.SetCTICalloutTask(a)};this.GetCTICalloutTask=function(){return this.oJVccBarCenter.GetCTICalloutTask()};this.GetCallData=function(a){return this.oJVccBarCenter.GetCallData(a)};this.SetCallData=function(a,b){return this.oJVccBarCenter.SetCallData(a,b)};this.GetTransfer=function(){return this.oJVccBarCenter.GetTransfer()};this.SetTransfer=function(a,b,c){return this.oJVccBarCenter.SetTransfer(a,b,c)};this.ChangeCallQueue=function(a,b,c){return this.oJVccBarCenter.ChangeCallQueue(a,b,c)};this.GetCallID=function(){return this.oJVccBarCenter.GetCallID()};this.QuerySPGroupList=function(a,b,c,d,e,f){return this.oJVccBarCenter.QuerySPGroupList(a,b,c,d,e,f)};this.GetCallInfo=function(){return this.oJVccBarCenter.GetCallInfo()};this.SetTransparentParameter=function(a){return this.oJVccBarCenter.SetTransparentParameter(a)};this.GetAgentStatus=function(){return this.oJVccBarCenter.GetAgentStatus()};this.GetAgentSubBusyStatus=function(){return this.oJVccBarCenter.GetAgentSubBusyStatus()};this.GetBusySubStatus=function(){return this.oJVccBarCenter.GetBusySubStatus()};this.SetDisplayNumber=function(a){return this.oJVccBarCenter.SetDisplayNumber(a)};this.GetDisplayNumber=function(){return this.oJVccBarCenter.GetDisplayNumber()};this.CallQueueQuery=function(a,b,c){return this.oJVccBarCenter.CallQueueQuery(a,b,c)};this.QueryGroupAgentStatus=function(a,b,c,d){return this.oJVccBarCenter.QueryGroupAgentStatus(a,b,c,d)};this.QueryPreViewCallOutNumbers=function(a,b,c,d){return this.oJVccBarCenter.QueryPreViewCallOutNumbers(a,b,c,d)};this.QueryMonitorSumInfo=function(a,b){return this.oJVccBarCenter.QueryMonitorSumInfo(a,b)};this.GetBase64Data=function(a){return this.oJVccBarCenter.GetBase64Data(a)};this.GetDataFromBase64=function(a){return this.oJVccBarCenter.GetDataFromBase64(a)};this.SetWeChatQueueFlag=function(a){return this.oJVccBarCenter.SetWeChatQueueFlag(a)};this.GetWeChatQueueFlag=function(){return this.oJVccBarCenter.GetWeChatQueueFlag()};this.TransferCallQueue=function(a,b,c){return this.oJVccBarCenter.TransferCallQueue(a,b,c)};this.SetActiveService=function(a){return this.oJVccBarCenter.SetActiveService(a)};this.GetActiveService=function(){return this.oJVccBarCenter.GetActiveService()};this.GetExitCause=function(){return this.oJVccBarCenter.GetExitCause()};this.SetForwardNumber=function(a,b){return this.oJVccBarCenter.SetForwardNumber(a,b)};this.GetForwardNumber=function(){return this.oJVccBarCenter.GetForwardNumber()};this.SetAgentReservedStatus=function(a,b){return this.oJVccBarCenter.SetAgentReservedStatus(a,b)};this.GetAgentLogFile=function(a,b,c){return this.oJVccBarCenter.GetAgentLogFile(a,b,c)};this.GetMonitorStatus=function(){return this.oJVccBarCenter.GetMonitorStatus()};this.MakeCall=function(a,b,c,d,e,f,g,h){return this.oJVccBarCenter.MakeCall(a,b,c,d,e,f,g,h)};this.CallIn=function(a,b,c,d){return this.oJVccBarCenter.CallIn(a,b,c,d)};this.TransferOut=function(a,b){return this.oJVccBarCenter.TransferOut(a,b)};this.Hold=function(){return this.oJVccBarCenter.Hold()};this.RetrieveHold=function(){return this.oJVccBarCenter.RetrieveHold()};this.Disconnect=function(a){return this.oJVccBarCenter.Disconnect(a)};this.Answer=function(a){return this.oJVccBarCenter.Answer(a)};this.Consult=function(a,b){return this.oJVccBarCenter.Consult(a,b)};this.Transfer=function(){return this.oJVccBarCenter.Transfer()};this.Conference=function(){return this.oJVccBarCenter.Conference()};this.SendDTMF=function(a){return this.oJVccBarCenter.SendDTMF(a)};this.Bridge=function(a,b){return this.oJVccBarCenter.Bridge(a,b)};this.Mute=function(a){return this.oJVccBarCenter.Mute(a)};this.ReleaseThirdOne=function(a){return this.oJVccBarCenter.ReleaseThirdOne(a)};this.ForceReset=function(){return this.oJVccBarCenter.ForceReset()};this.SendIMMessage=function(a,b,c,d,e,f){return this.oJVccBarCenter.SendIMMessage(a,b,c,d,e,f)};this.BeginPlay=function(a,b,c,d,e){return this.oJVccBarCenter.BeginPlay(a,b,c,d,e)};this.StopPlay=function(a,b){return this.oJVccBarCenter.StopPlay(a,b)};this.BeginCollect=function(a,b,c,d,e,f,g,h,k,l){return this.oJVccBarCenter.BeginCollect(a,b,c,d,e,f,g,h,k,l)};this.StopCollect=function(a,b){return this.oJVccBarCenter.StopCollect(a,b)};this.BeginRecord=function(a,b){return this.oJVccBarCenter.BeginRecord(a,b)};this.StopRecord=function(a){return this.oJVccBarCenter.StopRecord(a)};this.AlterNate=function(a){return this.oJVccBarCenter.AlterNate(a)};this.CallBack=function(){return this.oJVccBarCenter.CallBack()};this.ReCall=function(){return this.oJVccBarCenter.ReCall()};this.SMMsg=function(a,b){return this.oJVccBarCenter.SMMsg(a,b)};this.ForeReleaseCall=function(a,b){return this.oJVccBarCenter.ForeReleaseCall(a,b)};this.Insert=function(a,b,c){return this.oJVccBarCenter.Insert(a,b,c)};this.Listen=function(a,b,c){return this.oJVccBarCenter.Listen(a,b,c)};this.Intercept=function(a,b,c){return this.oJVccBarCenter.Intercept(a,b,c)};this.Help=function(a,b,c){return this.oJVccBarCenter.Help(a,b,c)};this.Lock=function(a){return this.oJVccBarCenter.Lock(a)};this.UnLock=function(a){return this.oJVccBarCenter.UnLock(a)};this.ForceIdle=function(a){return this.oJVccBarCenter.ForceIdle(a)};this.ForceBusy=function(a){return this.oJVccBarCenter.ForceBusy(a)};this.ForceOut=function(a){return this.oJVccBarCenter.ForceOut(a)};this.InitialState=function(){return this.oJVccBarCenter.InitialState()};this.AgentQuery=function(a,b){return this.oJVccBarCenter.AgentQuery(a,b)};this.TelQuery=function(a,b){return this.oJVccBarCenter.TelQuery(a,b)};this.IvrQuery=function(a,b){return this.oJVccBarCenter.IvrQuery(a,b)};this.TrunkQuery=function(a,b){return this.oJVccBarCenter.TrunkQuery(a,b)};this.ServiceQuery=function(a,b){return this.oJVccBarCenter.ServiceQuery(a,b)};this.TaskQuery=function(a,b){return this.oJVccBarCenter.TaskQuery(a,b)};this.CallReportQuery=function(a,b){return this.oJVccBarCenter.CallReportQuery(a,b)};this.GetTaskSummary=function(a,b){return this.oJVccBarCenter.GetTaskSummary(a,b)};this.StartNotification=function(a,b,c){return this.oJVccBarCenter.StartNotification(a,b,c)};this.EndNotification=function(a){return this.oJVccBarCenter.EndNotification(a)};this.SendWeiboMsg=function(a){return this.oJVccBarCenter.SendWeiboMsg(a)};this.UploadFileToMMS=function(a,b,c){return this.oJVccBarCenter.UploadFileToMMS(a,b,c)};this.DownFileFromMMS=function(a,b,c,d,e){return this.oJVccBarCenter.DownFileFromMMS(a,b,c,d,e)};this.SendWeChatMsg=function(a,b,c,d,e,f,g,h,k,l){return this.oJVccBarCenter.SendWeChatMsg(a,b,c,d,e,f,g,h,k,l)};this.QueryWeChatData=function(a,b,c,d,e,f,g){return this.oJVccBarCenter.QueryWeChatData(a,b,c,d,e,f,g)};this.QueryWeChatHistory=function(a,b,c,d,e,f,g){return this.oJVccBarCenter.QueryWeChatHistory(a,b,c,d,e,f,g)};this.GetWeChatParam=function(a){return this.oJVccBarCenter.GetWeChatParam(a)};this.SetCtrlAttribute=function(a,b){this.oJVccBarCenter.SetCtrlAttribute(a,b)};this.GetCtrlAttribute=function(a){return this.oJVccBarCenter.GetCtrlAttribute(a)};this.GetBarCtrl=function(){return this};this.GetSipCtrl=function(){return this.oJVccBarCenter.GetSipCtrl()};this.attachEventfun=function(a){this._eventCallBackFunction=a};this.attachResponsefun=function(a){this._methodCallBackFunction=a};this._createObject()}var ACP_UNKNOWN=0,ACP_HEART_BEAT=ACP_UNKNOWN+1,ACP_Initial_CONF=ACP_HEART_BEAT+1,ACP_SignIn_CONF=ACP_HEART_BEAT+2,ACP_SignOut_CONF=ACP_HEART_BEAT+3,ACP_SetBusy_CONF=ACP_HEART_BEAT+4,ACP_SetIdle_CONF=ACP_HEART_BEAT+5,ACP_AgentReport_CONF=ACP_HEART_BEAT+7,ACP_SetAgentAutoEnterIdle_CONF=ACP_HEART_BEAT+8,ACP_AgentEnterIdle_CONF=ACP_HEART_BEAT+9,ACP_SetWrapUp_CONF=ACP_HEART_BEAT+10,ACP_ForceIdle_CONF=ACP_HEART_BEAT+11,ACP_ForceBusy_CONF=ACP_HEART_BEAT+12,ACP_ForceOut_CONF=ACP_HEART_BEAT+13,ACP_Lock_CONF=ACP_HEART_BEAT+14,ACP_UnLock_CONF=ACP_HEART_BEAT+15,ACP_ReleaseCall_CONF=ACP_HEART_BEAT+16,ACP_ReleaseCallByCallID_CONF=ACP_HEART_BEAT+17,ACP_SendDTMF_CONF=ACP_HEART_BEAT+18,ACP_CallInside_CONF=ACP_HEART_BEAT+19,ACP_Consultation_CONF=ACP_HEART_BEAT+20,ACP_CallOutside_CONF=ACP_HEART_BEAT+21,ACP_SingleStepTransfer_CONF=ACP_HEART_BEAT+22,ACP_Transfer_CONF=ACP_HEART_BEAT+23,ACP_SetTransfer_CONF=ACP_HEART_BEAT+24,ACP_Hold_CONF=ACP_HEART_BEAT+25,ACP_RetrieveHold_CONF=ACP_HEART_BEAT+26,ACP_Conference_CONF=ACP_HEART_BEAT+27,ACP_Alternate_CONF=ACP_HEART_BEAT+28,ACP_DoReplyMultimeAndHangUpCall_CONF=ACP_HEART_BEAT+29,ACP_Listen_CONF=ACP_HEART_BEAT+30,ACP_Help_CONF=ACP_HEART_BEAT+31,ACP_Intercept_CONF=ACP_HEART_BEAT+32,ACP_Insert_CONF=ACP_HEART_BEAT+33,ACP_StopInsert_CONF=ACP_HEART_BEAT+34,ACP_BeginRecord_CONF=ACP_HEART_BEAT+35,ACP_StopRecord_CONF=ACP_HEART_BEAT+36,ACP_BeginPlay_CONF=ACP_HEART_BEAT+37,ACP_StopPlay_CONF=ACP_HEART_BEAT+38,ACP_BeginCollect_CONF=ACP_HEART_BEAT+39,ACP_StopCollect_CONF=ACP_HEART_BEAT+40,ACP_Bridge_CONF=ACP_HEART_BEAT+41,ACP_SMMsg_CONF=ACP_HEART_BEAT+42,ACP_Answer_CONF=ACP_HEART_BEAT+43,ACP_Mute_CONF=ACP_HEART_BEAT+44,ACP_SetCallData_CONF=ACP_HEART_BEAT+45,ACP_GetCallData_CONF=ACP_HEART_BEAT+46,ACP_QueryTotalQueueWaitNum_CONF=ACP_HEART_BEAT+47,ACP_QueryQueueWaitNum_CONF=ACP_HEART_BEAT+48,ACP_QueryAgentStatus_CONF=ACP_HEART_BEAT+49,ACP_GetAccessNo_CONF=ACP_HEART_BEAT+50,ACP_QueryAgentCallInfo_CONF=ACP_HEART_BEAT+51,ACP_SetCTIParam_CONF=ACP_HEART_BEAT+52,ACP_GetCTIParam_CONF=ACP_HEART_BEAT+53,ACP_GetCTITime_CONF=ACP_HEART_BEAT+54,ACP_QuerySpAgentList_CONF=ACP_HEART_BEAT+55,ACP_ChangeCallQueue_CONF=ACP_HEART_BEAT+56,ACP_AgentReconnect_CONF=ACP_HEART_BEAT+57,ACP_WorkReport_CONF=ACP_HEART_BEAT+58,ACP_SendWeiboMsg_CONF=ACP_HEART_BEAT+59,ACP_SendMessage_CONF=ACP_HEART_BEAT+60,ACP_SendWeChatMsg_CONF=ACP_HEART_BEAT+61,ACP_QueryWeChatSessionIDs_CONF=ACP_HEART_BEAT+62,ACP_GetWeChatParam_CONF=ACP_HEART_BEAT+63,ACP_TransferCallQueue_CONF=ACP_HEART_BEAT+64,ACP_ForceReleaseCall_CONF=ACP_HEART_BEAT+65,ACP_OnOrigated=80,ACP_OnAnswerRequest=ACP_OnOrigated+1,ACP_OnAnswerSuccess=ACP_OnOrigated+2,ACP_OnAnswerFailure=ACP_OnOrigated+3,ACP_OnUserHangupBeforeResponse=ACP_OnOrigated+4,ACP_OnRequestRelease=ACP_OnOrigated+5,ACP_OnReleaseSuccess=ACP_OnOrigated+6,ACP_OnReleaseFailure=ACP_OnOrigated+7,ACP_OnLongNoAnswer=ACP_OnOrigated+8,ACP_OnConsultationBack=ACP_OnOrigated+9,ACP_OnConsultationSuccess=ACP_OnOrigated+10,ACP_OnConsultationFailure=ACP_OnOrigated+11,ACP_OnTransSuccess=ACP_OnOrigated+12,ACP_OnTransFailure=ACP_OnOrigated+13,ACP_OnTransferred=ACP_OnOrigated+14,ACP_OnReturnFromIVR=ACP_OnOrigated+15,ACP_OnReturnFromPhone=ACP_OnOrigated+16,ACP_OnBridgeSuccess=ACP_OnOrigated+17,ACP_OnBridgeFailure=ACP_OnOrigated+18,ACP_OnBeginSendDTMFSuccess=ACP_OnOrigated+19,ACP_OnBeginSendDTMFFailure=ACP_OnOrigated+20,ACP_OnStopSendDTMFSuccess=ACP_OnOrigated+21,ACP_OnStopSendDTMFFailure=ACP_OnOrigated+22,ACP_OnSingleTransferSuccess=ACP_OnOrigated+23,ACP_OnSingleTransferFailure=ACP_OnOrigated+24,ACP_OnCallInsideSuccess=ACP_OnOrigated+25,ACP_OnCallInsideFailure=ACP_OnOrigated+26,ACP_OnCallInsideSuccTalk=ACP_OnOrigated+27,ACP_OnCallOutsideSuccess=ACP_OnOrigated+28,ACP_OnCallOutsideFailure=ACP_OnOrigated+29,ACP_OnCallOutsideSuccTalk=ACP_OnOrigated+30,ACP_OnHoldSuccess=ACP_OnOrigated+31,ACP_OnHoldFailure=ACP_OnOrigated+32,ACP_OnRetrieveHoldSuccess=ACP_OnOrigated+33,ACP_OnRetrieveHoldFailure=ACP_OnOrigated+34,ACP_OnHoldCallRelease=ACP_OnOrigated+35,ACP_OnConferenceSuccess=ACP_OnOrigated+36,ACP_OnConferenceFailure=ACP_OnOrigated+37,ACP_OnConferenceSucTalk=ACP_OnOrigated+38,ACP_OnHangupCallInConf=ACP_OnOrigated+39,ACP_OnAlternateSuccess=ACP_OnOrigated+40,ACP_OnAlternated=ACP_OnOrigated+41,ACP_OnAlternateFailure=ACP_OnOrigated+42,ACP_OnListenSuccess=ACP_OnOrigated+43,ACP_OnListenFailure=ACP_OnOrigated+44,ACP_OnHelpSuccess=ACP_OnOrigated+45,ACP_OnHelpFailure=ACP_OnOrigated+46,ACP_OnInsertSuccess=ACP_OnOrigated+47,ACP_OnInsertFailure=ACP_OnOrigated+48,ACP_OnStopInsertSuccess=ACP_OnOrigated+49,ACP_OnStopInsertFailure=ACP_OnOrigated+50,ACP_OnInterceptSuccess=ACP_OnOrigated+51,ACP_OnInterceptFailure=ACP_OnOrigated+52,ACP_OnForceIdleSuccess=ACP_OnOrigated+53,ACP_OnForceIdleFailure=ACP_OnOrigated+54,ACP_OnForceBusySuccess=ACP_OnOrigated+55,ACP_OnForceBusyFailure=ACP_OnOrigated+56,ACP_OnForceOutSuccess=ACP_OnOrigated+57,ACP_OnForceOutFailure=ACP_OnOrigated+58,ACP_OnBeginRecordSuccess=ACP_OnOrigated+59,ACP_OnBeginRecordFailure=ACP_OnOrigated+60,ACP_OnStopRecordSuccess=ACP_OnOrigated+61,ACP_OnStopRecordFailure=ACP_OnOrigated+62,ACP_OnForceIdle=ACP_OnOrigated+63,ACP_OnForceBusy=ACP_OnOrigated+64,ACP_OnForceOut=ACP_OnOrigated+65,ACP_OnSignOuted=ACP_OnOrigated+66,ACP_OnSystemIdle=ACP_OnOrigated+67,ACP_OnLocked=ACP_OnOrigated+68,ACP_OnUnLocked=ACP_OnOrigated+69,ACP_OnForceRelease=ACP_OnOrigated+70,ACP_OnAgentAllBusy=ACP_OnOrigated+71,ACP_OnIntercepted=ACP_OnOrigated+72,ACP_OnInserted=ACP_OnOrigated+73,ACP_OnStopListenSuccess=ACP_OnOrigated+74,ACP_OnStopListenFailure=ACP_OnOrigated+75,ACP_OnListened=ACP_OnOrigated+76,ACP_OnBeginPlaySuccess=ACP_OnOrigated+77,ACP_OnBeginPlayFailure=ACP_OnOrigated+78,ACP_OnStopPlaySuccess=ACP_OnOrigated+79,ACP_OnStopPlayFailure=ACP_OnOrigated+80,ACP_OnBeginCollectSuccess=ACP_OnOrigated+81,ACP_OnBeginCollectFailure=ACP_OnOrigated+82,ACP_OnStopCollectSuccess=ACP_OnOrigated+83,ACP_OnStopcollectFailure=ACP_OnOrigated+84,ACP_GetLog=ACP_OnOrigated+85,ACP_OnCallQueueQuery=ACP_OnOrigated+86,ACP_OnQueueReport=ACP_OnOrigated+87,ACP_OnSystemMessage=ACP_OnOrigated+88,ACP_OnRecvWeiboMsg=ACP_OnOrigated+89,ACP_OnStaticInfoReport=ACP_OnOrigated+90,ACP_OnRecvWeChatMsg=ACP_OnOrigated+91,ACP_OnWeChatEventReport=ACP_OnOrigated+92,ACP_OnForceReleaseCallSuccess=ACP_OnOrigated+93,ACP_OnForceReleaseCallFailure=ACP_OnOrigated+94,ACP_OnAgentBusyReason=ACP_OnOrigated+95,ACP_OnAsrEventReport=ACP_OnOrigated+96,ACP_OnStopSmSuccess=ACP_OnOrigated+97,CD_IVR_CALLIN=0,CD_SERVRE_EXACT_CALLOUT=1,CD_PREVIEW_CALLOUT=2,CD_AGENT_OUTSIDE_CALLOUT=3,CD_IVR_CALLOUT=4,CD_AGENT_INSIDE_CALLOUT=5,CD_CONSULT_CALLOUT=6,CD_SINGLE_CALLOUT=6,CD_BRIDGE_CALLOUT=8,CD_MONITOR_CALLIN=9,CD_INTERCEPT_CALLIN=10,CD_INSERT_CALLIN=11,CD_STEPBYSTEP_CALLOUT=12,CD_FORECAST_CALLOUT=13,CD_EXACT_PREVIEW_CALLOUT=14,CD_HELP_CALLIN=19,EC_REQUEST=0,EC_UNSOLICITED=1,EC_CONFIRMATION=2,CS_IDLE=0,CS_ORIGATED=1,CS_INITIATED=2,CS_QUEUED=3,CS_DELIVERED=4,CS_ALERTING=5,CS_CONNECTED=6,CS_CONFERENCED=7,CS_HELD=8,AG_NULL=0,AG_NOT_READY=1,AG_READY=2,AG_BUSY=3,AG_WORKING_AFTER_CALL=4,IE_InitNull=-1,IE_Initing=0,IE_InitParamError=1,IE_InitSuccess=2,IE_InitSIPError=3,IE_InitMaccardError=4,IE_InitCTIError=5,IE_InitMonitorError=6;function JHead(){this.serialID=this.sessionID=this.curtime="";this.serviceID=this.direction=-1;this.timeStamp=""}function JAgent(){this.type=0;this.deviceID=this.agentID=this.vccID="";this.master=this.phoneStatus=this.agentSubStatus=this.agentStatus=-1}function JCause(){this.code=0;this.desc=""}function JDevice(){this.legID=this.phonestatus=-1;this.deviceID=""}function JCallinfo(){this.callData=this.opAgentID=this.callBackDevice=this.orgCallingDevice=this.orgCalledDevice=this.calledDevice=this.callingDevice="";this.count=0;this.device=[];this._create=function(){for(var a=0;4>a;a++){var b=new JDevice;this.device.push(b)}};this._create()}function JCallReportInfo(){this.callrescode=this.msserver=this.srfmsgid=this.answerflag=this.answerseconds=this.ringseconds=this.endtime=this.answertime=this.ringtime=this.starttime=this.detail=this.serviceid=this.direction=this.usernumber=this.sid=this.callid=""}function JBody(){this.eventTypeName="";this.eventType=this.eventClass=-1;this.datas=Array(32);this.datas_count=0;this.data="";this.agent=new JAgent;this.cause=new JCause;this.callinfo=new JCallinfo;this.reportinfo=new JCallReportInfo}function JAcpEvent(){this.head=new JHead;this.body=new JBody;this.acpMessage=""}var AMP_UNKNOWN=0,AMP_HEART_BEAT=1,AMP_Initial_CONF=AMP_HEART_BEAT+1,AMP_Login_CONF=AMP_HEART_BEAT+2,AMP_LogOut_CONF=AMP_HEART_BEAT+3,AMP_SetQueueType_CONF=AMP_HEART_BEAT+4,AMP_SetMsgFlag_CONF=AMP_HEART_BEAT+5,AMP_AgentReport_CONF=AMP_HEART_BEAT+6,AMP_QueryMonitorGroup_CONF=AMP_HEART_BEAT+7,AMP_QueryAgentState_CONF=AMP_HEART_BEAT+8,AMP_QueryQueueStatus_CONF=AMP_HEART_BEAT+9,AMP_QueryIvrStatus_CONF=AMP_HEART_BEAT+10,AMP_AgentReconnect_CONF=AMP_HEART_BEAT+11,AMP_InitialState_CONF=AMP_HEART_BEAT+12,AMP_AgentQuery_CONF=AMP_HEART_BEAT+13,AMP_IvrQuery_CONF=AMP_HEART_BEAT+14,AMP_TelQuery_CONF=AMP_HEART_BEAT+15,AMP_ServiceQuerySummary_CONF=AMP_HEART_BEAT+16,AMP_IvrSumQuery_CONF=AMP_HEART_BEAT+17,AMP_TaskQuerySummary_CONF=AMP_HEART_BEAT+18,AMP_StartNotification_CONF=AMP_HEART_BEAT+19,AMP_EndNotification_CONF=AMP_HEART_BEAT+20,AMP_CallReportQuery_CONF=AMP_HEART_BEAT+21,AMP_AgentSumQuery_CONF=AMP_HEART_BEAT+22,AMP_AgentWorkSumQuery_CONF=AMP_HEART_BEAT+23,AMP_ServiceSumQueryByHour_CONF=AMP_HEART_BEAT+24,AMP_TaskSumQueryByHour_CONF=AMP_HEART_BEAT+25,AMP_QueryActiveTask_CONF=AMP_HEART_BEAT+26,AMP_M4AgentSumQuery_CONF=AMP_HEART_BEAT+27,AMP_M4ServiceSumQuery_CONF=AMP_HEART_BEAT+28,AMP_M4IvrServiceQuery_CONF=AMP_HEART_BEAT+29,AMP_M4TrunkSumQuery_CONF=AMP_HEART_BEAT+30,AMP_telephoneStatusReport=AMP_HEART_BEAT+40,AMP_agentStatusReport=AMP_HEART_BEAT+41,AMP_lockStatusReport=AMP_HEART_BEAT+42,AMP_queueStatusReport=AMP_HEART_BEAT+43,AMP_ivrStatusReport=AMP_HEART_BEAT+44,AMP_AgentReport=AMP_HEART_BEAT+50,AMP_IvrReport=AMP_HEART_BEAT+51,AMP_TelReport=AMP_HEART_BEAT+52,AMP_ServiceReport=AMP_HEART_BEAT+53,AMP_TaskReport=AMP_HEART_BEAT+54,AMP_OutboundReport=AMP_HEART_BEAT+55,AMP_CallReportReport=AMP_HEART_BEAT+56,AMP_M4WallServiceReport=AMP_HEART_BEAT+57,AMP_M4WallQueueReport=AMP_HEART_BEAT+58,AMP_M4AgentSumReport=AMP_HEART_BEAT+59,AMP_M4ServiceSumReport=AMP_HEART_BEAT+60,AMP_M4IvrServiceReport=AMP_HEART_BEAT+61,AMP_OnSignOuted=AMP_HEART_BEAT+62,AMP_TrunkReport=AMP_HEART_BEAT+63,AMP_TrunkSumReport=AMP_HEART_BEAT+64;function AMPBody_t(){this.eventTypeName="";this.eventType=this.eventClass=-1;this.description=this.sessionID=this.version="";this.code=-1;this.currentTime=this.ampMessage=this.data=""}var eventOnCallRing=0,eventOnAnswerCall=1,eventOnCallEnd=2,eventOnPrompt=3,eventOnReportBtnStatus=4,eventOnInitalSuccess=5,eventOnInitalFailure=6,eventOnEventPrompt=7,eventOnAgentWorkReport=8,eventOnCallDataChanged=9,eventOnBarExit=10,eventOnCallQueueQuery=11,eventOnQueryGroupAgentStatus=12,eventOnSystemMessage=13,eventOnRecvWeiboMsg=14,eventOnIMMessage=15,eventOnRecvWeChatMessage=16,eventOnSendWeChatMsgReport=17,eventOnUploadFileToMMSReport=18,eventOnDownloadFileToMMSReport=19,eventOnWorkStaticInfoReport=20,eventOnAQueryCTIInfoReport=21,eventOnQueueReport=22,eventOnAgentBusyReasonReport=23,eventOnAgentLogUploadReport=24,eventOnAsrEventReport=25,eventOnStopSmSuccess=26,eventOnCallCdrReport=27,eventOnAgentReport=eventOnCallCdrReport+1,eventOnTelReport=eventOnAgentReport+1,eventOnServiceReport=eventOnAgentReport+2,eventOnIvrReport=eventOnAgentReport+3,eventOnTaskReport=eventOnAgentReport+4,eventOnOutboundReport=eventOnAgentReport+5,eventOnCallReportInfo=eventOnAgentReport+6,eventOnQueryMonitorSumReport=eventOnAgentReport+8,eventOnWallServiceReport=eventOnAgentReport+9,eventOnWallQueueReport=eventOnAgentReport+10,eventOnServiceStaticReport=eventOnAgentReport+11,eventOnAgentStaticReport=eventOnAgentReport+13,eventOnTrunkReport=eventOnAgentReport+14,eventOnTrunkSumReport=eventOnAgentReport+15,eventOnAgentMonitorSignOut=eventOnAgentReport+16,eventOnWebsocketSocket=60,VccBar_Log_None=0,VccBar_Log_Error=1,VccBar_Log_Warn=2,VccBar_Log_Debug=4,VccBar_Log_Info=8,VccBar_Log_Protocol=16,MAXCALLNUMLEN=64,gLogType=VccBar_Log_None,lg_zhcn="zh-cn",lg_english="en-us",g_JsVersion="3.0.3",g_DebugFlag=0;function IsOverThisVersion(a){var b=new JVersion(g_JsVersion);a=new JVersion(a);var c=b.IsOverVersion(a);delete b;delete a;return c}function JVersion(a){this.str=a;this.MinVersion=this.MaxVersion2=this.MaxVersion1=this.MaxVersion=0;this._init=function(){var b;try{b=this.str.split(".")}catch(a){}this.MaxVersion=parseInt(b[0]);this.MaxVersion1=parseInt(b[1]);this.MaxVersion2=parseInt(b[2]);this.MinVersion=parseInt(b[3])};this._init();this.IsOverVersion=function(b){return this.MaxVersion>b.MaxVersion||this.MaxVersion==b.MaxVersion&&this.MaxVersion1>b.MaxVersion1||this.MaxVersion==b.MaxVersion&&this.MaxVersion1==b.MaxVersion1&&this.MaxVersion2>b.MaxVersion2||this.MaxVersion==b.MaxVersion&&this.MaxVersion1==b.MaxVersion1&&this.MaxVersion2==b.MaxVersion2&&this.MinVersion>b.MinVersion?!0:!1};return this}function LeafOutMuchMessage(a,b){return 0<=b.indexOf("OnStaticInfoReport")||0<=b.indexOf("OnQueueReport")||0<=b.indexOf("heartBeat")||0<=b.indexOf("alivecheck")?!1:!0}function DisplayLog(a,b){if(LeafOutMuchMessage(a,b)&&("function"===typeof OnSimulatorProtocol&&a==VccBar_Log_Protocol&&OnSimulatorProtocol(b),a&gLogType)){var c="";a==VccBar_Log_Error&&(c="\u3010\u9519\u8bef\u3011\u3010"+getTimeString()+"\u3011");a==VccBar_Log_Warn&&(c="\u3010\u8b66\u544a\u3011\u3010"+getTimeString()+"\u3011");a==VccBar_Log_Debug&&(c="\u3010\u8c03\u8bd5\u3011\u3010"+getTimeString()+"\u3011");a==VccBar_Log_Info&&(c="\u3010\u4fe1\u606f\u3011\u3010"+getTimeString()+"\u3011");a==VccBar_Log_Protocol&&(c="\u3010\u534f\u8bae\u3011\u3010"+getTimeString()+"\u3011");b=c+b;a==VccBar_Log_Protocol&&(b+="\r\n");null!=application&&application.Log(b)}}function stringToInt(a,b){return""==a||null==a||"undefined"==typeof a?b:parseInt(a)}function stringCopy(a,b){return""==a||null==a||"undefined"==typeof a?b:a}function getSubString(a,b,c){if(""==b&&""==c)return a;var d="";if(""==b)d=a;else{d=a.indexOf(b);if(0>d)return"";d+=b.length;d=a.substr(d,a.length)}a=d;if(""==c)d=a;else{b=a.indexOf(c);if(0>b)return"";d=a.substr(0,b)}return d}function trimStr(a){return a.replace(/(^\s*)|(\s*$)/g,"")}function trimLeftStr(a){return a.replace(/(^\s*)/g,"")}function trimRightStr(a){return a.replace(/(\s*$)/g,"")}function getDefaultParam(a){return"undefined"==typeof a?"":a}function getDefaultParamValue(a,b){return"undefined"==typeof a?getDefaultParam(b):a}function getAcpTimeString(a){var b=new Date,c=b.getFullYear(),d=b.getMonth()+1,d=10>d?"0"+d:d,e=b.getDate(),e=10>e?"0"+e:e,f=b.getHours(),f=10>f?"0"+f:f,g=b.getMinutes(),g=10>g?"0"+g:g,h=b.getSeconds(),h=10>h?"0"+h:h,b=b.getMilliseconds();return(a=getDefaultParamValue(a,!0))?stringFormat("{0}:{1}:{2} {3}:{4}:{5} {6}",c.toString(),d.toString(),e.toString(),f.toString(),g.toString(),h.toString(),b.toString()):stringFormat("{0}{1}{2}{3}{4}{5}",c.toString(),d.toString(),e.toString(),f.toString(),g.toString(),h.toString())}function StringToDate(a){if(""==a||"undefined"==typeof a||14!=a.length)return 0;var b=new Date;b.setYear(parseInt(a.substr(0,4)));b.setMonth(parseInt(a.substr(4,2)));b.setDate(parseInt(a.substr(6,2)));b.setHours(parseInt(a.substr(8,2)));b.setMinutes(parseInt(a.substr(10,2)));b.setSeconds(parseInt(a.substr(12,2)));return b}function getStringTimerInterval(a,b){var c=StringToDate(a),d=StringToDate(b);if(0==c||0==d)return 0;c=d.getTime()-c.getTime();return Math.round(c/1E3)}function getTimeString(){var a=new Date,b=a.getFullYear(),c=a.getMonth()+1,c=10>c?"0"+c:c,d=a.getDate(),d=10>d?"0"+d:d,e=a.getHours(),e=10>e?"0"+e:e,f=a.getMinutes(),f=10>f?"0"+f:f,g=a.getSeconds(),g=10>g?"0"+g:g,a=a.getMilliseconds();return b.toString()+c.toString()+d.toString()+" "+e.toString()+f.toString()+g.toString()+"  "+a.toString()}function stringFormat(){if(0==arguments.length)return"";for(var a=arguments[0],b=1;b<arguments.length;b++)a=a.replace(new RegExp("\\{"+(b-1)+"\\}","gm"),arguments[b]);return a}function formatCallNum(a){for(var b="",c=0,d=0;d<a.length;d++)" "!=a[d]&&"-"!=a[d]&&(b+=a[d],c++);return b}function isPhoneNum(a,b){"undefined"==typeof b&&(b=!1);for(var c=0;c<a.length;c++){var d=a[c];if((!b||","!=d&&"*"!=d&&"#"!=d)&&isNaN(d))return!1}return!0}function getArrayIndex(a,b){if(0>=a.length)return-1;for(var c=0;c<a.length;c++)if(a[c]==b)return c;return-1}function getArrayFromJsonItem(a,b){for(var c=[],d=0;d<a.length;d++)c.push(a[d][b]);return c}function $$(a){return window.document.getElementById(a)}function arrayEmpty(a){a.splice(0,a.length)}function arrayRemoveItem(a,b){for(var c=0;c<a;c++)if(a[c]==b)return c;-1!=c&&a.splice(index,1)}function saveFileAs(a,b){var c=a.type;c&&"application/octet-stream"!=c&&(a=(a.slice||a.webkitSlice||a.mozSlice).call(a,0,a.size,"application/octet-stream"));var c=URL.createObjectURL(a),d=document.createElementNS("http://www.w3.org/1999/xhtml","a");d.href=c;d.download=b;var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null);d.dispatchEvent(e);URL.revokeObjectURL(c)}function getInnerText(a){var b=a.replace(/\ +/g,"");a.replace(/[ ]/g,"");return b=a.replace(/[\r\n]/g,"")}function SendLogFileTo(a,b,c,d){var e=stringFormat("cinvccbar_{0}_{1}.txt",c,getAcpTimeString(!1));a+=e;c=stringFormat('--{0}{1}Content-Disposition: form-data; name\x3d"MAX_FILE_SIZE"{2}{3}{4}{5}',"---14097859520810---","\r\n","\r\n","\r\n",5E6,"\r\n");stringFormat('--{0}{1}Content-Disposition: form-data; name\x3d"mediafile"; filename\x3d"{2}"{3}Content-Type: audio/x-wav{4}{5}',"---14097859520810---","\r\n",e,"\r\n","\r\n","\r\n");var f=stringFormat("{0}--{1}--{2}","\r\n","---14097859520810---","\r\n");b=c+b+f;var g=0,h=stringFormat("Content-Type: multipart/form-data; boundary\x3d{0}{1}","---14097859520810---","\r\n");$.ajax({url:a,data:b,type:"POST",dataType:"text",cache:!1,beforeSend:function(b){b.setRequestHeader("Content-type",h)},success:function(b,a,c){b=getInnerText(b);g=b.length;d(e,g,b)},error:function(b,a){d(e,-4,a)},complete:function(b,a){}})}var base64EncodeChars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",base64DecodeChars=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];function base64encode(a){var b,c,d,e,f,g;d=a.length;c=0;for(b="";c<d;){e=a.charCodeAt(c++)&255;if(c==d){b+=base64EncodeChars.charAt(e>>2);b+=base64EncodeChars.charAt((e&3)<<4);b+="\x3d\x3d";break}f=a.charCodeAt(c++);if(c==d){b+=base64EncodeChars.charAt(e>>2);b+=base64EncodeChars.charAt((e&3)<<4|(f&240)>>4);b+=base64EncodeChars.charAt((f&15)<<2);b+="\x3d";break}g=a.charCodeAt(c++);b+=base64EncodeChars.charAt(e>>2);b+=base64EncodeChars.charAt((e&3)<<4|(f&240)>>4);b+=base64EncodeChars.charAt((f&15)<<2|(g&192)>>6);b+=base64EncodeChars.charAt(g&63)}return b}function base64decode(a){var b,c,d,e,f;e=a.length;d=0;for(f="";d<e;){do b=base64DecodeChars[a.charCodeAt(d++)&255];while(d<e&&-1==b);if(-1==b)break;do c=base64DecodeChars[a.charCodeAt(d++)&255];while(d<e&&-1==c);if(-1==c)break;f+=String.fromCharCode(b<<2|(c&48)>>4);do{b=a.charCodeAt(d++)&255;if(61==b)return f;b=base64DecodeChars[b]}while(d<e&&-1==b);if(-1==b)break;f+=String.fromCharCode((c&15)<<4|(b&60)>>2);do{c=a.charCodeAt(d++)&255;if(61==c)return f;c=base64DecodeChars[c]}while(d<e&&-1==c);if(-1==c)break;f+=String.fromCharCode((b&3)<<6|c)}return f}function utf16to8(a){var b,c,d,e;b="";d=a.length;for(c=0;c<d;c++)e=a.charCodeAt(c),1<=e&&127>=e?b+=a.charAt(c):(2047<e?(b+=String.fromCharCode(224|e>>12&15),b+=String.fromCharCode(128|e>>6&63)):b+=String.fromCharCode(192|e>>6&31),b+=String.fromCharCode(128|e>>0&63));return b}function utf8to16(a){var b,c,d,e,f,g;b="";d=a.length;for(c=0;c<d;)switch(e=a.charCodeAt(c++),e>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:b+=a.charAt(c-1);break;case 12:case 13:f=a.charCodeAt(c++);b+=String.fromCharCode((e&31)<<6|f&63);break;case 14:f=a.charCodeAt(c++),g=a.charCodeAt(c++),b+=String.fromCharCode((e&15)<<12|(f&63)<<6|(g&63)<<0)}return b}function GetBase64FromGBK(a){return"undefined"==typeof a?"":base64encode(utf16to8(a))}function GetGBKFromBase64(a){return"undefined"==typeof a?"":utf8to16(base64decode(a))}function Utf8ToUnicode(a){for(var b="",c=a.length,d=0,e=c,f,g,h;d<c;)if(f=a.charCodeAt(d),0==(f&128)){if(1>e)break;b+=String.fromCharCode(f&127);d++;--e}else if(192==(f&224)){g=a.charCodeAt(d+1);if(2>e||128!=(g&192))break;b+=String.fromCharCode((f&63)<<6|g&63);d+=2;e-=2}else if(224==(f&240)){g=a.charCodeAt(d+1);h=a.charCodeAt(d+2);if(3>e||128!=(g&192)||128!=(h&192))break;b+=String.fromCharCode((f&15)<<12|(g&63)<<6|h&63);d+=3;e-=3}else break;return 0!=e?"":b}function CharToHex(a){var b,c,d,e;b="";d=a.length;for(c=0;c<d;)e=a.charCodeAt(c++),e=e.toString(16),2>e.length&&(e="0"+e),b+="\\x"+e+" ",0<c&&0==c%8&&(b+="\r\n");return b}function getCookie(a){return 0<document.cookie.length&&(c_start=document.cookie.indexOf(a+"\x3d"),-1!=c_start)?(c_start=c_start+a.length+1,c_end=document.cookie.indexOf(";",c_start),-1==c_end&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))):""}function setCookie(a,b,c){var d=new Date;d.setDate(d.getDate()+c);a=a+"\x3d"+escape(b)+(null==c?"":";expires\x3d"+d.toGMTString());document.cookie=a}function getCookieIntValue(a,b){var c=getCookie(a);return""==c?b:parseInt(c)}function getCookieStrValue(a,b){var c=getCookie(a);return""==c?b:c}function IsCookiesUsed(){return 0<document.cookie.length}var xmlForNONE=-1,xmlForNotIE=0,xmlForIE=1;function CXmlParse(){this.oXmlDoc=null;this.nType=xmlForNONE;this.loadXMLFile=function(a){try{this.oXmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.nType=xmlForIE}catch(b){try{this.oXmlDoc=document.implementation.createDocument("","",null),this.nType=xmlForNotIE}catch(c){return alert(c.message),this.nType=xmlForNONE,!1}}try{this.oXmlDoc.async=!1,this.oXmlDoc.load(a),alert(a)}catch(b){return alert(b.message),this.nType=xmlForNONE,!1}return!0};this.loadXml=function(a){try{this.oXmlDoc=(new DOMParser).parseFromString(a,"text/xml"),this.nType=xmlForNotIE}catch(b){try{this.oXmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.nType=xmlForIE,this.oXmlDoc.async=!1,this.oXmlDoc.loadXML(a)}catch(c){return this.nType=xmlForNONE,!1}}return!0};this.queryNodes=function(a){return this.nType==xmlForNONE?null:this.nType==xmlForNotIE?this.oXmlDoc.getElementsByTagName(a):this.oXmlDoc.selectNodes(a)};this.queryNode=function(a){return this.nType==xmlForNONE?null:this.nType==xmlForNotIE?(a=this.oXmlDoc.getElementsByTagName(a),0<a.length?a[0]:null):this.oXmlDoc.selectSingleNode(a)};this.queryNodeValue=function(a){return this.nType==xmlForNONE?"":this.nType==xmlForNotIE?null==a?"":a.textContent:null!=a?a.text:""};this.queryNodeValueByPath=function(a){return this.nType==xmlForNONE?"":this.queryNodeValue(this.queryNode(a))};this.queryNodeAttribute=function(a,b){return this.nType==xmlForNONE?"":this.nType==xmlForNotIE?null==a?"":a.getAttribute(b):a&&a.attributes?null!=a.attributes[b]?a.attributes[b].value:null!=a.attributes.getNamedItem(b)?a.attributes.getNamedItem(b).value:"":""};this.queryNodeAttributeByPath=function(a,b){return this.nType==xmlForNONE?"":this.queryNodeAttribute(this.queryNode(a),b)};this.close=function(){this.nType=this.oXmlDoc=null};return this}function CHtmlBarControl(a){function b(){this.code=0;this.description="";this.level=0;this.engshDes="";return this}this._language=a;this._arrErrorInfo=[];this._loadErrorInfo=function(){this._addItem(IE_InitSIPError,0,"sip\u7535\u8bdd\u6ce8\u518c\u5931\u8d25","Sipphone register failure!");this._addItem(IE_InitCTIError,0,"CTI\u670d\u52a1\u5668\u7b7e\u5165\u5931\u8d25","signin to CTI sevrer failure");this._addItem(IE_InitMonitorError,0,"Monitor\u670d\u52a1\u5668\u7b7e\u5165\u5931\u8d25","signin to Monitor sevrer failure");this._addItem(2100,0,"\u6d88\u606f\u672a\u5b9a\u4e49","message not defined");this._addItem(2101,2,"\u6d88\u606f\u53c2\u6570\u5f02\u5e38","parameter error");this._addItem(2102,2,"\u6d88\u606f\u53d1\u9001\u5931\u8d25","send message failure");this._addItem(2110,2,"\u5ea7\u5e2d\u4e0d\u5b58\u5728","agent not exist");this._addItem(2111,2,"\u5ea7\u5e2d\u6682\u505c\u4f7f\u7528","agent unusefull temporary");this._addItem(2112,2,"\u5ea7\u5e2d\u5bc6\u7801\u9a8c\u8bc1\u9519\u8bef","wrong agent password");this._addItem(2113,2,"\u5ea7\u5e2d\u5bc6\u7801\u672a\u751f\u6548","agent password uneffective");this._addItem(2114,2,"\u5ea7\u5e2d\u5bc6\u7801\u5df2\u8fc7\u671f","agent password overdue");this._addItem(2115,2,"\u5ea7\u5e2d\u5df2\u9501\u5b9a","agent locked");this._addItem(2116,2,"\u5ea7\u5e2d\u65f6\u95f4\u6233\u4e0d\u5339\u914d","agent timestamp mismatching");this._addItem(2117,2,"\u5ea7\u5e2d\u767b\u5f55\u5206\u673a\u548c\u7ed1\u5b9a\u5206\u673a\u4e0d\u5339\u914d","agent'd device is mismatching with binded device");this._addItem(2118,2,"\u5ea7\u5e2d\u6240\u7528\u5206\u673a\u5df2\u88ab\u5176\u4ed6\u5ea7\u5e2d\u767b\u5f55","agent'd device is used by other");this._addItem(2119,1,"\u5ea7\u5e2d\u5df2\u767b\u5f55","agent signined");this._addItem(2120,2,"\u5ea7\u5e2d\u4e0d\u5141\u8bb8\u88ab\u66ff\u4ee3","agent can't be replaced");this._addItem(2121,1,"\u5ea7\u5e2d\u672a\u767b\u5f55","agent have not been signined");this._addItem(2122,1,"\u5ea7\u5e2d\u5fd9","agent busy");this._addItem(2123,2,"\u767b\u5f55\u5931\u8d25\uff1a\u6b64\u5ea7\u5e2d\u5df2\u5728\u5176\u4ed6\u5730\u65b9\u767b\u5f55\u4e14\u6b63\u5728\u901a\u8bdd\u4e2d","signing failuer:this agent is called by other");this._addItem(2124,2,"\u767b\u5f55\u5931\u8d25\uff1a\u6b64\u5ea7\u5e2d\u5df2\u5728\u5176\u4ed6\u5730\u65b9\u767b\u5f55\u4e14\u540e\u5904\u7406\u4e2d","signing failuer:this agent is wrapup by other");this._addItem(2125,1,"\u5ea7\u5e2d\u672a\u7a7a\u95f2","agent not idle");this._addItem(2126,1,"\u5ea7\u5e2d\u672a\u63a5\u901a","agent not connected");this._addItem(2130,2,"\u5bf9\u65b9\u5ea7\u5e2d\u4e0d\u5b58\u5728","opponent agent not exist");this._addItem(2131,2,"\u5bf9\u65b9\u5ea7\u5e2d\u6682\u505c\u4f7f\u7528","opponent agent unusefull temporary");this._addItem(2132,2,"\u5bf9\u65b9\u5ea7\u5e2d\u5df2\u9501\u5b9a","opponent agent locked");this._addItem(2133,2,"\u5bf9\u65b9\u5ea7\u5e2d\u5206\u673a\u672a\u8bbe\u7f6e","opponent agent's device not set");this._addItem(2134,1,"\u5bf9\u65b9\u5ea7\u5e2d\u672a\u767b\u5f55","opponent agent not signin");this._addItem(2135,1,"\u5bf9\u65b9\u5ea7\u5e2d\u5fd9","opponent agent busy");this._addItem(2136,1,"\u5bf9\u65b9\u5ea7\u5e2d\u901a\u8bdd\u4e2d","opponent agent calling");this._addItem(2137,1,"\u5bf9\u65b9\u5ea7\u5e2d\u540e\u5904\u7406\u4e2d","opponent agent wrapup");this._addItem(2138,1,"\u5bf9\u65b9\u5ea7\u5e2d\u7a7a\u95f2","opponent agent idle");this._addItem(2140,1,"\u5206\u673a\u901a\u8bdd\u4e2d","agent'device calling");this._addItem(2141,2,"\u5206\u673a\u672a\u8bbe\u7f6eIVR\u670d\u52a1","device not set IVR service");this._addItem(2142,2,"\u4f01\u4e1a\u5df2\u6682\u505c\u6216\u65e0\u6b64\u4f01\u4e1a","department invalid");this._addItem(2143,2,"\u5750\u5e2d\u767b\u5f55\u8fbe\u5230\u6700\u5927\u9650\u5236","signined agent count over limit");this._addItem(2144,2,"\u5750\u5e2d\u5206\u673a\u4e0d\u662fcti\u53d7\u63a7","signined agent count over limit");this._addItem(2150,2,"\u5750\u5e2d\u5df2\u88ab\u9009\u4e2d","agent already selected");this._addItem(2151,2,"\u5ea7\u5e2d\u88ab\u8d28\u68c0\u5458\u5f3a\u5236\u7b7e\u51fa","agent forceouted by monitor agent");this._addItem(2152,2,"\u5ea7\u5e2d\u56e0\u632f\u94c3\u8d85\u65f6\u88ab\u5f3a\u5236\u7b7e\u51fa","agent forceouted for alerting out of time");this._addItem(2153,2,"\u5ea7\u5e2d\u88ab\u8bdd\u673a\u547d\u4ee4\u5f3a\u5236\u7b7e\u51fa","agent forceouted by phone command");this._addItem(2160,2,"\u5ea7\u5e2d\u5fc3\u8df3\u8d85\u65f6cti\u53d1\u9001OnSignOuted\u4e8b\u4ef6","cti send OnSignOuted to agent for heartbeat overtime");this._addItem(2161,2,"\u5ea7\u5e2d\u6536\u5230AgentReport\u53d1\u73b0\u5750\u5e2d\u7b7e\u51facti\u53d1\u9001OnSignOuted\u4e8b\u4ef6","cti send OnSignOuted to agent for AgentReport message");this._addItem(2162,2,"\u5ea7\u5e2d\u4e0d\u5728\u5916\u547c\u4efb\u52a1\u4e2d\u9884\u8bbe\u5ea7\u5e2d\u5217\u8868\u4e2d","This agent is not in outtask's pre-setting agent list!");this._addItem(2300,2,"\u5ea7\u5e2d\u767b\u5f55\u8d28\u68c0\u670d\u52a1\u9a8c\u8bc1\u9519\u8bef","monitor login failure for wrong password");this._addItem(3001,2,"\u8fde\u63a5\u7535\u8bdd\u6761\u536b\u58eb\u6210\u529f","connect CINGurad success");this._addItem(3003,2,"\u7535\u8bdd\u6761\u536b\u58eb\u8fde\u63a5\u5931\u8d25,\u8bf7\u786e\u8ba4\u662f\u5426\u542f\u52a8!","connect CINGurad failure,be sure CINGuard startup");this._addItem(4E3,2,"\u521b\u5efaA\u670d\u52a1\u7c7b\u5931\u8d25","create AClass failuer");this._addItem(4001,2,"CTI Interface\u670d\u52a1\u5668\u5730\u5740\u9519\u8bef\u6216\u8005\u6ca1\u6709\u542f\u52a8!","CTI Interface address wrong or CTI Interface server not startup");this._addItem(4002,2,"\u65e0\u6cd5\u8fde\u63a5CTI\u670d\u52a1\u5668!","CTI server address wrong or CTI server server not startup");this._addItem(4003,2,"CTI Interface\u7684Initail\u65b9\u6cd5\u8c03\u7528\u5931\u8d25!","invoke Initial failure in CTI Interface");this._addItem(4004,2,"\u767b\u5f55CTI\u670d\u52a1\u5668\u5931\u8d25,\u786e\u8ba4CTI\u53ef\u7528\u6216\u8005\u914d\u7f6e\u4fe1\u606f\u662f\u5426\u6210\u529f!","login cti failure,be sure cti server is ok and congfiguration is right");this._addItem(4005,2,"\u7531\u4e8e\u7f51\u7edc\u539f\u56e0\u5ea7\u5e2d\u548cCTI\u65ad\u5f00\uff0c\u8bf7\u4e0d\u8981\u6302\u673a\uff0c10S\u540e\u91cd\u65b0\u8fde\u63a5!","agent disconnect temporary cause by network,it will be reconnect after ten seconds");this._addItem(4006,2,"\u5ea7\u5e2d\u6b63\u5728\u91cd\u8fde...","agent reconnecting ...");this._addItem(4007,0,"\u91cd\u8fde\u6210\u529f,\u5ea7\u5e2d\u5c31\u7eea\u53ef\u4ee5\u91cd\u65b0\u4f7f\u7528!","reconnected success! the agent is already ok");this._addItem(4008,2,"\u7531\u4e8e\u67d0\u4e9b\u539f\u56e0\u7f51\u7edc\u4e2d\u65ad,\u5bfc\u81f4\u5ea7\u5e2d\u548cCTI\u670d\u52a1\u5668\u65ad\u5f00,\u8bf7\u548c\u7ba1\u7406\u5458\u8054\u7cfb!","agent is signout from cti cause of network,please get help for administrator");this._addItem(4009,2,"\u5fc3\u8df3\u68c0\u6d4b\u5230CTI\u4e2d\u5ea7\u5e2d\u5df2\u7ecf\u9000\u51fa!","agent is signout by heartbeat checking");this._addItem(4010,1,"\u5ea7\u5e2d\u8bbe\u7f6e\u7684phoneType\u7c7b\u578b\u548c\u670d\u52a1\u5668\u7aef\u8bbe\u7f6e\u4e0d\u4e00\u6837\uff0c\u4f7f\u7528\u670d\u52a1\u5668\u7aef\u8bbe\u7f6e\u7684\u7535\u8bdd\u7c7b\u578b","phoneType mismatch with server's,using server's setting");this._addItem(4300,2,"A\u63a5\u53e3\u63a7\u4ef6\u6ca1\u6709\u6ce8\u518c\u6216\u8005\u8def\u5f84\u4e0d\u5bf9!","CINNGCCA not register");this._addItem(4301,2,"PA\u63a7\u4ef6\u6ca1\u6709\u6ce8\u518c\u6216\u8005\u8def\u5f84\u4e0d\u5bf9!","PA not register");this._addItem(4302,2,"M\u63a7\u4ef6\u6ca1\u6709\u6ce8\u518c\u6216\u8005\u8def\u5f84\u4e0d\u5bf9!","CINMonitor not register");this._addItem(4303,2,"CTI\u670d\u52a1\u5668\u65ad\u5f00,\u8bf7\u4e0e\u7ba1\u7406\u5458\u8054\u7cfb!","disconnect from cti,please get help for administrator");this._addItem(4305,2,"\u672c\u5ea7\u5e2d\u88ab\u5176\u4ed6\u7ec8\u7aef\u6240\u66ff\u4ee3!","agent replaced by other");this._addItem(4309,2,"\u7535\u8bdd\u6ce8\u518c\u5931\u8d25!","sipphone register failure");this._addItem(4310,2,"\u8bf7\u521d\u59cb\u5316\u63a7\u4ef6!","please initial the ocx");this._addItem(4311,2,"\u547d\u4ee4\u4e0d\u53ef\u7528,\u65e0\u6cd5\u6267\u884c!","method disanble,can't execute");this._addItem(4312,2,"\u76ee\u6807\u53f7\u7801\u4e0d\u80fd\u4e3a\u7a7a!","target number can't be empty");this._addItem(4313,2,"\u76ee\u6807\u53f7\u7801\u4e0d\u5408\u6cd5!","target number unvalidated ");this._addItem(4314,2,"\u76ee\u6807\u53f7\u7801\u4e0d\u80fd\u8d85\u8fc764\u4f4d","target number can't be more then 64 character");this._addItem(4360,0,"\u6b63\u5728\u6ce8\u518cSip\u7535\u8bdd...","sipphone regsitering...");this._addItem(4361,0,"\u7535\u8bdd\u6ce8\u518c\u6210\u529f!","sipphone regsitered success");this._addItem(4362,0,"\u6b63\u5728\u68c0\u6d4b\u5230\u5ea7\u5e2d\u5361...","checking agent card...");this._addItem(4363,2,"\u6ca1\u6709\u68c0\u6d4b\u5230\u5ea7\u5e2d\u5361!","ageng card not checked");this._addItem(4364,1,"\u8bbe\u7f6eftp\u670d\u52a1\u5668\u4fe1\u606f\u5931\u8d25!","ftp config wrong");this._addItem(4400,0,"\u7b7e\u5165CTI\u670d\u52a1\u5668\u6210\u529f!","agent signin success");this._addItem(4401,2,"\u7b7e\u5165CTI\u670d\u52a1\u5668\u5931\u8d25!","agent signin failure");this._addItem(4402,0,"\u7b7e\u51faCTI\u670d\u52a1\u5668\u6210\u529f!","agent signout success");this._addItem(4403,0,"\u7b7e\u51faCTI\u670d\u52a1\u5668\u5931\u8d25!","agent signout failure");this._addItem(4404,2,"\u5ea7\u5e2d\u88ab\u5f3a\u5236\u8fc1\u51fa!","agent force signout");this._addItem(4405,2,"\u5ea7\u5e2d\u5df2\u7ecf\u88ab\u9501\u5b9a,\u8bf7\u8054\u7cfb\u8d28\u68c0\u5e2d\u89e3\u9501!","agent locked,please contact with monitor agent");this._addItem(4407,1,"\u6b63\u5728\u5411CTI\u670d\u52a1\u5668\u6ce8\u518c...","sigining to cti server...");this._addItem(4408,0,"\u6b63\u5728\u5411Monitor\u670d\u52a1\u5668\u6ce8\u518c...","logining to monitor server...");this._addItem(4409,0,"\u6ce8\u518cMonitor\u6210\u529f!","login monitor server success");this._addItem(4410,0,"\u7535\u8bdd\u6761\u521d\u59cb\u5316\u6210\u529f!","cinvccbar initial success");this._addItem(4411,2,"\u7535\u8bdd\u6761\u521d\u59cb\u5316\u5931\u8d25!","cinvccbar initial failure");this._addItem(4412,0,"\u6b63\u5728\u5411\u5907\u7528CTI\u670d\u52a1\u5668\u6ce8\u518c...","sigining to backup cti server...");this._addItem(4413,0,"\u6b63\u5728\u5411\u5907\u7528Monitor\u670d\u52a1\u5668\u6ce8\u518c...","logining to backup monitor server...");this._addItem(4414,2,"\u5ea7\u5e2d\u5b50\u72b6\u6001\u62a5\u544a","agent substatus report");this._addItem(4450,0,"\u5ea7\u5e2d\u5df2\u7ecf\u88ab\u62e6\u622a!","agent intercepted");this._addItem(4451,1,"\u6ca1\u6709\u8981\u88ab\u63a5\u56de\u7684\u5bf9\u8c61!","have no retrieved line");this._addItem(4452,1,"\u5916\u547c\u5fc5\u987b\u5fd9\u788c\u4e0b\u624d\u80fd\u8fdb\u884c!","makeout must be use in busy");this._addItem(4453,1,"\u6ca1\u6709\u901a\u8bdd,\u4e0d\u80fd\u8f6c\u79fb...","can't transfer out of call");this._addItem(4454,1,"\u53ea\u6709\u4e24\u4e2a\u4eba\u901a\u8bdd\u7684\u65f6\u5019\u624d\u80fd\u6267\u884c\u6b64\u547d\u4ee4...","can only be executed in tow line");this._addItem(4455,1,"\u666e\u901a\u72b6\u6001\u4e0b,\u4e8c\u6b21\u62e8\u53f7\u7801\u5fc5\u987b\u57280-15\u4e4b\u95f4!","the code must be from 0 to 15 in senddtmf");this._addItem(4456,1,"\u7528\u6237\u5df2\u6302\u673a","user have been out of call");this._addItem(4457,1,"\u8bf7\u5feb\u70b9\u670d\u52a1,\u6240\u6709\u5750\u5e2d\u90fd\u5fd9\u788c!","hurry! all agents are busy");this._addItem(4458,1,"Mute\u5fc5\u987b\u901a\u8bdd\u4e0b\u624d\u80fd\u8fdb\u884c!","mute can only be execute in call");this._addItem(4459,2,"\u5ba2\u6237\u7aef\u63a5\u901ayealink\u8bdd\u673a\u7684\u5931\u8d25!","yealink phone pickup failure in client type");this._addItem(4460,1,"\u4f1a\u8bae\u6216\u8005\u54a8\u8be2\u65f6\u4e0d\u80fd\u6302\u65ad\u4e3b\u63a7\u5ea7\u5e2d!","the master agent can't be disconnect in conferece or consult scene");this._addItem(4600,2,"\u521b\u5efaM\u670d\u52a1\u7c7b\u5931\u8d25!","create M class failure");this._addItem(4601,2,"Monitor Interface\u7684Initail\u65b9\u6cd5\u8c03\u7528\u5931\u8d25!","Initail to Monitor Interface failure");this._addItem(4602,2,"Monitor\u670d\u52a1\u5668\u5730\u5740\u9519\u8bef\u6216\u8005\u6ca1\u6709\u542f\u52a8!","Monitor server  can't be use");this._addItem(4603,2,"Monitor Interface\u670d\u52a1\u5668\u5730\u5740\u9519\u8bef\u6216\u8005\u6ca1\u6709\u542f\u52a8!","Monitor Interface  can't be use");this._addItem(4604,2,"\u767b\u5f55(Login)Monitor\u670d\u52a1\u5668\u5931\u8d25!","login in Monitor server failure");this._addItem(4605,2,"\u7531\u4e8e\u67d0\u4e9b\u539f\u56e0\u7f51\u7edc\u4e2d\u65ad,\u5bfc\u81f4Monitor\u548c\u670d\u52a1\u5668\u65ad\u5f00,5\u540e\u91cd\u65b0\u8fde\u63a5....","agent disconnect from monitor server by network,will reconnect in 5 minutes");this._addItem(4606,2,"Monitor\u6b63\u5728\u548c\u670d\u52a1\u5668\u91cd\u65b0\u8fde\u63a5....","monitor is reconnecting...");this._addItem(4607,2,"\u7531\u4e8e\u67d0\u4e9b\u539f\u56e0\u7f51\u7edc\u4e2d\u65ad,\u5bfc\u81f4Monitor\u548c\u670d\u52a1\u5668\u65ad\u5f00,\u8bf7\u548c\u7ba1\u7406\u5458\u8054\u7cfb!","monitor can't be connected with server by network,please contact to admin");this._addItem(4608,2,"Monitor\u91cd\u8fde\u6210\u529f,\u76d1\u63a7\u5ea7\u5e2d\u5c31\u7eea\u53ef\u4ee5\u91cd\u65b0\u4f7f\u7528!","monitor reconnect success,it works")};this._addItem=function(a,d,e,f){var g=new b;g.code=a;g.level=d;g.description=e;g.engshDes=f;this._arrErrorInfo.push(g)};this.GetErrorItemDes=function(b){for(var a=0;a<this._arrErrorInfo.length;a++)if(this._arrErrorInfo[a].code==b)return this._language==lg_zhcn?this._arrErrorInfo[a].description:this._arrErrorInfo[a].engshDes;return""};this._loadErrorInfo();return this}var TIMER_AUTO=0,TIMER_HANDLE=1,Timer_Debug=0;function JTime(){this.id=-1;this.interval=0;this.intervalCount=this.intervalMax=-1;return this}function JBeginTimer(a){null!=a&&(a._timerID=setInterval(function(){JOnTimer(a)},a._cellInterVal))}function JOnTimer(a){null!=a&&a.OnTimer()}function JTimerEx(a){"undefined"==typeof a&&(a=1E3);this._cellInterVal=a;this._bStart=!1;this._onTimerCallBackEvent=null;this._timers=[];this._timerType=TIMER_AUTO;this._timerID=null;this._tag="TIME_"+getCurrentTimeString();this.SetTimerCallBack=function(b){this._onTimerCallBackEvent=b};this.IsProcess=function(){return this._bStart};this.OnTimer=function(){if(null!=this._onTimerCallBackEvent)for(var b=0;b<this._timers.length;b++)0>=this._timers[b].intervalMax||(this._timers[b].intervalCount++,this._timers[b].intervalCount>=this._timers[b].intervalMax&&(this._timers[b].intervalCount=0,this._onTimerCallBackEvent(this._timers[b].id)))};this.Start=function(){this._bStart||(this._timerType==TIMER_AUTO&&JBeginTimer(this),this._bStart=!0)};this.Stop=function(){this._bStart&&(null!=this._timerID&&(clearInterval(this._timerID),this._timerID=null),this._bStart=!1)};this.SetTimer=function(b,a){if(0>b||0>=a)return-1;Timer_Debug&&DisplayLog(VccBar_Log_Info,stringFormat("JTimerEx:SetTimer(id\x3d{0} interval\x3d{1})",b,a));if(-1!=this._getTimerIndex(b))return this.Reset(b),-3;var d=new JTime;d.id=b;d.interval=a;d.intervalMax=a/this._cellInterVal;this._timers.push(d);Timer_Debug&&DisplayLog(VccBar_Log_Info,stringFormat("JTimerEx:SetTimered(id\x3d{0} interval\x3d{1} interMax\x3d{2})",d.id,d.interval,d.intervalMax));this._display();return this._timers.length-1};this.KillTimer=function(b){var a=this._getTimerIndex(b);Timer_Debug&&DisplayLog(VccBar_Log_Info,stringFormat("JTimerEx:KillTimer(id\x3d{0} )",b));-1!=a&&(b=this._timers[a],Timer_Debug&&DisplayLog(VccBar_Log_Info,stringFormat("JTimerEx:KillTimered(id\x3d{0} interval\x3d{1} interMax\x3d{2})",b.id,b.interval,b.intervalMax)),this._timers.splice(a,1));this._display()};this.Reset=function(b){b=this._getTimerIndex(b);-1!=b&&(this._timers[b].intervalCount=0)};this._getTimerIndex=function(b){for(var a=0;a<this._timers.length;a++)if(this._timers[a].id==b)return a;return-1};this._display=function(){if(Timer_Debug)for(var b=0;b<this._timers.length;b++){var a=this._timers[b];DisplayLog(VccBar_Log_Info,stringFormat("TimerItem\u3010{0}\u3011:(id\x3d{1} interval\x3d{2} interMax\x3d{3})",b,a.id,a.interval,a.intervalMax))}};return this}function CJVccLog(){this._maxLen=1E5;this._data=[];this._addBrowerInfo=function(){this._data.push(navigator.userAgent.toLowerCase())};this.Insert=function(a){0==this._data.length&&this._addBrowerInfo();this._data.length>=this._maxLen&&this._data.splice(0,1);this._data.push(a)};this.GetLogText=function(a){var b=this._data.join("\n");a&&this._data.splice(0,this._data.length);return b};return this}function JVccBar(a){this.showstyle=this.height=this.width=this.top=this.left=0;this._contentWindow=null==a?window:a;this.id="oBar_"+Math.ceil(100*Math.random());this.name=this.id+"_Ctrl";this.oBarControl=null;this._language=getLocalLanguage();this.workStatus=-1;this.oBarCtrl=null;this.errCode=this.errDescription="";this.oMonitorDataManager=this.oMonitorCtrl=null;this._appType=-1;this._createObject=function(){null==this.oBarControl&&(this.oBarControl=new CHtmlBarControl(getLocalLanguage()));this.oBarCtrl=new JVccBarCtrl;this.SetAttribute("AgentType",0);this.SetAttribute("PassWord","111111");this.SetAttribute("MainPortID",14800);this.SetAttribute("BackPortID",14800);this.SetAttribute("TaskID","0");this.SetAttribute("MonitorPort",4502);this.SetAttribute("AppType",0);this.SetAttribute("SipServerPort",5060);this.SetAttribute("SipPassWord","00000000");this.SetAttribute("SipProtocol","UDP");this.SetAttribute("SipPassWdCryptType",0);this.SetAttribute("SipAuthType",1);this.SetAttribute("PhonType",0);this.SetAttribute("SelfPrompt",0);this.SetAttribute("forceEndProcess",g_DebugFlag);this.SetAttribute("ProtocolType",0);this.SetAttribute("TransportType",0);this.oBarCtrl.oParent=this;this.oBarCtrl.attachEventfun(this._eventFunction);this.oBarCtrl.attachResponsefun(this._responseFunction)};this._responseFunction=function(a,c){DisplayLog(VccBar_Log_Debug,"JVccBar:OnMethodResponseEvent(cmdName:\u3010"+a+"\u3011 param: \u3010"+c+"\u3011)");"GetWeChatParam"==a?null!=application.oWechatManager&&application.oWechatManager.SetUserInfo(c):"Initial"==a&&"-2"==c&&(getLocalLanguage()==lg_zhcn?alert("\u7248\u672c\u4e0d\u5339\u914d\uff0c\u8bf7\u66f4\u65b0\u7248\u672c\u518d\u4f7f\u7528!"):alert("dismatch version\uff0cplease update new version!"));var d=this.oParent;d.OnMethodResponseEvent(a,c);null!=d.oMonitorDataManager&&("InitialState"!=a&&"AgentQuery"!=a&&"TelQuery"!=a&&"IvrQuery"!=a&&"TrunkQuery"!=a&&"ServiceQuery"!=a&&"TaskQuery"!=a&&"CallReportQuery"!=a&&"GetTaskSummary"!=a&&"QueryMonitorSumInfo"!=a&&"StartNotification"!=a&&"EndNotification"!=a||d.oMonitorDataManager.__OnMonitorMethodResponseEvent(a,c))};this._eventFunction=function(a,c){if(null==c||"undefined"==typeof c)c="";var d;try{d=c.split("|")}catch(h){}DisplayLog(VccBar_Log_Debug,"JVccBar:_eventFunction(cmdIndex\x3d"+a+",param\x3d"+c+")");var e=this.oParent;switch(a){case eventOnCallRing:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnCallRing({0},{1},{2},{3},{4},{5},{6},{7},{8},{9},{10},{11},{12},{13},{14},{15},{16},{17})",d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],d[9],d[10],d[11],d[12],d[13],d[14],d[15],d[16],d[17]));e.OnCallRing(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],d[9],d[10],d[11],d[12],d[13],d[14],d[15],d[16],d[17]);break;case eventOnAnswerCall:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnAnswerCall({0},{1},{2},{3},{4},{5},{6})",d[0],d[1],d[2],d[3],d[4],d[5],d[6]));e.AnswerCall(d[0],d[1],d[2],d[3],d[4],d[5],d[6]);break;case eventOnCallEnd:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnCallEnd({0},{1},{2},{3},{4},{5},{6},{7},{8},{9},{10},{11},{12},{13},{14})",d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],d[9],d[10],d[11],d[12],d[13],d[14]));e.OnCallEnd(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],d[9],d[10],d[11],d[12],d[13],d[14]);break;case eventOnPrompt:var f=d[0],g=e.oBarControl.GetErrorItemDes(f);""==g&&(g=d[1]);"4401"==f&&(e.errDescription=d[1]+":"+e.oBarControl.GetErrorItemDes(d[1]),e.errCode=d[1],g=e._language==lg_zhcn?g+" \u539f\u56e0:"+e.errDescription:g+" Cause:"+e.errDescription);"4316"==f&&(e.errDescription=d[1],e.errCode=getSubString(e.errDescription,"",":"),g=e._language==lg_zhcn?"\u539f\u56e0:"+e.errDescription:"Cause:"+e.errDescription);DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnPrompt({0},{1})",d[0],g));e.OnPrompt(d[0],g);4409==d[0]&&null!=e.oMonitorDataManager&&e.oMonitorDataManager.__OnAgentMonitorSignIn();break;case eventOnReportBtnStatus:null!=e.oMonitorDataManager&&e.oMonitorDataManager.__SetReportBtnStatus(c,e.GetAgentStatus());DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnReportBtnStatus({0})",c));e.OnReportBtnStatus(c);DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnAgentStatus({0})",e.GetAgentStatus()));e.OnAgentStatus(e.GetAgentStatus());break;case eventOnInitalSuccess:DisplayLog(VccBar_Log_Info,"JVccBar::OnInitalSuccess({0})");e.OnInitalSuccess();break;case eventOnInitalFailure:g=e.oBarControl.GetErrorItemDes(d[0]);g=e._language==lg_zhcn?g+" \u539f\u56e0:"+e.errDescription:g+" Cause:"+e.errDescription;DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnInitalFailure({0},{1},{2})",d[0],g,e.errCode));e.OnInitalFailure(d[0],g,e.errCode);break;case eventOnEventPrompt:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnEventPrompt({0},{1})",d[0],d[1]));e.OnEventPrompt(d[0],d[1]);break;case eventOnAgentWorkReport:e.workStatus=parseInt(d[0]);null!=e.oMonitorDataManager&&e.oMonitorDataManager.__SetAgentWorkReport(e.GetAttribute("AgentID"),e.GetAgentStatus(),parseInt(d[0]));DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnAgentWorkReport({0},{1})",d[0],d[1]));e.OnAgentWorkReport(d[0],d[1]);break;case eventOnCallDataChanged:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnCallDataChanged({0})",c));e.OnCallDataChanged(c);break;case eventOnBarExit:g=e.oBarControl.GetErrorItemDes(d[0]);""==g&&(g=d[1]);DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnBarExit({0},{1})",d[0],g));e.OnBarExit(d[0],g);null!=e.oMonitorDataManager&&e.oMonitorDataManager.__OnAgentMonitorSignOut("");break;case eventOnCallQueueQuery:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnCallQueueQuery({0})",c));e.OnCallQueueQuery(c);break;case eventOnQueryGroupAgentStatus:f=c.split("@");g="0";1<f.length&&(g=f[1]);DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnQueryGroupAgentStatus({0},{1})",d[0],g));e.OnQueryGroupAgentStatus(f[0],g);break;case eventOnSystemMessage:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnSystemMessage({0},{1})",d[0],d[1]));e.OnSystemMessage(d[0],d[1]);break;case eventOnRecvWeiboMsg:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnRecvWeiboMsg({0})",c));e.OnRecvWeiboMsg(c);break;case eventOnIMMessage:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnIMMessage({0},{1})",d[0],d[1]));e.OnIMMessage(d[0],d[1]);break;case eventOnRecvWeChatMessage:null!=application.oWechatManager&&application.oWechatManager.OnSaveRecvMessageReport(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],d[9],d[10],d[11],d[12],d[13]);e.OnRecvWeChatMessage(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],d[9],d[10],d[11],d[12],d[13]);break;case eventOnSendWeChatMsgReport:null!=application.oWechatManager&&application.oWechatManager.OnSaveSendMessageReport(d[0],d[1],d[2],d[3],d[4],d[5]);e.OnSendWeChatMsgReport(d[0],d[1],d[2],d[3],d[4],d[5]);break;case eventOnUploadFileToMMSReport:null!=application.oWechatManager&&application.oWechatManager.OnInvokeUploadFileToMMSReport(d[0],d[1],d[2]);e.OnUploadFileToMMSReport(d[0],d[1],d[2]);break;case eventOnDownloadFileToMMSReport:null!=application.oWechatManager&&application.oWechatManager.OnInvokeDownFileFromMMSReport(d[0],d[1],d[2],d[3]);e.OnDownloadFileToMMSReport(d[0],d[1],d[2],d[3]);break;case eventOnWorkStaticInfoReport:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnWorkStaticInfoReport({0})",c));e.OnWorkStaticInfoReport(c);break;case eventOnAQueryCTIInfoReport:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnQuerySPGroupList({0},{1})",d[0],getSubString(c,"|","")));e.OnQuerySPGroupList(d[0],getSubString(c,"|",""));break;case eventOnAgentBusyReasonReport:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnAgentBusyReason({0},{1})",d[0],getSubString(c,"|","")));e.OnAgentBusyReason(d[0],getSubString(c,"|",""));break;case eventOnAsrEventReport:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnAsrEventReport({0},{1},{2},{3})",d[0],d[1],d[2],d[3]));e.OnAsrEventReport(d[0],d[1],d[2],d[3]);break;case eventOnStopSmSuccess:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnStopSmSuccess({0})",c));e.OnStopSmSuccess(c);break;case eventOnCallCdrReport:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnCallCdrReport({0},{1},{2},{3},{4},{5},{6},{7},{8},{9},{10},{11},{12},{13},{14},{15})",d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],d[9],d[10],d[11],d[12],d[13],d[14],d[15]));e.OnCallCdrReport(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],d[9],d[10],d[11],d[12],d[13],d[14],d[15]);break;case eventOnQueueReport:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnQueueReport({0})",c));e.OnQueueReport(c);break;case eventOnAgentLogUploadReport:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnAgentLogUpload({0},{1},{2},{3},{4},{5})",d[0],d[1],d[2],d[3],d[4],d[5]));e.OnAgentLogUpload(d[0],parseInt(d[1]),d[2],d[3],d[4],d[5]);break;case eventOnAgentReport:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnAgentReport({0})",c));e.OnAgentReport(c);null!=e.oMonitorDataManager&&e.oMonitorDataManager.__OnAgentReport(c);break;case eventOnTelReport:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnTelReport({0})",c));e.OnTelReport(c);null!=e.oMonitorDataManager&&e.oMonitorDataManager.__OnTelReport(c);break;case eventOnServiceReport:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnServiceReport({0})",c));e.OnServiceReport(c);null!=e.oMonitorDataManager&&e.oMonitorDataManager.__OnServiceReport(c);break;case eventOnIvrReport:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnIvrReport({0})",c));e.OnIvrReport(c);null!=e.oMonitorDataManager&&e.oMonitorDataManager.__OnIvrReport(c);break;case eventOnTrunkReport:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnTrunkReport({0})",c));e.OnTrunkReport(c);null!=e.oMonitorDataManager&&e.oMonitorDataManager.__OnTrunkReport(c);break;case eventOnTrunkSumReport:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnTrunkSumReport({0})",c));e.OnTrunkSumReport(c);null!=e.oMonitorDataManager&&e.oMonitorDataManager.__OnTrunkSumReport(c);break;case eventOnTaskReport:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnTaskReport({0})",c));e.OnTaskReport(c);null!=e.oMonitorDataManager&&e.oMonitorDataManager.__OnTaskReport(c);break;case eventOnOutboundReport:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnOutboundReport({0})",c));e.OnOutboundReport(c);null!=e.oMonitorDataManager&&e.oMonitorDataManager.__OnOutboundReport(c);break;case eventOnCallReportInfo:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnCallReportInfo({0})",c));e.OnCallReportInfo(c);null!=e.oMonitorDataManager&&e.oMonitorDataManager.__OnCallReportInfo(c);break;case eventOnQueryMonitorSumReport:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnQueryMonitorSumReport({0},{1})",d[0],d[1]));e.OnQueryMonitorSumReport(d[0],d[1]);null!=e.oMonitorDataManager&&e.oMonitorDataManager.__OnQueryMonitorSumReport(d[0],d[1]);break;case eventOnWallServiceReport:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnWallServiceReport({0})",c));e.OnWallServiceReport(c);null!=e.oMonitorDataManager&&e.oMonitorDataManager.__OnWallServiceReport(c);break;case eventOnWallQueueReport:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnWallQueueReport({0})",c));e.OnWallQueueReport(c);null!=e.oMonitorDataManager&&e.oMonitorDataManager.__OnWallQueueReport(c);break;case eventOnServiceStaticReport:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnServiceStaticReport({0})",c));e.OnServiceStaticReport(c);null!=e.oMonitorDataManager&&e.oMonitorDataManager.__OnServiceStaticReport(c);break;case eventOnAgentStaticReport:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnAgentStaticReport({0})",c));e.OnAgentStaticReport(c);null!=e.oMonitorDataManager&&e.oMonitorDataManager.__OnAgentStaticReport(c);break;case eventOnAgentMonitorSignOut:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::__OnAgentMonitorSignOut({0})",c));null!=e.oMonitorDataManager&&e.oMonitorDataManager.__OnAgentMonitorSignOut(c);break;case eventOnWebsocketSocket:DisplayLog(VccBar_Log_Info,stringFormat("JVccBar::OnPrompt({0},{1})",d[0],d[1])),e.OnPrompt(d[0],d[1])}};this.SetAttribute=function(a,c){"AppType"==a?this._appType=c:"AutoUpdateURL"==a&&""!=c&&(c="/"==c.charAt(c.length-1)?c+"JVccBar/version/update":c+"/JVccBar/version/update");this.oBarCtrl.SetCtrlAttribute(a,c)};this.GetAttribute=function(a){return this.oBarCtrl.GetCtrlAttribute(a)};this.Initial=function(){return 0==this._appType||1==this._appType||2==this._appType?this.oBarCtrl.Initial():-1};this.SerialBtn=function(a,c){return this.oBarCtrl.SerialBtn(a,c)};this.GetBtnStatus=function(a){return this.oBarCtrl.GetBtnStatus(a)};this.Configurate=function(a){return this.oBarCtrl.Configurate(a)};this.GetConfiguration=function(){return this.oBarCtrl.GetConfiguration()};this.UnInitial=function(a){"undefined"==typeof a&&(a=0);return this.oBarCtrl.UnInitial(a)};this.SetUIStyle=function(a){return this.oBarCtrl.SetUIStyle(a)};this.GetVersion=function(){return g_JsVersion+"("+this.oBarCtrl.GetVersion()+")"};this.SetBusy=function(a){return this.oBarCtrl.SetBusy(a)};this.SetIdle=function(){return this.oBarCtrl.SetIdle()};this.SetWrapUp=function(){return this.oBarCtrl.SetWrapUp()};this.SetCTICalloutTask=function(a){return this.oBarCtrl.SetCTICalloutTask(a)};this.GetCTICalloutTask=function(){return this.oBarCtrl.GetCTICalloutTask()};this.GetCallData=function(a){return this.oBarCtrl.GetCallData(a)};this.SetCallData=function(a,c){return this.oBarCtrl.SetCallData(a,c)};this.GetTransfer=function(){return this.oBarCtrl.GetTransfer()};this.SetTransfer=function(a,c,d){return this.oBarCtrl.SetTransfer(a,c,d)};this.ChangeCallQueue=function(a,c,d){return this.oBarCtrl.ChangeCallQueue(a,c,d)};this.GetCallID=function(){return this.oBarCtrl.GetCallID()};this.QuerySPGroupList=function(a,c,d,e,f,g){"undefined"==typeof f&&(f=2);"undefined"==typeof g&&(g=0);return this.oBarCtrl.QuerySPGroupList(a,c,d,e,f,g)};this.GetCallInfo=function(){return this.oBarCtrl.GetCallInfo()};this.SetTransparentParameter=function(a){return this.oBarCtrl.SetTransparentParameter(a)};this.GetAgentStatus=function(){return this.oBarCtrl.GetAgentStatus()};this.GetAgentSubBusyStatus=function(){return this.oBarCtrl.GetAgentSubBusyStatus()};this.GetBusySubStatus=function(){return this.oBarCtrl.GetBusySubStatus()};this.SetDisplayNumber=function(a){return this.oBarCtrl.SetDisplayNumber(a)};this.GetDisplayNumber=function(){return this.oBarCtrl.GetDisplayNumber()};this.CallQueueQuery=function(a,c,d){"undefined"==typeof c&&(c=2);"undefined"==typeof d&&(d=0);return this.oBarCtrl.CallQueueQuery(a,c,d)};this.QueryGroupAgentStatus=function(a,c,d,e){"undefined"==typeof e&&(e=0);return this.oBarCtrl.QueryGroupAgentStatus(a,c,d,e)};this.QueryPreViewCallOutNumbers=function(a,c,d,e){return this.oBarCtrl.QueryPreViewCallOutNumbers(a,c,d,e)};this.GetBase64Data=function(a){return this.oBarCtrl.GetBase64Data(a)};this.GetDataFromBase64=function(a){return this.oBarCtrl.GetDataFromBase64(a)};this.SetWeChatQueueFlag=function(a){return this.oBarCtrl.SetWeChatQueueFlag(a)};this.GetWeChatQueueFlag=function(){return this.oBarCtrl.GetWeChatQueueFlag()};this.TransferCallQueue=function(a,c,d){return this.oBarCtrl.TransferCallQueue(a,c,d)};this.SetActiveService=function(a){return this.oBarCtrl.SetActiveService(a)};this.GetActiveService=function(){return this.oBarCtrl.GetActiveService()};this.GetExitCause=function(){return this.oBarCtrl.GetExitCause()};this.SetForwardNumber=function(a,c){return this.oBarCtrl.SetForwardNumber(a,c)};this.GetForwardNumber=function(){return this.oBarCtrl.GetForwardNumber()};this.SetAgentReservedStatus=function(a,c){return this.oBarCtrl.SetAgentReservedStatus(a,c)};this.GetAgentWorkStatus=function(){return this.workStatus};this.GetAgentLogFile=function(a,c,d){a=getDefaultParam(a);if(""==a)return-1;"undefined"==typeof d&&(d=0);c=getDefaultParam(c);return this.oBarCtrl.GetAgentLogFile(a,d,c)};this.GetMonitorStatus=function(){return this.oBarCtrl.GetMonitorStatus()};this.GetMonitorTimeOffSet=function(){return this.oBarCtrl.GetCtrlAttribute("AmpTimeOffSet")};this.MakeCall=function(a,c,d,e,f,g,h,k){return this.oBarCtrl.MakeCall(a,c,d,e,f,g,h,k)};this.CallIn=function(a,c,d,e){return this.oBarCtrl.CallIn(a,c,d,e)};this.TransferOut=function(a,c){return this.oBarCtrl.TransferOut(a,c)};this.Hold=function(){return this.oBarCtrl.Hold()};this.RetrieveHold=function(){return this.oBarCtrl.RetrieveHold()};this.Disconnect=function(a){return this.oBarCtrl.Disconnect(a)};this.Answer=function(a){"undefined"==typeof a&&(a=0);return this.oBarCtrl.Answer(a)};this.Consult=function(a,c){return this.oBarCtrl.Consult(a,c)};this.Transfer=function(){return this.oBarCtrl.Transfer()};this.Conference=function(){return this.oBarCtrl.Conference()};this.SendDTMF=function(a){return this.oBarCtrl.SendDTMF(a)};this.BeginRecord=function(a,c){return this.oBarCtrl.BeginRecord(a,c)};this.StopRecord=function(a){return this.oBarCtrl.StopRecord(a)};this.BeginPlay=function(a,c,d,e,f){return this.oBarCtrl.BeginPlay(a,c,d,e,f)};this.StopPlay=function(a,c){return this.oBarCtrl.StopPlay(a,c)};this.Bridge=function(a,c){return this.oBarCtrl.Bridge(a,c)};this.Mute=function(a){return this.oBarCtrl.Mute(a)};this.AlterNate=function(a){return this.oBarCtrl.AlterNate(a)};this.CallBack=function(){return this.oBarCtrl.CallBack()};this.ReCall=function(){return this.oBarCtrl.ReCall()};this.SMMsg=function(a,c){return this.oBarCtrl.SMMsg(a,c)};this.ReleaseThirdOne=function(a){return this.oBarCtrl.ReleaseThirdOne(a)};this.BeginCollect=function(a,c,d,e,f,g,h,k,l,n){return this.oBarCtrl.BeginCollect(a,c,d,e,f,g,h,k,l,n)};this.StopCollect=function(a,c){return this.oBarCtrl.StopCollect(a,c)};this.ForceReset=function(){return this.oBarCtrl.ForceReset()};this.SendIMMessage=function(a,c,d,e,f,g){return this.oBarCtrl.SendIMMessage(a,c,d,e,f,g)};this.ForeReleaseCall=function(a,c){return this.oBarCtrl.ForeReleaseCall(a,c)};this.Insert=function(a,c,d){"undefined"==typeof c&&(c=0);"undefined"==typeof d&&(d="");return this.oBarCtrl.Insert(a,c,d)};this.Listen=function(a,c,d){"undefined"==typeof c&&(c=0);"undefined"==typeof d&&(d="");return this.oBarCtrl.Listen(a,c,d)};this.Intercept=function(a,c,d){"undefined"==typeof c&&(c=0);"undefined"==typeof d&&(d="");return this.oBarCtrl.Intercept(a,c,d)};this.Lock=function(a){return this.oBarCtrl.Lock(a)};this.UnLock=function(a){return this.oBarCtrl.UnLock(a)};this.ForceIdle=function(a){return this.oBarCtrl.ForceIdle(a)};this.ForceBusy=function(a){return this.oBarCtrl.ForceBusy(a)};this.ForceOut=function(a){return this.oBarCtrl.ForceOut(a)};this.Help=function(a,c,d){"undefined"==typeof c&&(c=0);"undefined"==typeof d&&(d="");return this.oBarCtrl.Help(a,c,d)};this.InitialState=function(){return this.oBarCtrl.InitialState()};this.AgentQuery=function(a,c){return this.oBarCtrl.AgentQuery(a,c)};this.TelQuery=function(a,c){return this.oBarCtrl.TelQuery(a,c)};this.IvrQuery=function(a,c){return this.oBarCtrl.IvrQuery(a,c)};this.ServiceQuery=function(a,c){return this.oBarCtrl.ServiceQuery(a,c)};this.TaskQuery=function(a,c){return this.oBarCtrl.TaskQuery(a,c)};this.CallReportQuery=function(a,c){return this.oBarCtrl.CallReportQuery(a,c)};this.GetTaskSummary=function(a,c){return this.oBarCtrl.GetTaskSummary(a,c)};this.QueryMonitorSumInfo=function(a,c){return this.oBarCtrl.QueryMonitorSumInfo(a,c)};this.StartNotification=function(a,c,d){return this.oBarCtrl.StartNotification(a,c,d)};this.EndNotification=function(a){return this.oBarCtrl.EndNotification(a)};this.TrunkQuery=function(a,c){return this.oBarCtrl.TrunkQuery(a,c)};this.SendWeiboMsg=function(a){return this.oBarCtrl.SendWeiboMsg(a)};this.UploadFileToMMS=function(a,c,d){return this.oBarCtrl.UploadFileToMMS(a,c,d)};this.DownFileFromMMS=function(a,c,d,e,f){return this.oBarCtrl.DownFileFromMMS(a,c,d,e,f)};this.SendWeChatMsg=function(a,c,d,e,f,g,h,k,l,n){null!=application.oWechatManager&&application.oWechatManager.SaveSendMessage(a,c,d,e,f,g,h,k,l,n);return this.oBarCtrl.SendWeChatMsg(a,c,d,e,f,g,h,k,l,n)};this.QueryWeChatData=function(a,c,d,e,f,g,h){return this.oBarCtrl.QueryWeChatData(a,c,d,e,f,g,h)};this.QueryWeChatHistory=function(a,c,d,e,f,g,h){return this.oBarCtrl.QueryWeChatHistory(a,c,d,e,f,g,h)};this.GetWeChatParam=function(a){return this.oBarCtrl.GetWeChatParam(a)};this.OnCallRing=function(a,c,d,e,f,g,h,k,l,n,p,m,q,r,t,u,v,w){};this.AnswerCall=function(a,c,d,e,f,g,h){};this.OnCallEnd=function(a,c,d,e,f,g,h,k,l,n,p,m,q,r,t){};this.OnPrompt=function(a,c){};this.OnReportBtnStatus=function(a){};this.OnInitalSuccess=function(){};this.OnInitalFailure=function(a,c,d){};this.OnEventPrompt=function(a,c){};this.OnAgentWorkReport=function(a,c){};this.OnCallDataChanged=function(a){};this.OnBarExit=function(a,c){};this.OnCallQueueQuery=function(a){};this.OnQueryGroupAgentStatus=function(a,c){};this.OnSystemMessage=function(a,c){};this.OnRecvWeiboMsg=function(a){};this.OnIMMessage=function(a,c){};this.OnRecvWeChatMessage=function(a,c,d,e,f,g,h,k,l,n,p,m,q,r){};this.OnSendWeChatMsgReport=function(a,c,d,e,f,g){};this.OnUploadFileToMMSReport=function(a,c,d){};this.OnDownloadFileToMMSReport=function(a,c,d,e){};this.OnWorkStaticInfoReport=function(a){};this.OnQueueReport=function(a){};this.OnQuerySPGroupList=function(a,c){};this.OnAgentBusyReason=function(a,c){};this.OnAgentStatus=function(a){};this.OnAgentLogUpload=function(a,c,d,e,f,g){};this.OnAsrEventReport=function(a,c,d,e){};this.OnStopSmSuccess=function(a){};this.OnCallCdrReport=function(a,c,d,e,f,g,h,k,l,n,p,m,q,r,t,u){};this.OnAgentReport=function(a){};this.OnTelReport=function(a){};this.OnServiceReport=function(a){};this.OnIvrReport=function(a){};this.OnTaskReport=function(a){};this.OnOutboundReport=function(a){};this.OnCallReportInfo=function(a){};this.OnQueryMonitorSumReport=function(a,c){};this.OnWallServiceReport=function(a){};this.OnWallQueueReport=function(a){};this.OnServiceStaticReport=function(a){};this.OnAgentStaticReport=function(a){};this.OnTrunkReport=function(a){};this.OnTrunkSumReport=function(a){};this.OnMethodResponseEvent=function(a,c){};this.SetMonitorCtrl=function(a){this.oMonitorCtrl=a};this.SetMonitorData=function(a){this.oMonitorDataManager=a};this.GetSipCtrl=function(){return this.oBarCtrl.GetSipCtrl()};this.GetBarCtrl=function(){return this.oBarCtrl.GetBarCtrl()};this._createObject();return this}var CINVccBar_FALSE=0,CINVccBar_TRUE=1,CINVccBar_NULL=0,CINVccBar_FAILURE=-1,CINVccBar_SUCCESS=0,CINVccBar_NOT_IMPL=-2,CINVccBar_EMPTY_STRING="",CINVccBar_VERSION="20190514",TIMER_MIN_INTERVAL=100,TIMER_RECONNECT_TIME=500,CINNGCCA_METHOD_ID=1,CINNGCCA_AGENTREPORT_ID=2,CINNGCCA_AGENTRECONNECT_ID=3,CINNGCCA_EMPTYHEARTBEAT_ID=4,CINNGCCA_OPENSOCKET_ID=5,CINNGCCA_REDIRECTSOCKET_ID=6,CINNGCCA_SIPDISCTI_ID=7,AMP_EMPTYHEARTBEAT_ID=12,AMP_AGENTRECONNECT_ID=13,AMP_STARTNOTIFICATION_ID=14,AMP_OPENSOCKET_ID=15,CTRL_AGENTRECONNECT_ID=20,CTRL_QueryCTIInfo_ID_8=21,CTRL_QueryCTIInfo_ID_9=22,CTRL_QueryCTIInfo_ID_10=23,CTRL_QueryCTIInfo_ID_22=24,CTRL_CallQueueQuery_ID=25,CTRL_AnswerPhone_ID=30,CTRL_GetLogFile_ID=31,CTRL_AgentWrapUp_ID=32,CTRL_ThisAgentWrapUp_ID=33,CINNGCCA_METHOD_INTERVAL=10,CINNGCCA_AGENTREPORT_INTERVAL=120,CINNGCCA_AGENTRECONNECT_INTERVAL=125,CINNGCCA_OPENSOCKET_INTERVAL=10,CINNGCCA_REDIRECTSOCKET_INTERVAL=.5,CINNGCCA_EMPTYHEARTBEAT_INTERVAL=3,CINNGCCA_SIPDISCTI_INTERVAL=2,AMP_EMPTYHEARTBEAT_INTERVAL=3,AMP_AGENTRECONNECT_INTERVAL=10,CTRL_AGENTRECONNECT_INTERVAL=10,PhoneMobile=0,PhoneSip=1,PhoneOutSide=2,PhoneRemoteSip=3,PhoneSofeSwitch=4,PhoneYealink=5,emPhoneNULL=-1,emPhoneLogin=0,emPhoneLogout=1,emPhoneIdle=2,emPhoneBusy=3,emPhoneOrigated=4,emPhoneAlerting=5,emPhoneOnLineOut=6,emPhoneOnLineOutIdle=7,emPhoneOnLineOutBusy=8,emPhoneOnLine=9,emPhoneOnLineIVR=10,emPhoneOnLineCallout=11,emPhoneOnLineConsult=12,emPhoneOnLineConference=13,emPhoneHold=14,emPhoneRetrive=15,emPhoneListen=16,emPhoneHelp=17,emPhoneInsert=18,emPhoneIncept=19,emPhoneOnCalloutMid=20,emPhoneOnConsultMid=21,emPhoneOnBridge=22,emPhoneOnCallouting=23,emPhoneOnCallining=24,emPhoneOnConsultFailuer=25,emPhoneOnCalloutBefore=26,emPhoneOnCallinBefore=27,emBtnWrapUp=0,emBtnSetBusy=1,emBtnSetIdle=2,emBtnMakeCall=3,emBtnHold=4,emBtnRetrieve=5,emBtnEndCall=6,emBtnTransfer=7,emBtnConference=8,emBtnPickUp=9,emBtnTransferOut=10,emBtnConsult=11,emBtnSendDtmf=12,emBtnBridge=13,emBtnAlterNate=14,emBtnConfig=15,emBtnForceReset=16,emBtnRecord=17,emBtnStopRecord=18,emBtnListen=19,emBtnInsert=20,emBtnIntercept=21,emBtnForceRelease=22,emBtnBeginPlay=23,emBtnStopPlay=24,emBtnLock=25,emBtnUnLock=26,emBtnMute=27,emBtnCallBack=28,emBtnReCall=29,emBtnHelp=30,emMonitorNoFlag=-1,emListenFlag=1,emHelpFlag=2,emInsertFlag=3,emInterceptFlag=4,eventidOnSignInSuccess=1,eventidOnSignInFailure=2,eventidOnSignOutSuccess=3,eventidOnSignOutFailure=4,eventidOnAnswerRequest=5,eventidOnAnswerSuccess=6,eventidOnAnswerFailure=7,eventidOnUserHangupBeforeResponse=8,eventidOnRequestRelease=9,eventidOnReleaseSuccess=10,eventidOnReleaseFailure=11,eventidOnLongNoAnswer=12,eventidOnSetBusySuccess=13,eventidOnStartBusy=14,eventidOnSetBusyFailure=15,eventidOnSetIdleSuccess=16,eventidOnSetIdleFailure=17,eventidOnConsultationBack=18,eventidOnConsultationSuccess=19,eventidOnConsultationFailure=20,eventidOnTransSuccess=21,eventidOnTransFailure=22,eventidOnReturnFromIVR=23,eventidOnSingleStepTransSuccess=24,eventidOnSingleStepTransFailure=25,eventidOnCallInsideSuccess=26,eventidOnCallInsideFailure=27,eventidOnCallOutsideSuccess=28,eventidOnCallOutsideSuccTalk=29,eventidOnCallOutsideFailure=30,eventidOnHoldSuccess=31,eventidOnHoldFailure=32,eventidOnRetrieveHoldSuccess=33,eventidOnRetrieveHoldFailure=34,eventidOnHoldCallRelease=35,eventidOnConferenceSuccess=36,eventidOnConferenceFailure=37,eventidOnHangupCallInConf=38,eventidOnAlternateSuccess=39,eventidOnAlternateFailture=40,eventidOnListenSuccess=41,eventidOnListenFailure=42,eventidOnInsertSuccess=43,eventidOnInsertFailure=44,eventidOnStopInsertSuccess=45,eventidOnStopInsertFailure=46,eventidOnInterceptSuccess=47,eventidOnInterceptFailure=48,eventidOnForceIdleSuccess=49,eventidOnForceIdleFailure=50,eventidOnForceBusySuccess=51,eventidOnForceBusyFailure=52,eventidOnAgentForceOutSuccess=53,eventidOnAgentForceOutFailure=54,eventidOnBeginRecordSuccess=55,eventidOnBeginRecordFailure=56,eventidOnStopRecordSuccess=57,eventidOnStopRecordFailure=58,eventidOnForceIdle=59,eventidOnForceBusy=60,eventidOnForceOut=61,eventidOnForceRelease=62,eventidOnAgentAllBusy=63,eventidOnError=64,eventidOnCTIDisconnected=65,eventidOnMasterChanged=66,eventidOnReleaseReport=67,eventidOnCallInsideSuccTalk=68,eventidOnTransSuccessTalk=69,eventidOnConferenceSuccTalk=70,eventidOnHoldExSuccess=71,eventidOnHoldExFailure=72,eventidOnHoldExed=73,eventidOnRetrieveHolded=74,eventidOnIntercepted=75,eventidOnInserted=76,eventidOnStopInserted=77,eventidOnForceOutSuccess=78,eventidOnForceOutFailure=79,eventidOnStopListenSuccess=80,eventidOnStopListenFailure=81,eventidOnListened=82,eventidOnListenStoped=83,eventidOnRecordReport=84,eventidOnFranchiseChange=85,eventidOnAgentEnterIdleSuccess=86,eventidOnAgentEnterIdleFailure=87,eventidOnAgentEnterWrapUpSuccess=88,eventidOnAgentEnterWrapUpFailure=89,eventidOnOrigated=90,eventidOnBridgeSuccess=91,eventidOnBridgeFailure=92,eventidOnReturnFromPhone=93,eventidOnTransferred=94,eventidOnLocked=95,eventidOnSignOuted=96,eventidOnBeginSendDTMFSuccess=97,eventidOnBeginSendDTMFFailure=98,eventidOnStopSendDTMFSuccess=99,eventidOnStopSendDTMFFailure=100,eventidOnUnLocked=101,eventidOnBeginPlaySuccess=102,eventidOnBeginPlayFailure=103,eventidOnStopPlaySuccess=104,eventidOnStopPlayFailure=105,eventidOnBeginCollectSuccess=106,eventidOnBeginCollectFailure=107,eventidOnStopCollectSuccess=108,eventidOnStopCollectFailure=109,eventidOnSystemStatusReport=110,eventidOnGetLog=111,eventidOnCallQueueQuery=112,eventidOnQueueReport=113,eventidOnSystemMessage=114,eventidOnHelpSuccess=115,eventidOnHelpFailure=116,eventidOnRecvWeiboMsg=117,eventidOnStaticInfoReport=118,eventidOnRecvWeChatMsg=119,eventidOnWeChatEventReport=120,eventidOnForceReleaseCallSuccess=121,eventidOnForceReleaseCallFailure=122,eventidOnAQueryCTIInfo=123,eventidOnAgentBusyReason=124,eventidOnNetError=125,emCenterOpStatusInitial=0,emCenterOpStatusConnecting=1,emCenterOpStatusConnected=2;function JScene(a,b,c){this._secneID=a;this._items=[];this._masterItems=[];this._description=b;this._description_eng=c}function JPhoneStatus(a){this._arrCallScene=null;this._language=a;this._arrShowBtnIDs=Array(31);this._showBtnIDCount=0;this._Create=function(){this._arrCallScene=[];var a=new JScene(emPhoneNULL,"\u6ca1\u6709\u521d\u59cb\u5316!","In uninitial scene");this._arrCallScene.push(a);a=new JScene(emPhoneLogin,"\u767b\u5f55CTI\u6210\u529f!","In login scene");a._items.push(emBtnSetIdle);a._items.push(emBtnSetBusy);a._items.push(emBtnMakeCall);a._items.push(emBtnConfig);a._items.push(emBtnForceReset);a._items.push(emBtnListen);a._items.push(emBtnHelp);a._items.push(emBtnIntercept);a._items.push(emBtnInsert);a._items.push(emBtnForceRelease);this._arrCallScene.push(a);a=new JScene(emPhoneIdle,"\u5ea7\u5e2d\u5c31\u7eea!","In idle scene");a._items.push(emBtnSetBusy);a._items.push(emBtnMakeCall);a._items.push(emBtnConfig);a._items.push(emBtnForceReset);a._items.push(emBtnRecord);a._items.push(emBtnListen);a._items.push(emBtnHelp);a._items.push(emBtnIntercept);a._items.push(emBtnInsert);a._items.push(emBtnForceRelease);this._arrCallScene.push(a);a=new JScene(emPhoneBusy,"\u5ea7\u5e2d\u5fd9\u788c!","In busy scene");a._items.push(emBtnSetIdle);a._items.push(emBtnSetBusy);a._items.push(emBtnMakeCall);a._items.push(emBtnConfig);a._items.push(emBtnForceReset);a._items.push(emBtnListen);a._items.push(emBtnHelp);a._items.push(emBtnIntercept);a._items.push(emBtnInsert);a._items.push(emBtnForceRelease);this._arrCallScene.push(a);a=new JScene(emPhoneOrigated,"\u5ea7\u5e2d\u5916\u62e8!","In makeouting scene");a._items.push(emBtnEndCall);a._items.push(emBtnForceReset);this._arrCallScene.push(a);a=new JScene(emPhoneAlerting,"\u5ea7\u5e2d\u632f\u94c3!","In alert scene");a._items.push(emBtnPickUp);a._items.push(emBtnForceReset);this._arrCallScene.push(a);a=new JScene(emPhoneOnLineOutIdle,"\u5ea7\u5e2d\u6302\u673a\u5904\u4e8e\u7a7a\u95f2\u72b6\u6001!","In idle scene after call scene");a._items.push(emBtnSetBusy);a._items.push(emBtnConfig);a._items.push(emBtnForceReset);a._items.push(emBtnRecord);a._items.push(emBtnListen);a._items.push(emBtnHelp);a._items.push(emBtnIntercept);a._items.push(emBtnInsert);a._items.push(emBtnForceRelease);this._arrCallScene.push(a);a=new JScene(emPhoneOnLineOutBusy,"\u5ea7\u5e2d\u6302\u673a\u5904\u4e8e\u540e\u5904\u7406\u72b6\u6001!","In wrapup scene after call scene");a._items.push(emBtnWrapUp);a._items.push(emBtnSetBusy);a._items.push(emBtnSetIdle);a._items.push(emBtnMakeCall);a._items.push(emBtnConfig);a._items.push(emBtnForceReset);this._arrCallScene.push(a);a=new JScene(emPhoneOnLineIVR,"\u5ea7\u5e2d\u63a5\u901a\u547c\u5165\u7535\u8bdd!","In callin scene");a._masterItems.push(emBtnHold);a._masterItems.push(emBtnConsult);a._masterItems.push(emBtnEndCall);a._masterItems.push(emBtnTransferOut);a._masterItems.push(emBtnForceReset);a._masterItems.push(emBtnSendDtmf);a._masterItems.push(emBtnBridge);this._arrCallScene.push(a);a=new JScene(emPhoneOnLineCallout,"\u5ea7\u5e2d\u63a5\u901a\u547c\u51fa\u7535\u8bdd!","In callout scene");a._masterItems.push(emBtnEndCall);a._masterItems.push(emBtnHold);a._masterItems.push(emBtnTransferOut);a._masterItems.push(emBtnConsult);a._masterItems.push(emBtnForceReset);a._masterItems.push(emBtnSendDtmf);a._masterItems.push(emBtnBridge);a._items.push(emBtnEndCall);a._items.push(emBtnTransferOut);a._items.push(emBtnForceReset);this._arrCallScene.push(a);a=new JScene(emPhoneOnLineConsult,"\u5ea7\u5e2d\u6b63\u5728\u54a8\u8be2\u4e2d!","In consult scene");a._masterItems.push(emBtnEndCall);a._masterItems.push(emBtnConference);a._masterItems.push(emBtnTransfer);a._masterItems.push(emBtnForceReset);a._masterItems.push(emBtnAlterNate);a._masterItems.push(emBtnSendDtmf);a._items.push(emBtnEndCall);a._items.push(emBtnForceReset);this._arrCallScene.push(a);a=new JScene(emPhoneOnLineConference,"\u5ea7\u5e2d\u5728\u4f1a\u8bae\u4e2d!","In conference scene");a._masterItems.push(emBtnEndCall);a._masterItems.push(emBtnTransfer);a._masterItems.push(emBtnForceReset);a._masterItems.push(emBtnSendDtmf);a._items.push(emBtnEndCall);a._items.push(emBtnForceReset);this._arrCallScene.push(a);a=new JScene(emPhoneHold,"\u7528\u6237\u5904\u4e8e\u4fdd\u6301\u4e2d!","In hold scene");a._items.push(emBtnEndCall);a._items.push(emBtnConsult);a._items.push(emBtnRetrieve);a._items.push(emBtnForceReset);this._arrCallScene.push(a);a=new JScene(emPhoneListen,"\u5ea7\u5e2d\u6b63\u5728\u76d1\u542c\u4e2d!","In listen scene");a._items.push(emBtnEndCall);a._items.push(emBtnForceReset);a._items.push(emBtnInsert);a._items.push(emBtnIntercept);a._items.push(emBtnHelp);this._arrCallScene.push(a);a=new JScene(emPhoneHelp,"\u5ea7\u5e2d\u6b63\u5728\u8f85\u52a9\u4e2d!","In help scene");a._items.push(emBtnEndCall);a._items.push(emBtnForceReset);a._items.push(emBtnListen);a._items.push(emBtnInsert);a._items.push(emBtnIntercept);this._arrCallScene.push(a);a=new JScene(emPhoneInsert,"\u5ea7\u5e2d\u6b63\u5728\u5f3a\u63d2\u4e2d!","In insert scene");a._items.push(emBtnEndCall);a._items.push(emBtnForceReset);a._items.push(emBtnListen);a._items.push(emBtnHelp);a._items.push(emBtnIntercept);this._arrCallScene.push(a);a=new JScene(emPhoneOnCalloutMid,"\u5ea7\u5e2d\u5916\u547c,\u5bf9\u65b9\u6b63\u5728\u632f\u94c3!","In alerting In callout scene");a._items.push(emBtnEndCall);a._items.push(emBtnForceReset);this._arrCallScene.push(a);a=new JScene(emPhoneOnConsultMid,"\u5ea7\u5e2d\u54a8\u8be2,\u5bf9\u65b9\u6b63\u5728\u632f\u94c3!","In alerting In consult scene");a._items.push(emBtnEndCall);a._items.push(emBtnForceReset);a._items.push(emBtnSendDtmf);this._arrCallScene.push(a);a=new JScene(emPhoneOnBridge,"\u6865\u63a5\u4e2d\uff0c\u5ea7\u5e2d\u5904\u4e8e\u4fdd\u6301\u72b6\u6001!","In hold In bridge scene");a._items.push(emBtnEndCall);a._items.push(emBtnForceReset);this._arrCallScene.push(a);a=new JScene(emPhoneOnCallouting,"\u5ea7\u5e2d\u5916\u547c\u4e2d!","In connect In callout scene");a._items.push(emBtnEndCall);a._items.push(emBtnForceReset);this._arrCallScene.push(a);a=new JScene(emPhoneOnCallining,"\u5ea7\u5e2d\u5185\u547c\u4e2d!","In connect In callin scene");a._items.push(emBtnEndCall);a._items.push(emBtnForceReset);this._arrCallScene.push(a);a=new JScene(emPhoneOnConsultFailuer,"\u54a8\u8be2\u5931\u8d25\uff0c\u7528\u6237\u4fdd\u6301\u4e2d!","In opponent hold In consult failure scene");a._items.push(emBtnEndCall);a._items.push(emBtnConsult);a._items.push(emBtnRetrieve);a._items.push(emBtnForceReset);this._arrCallScene.push(a);a=new JScene(emPhoneOnCalloutBefore,"\u5916\u547c\u540e\u5ea7\u5e2d\u632f\u94c3\u524d\u72b6\u6001!","before agent alert after callout scense");a._items.push(emBtnEndCall);a._items.push(emBtnForceReset);this._arrCallScene.push(a);a=new JScene(emPhoneOnCallinBefore,"\u5185\u90e8\u540e\u5ea7\u5e2d\u632f\u94c3\u524d\u72b6\u6001!","before agent alert after callin scense");a._items.push(emBtnEndCall);a._items.push(emBtnForceReset);this._arrCallScene.push(a)};this.GetSceneItems=function(a){for(var c=0;c<this._arrCallScene.length;c++)if(this._arrCallScene[c]._secneID==a)return this._arrCallScene[c];return 0};this.GetSceneDescription=function(a){return 0==a?"":"zh-cn"==this._language?a._description:a._description_eng};this.SetShowBtns=function(a,c){if(""!=a){var d=a.split(",");this._showBtnIDCount=d.length;for(var e=0;e<d.length;e++)this._arrShowBtnIDs[e]=stringToInt(d[e],0)}};this._Create();return this}function JTimeInfo_t(a){this.nTimerID=a;this.maxTimeOut=300;this.bIninit=this.timeIndex=0;this.strBeginTime=this.strParam="";return this}function JThisCallInfo(){this._bOrigated=!1;this._userRingTime=this._ringTime=this._endTimer=this._answerTimer=this._alertTime=this._strNetworkInfo=this._strRecordFile=this._strRecordServer="";this._thisIdleSubStatus=this._thisIdleStatus=this._thisAutoStatusInteval=0;this._queueTime=this._networkInfo=this._fileName=this._areaCode=this._authority=this._transParentParamet=this._taskID=this._alertingDevice="";this._thisAutoAnswer=0;this._projectID=this._userNo="";this._timeAgentWrapUp=new JTimeInfo_t(CTRL_AgentWrapUp_ID);this._timeThisAgentWrapUp=new JTimeInfo_t(CTRL_ThisAgentWrapUp_ID);this.ReleaseInfo=function(){this._bOrigated=!1;this._queueTime=this._networkInfo=this._fileName=this._areaCode=this._authority=this._transParentParamet=this._taskID=this._alertingDevice=this._userRingTime=this._ringTime=this._endTimer=this._answerTimer=this._alertTime=this._strNetworkInfo=this._strRecordFile=this._strRecordServer="";this._thisAutoAnswer=0;this._userNo=""};return this}function JAgentInfo_t(){this._passWord=this._agentID="";this._agentType=this._proTransportType=this._protocolCryptType=this._passWdCryptType=0;this._backIP=this._mainIP=this._agentName="";this._backPortID=this._mainPortID=14801;this._mainXPath="cti";this._monitorXPath="monitor";this._logXPath="log";this._monitorIP="";this._monitorPort=14851;this._dN="";this._isSignIn=this._isInitial=this._autoAnswer=!1;this._isInitialReady=this._idleStatus=0;this._isMonitorLogin=!1;this._vccID="";this._av=0;this._allTimeRecord=-1;this._deviceType=this._locked=0;this._taskID="";this._language=getLocalLanguage();this._monitorVersion="4.0";this._connectType=0;this._oldWorkStatus=-2;this._workstatus=-1;this._ctiVersion=this._exitCause=this._substatus=this._timeStamp=this._ctiEvent="";this._loginmode=0;this._idleSubStatus=this._autoStatusInterval=-1;this._autoAnswer=!1;this._phoneType=PhoneOutSide;this._sipRegisted=!1;this._ftpIp="";this._ftpPort=0;this._sipIp=this._sipDn=this._localDirectory=this._ftpDirectory=this._ftpPassWord=this._ftpUser="";this._sipServerPort=5060;this._sipProtocol="wss";this._sipPassWord="111111";this._sipXPath="acd";this._sipDomain="";this._sipAuthType=1;this._sipPassWdCryptType=0;this._sipBackIp="";this._sipBackServerPort=5060;this._sipBackProtocol="udp";this._sipBackPassWord="111111";this._sipBackDomain="";this._sipBackAuthType=1;this._selfPrompt=0;this._btnIDS="0,1,2,3,4,5,6,7,8,9,10,11,12,13,15,16";this._btnMaskIDS="";this._devConnectStatus=emCenterOpStatusInitial;this._logHttpCfg="";this._amptimeOff=0}function JVccBarCenter(){this._methodCallBackFunction=this._eventCallBackFunction=this._oTimer=this._oPhoneStatus=this._oMonitorDev=this._oPhoneDev=this._oAgentInfo=null;this._arrBtnStatus=[];this._thisCallInfo=new JThisCallInfo;this._AcpSocketReconnectTimer=0;this._arrQueryCTIInfo=Array(5);this._nMonitorFlag=emMonitorNoFlag;this._strReleaseSID=this._strExecuteMethod="";this._sipCtrl=null;this._create=function(){this._oAgentInfo=new JAgentInfo_t;IsOverThisVersion("2.0.0.1")?(this._oAgentInfo._mainXPath="cti",this._oAgentInfo._monitorXPath="monitor"):(this._oAgentInfo._mainXPath="",this._oAgentInfo._monitorXPath="");this._oPhoneDev=new JAcpDevice(this);this._oMonitorDev=new JAmpDevice(this);this._oTimer=new JTimerEx;this._oTimer.oParent=this;this._oTimer.SetTimerCallBack(this._OnTimerEvent);this._oTimer.Start();for(var a=0;a<emBtnHelp+1;a++)this._arrBtnStatus.push(0);this._arrBtnStatus[emBtnWrapUp]=1;this._arrBtnStatus[emBtnConfig]=1;this._oPhoneStatus=new JPhoneStatus(getLocalLanguage());this._oPhoneStatus.SetShowBtns(this._oAgentInfo._btnIDS,this._oAgentInfo._btnMaskIDS)};this._IsInitial=function(a){if(this._oAgentInfo._isInitial)return!0;var b=stringFormat("\u547d\u4ee4[{0}]\u4e0d\u53ef\u7528,\u8bf7\u521d\u59cb\u5316\u63a7\u4ef6!",a);"english"==this._oAgentInfo._language&&(b=stringFormat("Method [{0}] can't to be used,please initial this control first!",a));this._FireOnPrompt(4311,b);return!1};this._IsMethodEnable=function(a,b){if(!this._IsInitial(a))return!1;for(var c,d=!1,e=0;e<this._oPhoneStatus._showBtnIDCount;e++)if(c=this._oPhoneStatus._arrShowBtnIDs[e],c==b&&1==this._arrBtnStatus[c]){d=!0;break}return d?!0:(c=stringFormat("\u547d\u4ee4[{0}]\u4e0d\u53ef\u7528,\u65e0\u6cd5\u6267\u884c!",a),"english"==this._oAgentInfo._language&&(c=stringFormat("Method [{0}] forbidden to be execute",a)),this._FireOnPrompt(4311,c),!1)};this._RegisterPhone=function(){if(this._oAgentInfo._phoneType==PhoneSip||this._oAgentInfo._phoneType==PhoneRemoteSip){if(null==this._sipCtrl){var a=sipAdapterTypeJSip;this._oAgentInfo._phoneType==PhoneRemoteSip&&(a=IsWebSocketValid()?sipAdapterTypeRemoteSip:sipAdapterTypeRemoteHttpSip);DisplayLog(VccBar_Log_Info,stringFormat("SIPCtrl Type:[{0}] 0:jsip 1:ws+sip 2:http+sip",a));this._sipCtrl=new SIPAdapterCtrl(a,null==application?"":application.GetRelationPath());this._sipCtrl.oParent=this;this._sipCtrl.OnCallRing=this._OnSipEventOnRing;this._sipCtrl.OnOrigated=this._OnSipEventOnOrigated;this._sipCtrl.OnDisconnected=this._OnSipEventOnDisconnected;this._sipCtrl.OnConnected=this._OnSipEventOnConnected;this._sipCtrl.OnError=this._OnSipEventOnError;this._sipCtrl.OnLoginSuccess=this._OnSipEventOnLoginSuccess;this._sipCtrl.OnLoginFailure=this._OnSipEventOnLoginFailure;this._sipCtrl.OnLogoutSuccess=this._OnSipEventOnLogoutSuccess;this._sipCtrl.OnDebug=this._OnSipEventDebug}1!=this._oAgentInfo._sipRegisted&&(this._sipCtrl.SetAttribute("SipServerIP",this._oAgentInfo._sipServerIP),this._sipCtrl.SetAttribute("SipServerPort",this._oAgentInfo._sipServerPort),this._sipCtrl.SetAttribute("Dn",this._oAgentInfo._dN),this._sipCtrl.SetAttribute("Domain",this._oAgentInfo._sipServerIP),this._sipCtrl.SetAttribute("PassWord",this._oAgentInfo._sipPassWord),this._sipCtrl.SetAttribute("XPath",this._oAgentInfo._sipXPath),this._sipCtrl.SetAttribute("Vedio",2==this._oAgentInfo._av?!0:!1),this._sipCtrl.SetAttribute("SipProtocol",this._oAgentInfo._sipProtocol),0==this._sipCtrl.Initial()?(DisplayLog(VccBar_Log_Info,"\u521d\u59cb\u5316SIPCtrl\u6210\u529f"),this._sipCtrl.RegisterPA(),this._FireOnPrompt(4360)):DisplayLog(VccBar_Log_Info,"\u521d\u59cb\u5316SIPCtrl\u5931\u8d25"))}else this._FireOnInitalSuccess()};this._RegisterMonitor=function(){var a=CINVccBar_FAILURE;if(1==this._oAgentInfo._appType||2==this._oAgentInfo._appType)a=this._oMonitorDev.OpenStream(this._oAgentInfo._monitorIP,this._oAgentInfo._monitorPort),1<a&&this._FireOnPrompt(a,"");return a};this._SetBtnStatus=function(a,b){if(null!=this._oPhoneDev){"undefined"==typeof b&&(b=!1);this._ResetBtn();var c=-1;switch(a){case emPhoneLogin:case emPhoneNULL:case emPhoneIdle:case emPhoneBusy:case emPhoneOrigated:case emPhoneAlerting:case emPhoneHold:case emPhoneOnLineConsult:case emPhoneOnLineCallout:case emPhoneOnLineConference:case emPhoneOnLineIVR:case emPhoneListen:case emPhoneHelp:case emPhoneInsert:case emPhoneOnConsultMid:case emPhoneOnCalloutMid:case emPhoneOnBridge:case emPhoneOnCallouting:case emPhoneOnCallining:case emPhoneOnConsultFailuer:case emPhoneOnCalloutBefore:case emPhoneOnCallinBefore:case emPhoneOnLineOutBusy:case emPhoneOnLineOutIdle:c=a;break;case emPhoneOnLine:case emPhoneRetrive:case emPhoneIncept:0==b&&(b=1==this._oPhoneDev._oAcpCall._acpEvent.body.agent.master);switch(this._oPhoneDev._oAcpCall.GetCallScene()){case CST_ONE:return;case CST_IVR:c=emPhoneOnLineIVR;break;case CST_INVITED:c=b?emPhoneOnLineIVR:emPhoneOnLineCallout;break;case CST_MAKECALL:c=this._oPhoneDev._oAcpCall._acpEvent.head.serviceID==CD_INTERCEPT_CALLIN?emPhoneOnLineIVR:emPhoneOnLineCallout;break;case CST_CONSULT:c=emPhoneOnLineConsult;break;case CST_CONFERENCE:c=emPhoneOnLineConference}break;case emPhoneOnLineOut:this._oPhoneDev._oAcpCall._acpEvent.body.agent.agentStatus==AG_WORKING_AFTER_CALL?(c=emPhoneOnLineOutBusy,this._SetAgentEnterWrapUp()):c=emPhoneOnLineOutIdle}this._SetPhoneBtnStatus(c,b)}};this._ResetBtn=function(){for(var a=0;31>a;a++)this._arrBtnStatus[a]=!1};this._SetPhoneBtnStatus=function(a,b){var c=this._oPhoneStatus.GetSceneItems(a);if(0!=c){var d;if(b)for(d=0;d<c._masterItems.length;d++)this._arrBtnStatus[c._masterItems[d]]=!0;else for(d=0;d<c._items.length;d++)this._arrBtnStatus[c._items[d]]=!0;this._arrBtnStatus[emBtnConfig]=!0;this._arrBtnStatus[emBtnMute]=this._arrBtnStatus[emBtnEndCall];this._FireOnAgentWorkReport(c._secneID,this._oPhoneStatus.GetSceneDescription(c));c=this._GetBtnIDs();""!=c&&this._FireOnReportBtnStatus(c)}};this._GetBtnIDs=function(){for(var a,b="",c=0;c<this._oPhoneStatus._showBtnIDCount;c++)a=this._oPhoneStatus._arrShowBtnIDs[c],a==emBtnWrapUp?b=""==b?stringFormat("{0}",a):b+"|"+a:1==this._arrBtnStatus[a]&&(b=""==b?stringFormat("{0}",a):b+"|"+a);return b};this._NGCCARETURN=function(a){return 1==a?CINVccBar_SUCCESS:CINVccBar_FAILURE};this._AnswerPhone=function(a){if(!this._IsMethodEnable("Answer",emBtnPickUp))return CINVccBar_FAILURE;a=getDefaultParamValue(a,0);return this._oAgentInfo._phoneType==PhoneYealink?this._NGCCARETURN(this._oPhoneDev.Answer(this._oAgentInfo._dN,a,this._oAgentInfo._phoneType)):this._oAgentInfo._phoneType==PhoneSip||this._oAgentInfo._phoneType==PhoneRemoteSip?this._sipCtrl.Pickup():-1};this._SetAgentEnterWrapUp=function(){if(3==this._thisCallInfo._thisIdleStatus||4==this._thisCallInfo._thisIdleStatus)DisplayLog(VccBar_Log_Debug,stringFormat("SetThisAgentEnterWrapUp(IdleStatus:{0},interval:{1})",this._thisCallInfo._thisIdleStatus,this._thisCallInfo._thisAutoStatusInteval)),0!=this._thisCallInfo._thisAutoStatusInteval&&0==this._thisCallInfo._timeThisAgentWrapUp.bIninit&&(this._thisCallInfo._timeThisAgentWrapUp.bIninit=1,this._thisCallInfo._timeThisAgentWrapUp.timeIndex=0,this._thisCallInfo._timeThisAgentWrapUp.maxTimeOut=this._thisCallInfo._thisAutoStatusInteval,this._thisCallInfo._timeThisAgentWrapUp.strBeginTime=getAcpTimeString(!1),this._oTimer.SetTimer(this._thisCallInfo._timeThisAgentWrapUp.nTimerID,1E3));else if(3==this._oAgentInfo._idleStatus||4==this._oAgentInfo._idleStatus)DisplayLog(VccBar_Log_Debug,stringFormat("SetAgentEnterWrapUp(IdleStatus:%d,interval:%d)",this._oAgentInfo._idleStatus,this._oAgentInfo._autoStatusInterval)),0!=this._oAgentInfo._autoStatusInterval&&(this._thisCallInfo._timeAgentWrapUp.bIninit=1,this._thisCallInfo._timeAgentWrapUp.timeIndex=0,this._thisCallInfo._timeAgentWrapUp.maxTimeOut=this._oAgentInfo._autoStatusInterval,this._thisCallInfo._timeAgentWrapUp.strBeginTime=getAcpTimeString(!1),this._oTimer.SetTimer(this._thisCallInfo._timeAgentWrapUp.nTimerID,1E3))};this._UpLoadLogToCTI=function(a,b){var c=a.split("|"),d=c[0],e=c[1],f=c[2],c=c[3],g="",h="";"0"==f?(g=""==c?stringFormat("{0}:8089",this._oAgentInfo._sipServerIP):0<c.indexOf(":")?c:stringFormat("{0}:8089",c),h=stringFormat("http://{0}/ACD/vxml/receiveLogFileResult.shp?fileName\x3d",g)):0<c.indexOf("uploadCtiLog.jsp")?(g=getSubString(c,"","/"),h=stringFormat("{0}?filePath\x3dlog/{1}\x26fileName\x3d",c,this._oAgentInfo._vccID)):(g=""==c?stringFormat("{0}:8078",this._oAgentInfo._mainIP):0<c.indexOf(":")?c:stringFormat("{0}:8078",c),h=stringFormat("http://{0}/cin-cc/uploadCtiLog.jsp?filePath\x3dlog/{1}\x26fileName\x3d",g,this._oAgentInfo._vccID));c=getSubString(h,"cin-cc/uploadCtiLog.jsp","");h=stringFormat("https://{0}:{1}/{2}/uploadCtiLog.jsp{3}",this._oAgentInfo._mainIP,this._oAgentInfo._mainPortID,this._oAgentInfo._logXPath,c);SendLogFileTo(h,application.GetLogText(!0),e,function(a,c,h){h=stringFormat("{0}|{1}|{2}|{3}|{4}|{5}|{6}",e,d,f,g,a,c,h);b(h)})};this._MakeOnReleaseSuccess=function(){DisplayLog(VccBar_Log_Debug,stringFormat("MakeOnReleaseSuccess({0})",this._strReleaseSID));this._thisCallInfo._endTimer=getAcpTimeString(!1);this._oPhoneDev._oAcpCall._acpEvent.body.eventType=ACP_OnReleaseSuccess;this._oPhoneDev._oAcpCall._acpEvent.body.agent.agentStatus=4;this._FireOnCallEndEvent(this._oPhoneDev._oAcpCall)};this._OnTimerEvent=function(a){var b=this.oParent;a!=CINNGCCA_METHOD_ID&&a!=CINNGCCA_AGENTREPORT_ID&&a!=CINNGCCA_AGENTRECONNECT_ID&&a!=CINNGCCA_EMPTYHEARTBEAT_ID&&a!=CINNGCCA_OPENSOCKET_ID&&a!=CINNGCCA_REDIRECTSOCKET_ID||this.oParent._oPhoneDev.OnTimerEvent(a);a!=AMP_EMPTYHEARTBEAT_ID&&a!=AMP_AGENTRECONNECT_ID&&a!=AMP_STARTNOTIFICATION_ID&&a!=AMP_OPENSOCKET_ID||this.oParent._oMonitorDev.OnTimerEvent(a);a==CTRL_AGENTRECONNECT_ID&&(this.oParent._AcpSocketReconnectTimer>=TIMER_RECONNECT_TIME?(this.oParent._oTimer.KillTimer(CTRL_AGENTRECONNECT_ID),this._AcpSocketReconnectTimer=0,1==this.oParent._oAgentInfo._isInitial&&(this.oParent._oPhoneDev.CloseStream(),this.oParent._oPhoneDev._oAcpCall.SetAgentStatus(AG_NULL),this.oParent._oAgentInfo._isSignIn=!1),this.oParent._SetBtnStatus(emPhoneNULL,!1),this.oParent._FireOnPrompt(4303,""),this.oParent._FireOnBarExit(4303,"")):(this.oParent._AcpSocketReconnectTimer++,this.oParent._FireOnPrompt(4006),this.oParent._oPhoneDev.AgentReconnect(!0)&&(this.oParent._oTimer.KillTimer(CTRL_AGENTRECONNECT_ID),this.oParent._AcpSocketReconnectTimer=0)));a==CTRL_QueryCTIInfo_ID_8&&this.oParent._NGCCARETURN(this.oParent._oPhoneDev.GetCTIParam("",8,this.oParent._arrQueryCTIInfo[0],1));a==CTRL_QueryCTIInfo_ID_9&&this.oParent._NGCCARETURN(this.oParent._oPhoneDev.GetCTIParam("",9,this.oParent._arrQueryCTIInfo[1],1));a==CTRL_QueryCTIInfo_ID_10&&this.oParent._NGCCARETURN(this.oParent._oPhoneDev.GetCTIParam("",10,this.oParent._arrQueryCTIInfo[2],1));a==CTRL_QueryCTIInfo_ID_22&&this.oParent._NGCCARETURN(this.oParent._oPhoneDev.GetCTIParam("",22,this.oParent._arrQueryCTIInfo[3],1));a==CTRL_CallQueueQuery_ID&&this.oParent._NGCCARETURN(this.oParent._oPhoneDev.CallQueueQuery(this.oParent._arrQueryCTIInfo[4]));a==CTRL_AnswerPhone_ID&&(this.oParent._oTimer.KillTimer(a),this.oParent._AnswerPhone());if(a==CTRL_GetLogFile_ID){b._oTimer.KillTimer(a);b._oTimer.KillTimer(a);var c=b._oAgentInfo._logHttpCfg.split("|"),d=stringFormat("{0}|{1}|{2}|||-7|not surpported",b._oAgentInfo._agentID,c[0],c[2]);4==c.length?b._UpLoadLogToCTI(b._oAgentInfo._logHttpCfg,function(a){b._NGCCARETURN(b._oPhoneDev.SetCTIParam("",33,a,0))}):b._NGCCARETURN(b._oPhoneDev.SetCTIParam("",33,d,0))}if(a==CTRL_AgentWrapUp_ID){c=b._oPhoneDev._oAcpCall._acpEvent.body.agent.agentStatus;if(4!=c){b._thisCallInfo._timeAgentWrapUp.timeIndex=0;b._thisCallInfo._timeAgentWrapUp.bIninit=0;b._oTimer.KillTimer(a);return}b._thisCallInfo._timeAgentWrapUp.timeIndex+1>=b._thisCallInfo._timeAgentWrapUp.maxTimeOut||getStringTimerInterval(b._thisCallInfo._timeAgentWrapUp.strBeginTime,getAcpTimeString(!1))>b._thisCallInfo._timeAgentWrapUp.maxTimeOut?(b._thisCallInfo._timeAgentWrapUp.timeIndex=0,b._thisCallInfo._timeAgentWrapUp.bIninit=0,b._oTimer.KillTimer(a),3==b._oAgentInfo._idleStatus?b.SetIdle():b.SetBusy(b._oAgentInfo._idleSubStatus)):b._thisCallInfo._timeAgentWrapUp.timeIndex++}if(a==CTRL_ThisAgentWrapUp_ID){c=b._oPhoneDev._oAcpCall._acpEvent.body.agent.agentStatus;if(4!=c){b._thisCallInfo._timeThisAgentWrapUp.timeIndex=0;b._thisCallInfo._timeThisAgentWrapUp.bIninit=0;b._oTimer.KillTimer(a);return}b._thisCallInfo._timeThisAgentWrapUp.timeIndex+1>=b._thisCallInfo._timeThisAgentWrapUp.maxTimeOut||getStringTimerInterval(b._thisCallInfo._timeThisAgentWrapUp.strBeginTime,getAcpTimeString(!1))>b._thisCallInfo._timeThisAgentWrapUp.maxTimeOut?(b._thisCallInfo._timeThisAgentWrapUp.timeIndex=0,b._thisCallInfo._timeThisAgentWrapUp.bIninit=0,b._oTimer.KillTimer(a),3==b._thisCallInfo._thisIdleStatus?b.SetIdle():b.SetBusy(b._thisCallInfo._thisIdleSubStatus)):b._thisCallInfo._timeThisAgentWrapUp.timeIndex++}a==CINNGCCA_SIPDISCTI_ID&&(b._oTimer.KillTimer(a),3==b.GetAgentStatus()&&b._strReleaseSID==b._oPhoneDev._oAcpCall._acpEvent.head.serialID&&b.Disconnect(1))};this._OnRecieveAcpMessage=function(a){var b=a._acpEvent.body.eventTypeName;DisplayLog(VccBar_Log_Debug,stringFormat("JVccBarCenter:_OnRecieveAcpMessage({0},{1})",a._acpEvent.body.eventType,a._acpEvent.body.eventTypeName));switch(a._acpEvent.body.eventType){case ACP_Initial_CONF:if("2"==a._acpEvent.body.datas[0]){var c;try{c=a._acpEvent.body.datas[4].split("|")}catch(e){}this._oAgentInfo._mainIP=c[0];this._oAgentInfo._mainPortID=stringToInt(c[1]);this._oAgentInfo._monitorIP=c[2];this._oAgentInfo._monitorPort=stringToInt(c[3]);this._oAgentInfo._sipServerIP=c[4];this._oAgentInfo._sipServerPort=stringToInt(c[5])}break;case ACP_SignIn_CONF:if(a._msgReceived==MSG_SUCCESS)this._oAgentInfo._isSignIn=!0,this._oAgentInfo._idleStatus=stringToInt(a._acpEvent.body.datas[0],0),this._oAgentInfo._serviceLists=a._acpEvent.body.datas[2],this._oAgentInfo._ggentType=stringToInt(a._acpEvent.body.datas[3],0),this._oAgentInfo._locked=stringToInt(a._acpEvent.body.datas[4],0),this._oAgentInfo._allTimeRecord=stringToInt(a._acpEvent.body.datas[5],0),this._oAgentInfo._deviceType=stringToInt(a._acpEvent.body.datas[6],0),this._oAgentInfo._ctiEvent=a._acpEvent.body.datas[10],this._oAgentInfo._av=stringToInt(a._acpEvent.body.datas[11],0),this._oAgentInfo._timeStamp=a._acpEvent.head.timeStamp,this._oAgentInfo._substatus=a._acpEvent.body.datas[12],this._oAgentInfo._ctiVersion=a._acpEvent.body.datas[17],this._oAgentInfo._exitCause=a._acpEvent.body.datas[16],this._oAgentInfo._loginmode=stringToInt(a._acpEvent.body.datas[13],0),this._oAgentInfo._autoStatusInterval=stringToInt(a._acpEvent.body.datas[14],0),this._oAgentInfo._idleSubStatus=stringToInt(a._acpEvent.body.datas[1],0),this._oAgentInfo._AutoAnswer=stringToInt(a._acpEvent.body.datas[15],0),this._oAgentInfo._agentName=a._acpEvent.body.datas[18],this._FireOnPrompt(4400),this._FireOnEventPrompt(eventidOnSignInSuccess,this._oAgentInfo._av),this._RegisterMonitor(),this._RegisterPhone();else if(a._msgReceived==MSG_FAILURE){this._oAgentInfo.IsSignIn=!1;0!=this._oAgentInfo._appType&&2!=this._oAgentInfo._appType||this._oPhoneDev.CloseStream();if(1==this._oAgentInfo._appType||2==this._oAgentInfo._appType)this._oMonitorDev.CloseStream(),this._oAgentInfo._isMonitorLogin=!1;this._FireOnPrompt(4401,a._acpEvent.body.cause.code);this._FireOnEventPrompt(eventidOnSignInFailure,"");this._FireOnInitalFailure(IE_InitCTIError,"")}break;case ACP_SetIdle_CONF:a._msgReceived==MSG_SUCCESS?(this._FireOnMethodResponseEvent(b,"0"),this._SetBtnStatus(emPhoneIdle,!1)):this._FireOnMethodResponseEvent(b,a._acpEvent.body.cause.code);break;case ACP_SetBusy_CONF:a._msgReceived==MSG_SUCCESS?(this._FireOnMethodResponseEvent(b,"0"),this._SetBtnStatus(emPhoneBusy,!1)):this._FireOnMethodResponseEvent(b,a._acpEvent.body.cause.code);break;case ACP_OnForceOut:case ACP_OnSignOuted:case ACP_SignOut_CONF:if(a._acpEvent.body.eventType==ACP_OnForceOut&&2116==a._acpEvent.body.cause.code){this._oAgentInfo._connectType=1;this._oPhoneDev.SignIn();break}this._SetBtnStatus(emPhoneNULL,!1);c=this._oAgentInfo._isInitial;if(0==this._oAgentInfo._appType||2==this._oAgentInfo._appType)this._oAgentInfo._isInitial=!1,this._oPhoneDev.CloseStream();if(1==this._oAgentInfo._appType||2==this._oAgentInfo._appType)this._oAgentInfo._isMonitorLogin=!1,this._oMonitorDev.CloseStream();this._oAgentInfo._phoneType!=PhoneSip&&this._oAgentInfo._phoneType!=PhoneRemoteSip||this._sipCtrl.ReleasePA();var d=0;a._acpEvent.body.eventType==ACP_OnSignOuted?d=0!=a._acpEvent.body.cause.code?a._acpEvent.body.cause.code:4305:a._acpEvent.body.eventType==ACP_OnForceOut?d=4404:a._msgReceived!=MSG_SUCCESS&&this._FireOnMethodResponseEvent(b,a._acpEvent.body.cause.code);c&&(this._FireOnPrompt(d,""),this._FireOnBarExit(d,""));break;case ACP_AgentReport_CONF:0==a._acpEvent.body.agent.agentStatus&&(this._oAgentInfo._connectType=1,this._oPhoneDev.SignIn());break;case ACP_SetAgentAutoEnterIdle_CONF:case ACP_AgentEnterIdle_CONF:case ACP_SetWrapUp_CONF:case ACP_ForceIdle_CONF:case ACP_ForceBusy_CONF:case ACP_ForceOut_CONF:case ACP_Lock_CONF:case ACP_UnLock_CONF:case ACP_SendDTMF_CONF:case ACP_CallInside_CONF:case ACP_Consultation_CONF:case ACP_CallOutside_CONF:case ACP_SingleStepTransfer_CONF:case ACP_Transfer_CONF:case ACP_SetTransfer_CONF:case ACP_Hold_CONF:case ACP_RetrieveHold_CONF:case ACP_Conference_CONF:case ACP_Alternate_CONF:case ACP_DoReplyMultimeAndHangUpCall_CONF:case ACP_Listen_CONF:case ACP_Help_CONF:case ACP_Intercept_CONF:case ACP_Insert_CONF:case ACP_StopInsert_CONF:case ACP_BeginRecord_CONF:case ACP_StopRecord_CONF:case ACP_BeginPlay_CONF:case ACP_StopPlay_CONF:case ACP_BeginCollect_CONF:case ACP_StopCollect_CONF:case ACP_Bridge_CONF:case ACP_SMMsg_CONF:case ACP_Answer_CONF:case ACP_Mute_CONF:case ACP_SetCallData_CONF:case ACP_ChangeCallQueue_CONF:case ACP_AgentReconnect_CONF:case ACP_WorkReport_CONF:case ACP_SendWeiboMsg_CONF:case ACP_SendMessage_CONF:if(a._acpEvent.body.eventType==ACP_SendMessage_CONF&&"NULL"==this._strExecuteMethod){this._strExecuteMethod="";break}a._msgReceived==MSG_SUCCESS?(this._FireOnMethodResponseEvent(b,"0"),a._acpEvent.body.eventType==ACP_AgentReconnect_CONF&&-2!=this._oAgentInfo._oldWorkStatus&&(this._SetBtnStatus(this._oAgentInfo._oldWorkStatus,!1),this._oAgentInfo._oldWorkStatus=-2,this._RegisterPhone(),this._FireOnPrompt(4007,""),this._oTimer.KillTimer(CTRL_AGENTRECONNECT_ID)),a._acpEvent.body.eventType==ACP_CallOutside_CONF&&this._SetBtnStatus(emPhoneOnCalloutBefore,!1),a._acpEvent.body.eventType==ACP_CallInside_CONF&&this._SetBtnStatus(emPhoneOnCallinBefore,!1)):a._acpEvent.body.eventType==ACP_AgentReconnect_CONF?(this._FireOnPrompt(4008,""),this.UnInitial(4008)):(this._FireOnMethodResponseEvent(b,a._acpEvent.body.cause.code),this._FireOnPrompt(a._acpEvent.body.cause.code));break;case ACP_ReleaseCall_CONF:case ACP_ReleaseCallByCallID_CONF:a._msgReceived==MSG_SUCCESS?this._FireOnMethodResponseEvent(this._strExecuteMethod,"0"):(this._FireOnMethodResponseEvent(this._strExecuteMethod,a._acpEvent.body.cause.code),0!=a._acpEvent.body.cause.code&&this._strReleaseSID==oThis._oPhoneDev._oAcpCall._acpEvent.head.serialID&&oThis._MakeOnReleaseSuccess(),this._FireOnPrompt(a._acpEvent.body.cause.code));this._strExecuteMethod="";break;case ACP_SetCTIParam_CONF:switch(stringToInt(a._acpEvent.body.datas[1],0)){case 6:b="GetTransfer";break;case 3:b="Mute";break;case 2:b="SetCallData";break;case 4:b="SetCTICallOutTask";break;case 7:b="SetTransparentParameter";break;case 30:b="SetWeChatQueueFlag";break;case 26:b="SetActiveService";break;case 25:b="SetForwardNumber";break;case 8:b="SetDisplayNumber";break;case 31:b="SetAgentReservedStatus";break;case 32:b="GetAgentLogFile";break;default:return}a._msgReceived==MSG_SUCCESS?this._FireOnMethodResponseEvent(b,"0"):this._FireOnMethodResponseEvent(b,"-1");break;case ACP_GetCTIParam_CONF:c=stringToInt(a._acpEvent.body.datas[1],0);switch(c){case 6:b="GetTransfer";break;case 4:b="GetCTICallOutTask";break;case 2:b="GetCallData";break;case 20:b="SynchronizeCTITime";break;case 30:b="GetWeChatQueueFlag";break;case 26:b="GetActiveService";break;case 21:b="GetDisplayNumber";break;case 22:b="QueryGroupAgentStatus";break;case 23:b="QueryPreViewCallOutNumbers";break;case 25:b="GetForwardNumber";break;case 8:case 9:case 10:b="QuerySPGroupList";break;default:return}a._msgReceived==MSG_SUCCESS?(d=a._acpEvent.body.datas[2],"1"==a._acpEvent.body.datas[3]&&(d=this.GetDataFromBase64(a._acpEvent.body.datas[2])),"QuerySPGroupList"==b?this._FireOnQuerySPGroupList(c,d):this._FireOnMethodResponseEvent(b,d)):this._FireOnMethodResponseEvent(b,"");break;case ACP_OnAnswerFailure:this._nMonitorFlag=emMonitorNoFlag;this._FireOnEventPrompt(eventidOnAnswerFailure,a._acpEvent.body.cause.code);this._FireOnCallEndEvent(a);break;case ACP_OnConsultationFailure:a=this._oPhoneDev._oAcpCall;b=a.GetAlertDevice();b!=CINVccBar_NULL&&a.DeleteDeviceByID(b.deviceID);this._SetBtnStatus(emPhoneOnConsultFailuer,!1);break;case ACP_OnTransSuccess:this._nMonitorFlag=emMonitorNoFlag;this._FireOnCallEndEvent(a);break;case ACP_OnSingleTransferSuccess:this._nMonitorFlag=emMonitorNoFlag;break;case ACP_OnCallInsideSuccess:this._thisCallInfo._userRingTime=a._acpEvent.head.curtime;a=a.GetAlertDevice();null!=a&&this._FireOnEventPrompt(eventidOnCallInsideSuccess,a.deviceID);this._SetBtnStatus(emPhoneOnCalloutMid,!1);break;case ACP_OnCallInsideFailure:this._SetBtnStatus(emPhoneOnLineOut,!1);this._FireOnEventPrompt(eventidOnCallInsideFailure,"");break;case ACP_OnCallOutsideSuccess:this._thisCallInfo._userRingTime=a._acpEvent.head.curtime;a=a.GetAlertDevice();null!=a&&this._FireOnEventPrompt(eventidOnCallOutsideSuccess,a.deviceID);this._SetBtnStatus(emPhoneOnCalloutMid,!1);break;case ACP_OnCallOutsideFailure:this._SetBtnStatus(emPhoneOnLineOut,!1);this._FireOnEventPrompt(eventidOnCallOutsideFailure,a._acpEvent.body.cause.code);break;case ACP_OnStopRecordSuccess:this._thisCallInfo._endTimer=a._acpEvent.head.curtime;break;case ACP_OnForceRelease:this._nMonitorFlag=emMonitorNoFlag;this._thisCallInfo._endTimer=a._acpEvent.head.curtime;this._FireOnCallEndEvent(a);break;case ACP_OnForceIdle:this._SetBtnStatus(emPhoneIdle);break;case ACP_OnForceBusy:this._SetBtnStatus(emPhoneBusy);break;case ACP_OnAgentAllBusy:this._FireOnPrompt(4457);break;case ACP_OnLocked:this._FireOnPrompt(4405);break;case ACP_OnSystemIdle:a._acpEvent.body.agent.agentStatus==AG_NOT_READY&&this._SetBtnStatus(emPhoneBusy,!1);a._acpEvent.body.agent.agentStatus==AG_READY&&this._SetBtnStatus(emPhoneIdle,!1);break;case ACP_OnConsultationBack:a._acpEvent.body.datas[0]==a._acpEvent.body.callinfo.callingDevice?(this._nMonitorFlag=emMonitorNoFlag,a._acpEvent.body.datas[0]==this._oAgentInfo._dN?this._FireOnCallEndEvent(a):1==a.GetDeviceCount()?a.GetUserNo()==a._acpEvent.body.datas[0]&&a._acpEvent.head.serviceID!=CD_MONITOR_CALLIN&&a._acpEvent.head.serviceID!=CD_INTERCEPT_CALLIN&&a._acpEvent.head.serviceID!=CD_INSERT_CALLIN&&a._acpEvent.head.serviceID!=CD_HELP_CALLIN&&this._FireOnPrompt(4456):2==a.GetDeviceCount()&&(a.GetUserNo()==a._acpEvent.body.datas[0]&&(a._acpEvent.head.serviceID!=CD_MONITOR_CALLIN&&a._acpEvent.head.serviceID!=CD_INTERCEPT_CALLIN&&a._acpEvent.head.serviceID!=CD_INSERT_CALLIN&&a._acpEvent.head.serviceID!=CD_HELP_CALLIN&&this._FireOnPrompt(4456),this._FireOnEventPrompt(203,"")),0!=a.GetAlertDevice()?this._SetBtnStatus(emPhoneOnConsultMid,!1):a.GetHoldDevice()?this._SetBtnStatus(emPhoneHold):this._SetBtnStatus(emPhoneOnLine,!0))):(a=a.GetHoldDevice(),0!=a?(this._SetBtnStatus(emPhoneHold,!1),this._FireOnEventPrompt(eventidOnConsultationBack,"1")):(this._SetBtnStatus(emPhoneOnLine,!1),this._FireOnEventPrompt(eventidOnConsultationBack,"0")));break;case ACP_OnReturnFromPhone:case ACP_OnReturnFromIVR:a._acpEvent.body.datas[0]==a._acpEvent.body.agent.deviceID?(this._SetBtnStatus(emPhoneOnLineOut,!1),a._acpEvent.body.eventType==ACP_OnReturnFromIVR&&this._FireOnEventPrompt(eventidOnReturnFromIVR,"")):(a=a.GetHoldDevice(),0!=a?this._SetBtnStatus(emPhoneHold,!1):this._SetBtnStatus(emPhoneOnLine,!1));break;case ACP_OnReleaseSuccess:this._nMonitorFlag=emMonitorNoFlag;a._acpEvent.body.datas[0]==this._oAgentInfo._dN?(this._thisCallInfo._endTimer=a._acpEvent.head.curtime,this._FireOnCallEndEvent(a)):1==a.GetDeviceCount()?a.GetUserNo()==a._acpEvent.body.datas[0]&&a._acpEvent.head.serviceID!=CD_MONITOR_CALLIN&&a._acpEvent.head.serviceID!=CD_INTERCEPT_CALLIN&&a._acpEvent.head.serviceID!=CD_INSERT_CALLIN&&a._acpEvent.head.serviceID!=CD_HELP_CALLIN&&this._FireOnPrompt(4456):2==a.GetDeviceCount()&&(a.GetUserNo()==a._acpEvent.body.datas[0]&&(a._acpEvent.head.serviceID!=CD_MONITOR_CALLIN&&a._acpEvent.head.serviceID!=CD_INTERCEPT_CALLIN&&a._acpEvent.head.serviceID!=CD_INSERT_CALLIN&&a._acpEvent.head.serviceID!=CD_HELP_CALLIN&&this._FireOnPrompt(4456),this._FireOnEventPrompt(204,"")),0!=a.GetAlertDevice()?this._SetBtnStatus(emPhoneOnConsultMid,!1):a.GetHoldDevice()?this._SetBtnStatus(emPhoneHold):this._SetBtnStatus(emPhoneOnLine,!0));break;case ACP_OnAnswerSuccess:this._thisCallInfo._taskID=a._acpEvent.body.datas[0];this._thisCallInfo._transParentParamet=a._acpEvent.body.datas[1];this._thisCallInfo._authority=a._acpEvent.body.datas[2];this._FireAnswerCallEvent(a);a._acpEvent.head.serviceID==CD_AGENT_OUTSIDE_CALLOUT||a._acpEvent.head.serviceID==CD_PREVIEW_CALLOUT?(b=a.GetDeviceByDeviceID(a._acpEvent.body.callinfo.calledDevice),0!=b?b.phonestatus!=CS_CONFERENCED?this._SetBtnStatus(emPhoneOnCallouting,!1):this._SetBtnStatus(emPhoneOnLine,!this._thisCallInfo._bOrigated):this._SetBtnStatus(emPhoneOnLine,!this._thisCallInfo._bOrigated)):a._acpEvent.head.serviceID==CD_AGENT_INSIDE_CALLOUT?(b=a.GetDeviceByDeviceID(a._acpEvent.body.callinfo.calledDevice),0!=b?b.phonestatus!=CS_CONFERENCED?this._SetBtnStatus(emPhoneOnCallouting,!1):this._SetBtnStatus(emPhoneOnLine,!this._thisCallInfo._bOrigated):this._SetBtnStatus(emPhoneOnLine,!this._thisCallInfo._bOrigated)):this._SetBtnStatus(emPhoneOnLine,!this._thisCallInfo._bOrigated);break;case ACP_OnCallInsideSuccTalk:this._FireAnswerCallEvent(a);this._SetBtnStatus(emPhoneOnLine,!1);this._FireOnEventPrompt(eventidOnCallInsideSuccTalk,a.GetUserNo());break;case ACP_OnCallOutsideSuccTalk:this._FireAnswerCallEvent(a);this._SetBtnStatus(emPhoneOnLine,!1);this._FireOnEventPrompt(eventidOnCallOutsideSuccTalk,a.GetUserNo());break;case ACP_OnConsultationSuccess:if(2==a._acpEvent.body.callinfo.count){this._SetBtnStatus(emPhoneOnLine);break}this._SetBtnStatus(emPhoneOnLineConsult,!0);for(b=0;b<a._acpEvent.body.callinfo.count;b++)if(c=a._acpEvent.body.callinfo.device[b],c.deviceID!=this._oAgentInfo._dN&&c!=a.GetHoldDevice()){this._FireOnEventPrompt(202,c.deviceID);break}break;case ACP_OnHoldSuccess:this._SetBtnStatus(emPhoneHold,!1);break;case ACP_OnRetrieveHoldSuccess:this._SetBtnStatus(emPhoneOnLine,!0);break;case ACP_OnConferenceSuccess:this._SetBtnStatus(emPhoneOnLineConference,!0);a=this._oPhoneDev._oAcpCall;if(2>=a.GetDeviceCount())break;for(c=0;c<a._acpEvent.body.callinfo.count;c++)if(b=a._acpEvent.body.callinfo.device[c].deviceID,b!=this._oAgentInfo._dN&&b!=a._acpEvent.body.callinfo.calledDevice&&b!=a._acpEvent.body.callinfo.callingDevice){this._strExecuteMethod="NULL";this.SendIMMessage(b,"","",0,2,"$#CONFERENCENOTIFY#$");break}break;case ACP_OnConferenceSucTalk:this._SetBtnStatus(emPhoneOnLineConference,!1);break;case ACP_OnListenSuccess:this._nMonitorFlag=emListenFlag;this._SetBtnStatus(emPhoneListen);break;case ACP_OnHelpSuccess:this._nMonitorFlag=emHelpFlag;this._SetBtnStatus(emPhoneHelp);break;case ACP_OnInsertSuccess:this._nMonitorFlag=emInsertFlag;this._SetBtnStatus(emPhoneInsert);break;case ACP_OnInterceptSuccess:this._nMonitorFlag=emInterceptFlag;this._SetBtnStatus(emPhoneIncept);break;case ACP_OnInserted:this._SetBtnStatus(emPhoneOnLine);break;case ACP_OnBridgeSuccess:this._SetBtnStatus(emPhoneOnBridge);break;case ACP_OnTransferred:this._SetBtnStatus(emPhoneOnLine,!0);break;case ACP_OnOrigated:this._thisCallInfo._bOrigated=!0;this._thisCallInfo._alertTime=a._acpEvent.head.curtime;this._thisCallInfo._ringTime=a._acpEvent.head.curtime;this._FireOnRingCallEvent(a);this._SetBtnStatus(emPhoneOrigated,!1);break;case ACP_OnBeginRecordSuccess:this._thisCallInfo._strRecordFile=a._acpEvent.body.datas[0];this._thisCallInfo._strRecordServer=a._acpEvent.body.datas[1];this._thisCallInfo._strNetworkInfo=a._acpEvent.body.datas[2];break;case ACP_OnAnswerRequest:this._FireOnRingCallEvent(a);break;case ACP_OnCallQueueQuery:this._invokeEvent(eventOnCallQueueQuery,a._acpEvent.body.datas[0]);break;case ACP_OnBeginSendDTMFSuccess:this._FireOnEventPrompt(eventidOnBeginSendDTMFSuccess,a._acpEvent.body.datas[0]);break;case ACP_OnBeginSendDTMFFailure:this._FireOnEventPrompt(eventidOnBeginSendDTMFFailure,a._acpEvent.body.datas[0]);break;case ACP_OnBeginPlaySuccess:this._FireOnEventPrompt(eventidOnBeginPlaySuccess,a._acpEvent.body.datas[0]);break;case ACP_OnBeginPlayFailure:this._FireOnEventPrompt(eventidOnBeginPlayFailure,a._acpEvent.body.datas[0]);break;case ACP_OnStopPlaySuccess:this._FireOnEventPrompt(eventidOnStopPlaySuccess,a._acpEvent.body.datas[0]);break;case ACP_OnStopPlayFailure:this._FireOnEventPrompt(eventidOnStopPlayFailure,a._acpEvent.body.datas[0]);break;case ACP_OnBeginCollectSuccess:this._FireOnEventPrompt(eventidOnBeginCollectSuccess,a._acpEvent.body.datas[0]);break;case ACP_OnBeginCollectFailure:this._FireOnEventPrompt(eventidOnBeginCollectFailure,a._acpEvent.body.datas[0]);break;case ACP_OnStopCollectSuccess:this._FireOnEventPrompt(eventidOnStopCollectSuccess,a._acpEvent.body.datas[0]);break;case ACP_OnStopcollectFailure:this._FireOnEventPrompt(eventidOnStopCollectFailure,a._acpEvent.body.datas[0]);break;case ACP_OnQueueReport:this._FireOnQueueReport(a._acpEvent.body.datas[0]);break;case ACP_OnSystemMessage:if("3"==a._acpEvent.body.datas[0]&&"0"==a._acpEvent.body.datas[2]&&"$#CONFERENCENOTIFY#$"==a._acpEvent.body.datas[3]&&2==this._oPhoneDev._oAcpCall.GetDeviceCount()){this._FireOnEventPrompt(205,"");break}this._FireOnSystemMessage(a._acpEvent.body.datas[0],a._acpEvent.body.datas[1],a._acpEvent.body.datas[2],a._acpEvent.body.datas[3]);break;case ACP_OnAgentBusyReason:this._invokeEvent(eventOnAgentBusyReasonReport,stringFormat("{0}|{1}",a._acpEvent.body.datas[0],a._acpEvent.body.datas[1]));this._SetBtnStatus(emPhoneBusy,!1);break;case ACP_OnAsrEventReport:this._invokeEvent(eventOnAsrEventReport,stringFormat("{0}|{1}|{2}|{3}",a._acpEvent.body.datas[0],a._acpEvent.body.datas[1],a._acpEvent.body.datas[4],a._acpEvent.body.datas[5]));break;case ACP_OnStopSmSuccess:this._invokeEvent(eventOnStopSmSuccess,a._acpEvent.body.datas[1]);break;case ACP_OnStaticInfoReport:this._FireOnWorkStaticInfoReport(a._acpEvent.body.datas[0])}};this._OnAcpMessageOutTime=function(a){};this._OnAcpMessageInvoke=function(a){};this._FireOnRingCallEvent=function(a){this._thisCallInfo._alertTime=a._acpEvent.head.curtime;this._thisCallInfo._thisAutoStatusInteval=stringToInt(a._acpEvent.body.datas[0],0);this._thisCallInfo._thisIdleStatus=stringToInt(a._acpEvent.body.datas[1],0);this._thisCallInfo._thisIdleSubStatus=stringToInt(a._acpEvent.body.datas[2],0);this._thisCallInfo._alertingDevice=a._acpEvent.body.datas[3];this._thisCallInfo._taskID=a._acpEvent.body.datas[4];this._thisCallInfo._transParentParamet=a._acpEvent.body.datas[5];this._thisCallInfo._authority=a._acpEvent.body.datas[6];this._thisCallInfo._areaCode=a._acpEvent.body.datas[7];this._thisCallInfo._fileName=a._acpEvent.body.datas[8];this._thisCallInfo._networkInfo=a._acpEvent.body.datas[9];this._thisCallInfo._queueTime=a._acpEvent.body.datas[10];this._thisCallInfo._thisAutoAnswer=stringToInt(a._acpEvent.body.datas[11],0);this._thisCallInfo._projectID=a._acpEvent.body.datas[12];var b=a.GetAlertDevice();if(0!=b&&this._oAgentInfo._dN==b.deviceID){this._thisCallInfo._ringTime=a._acpEvent.head.curtime;this._FireOnCallRing(a._acpEvent.body.callinfo.callingDevice,a._acpEvent.body.callinfo.calledDevice,a._acpEvent.body.callinfo.orgCalledDevice,a._acpEvent.body.callinfo.callData,a._acpEvent.head.serialID,a._acpEvent.head.serviceID,a._acpEvent.head.sessionID,this._thisCallInfo._transParentParamet,this._thisCallInfo._taskID,a.GetPartenerNum(),this._oAgentInfo._dN,this._thisCallInfo._areaCode,this._thisCallInfo._fileName,this._thisCallInfo._networkInfo,this._thisCallInfo._queueTime,a._acpEvent.body.callinfo.opAgentID,this._thisCallInfo._ringTime,this._thisCallInfo._projectID);this._SetBtnStatus(emPhoneAlerting,!1);var c=a._acpEvent.head.serviceID;if(1==this._oAgentInfo._dN._thisAutoAnswer||1==this._oAgentInfo._autoAnswer||c==CD_AGENT_OUTSIDE_CALLOUT&&1==a.GetDirection()||c==CD_AGENT_INSIDE_CALLOUT&&1==a.GetDirection()||c==CD_PREVIEW_CALLOUT&&1==a.GetDirection()||c==CD_SERVRE_EXACT_CALLOUT||c==CD_STEPBYSTEP_CALLOUT||c==CD_FORECAST_CALLOUT||c==CD_EXACT_PREVIEW_CALLOUT)DisplayLog(VccBar_Log_Info,"\u632f\u94c3\uff1a\u81ea\u52a8\u63a5\u901a"),c!=CD_AGENT_OUTSIDE_CALLOUT&&c!=CD_AGENT_INSIDE_CALLOUT&&c!=CD_PREVIEW_CALLOUT&&c!=CD_EXACT_PREVIEW_CALLOUT?this._oTimer.SetTimer(CTRL_AnswerPhone_ID,5E3):this._AnswerPhone()}3==a.GetDeviceCount()&&0!=a.GetHoldDevice()&&(a.GetServiceDirect()!=CD_BRIDGE_CALLOUT&&this._SetBtnStatus(emPhoneOnConsultMid,!1),0!=b&&this._FireOnEventPrompt(201,b.deviceID))};this._FireAnswerCallEvent=function(a){this._thisCallInfo._answerTimer=a._acpEvent.head.curtime;this._thisCallInfo._userNo=a.GetUserNo();switch(a._acpEvent.body.eventType){case ACP_OnAnswerSuccess:if(a.GetCallScene()==CST_MAKECALL&&!this._thisCallInfo._bOrigated&&a._acpEvent.head.serviceID!=CD_MONITOR_CALLIN&&a._acpEvent.head.serviceID!=CD_INTERCEPT_CALLIN&&a._acpEvent.head.serviceID!=CD_INSERT_CALLIN&&a._acpEvent.head.serviceID!=CD_HELP_CALLIN)return;break;case ACP_OnCallInsideSuccTalk:case ACP_OnCallOutsideSuccTalk:break;default:return}this._FireOnCallConnectd(this._thisCallInfo._userNo,this._thisCallInfo._answerTimer,a._acpEvent.head.serialID,a._acpEvent.head.serviceID,a._acpEvent.head.sessionID,this._thisCallInfo._transParentParamet,this._thisCallInfo._taskID)};this._FireOnCallEndEvent=function(a){DisplayLog(VccBar_Log_Debug,stringFormat("ringTime:{0} UserRingTime:{1} answerTimer:{2} endTimer:{3}",this._thisCallInfo._ringTime,this._thisCallInfo._userRingTime,this._thisCallInfo._answerTimer,this._thisCallInfo._endTimer));var b=this._thisCallInfo._strRecordFile,c,d;d=c="";var e=b.lastIndexOf("/");0<e&&(c=b.substr(e,b.length-e+1),d=b.substr(0,e));switch(a._acpEvent.body.eventType){case ACP_OnAnswerFailure:case ACP_OnReleaseSuccess:case ACP_OnTransSuccess:case ACP_OnForceRelease:case ACP_OnSingleTransferSuccess:break;default:return}this._strReleaseSID="";b=stringFormat("{0}",getStringTimerInterval(this._thisCallInfo._ringTime,this._thisCallInfo._answerTimer));e=stringFormat("{0}",getStringTimerInterval(this._thisCallInfo._userRingTime,this._thisCallInfo._answerTimer));this._FireOnCallEnd(a._acpEvent.head.sessionID,a._acpEvent.head.serialID,a._acpEvent.head.serviceID,this._thisCallInfo._userNo,this._thisCallInfo._answerTimer,""==this._thisCallInfo._answerTimer?"":this._thisCallInfo._endTimer,b,e,c,d,0,this._thisCallInfo._transParentParamet,this._thisCallInfo._taskID,this._thisCallInfo._strRecordServer,this._thisCallInfo._strNetworkInfo);this._FireOnCdrReportInfo(a);this._thisCallInfo.ReleaseInfo();this._SetBtnStatus(emPhoneOnLineOut,!1)};this._FireOnCallRing=function(a,b,c,d,e,f,g,h,k,l,n,p,m,q,r,t,u,v){this._invokeEvent(eventOnCallRing,stringFormat("{0}|{1}|{2}|{3}|{4}|{5}|{6}|{7}|{8}|{9}|{10}|{11}|{12}|{13}|{14}|{15}|{16}|{17}",a,b,c,d,e,f,g,h,k,l,n,p,m,q,r,t,u,v))};this._FireOnCallConnectd=function(a,b,c,d,e,f,g){this._invokeEvent(eventOnAnswerCall,stringFormat("{0}|{1}|{2}|{3}|{4}|{5}|{6}",a,b,c,d,e,f,g))};this._FireOnCallEnd=function(a,b,c,d,e,f,g,h,k,l,n,p,m,q,r){this._oAgentInfo._phoneType!=PhoneSip&&this._oAgentInfo._phoneType!=PhoneRemoteSip||null==this._sipCtrl||this._sipCtrl.Disconnect();this._invokeEvent(eventOnCallEnd,stringFormat("{0}|{1}|{2}|{3}|{4}|{5}|{6}|{7}|{8}|{9}|{10}|{11}|{12}|{13}|{14}",a,b,c,d,e,f,g,h,k,l,n,p,m,q,r))};this._FireOnCdrReportInfo=function(a){reportInfo=a._acpEvent.body.reportinfo;""==reportInfo.callid?this._invokeEvent(eventOnCallCdrReport,stringFormat("{0}|{1}|{2}|{3}|{4}|{5}|{6}|{7}|{8}|{9}|{10}|{11}|{12}|{13}|{14}|{15}",a._acpEvent.head.sessionID,a._acpEvent.head.serialID,this._thisCallInfo._userNo,1==a.GetDirection()?2:1,this._thisCallInfo._taskID,"",this._thisCallInfo._answerTimer,this._thisCallInfo._ringTime,this._thisCallInfo._answerTimer,"",getStringTimerInterval(this._thisCallInfo._ringTime,this._thisCallInfo._answerTimer),0,""==this._thisCallInfo._answerTimer?"0":"1",this._thisCallInfo._strRecordFile,this._thisCallInfo._strRecordServer,"")):this._invokeEvent(eventOnCallCdrReport,stringFormat("{0}|{1}|{2}|{3}|{4}|{5}|{6}|{7}|{8}|{9}|{10}|{11}|{12}|{13}|{14}|{15}",reportInfo.callid,reportInfo.sid,reportInfo.usernumber,reportInfo.direction,reportInfo.serviceid,reportInfo.detail,reportInfo.starttime,reportInfo.ringtime,reportInfo.answertime,reportInfo.endtime,reportInfo.ringseconds,reportInfo.answerseconds,reportInfo.answerflag,reportInfo.srfmsgid,reportInfo.msserver,reportInfo.callrescode))};this._FireOnPrompt=function(a,b){"undefined"==typeof b&&(b="");this._invokeEvent(eventOnPrompt,stringFormat("{0}|{1}",a,b))};this._FireOnReportBtnStatus=function(a){this._invokeEvent(eventOnReportBtnStatus,a)};this._FireOnInitalSuccess=function(){if(1!=this._oAgentInfo._isInitial){var a=1==this._oAgentInfo._appType||2==this._oAgentInfo._appType,b=this._oAgentInfo._phoneType==PhoneSip||this._oAgentInfo._phoneType==PhoneRemoteSip,c=0==this._oAgentInfo._appType||2==this._oAgentInfo._appType,a=a?a&&this._oAgentInfo._isMonitorLogin:1,b=b?b&&this._oAgentInfo._sipRegisted:1,c=c?c&&this._oAgentInfo._isSignIn:1;a&&b&&c&&(this._FireOnPrompt(4410),this._oAgentInfo._isInitial=!0,this._SetBtnStatus(emPhoneLogin,!1),0==this._oAgentInfo._connectType&&this._invokeEvent(eventOnInitalSuccess,""),this._oAgentInfo._connectType=0)}};this._FireOnInitalFailure=function(a,b){this._oAgentInfo._isInitial=!1;this._oAgentInfo._isSignIn=!1;0==this._oAgentInfo._connectType&&this._invokeEvent(eventOnInitalFailure,stringFormat("{0}|{1}",a,b));this._oAgentInfo._connectType=0};this._FireOnEventPrompt=function(a,b){this._invokeEvent(eventOnEventPrompt,stringFormat("{0}|{1}",a,b))};this._FireOnAgentWorkReport=function(a,b){this._oAgentInfo._workstatus=a;this._invokeEvent(eventOnAgentWorkReport,stringFormat("{0}|{1}",a,b))};this._FireOnCallDataChanged=function(a){this._invokeEvent(eventOnCallDataChanged,a)};this._FireOnBarExit=function(a,b){this._oAgentInfo._isInitial=!1;this._oAgentInfo._isSignIn=!1;this._invokeEvent(eventOnBarExit,stringFormat("{0}|{1}",a,b))};this._FireOnSystemMessage=function(a,b,c,d){"1"==a?this._FireOnCallDataChanged(c):"2"==a?this._invokeEvent(eventOnSystemMessage,"2|"+c):"3"==a?"0"==c?this._invokeEvent(eventOnIMMessage,"0|"+d):this._invokeEvent(eventOnIMMessage,"1|"+d):"4"==a?(this._oAgentInfo._logHttpCfg=c,this._oTimer.SetTimer(CTRL_GetLogFile_ID,1E3)):"5"==a?(a=c.split("|"),7==a.length&&this._invokeEvent(eventOnAgentLogUploadReport,a[1]+"|"+a[2]+"|"+a[3]+"|"+a[4]+"|"+a[5]+"|"+a[6])):"22"==a&&this._invokeEvent(eventOnQueryGroupAgentStatus,c+"@"+d)};this._FireOnWorkStaticInfoReport=function(a){this._invokeEvent(eventOnWorkStaticInfoReport,a)};this._FireOnQueueReport=function(a){this._invokeEvent(eventOnQueueReport,a)};this._FireOnQuerySPGroupList=function(a,b){this._invokeEvent(eventOnAQueryCTIInfoReport,a+"|"+b)};this._FireOnMethodResponseEvent=function(a,b){null!=this._methodCallBackFunction&&"AgentReconnect"!=a&&"AgentReport"!=a&&this._methodCallBackFunction(a,b)};this._invokeEvent=function(a,b){null!=this._eventCallBackFunction&&this._eventCallBackFunction(a,b)};this._OnSipEventOnRing=function(a){DisplayLog(VccBar_Log_Info,"OnBarSipEventOnRing")};this._OnSipEventOnOrigated=function(){DisplayLog(VccBar_Log_Info,"OnBarSipEventOnOrigated")};this._OnSipEventOnDisconnected=function(){DisplayLog(VccBar_Log_Info,"OnBarSipEventOnDisconnected");var a=this.oParent;3==a.GetAgentStatus()&&(a._strReleaseSID=a._oPhoneDev._oAcpCall._acpEvent.head.serialID,a._oTimer.SetTimer(CINNGCCA_SIPDISCTI_ID,100*CINNGCCA_SIPDISCTI_INTERVAL))};this._OnSipEventOnConnected=function(a){DisplayLog(VccBar_Log_Info,"OnBarSipEventOnConnected")};this._OnSipEventOnError=function(a,b){DisplayLog(VccBar_Log_Error,stringFormat("OnBarSipEventOnError({0},{1})",a,b))};this._OnSipEventOnLoginSuccess=function(){DisplayLog(VccBar_Log_Info,"OnBarSipEventOnLoginSuccess");var a=this.oParent;a._FireOnPrompt(4361);a._oAgentInfo._sipRegisted=!0;a._oAgentInfo._phoneType!=PhoneSip&&a._oAgentInfo._phoneType!=PhoneRemoteSip||0!=a._oAgentInfo._isInitial||a._FireOnInitalSuccess()};this._OnSipEventOnLoginFailure=function(a,b){DisplayLog(VccBar_Log_Info,stringFormat("OnBarSipEventOnLoginFailure({0},{1})",a,b));var c=this.oParent;c._oAgentInfo._sipRegisted=!1;if(c._oAgentInfo._phoneType==PhoneSip||c._oAgentInfo._phoneType==PhoneRemoteSip){c._oAgentInfo.IsSignIn=!1;0!=c._oAgentInfo._appType&&2!=c._oAgentInfo._appType||c.UnInitial();if(1==c._oAgentInfo._appType||2==c._oAgentInfo._appType)c._oMonitorDev.CloseStream(),c._oAgentInfo._isMonitorLogin=!1;c._FireOnPrompt(4316,a+":"+b);c._FireOnInitalFailure(IE_InitSIPError,"")}};this._OnSipEventOnLogoutSuccess=function(){DisplayLog(VccBar_Log_Info,"OnBarSipEventOnLogoutSuccess");var a=this.oParent;a._oAgentInfo._sipRegisted=!1;a._sipCtrl=null};this._OnSipEventDebug=function(a){DisplayLog(VccBar_Log_Debug,"OnBarSipEventDebug:"+a)};this.Initial=function(){if(this._oAgentInfo._isInitial||this._oAgentInfo._isSignIn)return CINVccBar_FAILURE;var a=CINVccBar_FAILURE;if(0==this._oAgentInfo._appType||2==this._oAgentInfo._appType)a=this._oPhoneDev.OpenStream(this._oAgentInfo._mainIP,this._oAgentInfo._mainPortID,!0),1<a&&(this._FireOnPrompt(a,""),this._FireOnPrompt(4401,a),this._FireOnInitalFailure(IE_InitCTIError),a=-1);else if(1==this._oAgentInfo._appType||2==this._oAgentInfo._appType)a=this._RegisterMonitor();return a};this.SerialBtn=function(a,b){this._oAgentInfo._btnIDS=a;this._oAgentInfo._btnMaskIDS=b;this._oPhoneStatus.SetShowBtns(this._oAgentInfo._btnIDS,this._oAgentInfo._btnMaskIDS)};this.GetBtnStatus=function(a){return this._GetBtnIDs()};this.Configurate=function(a){return CINVccBar_NOT_IMPL};this.GetConfiguration=function(){return CINVccBar_NOT_IMPL};this.UnInitial=function(a){0==this._oAgentInfo._appType||2==this._oAgentInfo._appType?this._oAgentInfo._isSignIn&&this._oPhoneDev.SignOut(a):1!=this._oAgentInfo._appType&&2!=this._oAgentInfo._appType||this._oMonitorDev.CloseStream();return CINVccBar_SUCCESS};this.SetUIStyle=function(a){return CINVccBar_NOT_IMPL};this.GetVersion=function(){return CINVccBar_VERSION};this.SetBusy=function(a){return this._IsMethodEnable("SetBusy",emBtnSetBusy)?this._NGCCARETURN(this._oPhoneDev.SetBusy(a)):CINVccBar_FAILURE};this.SetIdle=function(){return this._IsMethodEnable("SetIdle",emBtnSetIdle)?this._NGCCARETURN(this._oPhoneDev.SetIdle()):CINVccBar_FAILURE};this.SetWrapUp=function(){return this._IsInitial("SetWrapUp")?this._oPhoneDev._oAcpCall.GetAgentStatus()==AG_NOT_READY||this._oPhoneDev._oAcpCall.GetAgentStatus()==AG_READY?this._NGCCARETURN(this._oPhoneDev.SetWrapUp()):CINVccBar_FAILURE:CINVccBar_FAILURE};this.SetCTICalloutTask=function(a){this._oAgentInfo._taskID=a;return this._IsInitial("SetCTICalloutTask")?this._NGCCARETURN(this._oPhoneDev.SetCTIParam("",4,this._oAgentInfo._taskID)):CINVccBar_FAILURE};this.GetCTICalloutTask=function(){return this._IsInitial("GetCTICalloutTask")?this._NGCCARETURN(this._oPhoneDev.GetCTIParam("",4)):CINVccBar_FAILURE};this.GetCallData=function(a){return this._IsInitial("GetCallData")?""==a&&(a=this._oPhoneDev._oAcpCall,a._acpEvent.body.agent.phoneStatus==CS_ALERTING||a.GetCallScene()==CST_IVR)?a._acpEvent.body.callinfo.callData:this._NGCCARETURN(this._oPhoneDev.GetCTIParam("",2,"")):CINVccBar_FAILURE};this.SetCallData=function(a,b){return this._IsInitial("SetCallData")?this._NGCCARETURN(this._oPhoneDev.SetCTIParam(a,2,b)):CINVccBar_FAILURE};this.GetTransfer=function(){return CINVccBar_NOT_IMPL};this.SetTransfer=function(a,b,c){return CINVccBar_NOT_IMPL};this.ChangeCallQueue=function(a,b,c){return this._IsInitial("ChangeCallQueue")?this._NGCCARETURN(this._oPhoneDev.ChangeCallQueue(a,b,c)):CINVccBar_FAILURE};this.GetCallID=function(){return this._IsInitial("GetCallID")?this._oPhoneDev._oAcpCall.GetCallID():CINVccBar_EMPTY_STRING};this.QuerySPGroupList=function(a,b,c,d,e,f){if(!this._IsInitial("QuerySPGroupList"))return CINVccBar_FAILURE;var g=-1;"undefined"==typeof c&&(c=9);"undefined"==typeof d&&(d=0);"undefined"==typeof e&&(e=2);"undefined"==typeof f&&(f=0);if(8!=c&&9!=c&&10!=c)return alert("\u9519\u8bef\u53c2\u6570!"),g;var h=CTRL_QueryCTIInfo_ID_8;9==c&&(h=CTRL_QueryCTIInfo_ID_9);10==c&&(h=CTRL_QueryCTIInfo_ID_10);1==e?(this._oTimer.KillTimer(h),g=0):0==e?(a=stringFormat("{0}|{1}|{2}",a,b,d),g=this._NGCCARETURN(this._oPhoneDev.GetCTIParam("",c,a,1)),0<f&&(this._oTimer.SetTimer(h,1E3*f),8==c&&(this._arrQueryCTIInfo[0]=""),9==c&&(this._arrQueryCTIInfo[1]=a),10==c&&(this._arrQueryCTIInfo[2]=a))):2==e&&(a=stringFormat("{0}|{1}|{2}",a,b,d),g=this._NGCCARETURN(this._oPhoneDev.GetCTIParam("",c,a,1)));return g};this.GetCallInfo=function(){return this._IsInitial("GetCallInfo")?this._oPhoneDev._oAcpCall.GetCallInfoString():CINVccBar_EMPTY_STRING};this.SetTransparentParameter=function(a){return this._IsInitial("SetTransparentParameter")?this._NGCCARETURN(this._oPhoneDev.SetCTIParam("",7,a)):CINVccBar_FAILURE};this.GetAgentStatus=function(){return this._oAgentInfo._isInitial?this._oPhoneDev._oAcpCall._acpEvent.body.agent.agentStatus:CINVccBar_FAILURE};this.GetAgentSubBusyStatus=function(){return this._oAgentInfo._isInitial?this._oPhoneDev._oAcpCall._acpEvent.body.agent.agentSubStatus:CINVccBar_FAILURE};this.GetBusySubStatus=function(){return this._oAgentInfo._isInitial?this._oAgentInfo._substatus:CINVccBar_EMPTY_STRING};this.SetDisplayNumber=function(a){return this._IsInitial("SetDisplayNumber")?this._NGCCARETURN(this._oPhoneDev.SetCTIParam("",8,a)):CINVccBar_FAILURE};this.GetDisplayNumber=function(){return this._IsInitial("GetDisplayNumber")?this._NGCCARETURN(this._oPhoneDev.GetCTIParam("",21,"")):CINVccBar_FAILURE};this.CallQueueQuery=function(a,b,c){if(!this._IsInitial("CallQueueQuery"))return CINVccBar_FAILURE;var d=-1;"undefined"==typeof b&&(b=2);"undefined"==typeof c&&(c=0);1==b?(this._oTimer.KillTimer(CTRL_CallQueueQuery_ID),d=0):0==b?(d=this._NGCCARETURN(this._oPhoneDev.CallQueueQuery(a)),0<c&&(this._oTimer.SetTimer(CTRL_CallQueueQuery_ID,1E3*c),this._arrQueryCTIInfo[4]=a)):2==b&&(d=this._NGCCARETURN(this._oPhoneDev.CallQueueQuery(a)));return d};this.QueryGroupAgentStatus=function(a,b,c,d){if(!this._IsInitial("QueryGroupAgentStatus"))return CINVccBar_FAILURE;var e=-1;"undefined"==typeof b&&(b=2);"undefined"==typeof c&&(c=0);"undefined"==typeof d&&(d=0);1==b?(this._oTimer.KillTimer(CTRL_QueryCTIInfo_ID_22),e=0):0==b&&(a=stringFormat("{0}|{1}",a,d),e=this._NGCCARETURN(this._oPhoneDev.GetCTIParam("",22,a,1)),0<c&&(this._oTimer.SetTimer(CTRL_QueryCTIInfo_ID_22,1E3*c),this._arrQueryCTIInfo[3]=a));return e};this.QueryPreViewCallOutNumbers=function(a,b,c,d){return this._IsInitial("QueryPreViewCallOutNumbers")?this._NGCCARETURN(this._oPhoneDev.GetCTIParam("",23,stringFormat("{0}|{1}|{2}|{3}",a,b,c,d))):CINVccBar_FAILURE};this.GetBase64Data=function(a){return GetBase64FromGBK(a)};this.GetDataFromBase64=function(a){return GetGBKFromBase64(a)};this.SetWeChatQueueFlag=function(a){return this._IsInitial("SetWeChatQueueFlag")?this._NGCCARETURN(this._oPhoneDev.SetCTIParam("",30,a)):CINVccBar_FAILURE};this.GetWeChatQueueFlag=function(){return this._IsInitial("GetWeChatQueueFlag")?this._NGCCARETURN(this._oPhoneDev.GetCTIParam("",30,"")):CINVccBar_FAILURE};this.TransferCallQueue=function(a,b,c){return this._IsInitial("TransferCallQueue")?this._NGCCARETURN(this._oPhoneDev.TransferCallQueue(a,b,c)):CINVccBar_FAILURE};this.SetActiveService=function(a){return this._IsInitial("SetActiveService")?this._NGCCARETURN(this._oPhoneDev.SetCTIParam("",26,a)):CINVccBar_FAILURE};this.GetActiveService=function(){return this._IsInitial("GetActiveService")?this._NGCCARETURN(this._oPhoneDev.GetCTIParam("",26,"")):CINVccBar_FAILURE};this.GetExitCause=function(){return this._oAgentInfo._exitCause};this.SetForwardNumber=function(a,b){return this._IsInitial("SetForwardNumber")?this._NGCCARETURN(this._oPhoneDev.SetCTIParam("",25,stringFormat("{0}|{1}",a,b))):CINVccBar_FAILURE};this.GetForwardNumber=function(){return this._IsInitial("GetForwardNumber")?this._NGCCARETURN(this._oPhoneDev.GetCTIParam("",25,"")):CINVccBar_FAILURE};this.SetAgentReservedStatus=function(a,b){return this._IsInitial("SetAgentReservedStatus")?this._NGCCARETURN(this._oPhoneDev.SetCTIParam("",31,stringFormat("{0}|{1}",a,b))):CINVccBar_FAILURE};this.GetAgentLogFile=function(a,b,c){return this._IsInitial("GetAgentLogFile")?this._NGCCARETURN(this._oPhoneDev.SetCTIParam("",32,stringFormat("{0}|{1}|{2}|{3}",this._oAgentInfo._agentID,a,b,c))):CINVccBar_FAILURE};this.GetMonitorStatus=function(){return this._oAgentInfo._isMonitorLogin};this.MakeCall=function(a,b,c,d,e,f,g,h){if(!this._IsMethodEnable("MakeCall",emBtnMakeCall))return CINVccBar_FAILURE;if(""==a)return this._FireOnPrompt(4312),CINVccBar_FAILURE;a=formatCallNum(a);b=getDefaultParam(b);""==b&&(b=CD_PREVIEW_CALLOUT);b!=CD_PREVIEW_CALLOUT&&b!=CD_AGENT_OUTSIDE_CALLOUT&&(ServiceID=CD_PREVIEW_CALLOUT);"undefined"==typeof c&&(c="");"undefined"==typeof d&&(d="");"undefined"==typeof e&&(e="");"undefined"==typeof f&&(f="");"undefined"==typeof g&&(g=0);"undefined"==typeof h&&(h="");return this._NGCCARETURN(this._oPhoneDev.CallOutside(a,this._oAgentInfo._dN,c,d,e,b,f,g,h))};this.CallIn=function(a,b,c,d){if(!this._IsMethodEnable("CallIn",emBtnMakeCall))return CINVccBar_FAILURE;if(""==a)return this._FireOnPrompt(4312),CINVccBar_FAILURE;getDefaultParam(b);b=CD_AGENT_INSIDE_CALLOUT;"undefined"==typeof c&&(c="");"undefined"==typeof d&&(d="");return this._NGCCARETURN(this._oPhoneDev.CallInside(a,c,d,b))};this.TransferOut=function(a,b){if(!this._IsMethodEnable("TransferOut",emBtnTransferOut))return CINVccBar_FAILURE;if(""==b)return this._FireOnPrompt(4312),CINVccBar_FAILURE;var c=this._oPhoneDev._oAcpCall;if(2!=c.GetDeviceCount())return CINVccBar_FAILURE;for(var d="",e=0;e<c._acpEvent.body.callinfo.count;e++)if(c._acpEvent.body.callinfo.device[e].deviceID!=this._oAgentInfo._dN){d=c._acpEvent.body.callinfo.device[e].deviceID;break}return this._NGCCARETURN(this._oPhoneDev.SingleStepTransfer(b,a,d))};this.Hold=function(){if(!this._IsMethodEnable("Hold",emBtnHold))return CINVccBar_FAILURE;var a=this._oPhoneDev._oAcpCall,b=a.GetUserDevice();if(b!=CINVccBar_NULL){var c=b.deviceID;""==this._oAgentInfo._ctiVersion&&(a._acpEvent.head.serviceID==CD_INTERCEPT_CALLIN?c=stringFormat("cinss103{0}",b.deviceID):a._acpEvent.head.serviceID==CD_MONITOR_CALLIN?c=stringFormat("cinss105{0}",b.deviceID):a._acpEvent.head.serviceID==CD_INSERT_CALLIN&&(c=stringFormat("cinss106{0}",b.deviceID)));return this._NGCCARETURN(this._oPhoneDev.Hold(c))}return CINVccBar_FAILURE};this.RetrieveHold=function(){if(!this._IsMethodEnable("RetrieveHold",emBtnRetrieve))return CINVccBar_FAILURE;var a=this._oPhoneDev._oAcpCall,b=a.GetUserDevice();if(b!=CINVccBar_NULL){var c=b.deviceID;""==this._oAgentInfo._ctiVersion&&(a._acpEvent.head.serviceID==CD_INTERCEPT_CALLIN?c=stringFormat("cinss103{0}",b.deviceID):a._acpEvent.head.serviceID==CD_MONITOR_CALLIN?c=stringFormat("cinss105{0}",b.deviceID):a._acpEvent.head.serviceID==CD_INSERT_CALLIN&&(c=stringFormat("cinss106{0}",b.deviceID)));return this._NGCCARETURN(this._oPhoneDev.RetrieveHold(c))}return CINVccBar_FAILURE};this.Disconnect=function(a){if(!this._IsMethodEnable("Disconnect",emBtnEndCall))return CINVccBar_FAILURE;this._strExecuteMethod="Disconnect";return 1==a?this._NGCCARETURN(this._oPhoneDev.ReleaseCall(this._oAgentInfo._agentID)):2>=this._oPhoneDev._oAcpCall.GetDeviceCount()?this._NGCCARETURN(this._oPhoneDev.ReleaseCall(this._oAgentInfo._agentID)):this.ReleaseThirdOne(0)};this.Answer=function(a){this._AnswerPhone(a)};this.Consult=function(a,b){if(!this._IsMethodEnable("Consult",emBtnConsult))return CINVccBar_FAILURE;if(""==b)return this._FireOnPrompt(4312),CINVccBar_FAILURE;var c=this._oPhoneDev._oAcpCall,d=c._acpEvent.body.callinfo.callingDevice;d==this._oAgentInfo._dN&&(d=c._acpEvent.body.callinfo.calledDevice);return this._NGCCARETURN(this._oPhoneDev.Consultation(b,a,d))};this.Transfer=function(){if(!this._IsMethodEnable("Transfer",emBtnTransfer))return CINVccBar_FAILURE;var a=this._oPhoneDev._oAcpCall,b=a.GetDeviceCount();if(2>=b)return CINVccBar_FAILURE;var c=a.GetHoldDevice();c==CINVccBar_NULL&&(c=a._acpEvent.body.callinfo.device[b-1],c.deviceID==this._oAgentInfo._dN&&(c=a._acpEvent.body.callinfo.device[b-2]));for(b=0;b<a._acpEvent.body.callinfo.count;b++)if(a._acpEvent.body.callinfo.device[b].deviceID!=this._oAgentInfo._dN&&a._acpEvent.body.callinfo.device[b].deviceID!=c.deviceID)return this._NGCCARETURN(this._oPhoneDev.Transfer(a._acpEvent.body.callinfo.device[b].deviceID,c.deviceID));return CINVccBar_FAILURE};this.Conference=function(){if(!this._IsMethodEnable("Conference",emBtnConference))return CINVccBar_FAILURE;var a=this._oPhoneDev._oAcpCall.GetHoldDevice();return a!=CINVccBar_NULL?this._NGCCARETURN(this._oPhoneDev.Conference(a.deviceID)):CINVccBar_FAILURE};this.SendDTMF=function(a){if(!this._IsMethodEnable("SendDTMF",emBtnSendDtmf))return CINVccBar_FAILURE;for(var b=0,c=this._oPhoneDev._oAcpCall,d=(c.GetDeviceCount(),0);d<c._acpEvent.body.callinfo.count;d++)b=c._acpEvent.body.callinfo.device[d];return this._NGCCARETURN(this._oPhoneDev.SendDTMF(a,b.deviceID))};this.Bridge=function(a,b){if(!this._IsMethodEnable("Bridge",emBtnBridge))return CINVccBar_FAILURE;var c=0,d=this._oPhoneDev._oAcpCall;if(2==d.GetDeviceCount())for(var e=0;e<d._acpEvent.body.callinfo.count;e++)if(c=d._acpEvent.body.callinfo.device[e],c.deviceID!=this._oAgentInfo._dN)return this._NGCCARETURN(this._oPhoneDev.Bridge(a,c.deviceID));return CINVccBar_FAILURE};this.Mute=function(a){return this._IsMethodEnable("Mute",emBtnMute)?this._NGCCARETURN(this._oPhoneDev.SetCTIParam("",3,a)):CINVccBar_FAILURE};this.ReleaseThirdOne=function(a){if(!this._IsMethodEnable("ReleaseThirdOne",emBtnEndCall))return CINVccBar_FAILURE;this._strExecuteMethod="ReleaseThirdOne";a=this._oPhoneDev._oAcpCall;if(2>=a.GetDeviceCount())return this._NGCCARETURN(this._oPhoneDev.ReleaseCall(this._oAgentInfo._agentID));for(var b=0;b<a._acpEvent.body.callinfo.count;b++){var c=a._acpEvent.body.callinfo.device[b].deviceID;if(c!=this._oAgentInfo._dN){if(a.GetCallScene()==CST_CONSULT){if(a.GetHoldDevice()==a._acpEvent.body.callinfo.device[b])continue}else{if(c==a._acpEvent.body.callinfo.calledDevice)continue;if(c==a._acpEvent.body.callinfo.callingDevice)continue}return this._NGCCARETURN(this._oPhoneDev.ReleaseCallbyCallID(this._oAgentInfo._agentID,c))}}this._strExecuteMethod="";return CINVccBar_FAILURE};this.SendIMMessage=function(a,b,c,d,e,f){return this._IsInitial("SendIMMessage")?this._NGCCARETURN(this._oPhoneDev.SendMessage(a,b,c,d,e,f)):CINVccBar_FAILURE};this.ForceReset=function(){if(!this._IsMethodEnable("ForceReset",emBtnForceReset))return CINVccBar_FAILURE;0<this._oPhoneDev._oAcpCall.GetDeviceCount()?this.ReleaseCall():this.SetBusy(0);return CINVccBar_SUCCESS};this.BeginPlay=function(a,b,c,d,e){return CINVccBar_NOT_IMPL};this.StopPlay=function(a,b){return CINVccBar_NOT_IMPL};this.BeginCollect=function(a,b,c,d,e,f,g,h,k,l){return CINVccBar_NOT_IMPL};this.StopCollect=function(a,b){return CINVccBar_NOT_IMPL};this.BeginRecord=function(a,b){return CINVccBar_NOT_IMPL};this.StopRecord=function(a){return CINVccBar_NOT_IMPL};this.AlterNate=function(a){return CINVccBar_NOT_IMPL};this.CallBack=function(){return CINVccBar_NOT_IMPL};this.ReCall=function(){return CINVccBar_NOT_IMPL};this.SMMsg=function(a,b){return CINVccBar_NOT_IMPL};this.ForeReleaseCall=function(a,b){return this._IsMethodEnable("ForeReleaseCall",emBtnForceRelease)?this._NGCCARETURN(this._oPhoneDev.ForceReleaseCall(a,b)):CINVccBar_FAILURE};this.Insert=function(a,b,c){if(!this._IsMethodEnable("Insert",emBtnInsert))return CINVccBar_FAILURE;var d="",d=this._oPhoneDev._oAcpCall;if(this._nMonitorFlag==emMonitorNoFlag&&0==d.GetDeviceCount())d="Comm";else if(this._nMonitorFlag==emListenFlag)d="Listen";else if(this._nMonitorFlag==emHelpFlag)d="Help";else return this._NGCCARETURN(!1);return this._NGCCARETURN(this._oPhoneDev.Insert(d,"Insert",a,b,c))};this.Listen=function(a,b,c){if(!this._IsMethodEnable("Listen",emBtnListen))return CINVccBar_FAILURE;var d="",d=this._oPhoneDev._oAcpCall;if(this._nMonitorFlag==emMonitorNoFlag&&0==d.GetDeviceCount())d="Comm";else if(this._nMonitorFlag==emInsertFlag)d="Insert";else if(this._nMonitorFlag==emHelpFlag)d="Help";else return this._NGCCARETURN(!1);return this._NGCCARETURN(this._oPhoneDev.Listen(d,"Listen",a,b,c))};this.Intercept=function(a,b,c){if(!this._IsMethodEnable("Intercept",emBtnIntercept))return CINVccBar_FAILURE;var d="",d=this._oPhoneDev._oAcpCall;if(this._nMonitorFlag==emMonitorNoFlag&&0==d.GetDeviceCount())d="Comm";else if(this._nMonitorFlag==emInsertFlag)d="Insert";else if(this._nMonitorFlag==emListenFlag)d="Listen";else if(this._nMonitorFlag==emHelpFlag)d="Help";else return this._NGCCARETURN(!1);return this._NGCCARETURN(this._oPhoneDev.Intercept(d,"Intercept",a,b,c))};this.Help=function(a,b,c){if(!this._IsMethodEnable("Help",emBtnHelp))return CINVccBar_FAILURE;var d="",d=this._oPhoneDev._oAcpCall;if(this._nMonitorFlag==emMonitorNoFlag&&0==d.GetDeviceCount())d="Comm";else if(this._nMonitorFlag==emInsertFlag)d="Insert";else if(this._nMonitorFlag==emInsertFlag)d="Insert";else return this._NGCCARETURN(!1);return this._NGCCARETURN(this._oPhoneDev.Help(d,"Help",a,b,c))};this.Lock=function(a){return this._IsMethodEnable("Lock",emBtnLock)?this._NGCCARETURN(this._oPhoneDev.Lock(a)):CINVccBar_FAILURE};this.UnLock=function(a){return this._IsMethodEnable("UnLock",emBtnUnLock)?this._NGCCARETURN(this._oPhoneDev.UnLock(a)):CINVccBar_FAILURE};this.ForceIdle=function(a){return this._IsInitial("ForceIdle")?this._NGCCARETURN(this._oPhoneDev.ForceIdle(a)):CINVccBar_FAILURE};this.ForceBusy=function(a){return this._IsInitial("ForceBusy")?this._NGCCARETURN(this._oPhoneDev.ForceBusy(a)):CINVccBar_FAILURE};this.ForceOut=function(a){return this._IsInitial("ForceOut")?this._NGCCARETURN(this._oPhoneDev.ForceOut(a)):CINVccBar_FAILURE};this.InitialState=function(){return this._oAgentInfo._isMonitorLogin?this._oMonitorDev.InitialState():CINVccBar_FAILURE};this.AgentQuery=function(a,b){return this._oAgentInfo._isMonitorLogin?this._oMonitorDev.AgentQuery(a,b):CINVccBar_FAILURE};this.TelQuery=function(a,b){return this._oAgentInfo._isMonitorLogin?this._oMonitorDev.TelQuery(a,b):CINVccBar_FAILURE};this.IvrQuery=function(a,b){return this._oAgentInfo._isMonitorLogin?this._oMonitorDev.IvrQuery(a,b):CINVccBar_FAILURE};this.TrunkQuery=function(a,b){return this._oAgentInfo._isMonitorLogin?this._oMonitorDev.TrunkQuery(a,b):CINVccBar_FAILURE};this.ServiceQuery=function(a,b){return this._oAgentInfo._isMonitorLogin?this._oMonitorDev.ServiceQuery(a,b):CINVccBar_FAILURE};this.TaskQuery=function(a,b){return this._oAgentInfo._isMonitorLogin?this._oMonitorDev.TaskQuery(a,b):CINVccBar_FAILURE};this.CallReportQuery=function(a,b){return this._oAgentInfo._isMonitorLogin?this._oMonitorDev.CallReportQuery(a,b):CINVccBar_FAILURE};this.GetTaskSummary=function(a,b){return this._oAgentInfo._isMonitorLogin?this._oMonitorDev.GetTaskSummary(a,b):CINVccBar_FAILURE};this.QueryMonitorSumInfo=function(a,b){return this._oAgentInfo._isMonitorLogin?this._oMonitorDev.QueryMonitorSumInfo(a,b):CINVccBar_FAILURE};this.StartNotification=function(a,b,c){return this._oAgentInfo._isMonitorLogin?this._oMonitorDev.StartNotification(a,b,c):CINVccBar_FAILURE};this.EndNotification=function(a){return this._oAgentInfo._isMonitorLogin?this._oMonitorDev.EndNotification(a):CINVccBar_FAILURE};this.SendWeiboMsg=function(a){return CINVccBar_NOT_IMPL};this.UploadFileToMMS=function(a,b,c){return CINVccBar_NOT_IMPL};this.DownFileFromMMS=function(a,b,c,d,e){return CINVccBar_NOT_IMPL};this.SendWeChatMsg=function(a,b,c,d,e,f,g,h,k,l){return CINVccBar_NOT_IMPL};this.QueryWeChatData=function(a,b,c,d,e,f,g){return CINVccBar_NOT_IMPL};this.QueryWeChatHistory=function(a,b,c,d,e,f,g){return CINVccBar_NOT_IMPL};this.GetWeChatParam=function(a){return CINVccBar_NOT_IMPL};this.GetSipCtrl=function(){return this._sipCtrl};this.SetCtrlAttribute=function(a,b){"MainIP"==a?this._oAgentInfo._mainIP=b:"BackIP"==a?this._oAgentInfo._backIP=b:"MainPortID"==a?this._oAgentInfo._mainPortID=b:"BackPortID"==a?this._oAgentInfo._backPortID=b:"AgentID"==a?this._oAgentInfo._agentID=b:"Dn"==a?this._oAgentInfo._dN=b:"PassWord"==a?this._oAgentInfo._passWord=b:"MediaFlag"==a?this._oAgentInfo._vccID=b:"PhonType"==a?this._oAgentInfo._phoneType=b:"AppType"==a?this._oAgentInfo._appType=b:"ProtocolType"==a?this._oAgentInfo._protocolCryptType=b:"TransportType"==a?this._oAgentInfo._proTransportType=b:"CtiXPath"==a?this._oAgentInfo._mainXPath=b:"LogXPath"==a?this._oAgentInfo._logXPath=b:"SipServerIP"==a?this._oAgentInfo._sipServerIP=b:"SipServerPort"==a?this._oAgentInfo._sipServerPort=b:"SipProtocol"==a?this._oAgentInfo._sipProtocol=b:"SipDn"==a?this._oAgentInfo._sipDn=b:"SipAuthType"==a?this._oAgentInfo._sipAuthType=b:"SipDomain"==a?this._oAgentInfo._sipDomain=b:"SipPassWord"==a?this._oAgentInfo._sipPassWord=b:"SipXPath"==a?this._oAgentInfo._sipXPath=b:"SipBackServerIP"==a?this._oAgentInfo._sipBackServerIP=b:"SipBackServerPort"==a?this._oAgentInfo._sipBackServerPort=b:"SipBackProtocol"==a?this._oAgentInfo._sipBackProtocol=b:"SipBackAuthType"==a?this.oATL_BarShow._sipBackAuthType=b:"SipBackDomain"==a?this._oAgentInfo._sipBackDomain=b:"SipBackPassWord"==a?this._oAgentInfo._sipBackPassWord=b:"MonitorIP"==a?this._oAgentInfo._monitorIP=b:"MonitorPort"==a?this._oAgentInfo._monitorPort=b:"MonitorXPath"==a?this._oAgentInfo._monitorXPath=b:"WeChatServer"==a?this._oAgentInfo._weChatServer=b:"SelfPrompt"==a?this._oAgentInfo._selfPrompt=b:"MinotorVersion"==a?this._oAgentInfo._minotorVersion=b:"TaskID"==a?this._oAgentInfo._taskID=b:"AutoUpdateURL"==a?this._oAgentInfo._autoUpdateURL=b:"SipPassWdCryptType"==a?this._oAgentInfo._sipPassWdCryptType=b:"PassWdCryptType"==a?this._oAgentInfo._passWdCryptType=b:"AutoSelectAgent"==a?this._oAgentInfo._autoSelectAgent=b:"VersionType"==a?this._oAgentInfo._versionType=b:"IsAllTimeRecord"==a?this._oAgentInfo._isAllTimeRecord=b:"RecordType"==a?this._oAgentInfo._recordType=b:"AgentName"==a?this._oAgentInfo._agentName=b:"msgFlag"==a?this._oAgentInfo._msgFlag=b:"AgentType"==a?this._oAgentInfo._agentType=b:"LocalPort"==a?this._oAgentInfo._localPort=b:"ServiceLists"==a?this._oAgentInfo.ServiceLists=b:"TimeOut"==a?this._oAgentInfo._timeOut=b:"ftpServerIP"==a?this._oAgentInfo._ftpServerIP=b:"ftpServerPort"==a?this._oAgentInfo._ftpServerPort=b:"ftpUser"==a?this._oAgentInfo._ftpUser=b:"ftpPassWord"==a?this._oAgentInfo._ftpPassWord=b:"ftpDirectory"==a?this._oAgentInfo._ftpDirectory=b:"forceEndProcess"!=a&&DisplayLog(VccBar_Log_Error,"SetCtrlAttribute bad attribute name:"+a)};this.GetCtrlAttribute=function(a){if("MainIP"==a)return this._oAgentInfo._mainIP;if("BackIP"==a)return this._oAgentInfo._backIP;if("MainPortID"==a)return this._oAgentInfo._mainPortID;if("BackPortID"==a)return this._oAgentInfo._backPortID;if("AgentID"==a)return this._oAgentInfo._agentID;if("Dn"==a)return this._oAgentInfo._dN;if("PassWord"==a)return this._oAgentInfo._passWord;if("MediaFlag"==a)return this._oAgentInfo._vccID;if("PhonType"==a)return this._oAgentInfo._phoneType;if("AppType"==a)return this._oAgentInfo._appType;if("ProtocolType"==a)return this._oAgentInfo._protocolCryptType;if("TransportType"==a)return this._oAgentInfo._proTransportType;if("CtiXPath"==a)return this._oAgentInfo._mainXPath;if("LogXPath"==a)return this._oAgentInfo._logXPath;if("SipServerIP"==a)return this._oAgentInfo._sipServerIP;if("SipServerPort"==a)return this._oAgentInfo._sipServerPort;if("SipProtocol"==a)return this._oAgentInfo._sipProtocol;if("SipDn"==a)return this._oAgentInfo._sipDn;if("SipAuthType"==a)return this._oAgentInfo._sipAuthType;if("SipDomain"==a)return this._oAgentInfo._sipDomain;if("SipPassWord"==a)return this._oAgentInfo._sipPassWord;if("SipXPath"==a)return this._oAgentInfo._sipXPath;if("SipBackServerIP"==a)return this._oAgentInfo._sipBackServerIP;if("SipBackServerPort"==a)return this._oAgentInfo._sipBackServerPort;if("SipBackProtocol"==a)return this._oAgentInfo._sipBackProtocol;if("SipBackAuthType"==a)return this._oAgentInfo._sipBackAuthType;if("SipBackDomain"==a)return this._oAgentInfo._sipBackDomain;if("SipBackPassWord"==a)return this._oAgentInfo._sipBackPassWord;if("MonitorIP"==a)return this._oAgentInfo._monitorIP;if("MonitorPort"==a)return this._oAgentInfo._monitorPort;if("MonitorXPath"==a)return this._oAgentInfo._monitorXPath;if("WeChatServer"==a)return this._oAgentInfo._weChatServer;if("SelfPrompt"==a)return this._oAgentInfo._selfPrompt;if("MinotorVersion"==a)return this._oAgentInfo._minotorVersion;if("TaskID"==a)return this._oAgentInfo._taskID;if("AutoUpdateURL"==a)return this._oAgentInfo._autoUpdateURL;if("PassWdCryptType"==a)return this._oAgentInfo._sipPassWdCryptType;if("SipPassWdCryptType"==a)return this._oAgentInfo._passWdCryptType;if("AutoSelectAgent"==a)return this._oAgentInfo._autoSelectAgent;if("VersionType"==a)return this._oAgentInfo._versionType;if("AmpTimeOffSet"==a)return this._oAgentInfo._amptimeOff;if("Av"==a)return this._oAgentInfo._av;if("IsAllTimeRecord"==a)return this._oAgentInfo._isAllTimeRecord;if("RecordType"==a)return this._oAgentInfo._recordType;if("AgentName"==a)return this._oAgentInfo._agentName;if("msgFlag"==a)return this._oAgentInfo._msgFlag;if("AgentType"==a)return this._oAgentInfo._agentType;if("LocalPort"==a)return this._oAgentInfo._localPort;if("ServiceLists"==a)return this._oAgentInfo._vccId;if("TimeOut"==a)return this._oAgentInfo._timeOut;if("ftpServerIP"==a)return this._oAgentInfo._ftpServerIP;if("ftpServerPort"==a)return this._oAgentInfo._ftpServerPort;if("ftpUser"==a)return this._oAgentInfo._ftpUser;if("ftpPassWord"==a)return this._oAgentInfo._ftpPassWord;if("ftpDirectory"==a)return this._oAgentInfo._ftpDirectory;"forceEndProcess"!=a&&DisplayLog(VccBar_Log_Error,"GetCtrlAttribute bad attribute name:"+a);return""};this.OnMonitorNotify=function(a,b){switch(a.eventType){case AMP_InitialState_CONF:case AMP_AgentQuery_CONF:case AMP_IvrQuery_CONF:case AMP_TelQuery_CONF:case AMP_StartNotification_CONF:case AMP_EndNotification_CONF:case AMP_CallReportQuery_CONF:case AMP_M4AgentSumQuery_CONF:case AMP_M4ServiceSumQuery_CONF:case AMP_M4IvrServiceQuery_CONF:case AMP_M4TrunkSumQuery_CONF:var c=a.eventTypeName;if(a.eventType==AMP_InitialState_CONF){var d=getAcpTimeString(!1);this._oAgentInfo._amptimeOff=getStringTimerInterval(a.currentTime,d);DisplayLog(VccBar_Log_Debug,"AmpSeverTimer:\u3010"+a.currentTime+"\u3011 localTime:\u3010"+d+"\u3011 offSet:\u3010"+this._oAgentInfo._amptimeOff+"\u3011");if(0==this._oAgentInfo._isMonitorLogin){"2300"==a.data?this._FireOnPrompt(2300):(this._FireOnPrompt(4409),this._oAgentInfo._isMonitorLogin=!0,this._FireOnInitalSuccess());break}}else a.eventType==AMP_M4AgentSumQuery_CONF?c="CallReportQuery":a.eventType==AMP_M4ServiceSumQuery_CONF?c="ServiceQuery":a.eventType==AMP_M4IvrServiceQuery_CONF?c="IvrQuery":a.eventType==AMP_M4TrunkSumQuery_CONF&&(c="TrunkQuery");0==a.code?a.eventType==AMP_EndNotification_CONF?this._FireOnMethodResponseEvent(c,a.code):this._FireOnMethodResponseEvent(c,a.data):this._FireOnMethodResponseEvent(c,a.code);break;case AMP_TaskQuerySummary_CONF:"4.0"==this._oAgentInfo._monitorVersion?0==a.code?this._FireOnMethodResponseEvent("GetTaskSummary",a.data):this._FireOnMethodResponseEvent("GetTaskSummary",a.code):this._invokeEvent(eventOnQueryMonitorSumReport,"TaskQuerySummary|"+a.data);break;case AMP_QueryActiveTask_CONF:case AMP_ServiceQuerySummary_CONF:case AMP_AgentSumQuery_CONF:case AMP_IvrSumQuery_CONF:case AMP_AgentWorkSumQuery_CONF:case AMP_ServiceSumQueryByHour_CONF:case AMP_TaskSumQueryByHour_CONF:this._invokeEvent(eventOnQueryMonitorSumReport,a.eventTypeName+"|"+a.data);break;case AMP_AgentReport:this._invokeEvent(eventOnAgentReport,a.data);break;case AMP_IvrReport:this._invokeEvent(eventOnIvrReport,a.data);break;case AMP_M4IvrServiceReport:this._invokeEvent(eventOnIvrReport,a.data);break;case AMP_TrunkReport:this._invokeEvent(eventOnTrunkReport,a.data);break;case AMP_TrunkSumReport:this._invokeEvent(eventOnTrunkSumReport,a.data);break;case AMP_TelReport:this._invokeEvent(eventOnTelReport,a.data);break;case AMP_ServiceReport:this._invokeEvent(eventOnServiceReport,a.data);break;case AMP_TaskReport:this._invokeEvent(eventOnTaskReport,a.data);break;case AMP_OutboundReport:this._invokeEvent(eventOnOutboundReport,a.data);break;case AMP_CallReportReport:this._invokeEvent(eventOnCallReportInfo,a.data);break;case AMP_M4WallServiceReport:this._invokeEvent(eventOnWallServiceReport,a.data);break;case AMP_M4WallQueueReport:this._invokeEvent(eventOnWallQueueReport,a.data);break;case AMP_M4AgentSumReport:this._invokeEvent(eventOnAgentStaticReport,a.data);break;case AMP_M4ServiceSumReport:this._invokeEvent(eventOnServiceStaticReport,a.data);break;case AMP_OnSignOuted:this._invokeEvent(eventOnAgentMonitorSignOut,a.data);break;default:bReturn=!1}};this.OnAcpSocketNotify=function(a){a==WS_EVENT_ONOPEN?this._oAgentInfo._devConnectStatus=emCenterOpStatusConnected:a==WS_EVENT_ONCLOSE&&(1==this._oAgentInfo._isInitial?(this._AcpSocketReconnectTimer=0,this._oTimer.SetTimer(CTRL_AGENTRECONNECT_ID,1E3*CTRL_AGENTRECONNECT_INTERVAL),-2==this._oAgentInfo._oldWorkStatus&&(this._oAgentInfo._oldWorkStatus=this._oAgentInfo._workstatus,DisplayLog(VccBar_Log_Debug,stringFormat("JVccBarCenter:oldWorkStatus:{0}",this._oAgentInfo._oldWorkStatus))),this._FireOnPrompt(4005)):0==this._oAgentInfo._isInitial&&this._oAgentInfo._devConnectStatus==emCenterOpStatusConnecting&&(this._FireOnPrompt(4401,4002),this._FireOnInitalFailure(IE_InitCTIError)),this._oAgentInfo._devConnectStatus=emCenterOpStatusInitial)};this.OnNotify=function(a,b){b==Notify_MSG?this._OnRecieveAcpMessage(a):b==Notify_OUTOFTIME?this._OnAcpMessageOutTime(a):this._OnAcpMessageInvoke(a)};this.attachEventfun=function(a){this._eventCallBackFunction=a};this.attachResponsefun=function(a){this._methodCallBackFunction=a};this._create();return this}var g_resPath="",SipCallSence={SIPCALL_NULL:0,SIPCALL_IDLE:1,SIPCALL_CALLING:2,SIPCALL_RING:3,SIPCALL_ORIGATE:4,SIPCALL_CONNECTED:5,SIPCALL_MUTE:6,SIPCALL_HOLD:7,SIPCALL_CONSULTRING:8,SIPCALL_CONSULT:9,SIPCALL_CONFERENCE:10,SIPCALL_END:11},G_JSIP=null;function OnGMessageFailure(a,b){if(null!=G_JSIP){var c=b.response;c?G_JSIP.OnMessage(a,"","outcoming",c.status_code.toString()+" "+c.reason_phrase):G_JSIP.OnMessage(a,"","outcoming",b.cause.toString())}}function SIPCtrl(a){this.path=a;this.config={Dn:"",SipServerIP:"",SipServerPort:5068,SipProtocol:"ws",XPath:"",AuthType:"",Domain:"",PassWord:"",Version:"20.20190328",JsipVersion:"",Vedio:!1,Sequence:0,Token:"ABC892342934892394",Reconnect:!0};this.sipConfig={sockets:null,log:{level:"debug"},uri:"",password:"",ws_servers:"",display_name:"",authorization_user:"",register:!1,register_expires:600,registrar_server:"",no_answer_timeout:60,session_timers:!0,use_preloaded_route:!1,connection_recovery_min_interval:2,connection_recovery_max_interval:30,hack_via_tcp:!1,hack_via_ws:!1,hack_ip_in_contact:!1,token:""};G_JSIP=this;this.peerconnection_config={rtcpMuxPolicy:"require",gatheringTimeout:2E3};this.inComingCallSurpportVedio=!1;this.localCanRenegotiateRTC="";this.SipCallSenceDes={items:"\u672a\u6ce8\u518c \u5c31\u7eea \u5916\u547c\u4e2d \u6765\u7535\u632f\u94c3 \u5916\u547c\u632f\u94c3 \u63a5\u901a \u9759\u97f3 \u4fdd\u6301 \u54a8\u8be2\u4e2d \u54a8\u8be2 \u4f1a\u8bae --".split(" ")};this.CallInfo={ScenseID:SipCallSence.SIPCALL_NULL,ScenseName:"\u672a\u6ce8\u518c",Code:0,RequsetName:"",Result:"",CallSegments:[]};this.call=this.ua=null;this.sessionCount=0;this.webcam=this.soundPlayer=this.remoteStream=this.localStream=this.remoteView=this.selfView=null;this.oldsipConfig=this.sipConfig;this.messge_options=this.oParse=this.options=null;this.Initial=function(a){this._GetBrowerInfo();"chrome"==this.os?53>string2Int(this.version)&&(alert("chrome\u6d4f\u89c8\u5668\u7248\u672c\u4f4e\u4e8e53\uff0c\u53ef\u80fd\u65e0\u6cd5\u4f7f\u7528\uff0c\u8bf7\u5347\u7ea7!"),this.OnError(-1,"chrome\u6d4f\u89c8\u5668\u7248\u672c\u4f4e\u4e8e53\uff0c\u53ef\u80fd\u65e0\u6cd5\u4f7f\u7528\uff0c\u8bf7\u5347\u7ea7!")):"msie"==this.os&&(alert("chrome\u6d4f\u89c8\u5668\u7248\u672c\u4f4e\u4e8e53\uff0c\u53ef\u80fd\u65e0\u6cd5\u4f7f\u7528\uff0c\u8bf7\u5347\u7ea7!"),this.OnError(-1,"IE\u6d4f\u89c8\u5668\u4e0d\u652f\u6301Jsip\uff0c\u8bf7\u66f4\u6362\u6d4f\u89c8\u5668!"));null==this.soundPlayer&&(this.soundPlayer=document.createElement("audio"),this.soundPlayer.volume=1);this.config.JsipVersion=JsSIP.version;this.OnDebug("current jssip version:"+this.GetVersion());1==a&&null==this.ua&&this._CreateUa();return 0};this.UnInitial=function(){this.ReleasePA();return 0};this.RegisterPA=function(){this._IsSipConfigChanged()&&null!=this.ua&&this._DeleteUa(!0);this.sipConfig.register=!0;if(null==this.ua)return this._CreateUa();this.ua.register();return 0};this.ReleasePA=function(){this.sipConfig.register=!1;null!=this.ua&&this.ua.unregister();return 0};this.Pickup=function(){if(null==this.call)return-1;this.call.answer({pcConfig:this.peerconnection_config,mediaConstraints:{audio:!0,video:this.inComingCallSurpportVedio},extraHeaders:["X-Can-Renegotiate: "+String(this.localCanRenegotiateRTC)],rtcOfferConstraints:{offerToReceiveAudio:1,offerToReceiveVideo:this.config.Vedio?1:0}});return 0};this.Reject=function(){if(null==this.call)return-1;this.call.terminate();return 0};this.Disconnect=function(){if(null==this.call)return-1;this.call.terminate();return 0};this.SendDTMF=function(a){if(null==this.call)return-1;var c=a.toString();10==a?c="*":11==a&&(c="#");this.call.sendDTMF(c);return 0};this.DoCall=function(a,c){if(null!=this.call)return-1;var d=["X-Can-Renegotiate: "+String(this.localCanRenegotiateRTC)];"undefined"==typeof c&&(c="");""!=c&&(d=d.concat(c));this._MakeCallInfo(SipCallSence.SIPCALL_CALLING,a);this.ua.call(a,{pcConfig:this.peerconnection_config||{iceServers:[]},mediaConstraints:{audio:!0,video:this.config.Vedio},extraHeaders:d,rtcOfferConstraints:{offerToReceiveAudio:1,offerToReceiveVideo:this.config.Vedio?1:0}});return 0};this.SendMessage=function(a,c){if(null==this.ua)return-1;"undefined"==typeof c&&(c="");this.ua.sendMessage(stringFormatSip("sip:{0}@{1}",a,this.config.SipServerIP),c);return 0};this.Mute=function(a){a=this._MakeRequest(a?"Mute":"UnMute","");return this._sendInfo(a)};this.Hold=function(){var a=this._MakeRequest("Hold","");return this._sendInfo(a)};this.RetriveHold=function(){var a=this._MakeRequest("UnHold","");return this._sendInfo(a)};this.Consult=function(a){a=this._MakeRequest("Consult",a);return this._sendInfo(a)};this.Conference=function(){var a=this._MakeRequest("Conference","");return this._sendInfo(a)};this.ReleaseLeg=function(a){a=this._MakeRequest("Release",a);return this._sendInfo(a)};this.Transfer=function(a){a=this._MakeRequest("Transfer",a);return this._sendInfo(a)};this.Alertnate=function(){var a=this._MakeRequest("Switch","");return this._sendInfo(a)};this.SetVedioWindow=function(a,c,d){"undefined"==typeof a||"undefined"==typeof c||"undefined"==typeof d||null==a||null==c||null==d?this.remoteView=this.selfView=this.webcam=null:"audio"==c.tagName.toLowerCase()&&"vedio"==c.tagName.toLowerCase()||"audio"==d.tagName.toLowerCase()&&"vedio"==d.tagName.toLowerCase()?this.remoteView=this.selfView=this.webcam=null:(this.webcam=a,this.selfView=c,this.remoteView=d,null==this.remoteView.getAttribute("playsinline")&&this.remoteView.setAttribute("playsinline","true"),null==this.remoteView.getAttribute("autoplay")&&this.remoteView.setAttribute("autoplay","true"),null==this.selfView.getAttribute("playsinline")&&this.selfView.setAttribute("playsinline","true"),null==this.selfView.getAttribute("autoplay")&&this.selfView.setAttribute("autoplay","true"))};this.DisplayVedio=function(a){null==this.webcam?this._CreateVedioWindow():this.webcam.style.display=a?"block":"none"};this.SetAttribute=function(a,c){"Dn"==a?this.config.Dn=c:"SipServerIP"==a?this.config.SipServerIP=c:"SipServerPort"==a?this.config.SipServerPort=c:"SipProtocol"==a?this.config.SipProtocol=c:"XPath"==a?this.config.XPath=c:"AuthType"==a?this.config.AuthType=c:"Domain"==a?this.config.Domain=c:"PassWord"==a?this.config.PassWord=c:"Vedio"==a?this.config.Vedio=c:"Token"==a&&(this.config.Token=c)};this.GetAttribute=function(a){return"Dn"==a?this.config.Dn:"SipServerIP"==a?this.config.SipServerIP:"SipServerPort"==a?this.config.SipServerPort:"SipProtocol"==a?this.config.SipProtocol:"XPath"==a?this.config.XPath:"AuthType"==a?this.config.AuthType:"Domain"==a?this.config.Domain:"PassWord"==a?this.config.PassWord:"Vedio"==a?this.config.Vedio:"Token"==a?this.config.Token:""};this.GetVersion=function(){return this.config.JsipVersion+"("+this.config.Version+")"};this._GetBrowerInfo=function(){this.version=this.os="";var a=navigator.userAgent.toLowerCase();0<a.indexOf("msie")?(this.os="msie",this.version=a.match(/msie ([\d.]+)/)[1]):0<a.lastIndexOf("firefox")?(this.os="firefox",this.version=a.match(/firefox\/([\d.]+)/)[1]):0<a.lastIndexOf("chrome")?(this.os="chrome",this.version=a.match(/chrome\/([\d.]+)/)[1]):0<a.lastIndexOf("trident")?(this.os="msie",this.version=a.match(/rv:([\d.]+)/)[1]):0<a.lastIndexOf("safari")?(this.os="safari",this.version=a.match(/safari\/([\d.]+)/)[1]):isIE()?(this.os="msie",this.version="11.0"):(this.os=a,this.version="")};this._CreateUa=function(){if(null==this.ua){this._SetSipConfig();try{this.ua=new JsSIP.UA(this.sipConfig),this.ua.parent=this}catch(a){return console.log(a.toString()),this.ua=null,-1}this.ua.on("connecting",function(a){this.parent.OnDebug("ua connecting")});this.ua.on("connected",function(a){this.parent.OnDebug("ua connected")});this.ua.on("disconnected",function(a){a=this.parent;null==a.ua||a.ua.isRegistered()||(a.config.Reconnect||(a.OnError(408,"Request Timeout"),a.OnLoginFailure(408,"Request Timeout")),a._DeleteUa(!1))});this.ua.on("registered",function(a){this.parent._MakeCallInfo(SipCallSence.SIPCALL_IDLE,"");this.parent.OnLoginSuccess()});this.ua.on("unregistered",function(a){1==this.parent.sipConfig.register?this.parent.OnError(0,"Reconnecting"):this.parent.OnLogoutSuccess();this.parent._DeleteUa(!1)});this.ua.on("registrationFailed",function(a){var c=a.cause,d=0;"Request Timeout"==c&&(d=408);a.response&&(d=a.response.status_code);this.parent.OnLoginFailure(d,c);this.parent._DeleteUa(!1)});this.ua.on("newRTCSession",function(a){this.parent.OnDebug("newRTCSession");this.parent._CreateRTCSession(a)});this.ua.on("newMessage",function(a){this.parent.OnDebug("newMessage");var c;c=a.request;a=a.message;var d=a.remote_identity.uri.toString();if("incoming"===a.direction)c=c.body,this.parent.OnMessage(d,c,"incoming","0");else a.on("failed",function(a){OnGMessageFailure(d,a)});a.ooParent=this});this.ua.start()}};this._BcdToASC2=function(a,c){if(""==a)return"";for(var d="",e=0;e<c;e++)d=e&1?d+"0123456789ABCDEF".charAt((a.charCodeAt(e>>1)&240)>>4):d+"0123456789ABCDEF".charAt(a.charCodeAt(e>>1)&15);return stringFormat("----{0}-------",d)};this._DeleteUa=function(a){!a&&1==this.sipConfig.register&&this.config.Reconnect||null==this.ua||(this.OnDebug("DeleteUa"),this.ua.stop(),this.ua=null)};this._SetSipConfig=function(){this.sipConfig.uri=stringFormatSip("sip:{0}@{1}:{2}",this.config.Dn,this.config.SipServerIP,this.config.SipServerPort);this.sipConfig.password=this.config.PassWord;this.sipConfig.ws_servers=stringFormatSip("{0}://{1}:{2}/{3}",this.config.SipProtocol,this.config.SipServerIP,this.config.SipServerPort,this.config.XPath);this.sipConfig.sockets=new JsSIP.WebSocketInterface(this.sipConfig.ws_servers);this.sipConfig.display_name=this.config.Dn;this.sipConfig.authorization_user=this.config.Dn;this.sipConfig.token=this.config.Token;this.oldsipConfig=this.sipConfig};this._CreateRTCSession=function(a){this.OnDebug("Begin CreateRTCSession");this.call=a.session;this.call.oParent=this;var c=this.call.remote_identity.display_name||this.call.remote_identity.uri.user;a=a.request;"incoming"===this.call.direction&&("false"===a.getHeader("X-Can-Renegotiate")?this.call.data.remoteCanRenegotiateRTC=!1:this.call.data.remoteCanRenegotiateRTC=!0,a.body&&(0<a.body.indexOf("m\x3dvideo")?this.inComingCallSurpportVedio=!0:this.inComingCallSurpportVedio=!1));if(0<this.sessionCount)return this.call.terminate(),!1;this.sessionCount+=1;this.OnDebug("url:"+c);this.call.on("progress",function(a){if("incoming"===this.oParent.call.direction)this.oParent._PlaySound("sounds/incoming-call2.mp3",!0),this.oParent._MakeCallInfo(SipCallSence.SIPCALL_RING,this.oParent.call.remote_identity.uri.toString()),this.oParent.OnRing(this.oParent.call.remote_identity.uri.toString());else{var b=a.response.body;this.oParent.OnDebug("outCall sdp["+b+"]");""==b?this.oParent._PlaySound("sounds/outgoing-call2.mp3",!0):this.oParent.OnDebug("180 with sdp...");this.oParent._MakeCallInfo(SipCallSence.SIPCALL_ORIGATE,this.oParent.call.remote_identity.uri.toString());this.oParent.OnOrigated(this.oParent.call.remote_identity.uri.toString())}"remote"===a.originator?this.oParent.OnDebug("in-progress"):this.oParent.OnDebug("progress")});this.call.on("accepted",function(a){this.oParent.OnDebug("accepted");g_consoleFlag&&console.info("accepted");this.oParent._bindLocalVedioView();this.oParent._bindRemoteVedioView(null);"remote"===a.originator&&("false"===a.response.getHeader("X-Can-Renegotiate")?this.oParent.call.data.remoteCanRenegotiateRTC=!1:this.oParent.call.data.remoteCanRenegotiateRTC=!0);this.oParent._PauseSound();this.oParent._MakeCallInfo(SipCallSence.SIPCALL_CONNECTED,"");this.oParent.OnConnected(0)});this.call.on("addstream",function(a){this.oParent.OnDebug("addstream");g_consoleFlag&&(console.info("onaddstream"),console.info(a));this.oParent._bindRemoteVedioView(a)});this.call.on("failed",function(a){this.oParent.OnDebug("failed");g_consoleFlag&&console.info("failed");a.message&&"undefined"!=typeof a.message.status_code?this.oParent.OnError(a.message.status_code,a.message.reason_phrase):this.oParent.OnError(487,a.cause);this.oParent._PlaySound("sounds/outgoing-call-rejected.mp3",!1);this.oParent._endCall();this.oParent._MakeCallInfo(SipCallSence.SIPCALL_IDLE,"");this.oParent.OnDisconnected()});this.call.on("newDTMF",function(a){-100==a.dtmf.tone?this.oParent._recvInfo(a.request.body):(this.oParent.OnDebug("newDTMF("+a.originator+","+a.dtmf.tone+")"),"remote"===a.originator&&this.oParent._PlaySound("sounds/dialpad/"+a.dtmf.tone+".ogg",!1))});this.call.on("hold",function(a){this.oParent.OnDebug("hold");this.oParent._PlaySound("sounds/dialpad/pound.ogg",!1)});this.call.on("unhold",function(a){this.oParent.OnDebug("unhold");this.oParent._PlaySound("sounds/dialpad/pound.ogg",!1)});this.call.on("ended",function(a){this.oParent.OnDebug("ended");g_consoleFlag&&console.info("ended");this.oParent._PlaySound("sounds/calling-end.mp3",!1);this.oParent._endCall();this.oParent._MakeCallInfo(SipCallSence.SIPCALL_IDLE,"");this.oParent.OnDisconnected()});this.call.on("confirmed",function(a){this.oParent.OnDebug("confirmed");g_consoleFlag&&console.info("confirmed")});this.call.on("update",function(a){this.oParent.OnDebug("update");a=a.request;g_consoleFlag&&console.info("update");!a.body||this.oParent.localCanRenegotiateRTC&&this.oParent.call.data.remoteCanRenegotiateRTC||(this.oParent.call.connection.reset(),this.oParent.call.connection.addStream(this.oParent.localStream))});this.call.on("reinvite",function(a){this.oParent.OnDebug("reinvite");a=a.request;g_consoleFlag&&console.info("reinvite");!a.body||this.oParent.localCanRenegotiateRTC&&this.oParent.call.data.remoteCanRenegotiateRTC||(this.oParent.call.connection.reset(),this.oParent.call.connection.addStream(this.oParent.localStream))});this.call.on("sdp",function(a){this.oParent.OnDebug("sdp");g_consoleFlag&&console.info("sdp");setTimeout(function(){G_JSIP._UpdateStream()},1E3)});this.call.on("peerconnection",function(a){this.oParent.OnDebug("peerconnection");g_consoleFlag&&(console.info("onpeerconnection"),console.info(a))});this.call.on("newTransaction",function(a){this.oParent.OnDebug("newTransaction")});this.call.on("transactionDestroyed",function(a){this.oParent.OnDebug("transactionDestroyed")});this.call.on("requestSucceeded",function(a){this.oParent.OnDebug("requestSucceeded")});this.call.on("requestFailed",function(a){this.oParent.OnDebug("requestFailed")})};this._UpdateStream=function(){this.OnDebug("_UpdateStream");this._bindRemoteVedioView(null);this._bindLocalVedioView()};this._CreateVedioWindow=function(){null==this.selfView&&(this.webcam=document.createElement("DIV"),this.webcam.style.cursor="move",this.webcam.style.position="absolute",this.webcam.style.border="2px solid #46A3FF",this.webcam.style.borderRadius="10px",this.webcam.style.left=window.innerWidth-410+"px",this.webcam.style.top="10px",this.webcam.style.width="406px",this.webcam.style.height="306px",this.webcam.style.textAlign="center",this.webcam.style.background="#828282",this.webcam.id="webcam",this.webcam.style.display=this.config.Vedio?"block":"none",document.body.appendChild(this.webcam),this.webcam.innerHTML="\x3cvideo id\x3d'remoteView_MY_SIPCTRL' style\x3d'width:400px; height: 300px;background-color: transparent;' _hidden\x3d'false' poster\x3d''\x3e\x3c/video\x3e\x3cvideo id\x3d'selfView_MY_SIPCTRL' style\x3d'position:absolute;left:8px;bottom: 6px;width: 133px;height: 100px;background-color: #aaaaaa;border-top: 2px solid #aaaaaa;border-right: 2px solid #aaaaaa;' muted\x3d'true' _hidden\x3d'false'\x3e\x3c/video\x3e",this.selfView=document.getElementById("selfView_MY_SIPCTRL"),this.remoteView=document.getElementById("remoteView_MY_SIPCTRL"),null==this.remoteView.getAttribute("playsinline")&&this.remoteView.setAttribute("playsinline","true"),null==this.remoteView.getAttribute("autoplay")&&this.remoteView.setAttribute("autoplay","true"),null==this.selfView.getAttribute("playsinline")&&this.selfView.setAttribute("playsinline","true"),null==this.selfView.getAttribute("autoplay")&&this.selfView.setAttribute("autoplay","true"))};this._bindRemoteVedioView=function(a){null!=this.call&&(null==a?0<this.call.connection.getRemoteStreams().length&&(this.remoteStream=this.call.connection.getRemoteStreams()[0]):this.remoteStream=a.stream,g_consoleFlag&&(console.info("bindRemoteVedioView("+this.remoteView.tagName.toLowerCase()+")"),console.info(this.call),console.info(this.call.connection.getRemoteStreams())),this._CreateVedioWindow(),this.remoteView&&(this.oParent.OnDebug("bindRemoteVedioView("+this.remoteView.tagName.toLowerCase()+")"),null!=this.remoteStream&&("undefined"!=typeof JsSIP.rtcninja?this.remoteView=JsSIP.rtcninja.attachMediaStream(this.remoteView,this.remoteStream):this.remoteView.srcObject=this.remoteStream)))};this._bindLocalVedioView=function(){null!=this.call&&(this._CreateVedioWindow(),0<this.call.connection.getLocalStreams().length&&(g_consoleFlag&&(console.info("bindLocalVedioView("+this.remoteView.tagName.toLowerCase()+")"),console.info(this.call),console.info(this.call.connection.getLocalStreams())),this.localStream=this.call.connection.getLocalStreams()[0],this.selfView&&(this.oParent.OnDebug("bindLocalVedioView("+this.remoteView.tagName.toLowerCase()+")"),"undefined"!=typeof JsSIP.rtcninja?(this.selfView=JsSIP.rtcninja.attachMediaStream(this.selfView,this.localStream),this.selfView.volume=0):this.selfView.srcObject=this.localStream)))};this._endCall=function(){this.selfView&&(this.selfView.src="");this.remoteView&&(this.remoteView.src="");this.sessionCount=0;this.call=null;this.localStream&&("undefined"!=typeof JsSIP.rtcninja?JsSIP.rtcninja.closeMediaStream(this.localStream):JsSIP.Utils.closeMediaStream(this.localStream));this.remoteStream=this.localStream=null};this._PauseSound=function(){null!=this.soundPlayer&&this.soundPlayer.pause()};this._GetResPath=function(){return""==g_resPath?this.path:g_resPath};this._PlaySound=function(a,c){null!=this.soundPlayer&&(this.OnDebug("PlayAudio:"+a),this.soundPlayer.setAttribute("src",this._GetResPath()+"scripts/sip/"+a),this.soundPlayer.loop=c,this.soundPlayer.play())};this._IsSipConfigChanged=function(){return this.sipConfig.Dn==this.oldsipConfig.Dn||this.sipConfig.SipServerIP==this.oldsipConfig.SipServerIP||this.sipConfig.password==this.oldsipConfig.password||this.sipConfig.SipProtocol==this.oldsipConfig.SipProtocol||this.sipConfig.SipServerPort==this.oldsipConfig.SipServerPort||this.sipConfig.XPath==this.oldsipConfig.XPath?!1:!0};this._sendInfo=function(a){if(null==this.call)return-1;null==this.options&&(this.options={eventHandlers:{onSuccessResponse:function(a){this.oParent._recvInfo(a.body)},onErrorResponse:function(a){this.oParent.OnError(a.status_code,a.reason_phrase)}}},this.options.eventHandlers.oParent=this);this.call.info(a,this.options);return 0};this._recvInfo=function(a){this.OnDebug(a);null==this.oParse&&(this.oParse=new CXmlParse);if(this.oParse.loadXml(a)){this.CallInfo.RequsetName=this.oParse.queryNodeValueByPath("Operator");this.CallInfo.Result=this.oParse.queryNodeValueByPath("Status");this.CallInfo.Code=this.oParse.queryNodeValueByPath("Code");a=this.oParse.queryNodes("cs");if(null!=a){this.CallInfo.CallSegments.splice(0,this.CallInfo.CallSegments.length);for(var c=0;c<a.length;c++){var d=a[c];this.CallInfo.CallSegments.push([this.oParse.queryNodeAttribute(d,"CallNumber"),this.oParse.queryNodeAttribute(d,"Status")])}}a=SipCallSence.SIPCALL_CONNECTED;for(var e=d=c=!1,f=0;f<this.CallInfo.CallSegments.length;f++){var g=this.CallInfo.CallSegments[f];"Hold"==g[1]&&(c=!0);"Mute"==g[1]&&(d=!0);"Ring"==g[1]&&(e=!0)}2==this.CallInfo.CallSegments.length?(c&&(a=SipCallSence.SIPCALL_HOLD),d&&(a=SipCallSence.SIPCALL_MUTE)):2<=this.CallInfo.CallSegments.length&&(a=c?e?SipCallSence.SIPCALL_CONSULTRING:SipCallSence.SIPCALL_CONSULT:SipCallSence.SIPCALL_CONFERENCE);this._MakeCallInfo(a,"")}else this.OnError(-1,"Bad RecvINFO Message!")};this._MakeRequest=function(a,c){this.config.Sequence++;return stringFormat("\x3cCallControl\x3e\x3cType\x3eRequest\x3c/Type\x3e\x3cOperator\x3e{0}\x3c/Operator\x3e\x3cSequence\x3e{1}\x3c/Sequence\x3e\x3cTarget\x3e{2}\x3c/Target\x3e\x3c/CallControl\x3e",a,this.config.Sequence,c)};this._MakeCallInfo=function(a,c){if(!(this.CallInfo.ScenseID<SipCallSence.SIPCALL_NULL||this.CallInfo.ScenseID>=SipCallSence.SIPCALL_END)){this.CallInfo.ScenseID=a;this.CallInfo.ScenseName=this.SipCallSenceDes.items[a];switch(a){case SipCallSence.SIPCALL_RING:this.CallInfo.CallSegments.splice(0,this.CallInfo.CallSegments.length);c=getSipSubString(c,"","@");c=getSipSubString(c,"sip:","");this.CallInfo.CallSegments.push([this.config.Dn,"RING"]);this.CallInfo.CallSegments.push([c,"RING"]);break;case SipCallSence.SIPCALL_ORIGATE:this.CallInfo.CallSegments.splice(0,this.CallInfo.CallSegments.length);c=getSipSubString(c,"","@");c=getSipSubString(c,"sip:","");this.CallInfo.CallSegments.push([this.config.Dn,"RING"]);this.CallInfo.CallSegments.push([c,"RING"]);break;case SipCallSence.SIPCALL_CONNECTED:for(var d=0;d<this.CallInfo.CallSegments.length;d++)this.CallInfo.CallSegments[d][1]="Connect";break;case SipCallSence.SIPCALL_MUTE:case SipCallSence.SIPCALL_HOLD:case SipCallSence.SIPCALL_CONSULTRING:case SipCallSence.SIPCALL_CONSULT:case SipCallSence.SIPCALL_CONFERENCE:break;default:case SipCallSence.SIPCALL_IDLE:case SipCallSence.SIPCALL_NULL:this.CallInfo.CallSegments.splice(0,this.CallInfo.CallSegments.length)}this.OnReportScense(this.CallInfo)}};this.OnRing=function(a){};this.OnOrigated=function(a){};this.OnDisconnected=function(){};this.OnConnected=function(a){};this.OnError=function(a,c){};this.OnConnectStatus=function(){};this.OnLoginSuccess=function(){};this.OnLoginFailure=function(a,c){};this.OnLogoutSuccess=function(){};this.OnDebug=function(a){};this.OnReportScense=function(a){};this.OnMessage=function(a,c,d,e){};try{JsSIP.debug.enable("*")}catch(b){}return this}var RSIP_SUCCESS=0,RSIP_FAILURE=1,RSIP_UNKNOWN=2,cmd_GuardType_Null=-1,cmd_GuardType_GetSipLocalPort=0,cmd_GuardType_UpdateSetup=1,PORT_COUNT=5,barStatus_Null=0,barStatus_GuardConnecting=1,barStatus_GuardConnected=2,barStatus_GuardDisconnecting=3,barStatus_GuardDisconnected=4,barStatus_SipConnecting=5,barStatus_SipConnected=6,barStatus_SipDisconnecting=7,barStatus_SipDisconnected=8,barStatus_SipReconnecting=9,CINGUARD_ERROR_NotStart=-100,CINGUARD_ERROR_MISSRMSIP=-101,CINGUARD_ERROR_NotSetupRMSIP=-102,CINGUARD_ERROR_NotRePlaceRMSIP=-103,RMSIP_ERROR_OnKickOff=-110,RMSIP_ERROR_RegisterFAILURE=-111,RMSIP_ERROR_InitialFAILURE=-112,RMSIP_ERROR_ErrorParam=-113,Sip_HttpGuardConnect_ID=200,Sip_HttpMsgQueue_ID=100,Sip_HttpMsgQueue_TimeInterval=3E3,sipAdapterTypeJSip=0,sipAdapterTypeRemoteSip=1,sipAdapterTypeRemoteHttpSip=2,continueSipExe=1,gSIP_Log_Protocol=0,SIPVERSION="3.0.3.20190418",lg_zhcn_sip="zh-cn",SIPADAPTER_Log_None=0,SIPADAPTER_Log_Error=1,SIPADAPTER_Log_Warn=2,SIPADAPTER_Log_Debug=4,SIPADAPTER_Log_Info=8,SIPADAPTER_Log_Protocol=16,WS_EVENT_SIP_ONOPEN=0,WS_EVENT_SIP_ONMESSAGE=1,WS_EVENT_SIP_ONCLOSE=2,WS_EVENT_SIP_ONERROR=3,ACPI_SIP_SUCCESS=0,ACPI_SIP_FAILURE=1,ACPI_SIP_UNKNOWN=2,WS_STATUS_SIP_NULL=-1,WS_STATUS_SIP_CONNECTING=0,WS_STATUS_SIP_OPEN=1,WS_STATUS_SIP_CLOSING=2,WS_STATUS_SIP_CLOSE=3,Phone_Status_Null=-1,Phone_Status_Idle=0,Phone_Status_IncomingReceived=1,Phone_Status_OutgoingInit=2,Phone_Status_Connected=3,Phone_Status_CallEnd=4;function DisplaySipLog(a,b){if(a&gLogType){var c="";a==SIPADAPTER_Log_Error&&(c="\u3010\u9519\u8bef\u3011\u3010"+getSipTimeString()+"\u3011");a==SIPADAPTER_Log_Warn&&(c="\u3010\u8b66\u544a\u3011\u3010"+getSipTimeString()+"\u3011");a==SIPADAPTER_Log_Debug&&(c="\u3010\u8c03\u8bd5\u3011\u3010"+getSipTimeString()+"\u3011");a==SIPADAPTER_Log_Info&&(c="\u3010\u4fe1\u606f\u3011\u3010"+getSipTimeString()+"\u3011");a==SIPADAPTER_Log_Protocol&&(c="\u3010\u534f\u8bae\u3011\u3010"+getSipTimeString()+"\u3011");b=c+b;a==SIPADAPTER_Log_Protocol&&(b+="\r\n");null!=application&&application.Log(b)}}function stringFormatSip(){if(0==arguments.length)return"";for(var a=arguments[0],b=1;b<arguments.length;b++)a=a.replace(new RegExp("\\{"+(b-1)+"\\}","gm"),arguments[b]);return a}function getSipTimeString(){var a=new Date,b=a.getFullYear(),c=a.getMonth()+1,c=10>c?"0"+c:c,d=a.getDate(),d=10>d?"0"+d:d,e=a.getHours(),e=10>e?"0"+e:e,f=a.getMinutes(),f=10>f?"0"+f:f,g=a.getSeconds(),g=10>g?"0"+g:g,a=a.getMilliseconds();return b.toString()+c.toString()+d.toString()+" "+e.toString()+f.toString()+g.toString()+"  "+a.toString()}function getSipSubString(a,b,c){if(""==b&&""==c)return a;var d="";if(""==b)d=a;else{d=a.indexOf(b);if(0>d)return"";d+=b.length;d=a.substr(d,a.length)}a=d;if(""==c)d=a;else{b=a.indexOf(c);if(0>b)return"";d=a.substr(0,b)}return d}function string2Int(a,b){return""==a||null==a||"undefined"==typeof a?b:parseInt(a)}var SIPTIMER_AUTO=0,g_oJSipTimer=null,SipTimer_Debug=0;function TimerItem(){this.id=-1;this.interval=0;this.intervalCount=this.intervalMax=-1;return this}function JSIPTimer(a){"undefined"==typeof a&&(a=1E3);if(null!=g_oJSipTimer)return g_oJSipTimer._cellInterVal=a,g_oJSipTimer;this._cellInterVal=a;this._bStart=!1;this._onTimerCallBackEvent=null;this._timers=[];this._timerType=SIPTIMER_AUTO;this._timerID=null;this.SetTimerCallBack=function(a){this._onTimerCallBackEvent=a};this.IsProcess=function(){return this._bStart};this.OnTimer=function(){if(null!=this._onTimerCallBackEvent)for(var a=0;a<this._timers.length;a++)0>=this._timers[a].intervalMax||(this._timers[a].intervalCount++,this._timers[a].intervalCount>=this._timers[a].intervalMax&&(this._timers[a].intervalCount=0,this._onTimerCallBackEvent(this._timers[a].id)))};this.Start=function(){this._bStart||(this._timerType==SIPTIMER_AUTO&&null==g_oJSipTimer._timerID&&(g_oJSipTimer._timerID=setInterval(function(){g_oJSipTimer.OnTimer()},g_oJSipTimer._cellInterVal)),this._bStart=!0)};this.Stop=function(){this._bStart&&(null!=g_oJSipTimer._timerID&&(clearInterval(g_oJSipTimer._timerID),g_oJSipTimer._timerID=null),this._bStart=!1)};this.SetTimer=function(a,c){if(0>a||0>=c)return-1;SipTimer_Debug&&DisplayLog(VccBar_Log_Info,stringFormat("JSIPTimer:SetTimer(id\x3d{0} interval\x3d{1})",a,c));if(-1!=this._getTimerIndex(a))return this.Reset(a),-3;var d=new TimerItem;d.id=a;d.interval=c;d.intervalMax=c/this._cellInterVal;this._timers.push(d);SipTimer_Debug&&DisplayLog(VccBar_Log_Info,stringFormat("JSIPTimer:SetTimered(id\x3d{0} interval\x3d{1} interMax\x3d{2})",d.id,d.interval,d.intervalMax));this._display();return this._timers.length-1};this.KillTimer=function(a){var c=this._getTimerIndex(a);SipTimer_Debug&&DisplayLog(VccBar_Log_Info,stringFormat("JSIPTimer:KillTimer(id\x3d{0} )",a));-1!=c&&(a=this._timers[c],SipTimer_Debug&&DisplayLog(VccBar_Log_Info,stringFormat("JSIPTimer:KillTimered(id\x3d{0} interval\x3d{1} interMax\x3d{2})",a.id,a.interval,a.intervalMax)),this._timers.splice(c,1));this._display()};this.Reset=function(a){a=this._getTimerIndex(a);-1!=a&&(this._timers[a].intervalCount=0)};this._getTimerIndex=function(a){for(var c=0;c<this._timers.length;c++)if(this._timers[c].id==a)return c;return-1};this._display=function(){if(SipTimer_Debug)for(var a=0;a<this._timers.length;a++){var c=this._timers[a];DisplayLog(VccBar_Log_Info,stringFormat("TimerItem\u3010{0}\u3011:(id\x3d{1} interval\x3d{2} interMax\x3d{3})",a,c.id,c.interval,c.intervalMax))}};g_oJSipTimer=this;return this}function JACPWebSocket(a){this._msgCallback=this._ws=null;this._appName=a;this.WSConnect=function(a,c,d){try{this._ws=0==d?new WebSocket("ws://"+a+":"+c):new WebSocket("wss://"+a+":"+c)}catch(e){g_DebugFlag&&console.error(e,"WebSocket::WSConnect("+this._appName+")");try{this._ws=0==d?new MozWebSocket("ws://"+a+":"+c):new MozWebSocket("wss://"+a+":"+c)}catch(f){return g_DebugFlag&&console.error(f,"WebSocket::WSConnect("+this._appName+")"),this._ws=null,!1}}0==d?DisplaySipLog(SIPADAPTER_Log_Info,"WebSocket::Connect(ws:"+a+":"+c+") By "+this._appName):DisplaySipLog(SIPADAPTER_Log_Info,"WebSocket::Connect(wss:"+a+":"+c+") By "+this._appName);this._ws.onopen=this._WSonOpen;this._ws.onmessage=this._WSonMessage;this._ws.onclose=this._WSonClose;this._ws.onerror=this._WSonError;this._ws.oParent=this;return!0};this.WSDisconnect=function(){null!=this._ws&&(this._ws.readyState!=WS_STATUS_SIP_CONNECTING&&this._ws.readyState!=WS_STATUS_SIP_OPEN||this._ws.close())};this.WSSendMsg=function(a){return null==this._ws||""==a?!1:this._ws.readyState==WS_STATUS_SIP_OPEN?(DisplaySipLog(SIPADAPTER_Log_Protocol,stringFormatSip("Sen{0}:{1}",this._appName,a)),this._ws.send(a),!0):!1};this.WSIsConnect=function(){return null==this._ws?!1:this._ws.readyState==WS_STATUS_SIP_OPEN};this.WSGetConnectStatus=function(){return null!=this._ws?this._ws.readyState:WS_STATUS_SIP_NULL};this.SetMsgCallBack=function(a){this._msgCallback=a};this._WSonOpen=function(){DisplaySipLog(SIPADAPTER_Log_Info,"WebSocket::WSonOpen("+this.oParent._appName+")");this.oParent._invokeCallBack(WS_EVENT_SIP_ONOPEN,"")};this._WSonMessage=function(a){DisplaySipLog(SIPADAPTER_Log_Protocol,stringFormatSip("Rec{0}:{1}",this.oParent._appName,a.data));this.oParent._invokeCallBack(WS_EVENT_SIP_ONMESSAGE,a.data)};this._WSonClose=function(){DisplaySipLog(SIPADAPTER_Log_Error,"WebSocket::WSonClose("+this.oParent._appName+")");this.oParent._invokeCallBack(WS_EVENT_SIP_ONCLOSE,"")};this._WSonError=function(a){DisplaySipLog(SIPADAPTER_Log_Error,"WebSocket::WSonError("+this.oParent._appName+")");this.oParent._invokeCallBack(WS_EVENT_SIP_ONERROR,"")};this._invokeCallBack=function(a,c){null!=this._msgCallback&&this._msgCallback(a,c)};this._APSPInit=function(){};this._APSPInit();return this}BuildApspMsg=function(a,b,c){var d='\x3capspMessage ver\x3d"2.0.0" time\x3d"'+getSipTimeString()+'"\x3e',d=d+'\x3cheader\x3e\x3csessionID\x3e0\x3c/sessionID\x3e\x3c/header\x3e\x3cbody type\x3d"command" name\x3d"'+a+'"\x3e',d="undefined"==typeof c?d+"\x3cpaspparam\x3e"+b+"\x3c/paspparam\x3e":d+"\x3cpaspparam\x3e"+b+"|"+c+"\x3c/paspparam\x3e";return d+="\x3c/body\x3e\x3c/apspMessage\x3e"};function getsipLocalLanguage(){var a="",a="Netscape"==navigator.appName?navigator.language:navigator.userLanguage;return a.toLowerCase()}function OnDisconnectRSIP(a){1==a.config.Registered&&(a.config.Registered=!1,a.OnLogoutSuccess());a.DisconnectToSipServer()}function ReRegiter(a){a.OnDebug("ReRegiter.....!");a.RegisterPA()}function JGuardCtrl(a){this.oGuradWS=null;this._ctrlStatus=barStatus_Null;this._connectCount=0;this._oParent=a;this._cmdType=cmd_GuardType_Null;this._cmdParam2=this._cmdParam1="";this._Create=function(){this.oGuradWS=new JACPWebSocket("CINGuard");this.oGuradWS.SetMsgCallBack(this.apspCallbackGurad);this.oGuradWS.oParent=this};this.exeGuardCmd=function(a,c,d){this._cmdType=a;this._cmdParam1=c;this._cmdParam2=d;this._ctrlStatus==barStatus_Null&&(this._ctrlStatus=barStatus_GuardConnecting,this.connectToService(this._oParent.config.RemoteSipServer,this._oParent.config.LocalGuardPort));return 0};this.connectToService=function(a,c){this.oGuradWS.WSConnect(a,c,0);this._ctrlStatus==barStatus_GuardConnecting&&this._oParent.OnDebug("\u6b63\u5728\u8fde\u63a5\u7535\u8bdd\u536b\u58eb\u3010"+a+":"+c+"\u3011...\u7b2c\u3010"+this._connectCount+"\u3011\u6b21");this._connectCount+=1};this._InvokeMethod=function(a,c){if(""==a)return-1;DisplaySipLog(SIPADAPTER_Log_Info,"JGuardCtrl:_InvokeMethod(cmdName\x3d"+a+",param\x3d"+c+")");this.oGuradWS.WSSendMsg(BuildApspMsg(a,c))};this.apspCallbackGurad=function(a,c){var d=this.oParent;if(a==WS_EVENT_SIP_ONOPEN)d._ctrlStatus=barStatus_GuardConnected,d._cmdType==cmd_GuardType_GetSipLocalPort&&d._InvokeMethod("GetSipLocalPort",d._oParent.config.RemoteSipServerPort+"|"+continueSipExe+"|"+sipAdapterTypeRemoteSip+"|"+d._oParent.config.SessionID);else if(a==WS_EVENT_SIP_ONCLOSE)d._ctrlStatus==barStatus_GuardDisconnecting&&(d._ctrlStatus=barStatus_GuardDisconnected,d._oParent.ConnectToSipServer(),d._ctrlStatus=barStatus_Null);else if(a==WS_EVENT_SIP_ONERROR)d._ctrlStatus==barStatus_GuardConnecting&&(d._connectCount<PORT_COUNT?(d._oParent.config.LocalGuardPort+=1,d.connectToService(d._oParent.config.RemoteSipServer,d._oParent.config.LocalGuardPort)):(d._oParent.config.LocalGuardPort=4510,d._oParent.OnDebug("\u7535\u8bdd\u6761\u536b\u58eb\u8fde\u63a5\u5931\u8d25\uff01"),d._oParent.OnError(CINGUARD_ERROR_NotStart)));else if(a==WS_EVENT_SIP_ONMESSAGE){if(d._ctrlStatus==barStatus_GuardConnected){d.oGuradWS.WSDisconnect();var e=getSipSubString(c,"\x3cpaspparam\x3e","\x3c/paspparam\x3e");d._oParent.config.RemoteSipServerPort=parseInt(e);-1==d._oParent.config.RemoteSipServerPort?d._oParent.OnError(CINGUARD_ERROR_MISSRMSIP):-2==d._oParent.config.RemoteSipServerPort?d._oParent.OnError(CINGUARD_ERROR_NotSetupRMSIP):-3==d._oParent.config.RemoteSipServerPort&&d._oParent.OnError(CINGUARD_ERROR_NotRePlaceRMSIP)}d._ctrlStatus=barStatus_GuardDisconnecting;d._cmdType=cmd_GuardType_Null;d._cmdParam1="";d._cmdParam2="";d._connectCount=0}};this._Create();return this}function SIPRemoteCtrl(){this.config={Dn:"",SipServerIP:"",SipServerPort:9060,SipProtocol:"",AuthType:1,Domain:"",PassWord:"",Registered:!1,RemoteSipServerPort:19060,RemoteSipServer:"127.0.0.1",LocalGuardPort:4510,ConnectCount:0,ReConnected:!1,AutoAnswer:!1,AutoRegister:!1,SessionID:"",SingleCall:!0,CallTarget:""};this._oCINGuard=this._SocketCallback=this._oRemoteSipSocket=null;this._sipConnectStatus=barStatus_Null;this._phoneStatus=Phone_Status_Null;this._Create=function(){this._oRemoteSipSocket=new JACPWebSocket("RemoteSIP");this._oRemoteSipSocket.oParent=this;this._oRemoteSipSocket.SetMsgCallBack(this._SocketCallBack);this._oCINGuard=new JGuardCtrl(this);this.config.SessionID="TCP-"+getCurrentTimeString()};this._SocketCallBack=function(a,b){var c=this.oParent;if(a==WS_EVENT_SIP_ONOPEN)c._sipConnectStatus==barStatus_SipConnecting&&(c._sipConnectStatus=barStatus_SipConnected,1==c.config.AutoRegister?c.RegisterPA():c.InitialPA());else if(a==WS_EVENT_SIP_ONCLOSE)c._sipConnectStatus==barStatus_SipDisconnecting?c._sipConnectStatus=barStatus_SipDisconnected:c._sipConnectStatus==barStatus_SipConnected&&(c._sipConnectStatus=barStatus_SipReconnecting,c.config.Registered=!1,c.config.ReConnected=!0,c.Initial());else if(a==WS_EVENT_SIP_ONERROR)c._sipConnectStatus==barStatus_SipConnecting?c.config.ConnectCount<PORT_COUNT?(c.config.RemoteSipServerPort+=2,c.ConnectToSipServer()):(c.config.RemoteSipServerPort=19060,c.OnDebug("RMSIP\u670d\u52a1\u8fde\u63a5\u5931\u8d25\uff01"),c._sipConnectStatus=barStatus_Null):c._sipConnectStatus==barStatus_SipConnected&&(c._sipConnectStatus=barStatus_SipReconnecting,c.Initial());else if(a==WS_EVENT_SIP_ONMESSAGE){1==gSIP_Log_Protocol&&c.OnDebug("RevSIP:"+b);var d=getSipSubString(b,'name\x3d"','"'),e=getSipSubString(b,"\x3cpaspparam\x3e","\x3c/paspparam\x3e");"Register"==d?"0"==e?c.OnDebug("RemoteSip\u521d\u59cb\u5316\u6210\u529f\uff0c\u6b63\u5728\u6ce8\u518c!"):"-1"==e?c.OnLoginFailure(RMSIP_ERROR_RegisterFAILURE):"-2"==e?c.OnLoginFailure(RMSIP_ERROR_InitialFAILURE):"-3"==e&&c.OnLoginFailure(RMSIP_ERROR_ErrorParam):"Initial"==d?"0"==e?0==c.config.SingleCall?(c.OnDebug("RemoteSip\u521d\u59cb\u5316\u6210\u529f!"),c.OnInitialSuccess()):setTimeout(function(){c.OnDebug("\u547c\u53eb\u4e2d...");c._SendMsg("DoCall",c.config.CallTarget+"|")},1E3):"-1"==e?0==c.config.SingleCall&&c.OnInitialFailure(RMSIP_ERROR_InitialFAILURE):"-2"==e?(c.OnDebug("RemoteSip\u521d\u59cb\u5316\u5931\u8d25!"),0==c.config.SingleCall&&c.OnInitialFailure(RMSIP_ERROR_InitialFAILURE)):"-3"==e&&(c.OnDebug("SIP\u53c2\u6570\u9519\u8bef!"),0==c.config.SingleCall&&c.OnInitialFailure(RMSIP_ERROR_ErrorParam)):"UnRegister"==d?setTimeout(function(){OnDisconnectRSIP(c)},1E3):"Pickup"!=d&&"Reject"!=d&&"Disconnect"!=d&&"SendDTMF"!=d&&"DoCall"!=d&&("OnLoginSuccess"==d?(c.config.Registered=!0,0==c.config.ReConnected?c.OnLoginSuccess():(c.config.ReConnected=!1,c.OnDebug("RemoteSip\u6ce8\u518c\u6210\u529f!"))):"OnLoginFailure"==d?c.config.Registered?setTimeout(function(){ReRegiter(c)},1E3):(c.config.Registered=!1,c.OnLoginFailure(e,""),c.DisconnectToSipServer()):"OnLogoutSuccess"==d?(c.config.Registered=!1,c.OnLogoutSuccess(),c.DisconnectToSipServer()):"OnRing"==d?(c.OnRing(e),1==c.config.AutoAnswer&&c.Pickup()):"OnDisconnected"==d?1==c.config.SingleCall?c.UnInitial():c.OnDisconnected():"OnConnected"==d?c.OnConnected(e):"OnOrigated"==d?c.OnOrigated():"OnError"==d?c.OnError(e,""):"OnKickOff"==d&&(c.config.Registered=!1,c.OnLogoutSuccess(),c.OnError(RMSIP_ERROR_OnKickOff),c.DisconnectToSipServer()))}};this._SendMsg=function(a,b){if(!this._oRemoteSipSocket.WSIsConnect())return RSIP_SUCCESS;var c=BuildApspMsg(a,b,this.config.SessionID);1==gSIP_Log_Protocol&&this.OnDebug("SendSIP:"+c);return this._oRemoteSipSocket.WSSendMsg(c)?RSIP_SUCCESS:RSIP_FAILURE};this.ConnectToSipServer=function(){this._sipConnectStatus=barStatus_SipConnecting;this.config.ConnectCount+=1;return this._oRemoteSipSocket.WSConnect(this.config.RemoteSipServer,this.config.RemoteSipServerPort,0)?ACPI_SIP_SUCCESS:ACPI_SIP_FAILURE};this.DisconnectToSipServer=function(){this._sipConnectStatus=barStatus_SipDisconnecting;return this._oRemoteSipSocket.WSDisconnect()?ACPI_SIP_SUCCESS:ACPI_SIP_FAILURE};this.Initial=function(){if(this._sipConnectStatus==barStatus_SipConnected)return-1;this.OnDebug("\u521d\u59cb\u5316...");this._oCINGuard.exeGuardCmd(cmd_GuardType_GetSipLocalPort,"","");return 0};this.UnInitial=function(){return this.ReleasePA()};this.RegisterPA=function(){return this._SendMsg("Register",stringFormatSip("{0}|{1}|{2}|{3}|{4}|{5}|{6}|",this.config.Dn,this.config.SipServerIP,this.config.SipServerPort,this.config.SipProtocol,this.config.AuthType,this.config.Domain,this.config.PassWord))};this.InitialPA=function(){return this._SendMsg("Initial",stringFormatSip("{0}|{1}|{2}|{3}|{4}|{5}|{6}|",this.config.Dn,this.config.SipServerIP,this.config.SipServerPort,this.config.SipProtocol,this.config.AuthType,this.config.Domain,this.config.PassWord))};this.ReleasePA=function(){return this._SendMsg("UnRegister","|")};this.Pickup=function(){return this._SendMsg("Pickup","|")};this.Reject=function(){return this._SendMsg("Reject","|")};this.Disconnect=function(){return this._SendMsg("Disconnect","|")};this.SendDTMF=function(a){var b=string2Int(a,-1);return 0>b||15<b?(this.OnDebug("SendDTMF\u53c2\u6570\u4e0d\u5728[0~15]\u8303\u56f4\u5185"),-1):this._SendMsg("SendDTMF",a+"|")};this.DoCall=function(a){return this._sipConnectStatus!=barStatus_SipConnected?(this.Initial(),this.config.CallTarget=a,RSIP_SUCCESS):this._SendMsg("DoCall",a+"|")};this.SetAttribute=function(a,b){"Dn"==a?this.config.Dn=b:"SipServerIP"==a?this.config.SipServerIP=b:"SipServerPort"==a?this.config.SipServerPort=b:"SipProtocol"==a?this.config.SipProtocol=b:"AuthType"==a?this.config.AuthType=b:"Domain"==a?this.config.Domain=b:"PassWord"==a?this.config.PassWord=b:"AutoAnswer"==a?this.config.AutoAnswer=b:"AutoRegister"==a&&(this.config.AutoRegister=b)};this.GetAttribute=function(a){return"Dn"==a?this.config.Dn:"SipServerIP"==a?this.config.SipServerIP:"SipServerPort"==a?this.config.SipServerPort:"SipProtocol"==a?this.config.SipProtocol:"AuthType"==a?this.config.AuthType:"Domain"==a?this.config.Domain:"PassWord"==a?this.config.PassWord:"AutoAnswer"==a?this.config.AutoAnswer:"AutoRegister"==a?this.config.AutoRegister:""};this.OnRing=function(a){};this.OnOrigated=function(){};this.OnDisconnected=function(){};this.OnConnected=function(a){};this.OnError=function(a,b){};this.OnInitialSuccess=function(){};this.OnInitialFailure=function(a,b){};this.OnLoginSuccess=function(){};this.OnLoginFailure=function(){};this.OnLogoutSuccess=function(a,b){};this.OnDebug=function(a){};this._Create();return this}var G_appHttpSip=null;function HttpSipResponse(a){null!=G_appHttpSip&&G_appHttpSip._HttpCallBackEvent(a)}function getCurrentTimeString(){var a=new Date,b=a.getFullYear(),c=a.getMonth()+1,c=10>c?"0"+c:c,d=a.getDate(),d=10>d?"0"+d:d,e=a.getHours(),e=10>e?"0"+e:e,f=a.getMinutes(),f=10>f?"0"+f:f,g=a.getSeconds(),g=10>g?"0"+g:g,a=a.getMilliseconds();return b.toString()+c.toString()+d.toString()+e.toString()+f.toString()+g.toString()+"-"+a.toString()}function SIPRemoteHttpCtrl(){this.config={Dn:"",SipServerIP:"",SipServerPort:9060,SipProtocol:"",AuthType:1,Domain:"",PassWord:"",Registered:!1,RemoteSipServerPort:19060,RemoteSipServer:"127.0.0.1",LocalGuardPort:4510,ConnectCount:0,AutoAnswer:!1,AutoRegister:!0,SessionID:"",SingleCall:!0,CallTarget:""};this._oScrip=null;this._bSipPhoneBegin=!1;this._oTimer=null;G_appHttpSip=this;this._arrRequestURL=[];this._LOSTCOUNT=5;this._Create=function(){this._oTimer=new JSIPTimer;this._oTimer.oParent=this;this._oTimer.SetTimerCallBack(this._OnTimerEvent);this._oTimer.Start();this.config.SessionID="HTTP-"+getCurrentTimeString()};this._HttpGet=function(a,b){var c=stringFormatSip("http://{0}:{1}/{2}?\x3d{3}|HttpSipResponse|{4}|{5}",this.config.RemoteSipServer,this.config.RemoteSipServerPort,a,b,this.config.SessionID,getCurrentTimeString());1==gSIP_Log_Protocol&&this.OnDebug("HttpGet:"+c);this._HttpResquest(c);return 0};this._GuardHttpGet=function(a,b){if(this.config.ConnectCount>=this._LOSTCOUNT)this.OnError(CINGUARD_ERROR_NotStart),this._ResetStatus();else{var c=stringFormatSip("http://{0}:{1}/{2}?\x3d{3}|HttpSipResponse|{4}",this.config.RemoteSipServer,this.config.LocalGuardPort,a,b,getCurrentTimeString());1==gSIP_Log_Protocol&&this.OnDebug("GuardHttpGet:"+c);this._HttpGuardResquest(c);this.OnDebug("\u6b63\u5728\u8fde\u63a5\u7535\u8bdd\u6761\u536b\u58eb\u3010"+this.config.RemoteSipServer+":"+this.config.LocalGuardPort+"\u3011...\u7b2c\u3010"+this.config.ConnectCount+"\u3011\u6b21");this.config.ConnectCount++;return 0}};this._HttpGuardResquest=function(a){null!=this._oScrip&&(document.body.removeChild(this._oScrip),this._oScrip=null);try{this._oScrip=document.createElement("script"),this._oScrip.src=a,document.body.insertBefore(this._oScrip,document.body.firstChild)}catch(b){alert(b)}};this._HttpResquest=function(a){null!=this._oScrip&&(document.body.removeChild(this._oScrip),this._oScrip=null);try{this._arrRequestURL.length>this._LOSTCOUNT&&(this._bSipPhoneBegin=!1,this._oTimer.KillTimer(Sip_HttpMsgQueue_ID),this.config.Registered=!1,this._arrRequestURL.splice(0,this._arrRequestURL.length),this._BeginRMSipPhone()),this._arrRequestURL.push(a),this._oScrip=document.createElement("script"),this._oScrip.src=a,document.body.insertBefore(this._oScrip,document.body.firstChild)}catch(b){alert(b)}};this._QueryMsgQueue=function(){return this._HttpGet("QueryMsgQueue","")};this._BeginRMSipPhone=function(){if(0==this._bSipPhoneBegin)return this._oTimer.SetTimer(Sip_HttpGuardConnect_ID,5E3),this._GuardHttpGet("BeignRMSIP","19060|"+continueSipExe+"|"+sipAdapterTypeRemoteHttpSip+"|"+this.config.SessionID)};this._EndRMSipPhone=function(){return this._GuardHttpGet("EndRMSIP","")};this._ResetStatus=function(){this._bSipPhoneBegin=!1;this._oTimer.KillTimer(Sip_HttpMsgQueue_ID);this._oTimer.KillTimer(Sip_HttpGuardConnect_ID);this.config.Registered=!1;this.config.ConnectCount=0;this._arrRequestURL.splice(0,this._arrRequestURL.length)};this._OnTimerEvent=function(a){var b=this.oParent;a==Sip_HttpMsgQueue_ID?b._QueryMsgQueue():a==Sip_HttpGuardConnect_ID&&b._GuardHttpGet("BeignRMSIP","19060|"+continueSipExe+"|"+sipAdapterTypeRemoteHttpSip+"|"+b.config.SessionID)};this._HttpCallBackEvent=function(a){1==gSIP_Log_Protocol&&this.OnDebug("RevSIP:"+a);var b=getSipSubString(a,'name\x3d"','"');a=getSipSubString(a,"\x3cpaspparam\x3e","\x3c/paspparam\x3e");0<this._arrRequestURL.length&&this._arrRequestURL.splice(0,this._arrRequestURL.length);"BeignRMSIP"==b?(this.OnDebug("RemoteSip\u5df2\u7ecf\u542f\u52a8!"),this._oTimer.KillTimer(Sip_HttpGuardConnect_ID),this.config.ConnectCount=0,this.config.RemoteSipServerPort=parseInt(a),-1==this.config.RemoteSipServerPort?this.OnError(CINGUARD_ERROR_MISSRMSIP):-2==this.config.RemoteSipServerPort?this.OnError(CINGUARD_ERROR_NotSetupRMSIP):(this._bSipPhoneBegin=!0,1==this.config.AutoRegister&&this.RegisterPA())):"EndRMSIP"==b?(this.OnDebug("RemoteSip\u5df2\u7ecf\u7ed3\u675f!"),this._bSipPhoneBegin=!1,this._oTimer.KillTimer(Sip_HttpMsgQueue_ID),this.config.Registered=!1,this.OnLogoutSuccess()):"NewSession"==b?(this._ResetStatus(),this.OnError(RMSIP_ERROR_OnKickOff),this.OnLogoutSuccess()):"Register"==b?"0"==a?(this.OnDebug("RemoteSip\u521d\u59cb\u5316\u6210\u529f\uff0c\u6b63\u5728\u6ce8\u518c!"),this._oTimer.SetTimer(Sip_HttpMsgQueue_ID,Sip_HttpMsgQueue_TimeInterval)):"-1"==a?this.OnLoginFailure(RMSIP_ERROR_RegisterFAILURE):"-2"==a?this.OnLoginFailure(RMSIP_ERROR_InitialFAILURE):"-3"==a&&(this.OnDebug("\u53c2\u6570\u9519\u8bef!"),this.OnLoginFailure(RMSIP_ERROR_ErrorParam)):"UnRegister"==b?(this._ResetStatus(),this.OnLogoutSuccess()):"Pickup"!=b&&"Reject"!=b&&"Disconnect"!=b&&"SendDTMF"!=b&&"DoCall"!=b&&("OnLoginSuccess"==b?(this.config.Registered=!0,this.OnLoginSuccess()):"OnLoginFailure"==b?(this.config.Registered=!1,a.split("|"),this.OnLoginFailure(a,""),this._ResetStatus()):"OnLogoutSuccess"==b?(this.config.Registered=!1,this.OnLogoutSuccess(),this._ResetStatus()):"OnRing"==b?(this.OnRing(a),1==this.config.AutoAnswer&&this.Pickup()):"OnDisconnected"==b?this.OnDisconnected():"OnConnected"==b?this.OnConnected(a):"OnOrigated"==b?this.OnOrigated():"OnError"==b&&this.OnError(a,""))};this.Initial=function(){return this._BeginRMSipPhone()};this.UnInitial=function(){1==this._bSipPhoneBegin?this.ReleasePA():this._EndRMSipPhone();return 0};this.RegisterPA=function(){return 0==this._bSipPhoneBegin?0:this._HttpGet("Register",stringFormatSip("{0}|{1}|{2}|{3}|{4}|{5}|{6}",this.config.Dn,this.config.SipServerIP,this.config.SipServerPort,this.config.SipProtocol,this.config.AuthType,this.config.Domain,this.config.PassWord))};this.ReleasePA=function(){return this._HttpGet("UnRegister","")};this.Pickup=function(){return this._HttpGet("Pickup","")};this.Reject=function(){return this._HttpGet("Reject","")};this.Disconnect=function(){return this._HttpGet("Disconnect","")};this.SendDTMF=function(a){return this._HttpGet("SendDTMF",target)};this.DoCall=function(a){return this._HttpGet("DoCall",a)};this.SetAttribute=function(a,b){"Dn"==a?this.config.Dn=b:"SipServerIP"==a?this.config.SipServerIP=b:"SipServerPort"==a?this.config.SipServerPort=b:"SipProtocol"==a?this.config.SipProtocol=b:"AuthType"==a?this.config.AuthType=b:"Domain"==a?this.config.Domain=b:"PassWord"==a?this.config.PassWord=b:"AutoAnswer"==a?this.config.AutoAnswer=b:"AutoRegister"==a&&(this.config.AutoRegister=b)};this.GetAttribute=function(a){return"Dn"==a?this.config.Dn:"SipServerIP"==a?this.config.SipServerIP:"SipServerPort"==a?this.config.SipServerPort:"SipProtocol"==a?this.config.SipProtocol:"AuthType"==a?this.config.AuthType:"Domain"==a?this.config.Domain:"PassWord"==a?this.config.PassWord:"AutoAnswer"==a?this.config.AutoAnswer:"AutoRegister"==a?this.config.AutoRegister:""};this.OnRing=function(a){};this.OnOrigated=function(){};this.OnDisconnected=function(){};this.OnConnected=function(a){};this.OnError=function(a,b){};this.OnInitialSuccess=function(){};this.OnInitialFailure=function(a,b){};this.OnLoginSuccess=function(){};this.OnLoginFailure=function(a,b){};this.OnLogoutSuccess=function(){};this.OnDebug=function(a){};this._Create();return this}function SIPAdapterCtrl(a,b){this.path=b;this.sipType=a;this.oSipCtrl=null;this.realSipType=a;this.language=getsipLocalLanguage();this.ErrorsTable={items:[{code:CINGUARD_ERROR_NotStart,des:"\u7535\u8bdd\u6761\u536b\u58eb\u6ca1\u6709\u542f\u52a8",eng_des:"CINGuard.exe not start"},{code:CINGUARD_ERROR_MISSRMSIP,des:"CINRMSIP.exe\u4e0d\u5b58\u5728",eng_des:"CINRMSIP.exe not exist"},{code:CINGUARD_ERROR_NotSetupRMSIP,des:"SIP\u7535\u8bdd\u5b89\u88c5\u5305\u5b89\u88c5\u4e0d\u6b63\u786e",eng_des:"CINRMSIP package setup failure"},{code:CINGUARD_ERROR_NotRePlaceRMSIP,des:"SIP\u7535\u8bdd\u6b63\u5728\u4f7f\u7528\u4e14\u4e0d\u5141\u8bb8\u88ab\u66ff\u6362",eng_des:"CINRMSIP currently In use and not allowed to be replaced"},{code:RMSIP_ERROR_OnKickOff,des:"RemoteSip\u88ab\u5176\u4ed6\u5e94\u7528\u4f7f\u7528",eng_des:"RemoteSip used by other application"},{code:RMSIP_ERROR_RegisterFAILURE,des:"RemoteSip\u521d\u59cb\u5316\u6210\u529f\uff0c\u6ce8\u518c\u5931\u8d25",eng_des:"RemoteSip register failured"},{code:RMSIP_ERROR_InitialFAILURE,des:"RemoteSip\u521d\u59cb\u5316\u5931\u8d25",eng_des:"RemoteSip init failured"},{code:RMSIP_ERROR_ErrorParam,des:"SIP\u53c2\u6570\u9519\u8bef",eng_des:"bad sip parameter"},{code:100,des:"Trying",eng_des:"Trying"},{code:180,des:"Ringing",eng_des:"Ringing"},{code:181,des:"Call Is Being Forwarded",eng_des:"Call Is Being Forwarded"},{code:182,des:"Queued",eng_des:"Queued"},{code:183,des:"Session Progress",eng_des:"Session Progress"},{code:199,des:"Early Dialog Terminated",eng_des:"Early Dialog Terminated"},{code:200,des:"OK",eng_des:"OK"},{code:202,des:"Accepted",eng_des:"Accepted"},{code:204,des:"No Notification",eng_des:"No Notification"},{code:300,des:"Multiple Choices",eng_des:"Multiple Choices"},{code:301,des:"Moved Permanently",eng_des:"Moved Permanently"},{code:302,des:"Moved Temporarily",eng_des:"Moved Temporarily"},{code:305,des:"Use Proxy",eng_des:"Use Proxy"},{code:380,des:"Alternative Service",eng_des:"Alternative Service"},{code:400,des:"Bad Request",eng_des:"Bad Request"},{code:401,des:"Unauthorized",eng_des:"Unauthorized"},{code:402,des:"Payment Required",eng_des:"Payment Required"},{code:403,des:"Forbidden",eng_des:"Forbidden"},{code:404,des:"Not Found",eng_des:"Not Found"},{code:405,des:"Method Not Allowed",eng_des:"Method Not Allowed"},{code:406,des:"Not Acceptable",eng_des:"Not Acceptable"},{code:407,des:"Proxy Authentication Required",eng_des:"Proxy Authentication Required"},{code:408,des:"Request Timeout",eng_des:"Request Timeout"},{code:410,des:"Gone",eng_des:"Gone"},{code:412,des:"Conditional Request Failed",eng_des:"Conditional Request Failed"},{code:413,des:"Request Entity Too Large",eng_des:"Request Entity Too Large"},{code:414,des:"Request-URI Too Long",eng_des:"Request-URI Too Long"},{code:415,des:"Unsupported Media Type",eng_des:"Unsupported Media Type"},{code:416,des:"Unsupported URI Scheme",eng_des:"Unsupported URI Scheme"},{code:417,des:"Unknown Resource-Priority",eng_des:"Unknown Resource-Priority"},{code:420,des:"Bad Extension",eng_des:"Bad Extension"},{code:421,des:"Extension Required",eng_des:"Extension Required"},{code:422,des:"Session Interval Too Small",eng_des:"Session Interval Too Small"},{code:423,des:"Interval Too Brief",eng_des:"Interval Too Brief"},{code:428,des:"Use Identity Header",eng_des:"Use Identity Header"},{code:429,des:"Provide Referrer Identity",eng_des:"Provide Referrer Identity"},{code:430,des:"Flow Failed",eng_des:"Flow Failed"},{code:433,des:"Anonymity Disallowed",eng_des:"Anonymity Disallowed"},{code:436,des:"Bad Identity-Info",eng_des:"Bad Identity-Info"},{code:437,des:"Unsupported Certificate",eng_des:"Unsupported Certificate"},{code:438,des:"Invalid Identity Header",eng_des:"Invalid Identity Header"},{code:439,des:"First Hop Lacks Outbound Support",eng_des:"First Hop Lacks Outbound Support"},{code:440,des:"Max-Breadth Exceeded",eng_des:"Max-Breadth Exceeded"},{code:469,des:"Bad Info Package",eng_des:"Bad Info Package"},{code:470,des:"Consent Needed",eng_des:"Consent Needed"},{code:478,des:"Unresolvable Destination",eng_des:"Unresolvable Destination"},{code:480,des:"Temporarily Unavailable",eng_des:"Temporarily Unavailable"},{code:481,des:"Call/Transaction Does Not Exist",eng_des:"Call/Transaction Does Not Exist"},{code:482,des:"Loop Detected",eng_des:"Loop Detected"},{code:483,des:"Too Many Hops",eng_des:"Too Many Hops"},{code:484,des:"Address Incomplete",eng_des:"Address Incomplete"},{code:485,des:"Ambiguous",eng_des:"Ambiguous"},{code:486,des:"Busy Here",eng_des:"Busy Here"},{code:487,des:"Request Terminated",eng_des:"Request Terminated"},{code:488,des:"Not Acceptable Here",eng_des:"Not Acceptable Here"},{code:489,des:"Bad Event",eng_des:"Bad Event"},{code:491,des:"Request Pending",eng_des:"Request Pending"},{code:493,des:"Undecipherable",eng_des:"Undecipherable"},{code:494,des:"Security Agreement Required",eng_des:"Security Agreement Required"},{code:500,des:"JsSIP Internal Error",eng_des:"JsSIP Internal Error"},{code:501,des:"Not Implemented",eng_des:"Not Implemented"},{code:502,des:"Bad Gateway",eng_des:"Bad Gateway"},{code:503,des:"Service Unavailable",eng_des:"Service Unavailable"},{code:504,des:"Server Time-out",eng_des:"Server Time-out"},{code:505,des:"Version Not Supported",eng_des:"Version Not Supported"},{code:513,des:"Message Too Large",eng_des:"Message Too Large"},{code:580,des:"Precondition Failure",eng_des:"Precondition Failure"},{code:600,des:"Busy Everywhere",eng_des:"Busy Everywhere"},{code:603,des:"Decline",eng_des:"Decline"},{code:604,des:"Does Not Exist Anywhere",eng_des:"Does Not Exist Anywhere"},{code:606,des:"Not Acceptable",eng_des:"Not Acceptable"}]};this._Create=function(){switch(this.sipType){case sipAdapterTypeJSip:this.oSipCtrl=new SIPCtrl(this.path);break;case sipAdapterTypeRemoteSip:this.oSipCtrl=new SIPRemoteCtrl;break;case sipAdapterTypeRemoteHttpSip:this.oSipCtrl=new SIPRemoteHttpCtrl;break;default:alert("Not surpport this sip mode");return}this.oSipCtrl.oParent=this;this.oSipCtrl.OnRing=this._OnSipApaterEventOnRing;this.oSipCtrl.OnOrigated=this._OnSipApaterEventOnOrigated;this.oSipCtrl.OnDisconnected=this._OnSipApaterEventOnDisconnected;this.oSipCtrl.OnConnected=this._OnSipApaterEventOnConnected;this.oSipCtrl.OnError=this._OnSipApaterEventOnError;this.oSipCtrl.OnInitialSuccess=this._OnSipApaterEventOnInitialSuccess;this.oSipCtrl.OnInitialFailure=this._OnSipApaterEventOnInitialFailure;this.oSipCtrl.OnLoginSuccess=this._OnSipApaterEventOnLoginSuccess;this.oSipCtrl.OnLoginFailure=this._OnSipApaterEventOnLoginFailure;this.oSipCtrl.OnLogoutSuccess=this._OnSipApaterEventOnLogoutSuccess;this.oSipCtrl.OnDebug=this._OnSipApaterEventDebug;this.sipType==sipAdapterTypeJSip&&(this.oSipCtrl.OnReportScense=this._OnSipApaterEventReportScense,this.oSipCtrl.OnMessage=this._OnSipApaterEventOnMessage)};this._GetBrowerSys=function(){this.version=this.os="";var a=navigator.userAgent.toLowerCase();0<a.indexOf("msie")?(this.os="msie",this.version=a.match(/msie ([\d.]+)/)[1]):0<a.lastIndexOf("firefox")?(this.os="firefox",this.version=a.match(/firefox\/([\d.]+)/)[1]):0<a.lastIndexOf("chrome")?(this.os="chrome",this.version=a.match(/chrome\/([\d.]+)/)[1]):0<a.lastIndexOf("trident")?(this.os="msie",this.version=a.match(/rv:([\d.]+)/)[1]):(this.os=a,this.version="");return this};this._OnSipApaterEventOnRing=function(a){DisplaySipLog(SIPADAPTER_Log_Info,"SipApaterEventOnRing");this.oParent.OnRing(a)};this._OnSipApaterEventOnOrigated=function(a){DisplaySipLog(SIPADAPTER_Log_Info,"SipApaterEventOnOrigated");this.oParent.OnOrigated(a)};this._OnSipApaterEventOnDisconnected=function(){DisplaySipLog(SIPADAPTER_Log_Info,"SipApaterEventOnDisconnected");this.oParent.OnDisconnected()};this._OnSipApaterEventOnConnected=function(a){DisplaySipLog(SIPADAPTER_Log_Info,"SipApaterEventOnConnected");this.oParent.OnConnected(a)};this._OnSipApaterEventOnError=function(a,b){"undefined"==typeof b&&(b=this.oParent._GetErrorDes(a));DisplaySipLog(SIPADAPTER_Log_Info,stringFormatSip("SipApaterEventOnError({0},{1})",a,b));this.oParent.OnError(a,b)};this._OnSipApaterEventOnLoginSuccess=function(){DisplaySipLog(SIPADAPTER_Log_Info,"SipApaterEventOnLoginSuccess");this.oParent.OnLoginSuccess()};this._OnSipApaterEventOnLoginFailure=function(a,b){"undefined"==typeof b&&(b=this.oParent._GetErrorDes(a));""==b&&(b=this.oParent._GetErrorDes(a));DisplaySipLog(SIPADAPTER_Log_Info,stringFormatSip("SipApaterEventOnLoginFailure({0},{1})",a,b));this.oParent.OnLoginFailure(a,b)};this._OnSipApaterEventOnLogoutSuccess=function(){DisplaySipLog(SIPADAPTER_Log_Info,"SipApaterEventOnLogoutSuccess");this.oParent.OnLogoutSuccess()};this._OnSipApaterEventDebug=function(a){DisplaySipLog(SIPADAPTER_Log_Info,"SipApaterEventDebug:"+a);this.oParent.OnDebug(a)};this._GetErrorDes=function(a){for(var b=0;b<this.ErrorsTable.items.length;b++)if(this.ErrorsTable.items[b].code==a)return this.language==lg_zhcn_sip?this.ErrorsTable.items[b].des:this.ErrorsTable.items[b].eng_des};this._OnSipApaterEventReportScense=function(a){DisplaySipLog(SIPADAPTER_Log_Info,"SipApaterEventReportScense");this.oParent.OnReportScense(a)};this._OnSipApaterEventOnMessage=function(a,b,e,f){DisplaySipLog(SIPADAPTER_Log_Info,"SipApaterEventOnMessage");this.oParent.OnMessage(a,b,e,f)};this._OnSipApaterEventOnInitialSuccess=function(){DisplaySipLog(SIPADAPTER_Log_Info,"SipApaterEventOnInitialSuccess");this.oParent.OnInitialSuccess()};this._OnSipApaterEventOnInitialFailure=function(a,b){"undefined"==typeof b&&(b=this.oParent._GetErrorDes(a));""==b&&(b=this.oParent._GetErrorDes(a));DisplaySipLog(SIPADAPTER_Log_Info,stringFormatSip("SipApaterEventOnInitialFailure({0},{1})",a,b));this.oParent.OnInitialFailure(a,b)};this.Initial=function(a){return this.oSipCtrl.Initial(a)};this.UnInitial=function(){return this.oSipCtrl.UnInitial()};this.GetVersion=function(){return SIPVERSION};this.RegisterPA=function(){return this.oSipCtrl.RegisterPA()};this.ReleasePA=function(){return this.oSipCtrl.ReleasePA()};this.Pickup=function(){return this.oSipCtrl.Pickup()};this.Reject=function(){return this.oSipCtrl.Reject()};this.Disconnect=function(){return this.oSipCtrl.Disconnect()};this.SendDTMF=function(a){return this.oSipCtrl.SendDTMF(a)};this.DoCall=function(a,b){if(this.realSipType==sipAdapterTypeJSip)return this.oSipCtrl.DoCall(a,b);if("undefined"==typeof callData||null==callData)callData="";""!=callData&&(a=a+"@"+this.oSipCtrl.GetAttribute("SipServerIP")+"$"+b);return this.oSipCtrl.DoCall(a)};this.SendMessage=function(a,b){return this.realSipType==sipAdapterTypeJSip?this.oSipCtrl.SendMessage(a,b):0};this.SetAttribute=function(a,b){this.oSipCtrl.SetAttribute(a,b)};this.GetAttribute=function(a){return this.oSipCtrl.GetAttribute(a)};this.Mute=function(a){return this.realSipType==sipAdapterTypeJSip?this.oSipCtrl.Mute(a):0};this.Hold=function(){return this.realSipType==sipAdapterTypeJSip?this.oSipCtrl.Hold():0};this.RetriveHold=function(){return this.realSipType==sipAdapterTypeJSip?this.oSipCtrl.RetriveHold():0};this.Consult=function(a){return this.realSipType==sipAdapterTypeJSip?this.oSipCtrl.Consult(a):0};this.Conference=function(){return this.realSipType==sipAdapterTypeJSip?this.oSipCtrl.Conference():0};this.Transfer=function(a){return this.realSipType==sipAdapterTypeJSip?this.oSipCtrl.Transfer(a):0};this.Alertnate=function(a){return this.realSipType==sipAdapterTypeJSip?this.oSipCtrl.Alertnate(a):0};this.ReleaseLeg=function(a){return this.realSipType==sipAdapterTypeJSip?this.oSipCtrl.ReleaseLeg(a):0};this.SetVedioWindow=function(a,b,e){return this.realSipType==sipAdapterTypeJSip?this.oSipCtrl.SetVedioWindow(a,b,e):0};this.DisplayVedio=function(a){return this.realSipType==sipAdapterTypeJSip?this.oSipCtrl.DisplayVedio(a):0};this.OnRing=function(a){};this.OnOrigated=function(a){};this.OnDisconnected=function(){};this.OnConnected=function(a){};this.OnError=function(a,b){};this.OnInitialSuccess=function(){};this.OnInitialFailure=function(a,b){};this.OnLoginSuccess=function(){};this.OnLoginFailure=function(a,b){};this.OnLogoutSuccess=function(a,b){};this.OnDebug=function(a){};this.OnInfoEvent=function(a){};this.OnReportScense=function(a){};this.OnMessage=function(a,b,e,f){};this._Create();return this}var application=null,sipTypeJSip=0,sipTypeRemoteSip=1,sipTypeRemoteHttpSip=2,sipTypeAuto=3;function applicationSipLoad(a,b,c){null==application&&("undefined"==typeof a&&(a=""),"undefined"==typeof b&&(b=null),"undefined"==typeof c&&(c=sipTypeJSip),application=new JSipApplication(a,c),application.onLoad=b,null!=b&&setTimeout(createSipBar,1E3))}function applicationSipUnLoad(){null!==application&&(null!=application.oJSipCtrl&&(application.oJSipCtrl.ReleasePA(),application.oJSipCtrl=null),application=null)}function JSipApplication(a,b){this.path=a;this.sipType=b;this.realsipType=-1;this.oBrowserSys=null;this.surpportWebsocket=!1;this.Log=function(a){this.OnDebug(a)};this.DislayProtocol=function(a){gSIP_Log_Protocol=a;g_consoleFlag=gLogType=0==gSIP_Log_Protocol?0:31};this.GetSipType=function(){return this.realsipType};this._IsWebSocketValid=function(){!window.WebSocket&&window.MozWebSocket&&(window.WebSocket=window.MozWebSocket);return window.WebSocket?!0:!1};this._CreateObject=function(){this.surpportWebsocket=this._IsWebSocketValid();switch(this.sipType){case sipTypeAuto:this.realsipType=this.surpportWebsocket?sipAdapterTypeRemoteSip:sipAdapterTypeRemoteHttpSip;break;case sipTypeRemoteSip:this.realsipType=sipAdapterTypeRemoteSip;break;case sipTypeRemoteHttpSip:this.realsipType=sipAdapterTypeRemoteHttpSip;break;case sipTypeJSip:this.realsipType=sipAdapterTypeJSip;break;default:this.realsipType=-1}};this.OnDebug=function(a){};this.OnLoad=function(){};this._CreateObject();return this}function createSipBar(){application.oJSipCtrl=new SIPAdapterCtrl(application.realsipType,application.path,!0);if(application.onLoad)application.onLoad()};