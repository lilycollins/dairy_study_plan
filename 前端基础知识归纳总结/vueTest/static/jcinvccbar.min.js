var websocket_guard_connecting=3E3,websocket_guard_connected=websocket_guard_connecting+1,websocket_guard_colsed=websocket_guard_connected+2,websocket_guard_remoteserver_disconnected=websocket_guard_connected+3,websocket_connecting=3100,websocket_connected=websocket_connecting+1,websocket_closed=websocket_connected+2,websocket_remoteserver_disconnected=websocket_connected+3,websocket_reconnecting=websocket_connected+4,APSP_Type_NONE=-1,APSP_Type_Action=0,APSP_Type_Event=1,APSP_Type_Command=2,APSP_Type_Prompt=3,APSP_NONE=-1,APSP_GetLocalPort_CONF=APSP_NONE+1,APSP_UpdateSetup_CONF=APSP_GetLocalPort_CONF+1,APSP_GetVersion_CONF=APSP_UpdateSetup_CONF+1,APSP_Initial_CONF=APSP_GetVersion_CONF+1,APSP_MakeCall_CONF=APSP_Initial_CONF+1,APSP_TransferOut_CONF=APSP_MakeCall_CONF+1,APSP_SerialBtn_CONF=APSP_TransferOut_CONF+1,APSP_ForeReleaseCall_CONF=APSP_SerialBtn_CONF+1,APSP_Insert_CONF=APSP_ForeReleaseCall_CONF+1,APSP_Listen_CONF=APSP_Insert_CONF+1,APSP_Help_CONF=APSP_Listen_CONF+1,APSP_Bridge_CONF=APSP_Help_CONF+1,APSP_SetBusy_CONF=APSP_Bridge_CONF+1,APSP_SetIdle_CONF=APSP_SetBusy_CONF+1,APSP_CallIn_CONF=APSP_SetIdle_CONF+1,APSP_Hold_CONF=APSP_CallIn_CONF+1,APSP_RetrieveHold_CONF=APSP_Hold_CONF+1,APSP_Disconnect_CONF=APSP_RetrieveHold_CONF+1,APSP_Conference_CONF=APSP_Disconnect_CONF+1,APSP_Answer_CONF=APSP_Conference_CONF+1,APSP_Consult_CONF=APSP_Answer_CONF+1,APSP_GetBtnStatus_CONF=APSP_Consult_CONF+1,APSP_Intercept_CONF=APSP_GetBtnStatus_CONF+1,APSP_SendDTMF_CONF=APSP_Intercept_CONF+1,APSP_BeginRecord_CONF=APSP_SendDTMF_CONF+1,APSP_StopRecord_CONF=APSP_BeginRecord_CONF+1,APSP_BeginPlay_CONF=APSP_StopRecord_CONF+1,APSP_StopPlay_CONF=APSP_BeginPlay_CONF+1,APSP_ForceReset_CONF=APSP_StopPlay_CONF+1,APSP_Configurate_CONF=APSP_ForceReset_CONF+1,APSP_Transfer_CONF=APSP_Configurate_CONF+1,APSP_Mute_CONF=APSP_Transfer_CONF+1,APSP_Lock_CONF=APSP_Mute_CONF+1,APSP_UnLock_CONF=APSP_Lock_CONF+1,APSP_SetWrapUp_CONF=APSP_UnLock_CONF+1,APSP_ForceIdle_CONF=APSP_SetWrapUp_CONF+1,APSP_ForceBusy_CONF=APSP_ForceIdle_CONF+1,APSP_ForceOut_CONF=APSP_ForceBusy_CONF+1,APSP_AlterNate_CONF=APSP_ForceOut_CONF+1,APSP_CallBack_CONF=APSP_AlterNate_CONF+1,APSP_ReCall_CONF=APSP_CallBack_CONF+1,APSP_GetConfiguration_CONF=APSP_ReCall_CONF+1,APSP_GetCallInfo_CONF=APSP_GetConfiguration_CONF+1,APSP_ChangeCallQueue_CONF=APSP_GetCallInfo_CONF+1,APSP_GetCallID_CONF=APSP_ChangeCallQueue_CONF+1,APSP_QueryQueueInfo_CONF=APSP_GetCallID_CONF+1,APSP_QueryIvrInfo_CONF=APSP_QueryQueueInfo_CONF+1,APSP_SMMsg_CONF=APSP_QueryIvrInfo_CONF+1,APSP_SetCTICalloutTask_CONF=APSP_SMMsg_CONF+1,APSP_GetCTICalloutTask_CONF=APSP_SetCTICalloutTask_CONF+1,APSP_QuerySPGroupList_CONF=APSP_GetCTICalloutTask_CONF+1,APSP_ReleaseThirdOne_CONF=APSP_QuerySPGroupList_CONF+1,APSP_GetCallData_CONF=APSP_ReleaseThirdOne_CONF+1,APSP_SetCallData_CONF=APSP_GetCallData_CONF+1,APSP_BeginCollect_CONF=APSP_SetCallData_CONF+1,APSP_StopCollect_CONF=APSP_BeginCollect_CONF+1,APSP_GetTransfer_CONF=APSP_StopCollect_CONF+1,APSP_SetTransfer_CONF=APSP_GetTransfer_CONF+1,APSP_GetMonitoredAgentList_CONF=APSP_SetTransfer_CONF+1,APSP_UnInitial_CONF=APSP_GetMonitoredAgentList_CONF+1,APSP_SetTransparentParameter_CONF=APSP_UnInitial_CONF+1,APSP_InitialState_CONF=APSP_SetTransparentParameter_CONF+1,APSP_AgentQuery_CONF=APSP_InitialState_CONF+1,APSP_IvrQuery_CONF=APSP_AgentQuery_CONF+1,APSP_TrunkQuery_CONF=APSP_IvrQuery_CONF+1,APSP_TelQuery_CONF=APSP_TrunkQuery_CONF+1,APSP_ServiceQuery_CONF=APSP_TelQuery_CONF+1,APSP_TaskQuery_CONF=APSP_ServiceQuery_CONF+1,APSP_StartNotification_CONF=APSP_TaskQuery_CONF+1,APSP_EndNotification_CONF=APSP_StartNotification_CONF+1,APSP_GetTaskSummary_CONF=APSP_EndNotification_CONF+1,APSP_CallReportQuery_CONF=APSP_GetTaskSummary_CONF+1,APSP_QueryCTIInfo_CONF=APSP_CallReportQuery_CONF+1,APSP_CallQueueQuery_CONF=APSP_QueryCTIInfo_CONF+1,APSP_SetCTIInfo_CONF=APSP_CallQueueQuery_CONF+1,APSP_QueryMonitorSumInfo_CONF=APSP_SetCTIInfo_CONF+1,APSP_SendWeiboMsg_CONF=APSP_QueryMonitorSumInfo_CONF+1,APSP_SendIMMessage_CONF=APSP_SendWeiboMsg_CONF+1,APSP_SendWeChatMsg_CONF=APSP_SendIMMessage_CONF+1,APSP_QueryWeChatData_CONF=APSP_SendWeChatMsg_CONF+1,APSP_QueryWeChatHistory_CONF=APSP_QueryWeChatData_CONF+1,APSP_UploadFileToMMS_CONF=APSP_QueryWeChatHistory_CONF+1,APSP_DownFileFromMMS_CONF=APSP_UploadFileToMMS_CONF+1,APSP_GetWeChatParam_CONF=APSP_DownFileFromMMS_CONF+1,APSP_TransferCallQueue_CONF=APSP_GetWeChatParam_CONF+1,APSP_SendIMMessage2_CONF=APSP_TransferCallQueue_CONF+1,APSP_WinCap_CONF=APSP_SendIMMessage2_CONF+1,APSP_PopDLG_CONF=APSP_WinCap_CONF+1,APSP_ComingCall_EVENT=APSP_PopDLG_CONF+1,APSP_RecordFileUpLoaded_EVENT=APSP_ComingCall_EVENT+1,APSP_AnswerCall_EVENT=APSP_RecordFileUpLoaded_EVENT+1,APSP_OnPrompt_EVENT=APSP_AnswerCall_EVENT+1,APSP_OnReportBtnStatus_EVENT=APSP_OnPrompt_EVENT+1,APSP_OnTelephoneStatusChanged_EVENT=APSP_OnReportBtnStatus_EVENT+1,APSP_OnAgentStatusChanged_EVENT=APSP_OnTelephoneStatusChanged_EVENT+1,APSP_OnQueueStatusChanged_EVENT=APSP_OnAgentStatusChanged_EVENT+1,APSP_OnlockStatusReport_EVENT=APSP_OnQueueStatusChanged_EVENT+1,APSP_OnInitalSuccess_EVENT=APSP_OnlockStatusReport_EVENT+1,APSP_OnShortCutKey_EVENT=APSP_OnInitalSuccess_EVENT+1,APSP_OnIVRStatusChanged_EVENT=APSP_OnShortCutKey_EVENT+1,APSP_OnEventPrompt_EVENT=APSP_OnIVRStatusChanged_EVENT+1,APSP_OnAgentWorkReport_EVENT=APSP_OnEventPrompt_EVENT+1,APSP_OnInitalFailure_EVENT=APSP_OnAgentWorkReport_EVENT+1,APSP_OnCallEnd_EVENT=APSP_OnInitalFailure_EVENT+1,APSP_OnAgentReport_EVENT=APSP_OnCallEnd_EVENT+1,APSP_OnIvrReport_EVENT=APSP_OnAgentReport_EVENT+1,APSP_OnTelReport_EVENT=APSP_OnIvrReport_EVENT+1,APSP_OnServiceReport_EVENT=APSP_OnTelReport_EVENT+1,APSP_OnTaskReport_EVENT=APSP_OnServiceReport_EVENT+1,APSP_OutboundReport_EVENT=APSP_OnTaskReport_EVENT+1,APSP_CallReportInfo_EVENT=APSP_OutboundReport_EVENT+1,APSP_QueryMonitorSumReport_EVENT=APSP_CallReportInfo_EVENT+1,APSP_OnCallRing_EVENT=APSP_QueryMonitorSumReport_EVENT+1,APSP_OnHeatBeat_EVENT=APSP_OnCallRing_EVENT+1,APSP_OnBarExit_EVENT=APSP_OnHeatBeat_EVENT+1,APSP_OnSystemBusy_EVENT=APSP_OnBarExit_EVENT+1,APSP_OnCallQueueQuery_EVENT=APSP_OnSystemBusy_EVENT+1,APSP_OnQueueReport_EVENT=APSP_OnCallQueueQuery_EVENT+1,APSP_OnSystemMessage_EVENT=APSP_OnQueueReport_EVENT+1,APSP_OnRecvWeiboMsg_EVENT=APSP_OnSystemMessage_EVENT+1,APSP_OnIMNoticsMsg_EVENT=APSP_OnRecvWeiboMsg_EVENT+1,APSP_OnIMTextMsg_EVENT=APSP_OnIMNoticsMsg_EVENT+1,APSP_OnWallServiceReport_EVENT=APSP_OnIMTextMsg_EVENT+1,APSP_OnWallQueueReport_EVENT=APSP_OnWallServiceReport_EVENT+1,APSP_OnStaticInfoReport_EVENT=APSP_OnWallQueueReport_EVENT+1,APSP_OnRecvWeChatMsg_EVENT=APSP_OnStaticInfoReport_EVENT+1,APSP_OnServiceStaticReport_EVENT=APSP_OnRecvWeChatMsg_EVENT+1,APSP_OnAgentStaticReport_EVENT=APSP_OnServiceStaticReport_EVENT+1,APSP_OnTrunkReport_EVENT=APSP_OnAgentStaticReport_EVENT+1,APSP_OnTrunkSumReport_EVENT=APSP_OnTrunkReport_EVENT+1,APSP_OnUploadFileToMMSReport_EVENT=APSP_OnTrunkSumReport_EVENT+1,APSP_OnDownloadFileToMMSReport_EVENT=APSP_OnUploadFileToMMSReport_EVENT+1,APSP_OnSendWeChatMsgReport_EVENT=APSP_OnDownloadFileToMMSReport_EVENT+1,APSP_OnAQueryCTIInfo_EVENT=APSP_OnSendWeChatMsgReport_EVENT+1,APSP_OnAgentBusyReason_EVENT=APSP_OnAQueryCTIInfo_EVENT+1,APSP_OnAsrEventReport_EVENT=APSP_OnAgentBusyReason_EVENT+1,APSP_OnAction_EVENT=APSP_OnAsrEventReport_EVENT+1,APSP_OnSetDlgStatusText_EVENT=APSP_OnAction_EVENT+1,APSP_OnChangeBtnSerial_EVENT=APSP_OnSetDlgStatusText_EVENT+1,APSP_Test_CONF=APSP_OnChangeBtnSerial_EVENT+1,APSP_Item_End=APSP_Test_CONF+1,APSP_WebSocket_Event=APSP_Item_End+1;function getCmdType(a){var b=APSP_Type_NONE;"event"==a&&(b=APSP_Type_Event);"command"==a&&(b=APSP_Type_Command);"action"==a&&(b=APSP_Type_Action);return b}function GetApspParam(){for(var a="",b=0;b<arguments.length;b++)a=0==b?getDefaultParam(arguments[b]):a+"|"+getDefaultParam(arguments[b]);return a}function buildApspMsg(a,b){var c='\x3capspMessage ver\x3d"2.0.0" time\x3d"'+getTimeString()+'"\x3e',c=c+'\x3cheader\x3e\x3csessionID\x3e0\x3c/sessionID\x3e\x3c/header\x3e\x3cbody type\x3d"command" name\x3d"'+a+'"\x3e',c=c+"\x3cpaspparam\x3e"+b+"\x3c/paspparam\x3e";return c+="\x3c/body\x3e\x3c/apspMessage\x3e"}function JAPSPWebSocket(a){this._ws=null;this._connectFlag=!1;this._msgCallback=null;this._appName=a;this.m_arrCmd=[];this.m_arrCmdIndex=[];this.WSConnect=function(a,c){try{this._ws=new WebSocket("ws://"+a+":"+c)}catch(d){try{this._ws=new MozWebSocket("ws://"+a+":"+c)}catch(e){alert(e);this._ws=null;return}}this._ws.onopen=this.WSonOpen;this._ws.onmessage=this.WSonMessage;this._ws.onclose=this.WSonClose;this._ws.onerror=this.WSonError;this._ws.oParent=this};this.WSDisconnect=function(){!this._connectFlag||0!=this._ws.readyState&&1!=this._ws.readyState||this._ws.close()};this.WSSendMsg=function(a){return""==a?-1:this._connectFlag?(DisplayLog(VccBar_Log_Protocol,"SenPAS:"+a),this._ws.send(a),0):-1};this.SetMsgCallBack=function(a){this._msgCallback=a};this.WSonOpen=function(){this.oParent._connectFlag=!0;this.oParent.invokeCallBack(APSP_Type_Prompt,APSP_WebSocket_Event,websocket_connected)};this.WSonMessage=function(a){DisplayLog(VccBar_Log_Protocol,"RecPAS:"+a.data);var c=getSubString(a.data,'type\x3d"','"'),d=getSubString(a.data,'name\x3d"','"');a=getSubString(a.data,"\x3cpaspparam\x3e","\x3c/paspparam\x3e");this.oParent.invokeCallBack(getCmdType(c),this.oParent.GetCmdIndex(d),a)};this.WSonClose=function(){DisplayLog(VccBar_Log_Error,"WebSocket::WSonClose("+this.oParent._appName+")");this.oParent.invokeCallBack(APSP_Type_Prompt,APSP_WebSocket_Event,websocket_closed);this.oParent._connectFlag=!1};this.WSonError=function(a){DisplayLog(VccBar_Log_Error,"WebSocket::WSonError("+this.oParent._appName+")");this.oParent.invokeCallBack(APSP_Type_Prompt,APSP_WebSocket_Event,websocket_remoteserver_disconnected);this.oParent._connectFlag=!1};this.invokeCallBack=function(a,c,d){null!=this._msgCallback&&this._msgCallback(a,c,d)};this._APSPInit=function(){0<this.m_arrCmd.length||(this.m_arrCmd.push("GetLocalPort"),this.m_arrCmdIndex.push(APSP_GetLocalPort_CONF),this.m_arrCmd.push("UpdateSetup"),this.m_arrCmdIndex.push(APSP_UpdateSetup_CONF),this.m_arrCmd.push("GetVersion"),this.m_arrCmdIndex.push(APSP_GetVersion_CONF),this.m_arrCmd.push("Initial"),this.m_arrCmdIndex.push(APSP_Initial_CONF),this.m_arrCmd.push("MakeCall"),this.m_arrCmdIndex.push(APSP_MakeCall_CONF),this.m_arrCmd.push("TransferOut"),this.m_arrCmdIndex.push(APSP_TransferOut_CONF),this.m_arrCmd.push("SerialBtn"),this.m_arrCmdIndex.push(APSP_SerialBtn_CONF),this.m_arrCmd.push("ForeReleaseCall"),this.m_arrCmdIndex.push(APSP_ForeReleaseCall_CONF),this.m_arrCmd.push("Insert"),this.m_arrCmdIndex.push(APSP_Insert_CONF),this.m_arrCmd.push("Listen"),this.m_arrCmdIndex.push(APSP_Listen_CONF),this.m_arrCmd.push("Help"),this.m_arrCmdIndex.push(APSP_Help_CONF),this.m_arrCmd.push("Bridge"),this.m_arrCmdIndex.push(APSP_Bridge_CONF),this.m_arrCmd.push("SetBusy"),this.m_arrCmdIndex.push(APSP_SetBusy_CONF),this.m_arrCmd.push("SetIdle"),this.m_arrCmdIndex.push(APSP_SetIdle_CONF),this.m_arrCmd.push("CallIn"),this.m_arrCmdIndex.push(APSP_CallIn_CONF),this.m_arrCmd.push("Hold"),this.m_arrCmdIndex.push(APSP_Hold_CONF),this.m_arrCmd.push("RetrieveHold"),this.m_arrCmdIndex.push(APSP_RetrieveHold_CONF),this.m_arrCmd.push("Disconnect"),this.m_arrCmdIndex.push(APSP_Disconnect_CONF),this.m_arrCmd.push("Conference"),this.m_arrCmdIndex.push(APSP_Conference_CONF),this.m_arrCmd.push("Answer"),this.m_arrCmdIndex.push(APSP_Answer_CONF),this.m_arrCmd.push("Consult"),this.m_arrCmdIndex.push(APSP_Consult_CONF),this.m_arrCmd.push("GetBtnStatus"),this.m_arrCmdIndex.push(APSP_GetBtnStatus_CONF),this.m_arrCmd.push("Intercept"),this.m_arrCmdIndex.push(APSP_Intercept_CONF),this.m_arrCmd.push("SendDTMF"),this.m_arrCmdIndex.push(APSP_SendDTMF_CONF),this.m_arrCmd.push("BeginRecord"),this.m_arrCmdIndex.push(APSP_BeginRecord_CONF),this.m_arrCmd.push("StopRecord"),this.m_arrCmdIndex.push(APSP_StopRecord_CONF),this.m_arrCmd.push("BeginPlay"),this.m_arrCmdIndex.push(APSP_BeginPlay_CONF),this.m_arrCmd.push("StopPlay"),this.m_arrCmdIndex.push(APSP_StopPlay_CONF),this.m_arrCmd.push("ForceReset"),this.m_arrCmdIndex.push(APSP_ForceReset_CONF),this.m_arrCmd.push("Configurate"),this.m_arrCmdIndex.push(APSP_Configurate_CONF),this.m_arrCmd.push("Transfer"),this.m_arrCmdIndex.push(APSP_Transfer_CONF),this.m_arrCmd.push("Mute"),this.m_arrCmdIndex.push(APSP_Mute_CONF),this.m_arrCmd.push("Lock"),this.m_arrCmdIndex.push(APSP_Lock_CONF),this.m_arrCmd.push("UnLock"),this.m_arrCmdIndex.push(APSP_UnLock_CONF),this.m_arrCmd.push("SetWrapUp"),this.m_arrCmdIndex.push(APSP_SetWrapUp_CONF),this.m_arrCmd.push("ForceIdle"),this.m_arrCmdIndex.push(APSP_ForceIdle_CONF),this.m_arrCmd.push("ForceBusy"),this.m_arrCmdIndex.push(APSP_ForceBusy_CONF),this.m_arrCmd.push("ForceOut"),this.m_arrCmdIndex.push(APSP_ForceOut_CONF),this.m_arrCmd.push("AlterNate"),this.m_arrCmdIndex.push(APSP_AlterNate_CONF),this.m_arrCmd.push("CallBack"),this.m_arrCmdIndex.push(APSP_CallBack_CONF),this.m_arrCmd.push("ReCall"),this.m_arrCmdIndex.push(APSP_ReCall_CONF),this.m_arrCmd.push("GetConfiguration"),this.m_arrCmdIndex.push(APSP_GetConfiguration_CONF),this.m_arrCmd.push("GetCallInfo"),this.m_arrCmdIndex.push(APSP_GetCallInfo_CONF),this.m_arrCmd.push("ChangeCallQueue"),this.m_arrCmdIndex.push(APSP_ChangeCallQueue_CONF),this.m_arrCmd.push("GetCallID"),this.m_arrCmdIndex.push(APSP_GetCallID_CONF),this.m_arrCmd.push("QueryQueueInfo"),this.m_arrCmdIndex.push(APSP_QueryQueueInfo_CONF),this.m_arrCmd.push("QueryIvrInfo"),this.m_arrCmdIndex.push(APSP_QueryIvrInfo_CONF),this.m_arrCmd.push("SMMsg"),this.m_arrCmdIndex.push(APSP_SMMsg_CONF),this.m_arrCmd.push("SetCTICalloutTask"),this.m_arrCmdIndex.push(APSP_SetCTICalloutTask_CONF),this.m_arrCmd.push("GetCTICalloutTask"),this.m_arrCmdIndex.push(APSP_GetCTICalloutTask_CONF),this.m_arrCmd.push("QuerySPGroupList"),this.m_arrCmdIndex.push(APSP_QuerySPGroupList_CONF),this.m_arrCmd.push("ReleaseThirdOne"),this.m_arrCmdIndex.push(APSP_ReleaseThirdOne_CONF),this.m_arrCmd.push("GetCallData"),this.m_arrCmdIndex.push(APSP_GetCallData_CONF),this.m_arrCmd.push("SetCallData"),this.m_arrCmdIndex.push(APSP_SetCallData_CONF),this.m_arrCmd.push("BeginCollect"),this.m_arrCmdIndex.push(APSP_BeginCollect_CONF),this.m_arrCmd.push("StopCollect"),this.m_arrCmdIndex.push(APSP_StopCollect_CONF),this.m_arrCmd.push("GetTransfer"),this.m_arrCmdIndex.push(APSP_GetTransfer_CONF),this.m_arrCmd.push("SetTransfer"),this.m_arrCmdIndex.push(APSP_SetTransfer_CONF),this.m_arrCmd.push("GetMonitoredAgentList"),this.m_arrCmdIndex.push(APSP_GetMonitoredAgentList_CONF),this.m_arrCmd.push("UnInitial"),this.m_arrCmdIndex.push(APSP_UnInitial_CONF),this.m_arrCmd.push("SetTransparentParameter"),this.m_arrCmdIndex.push(APSP_SetTransparentParameter_CONF),this.m_arrCmd.push("InitialState"),this.m_arrCmdIndex.push(APSP_InitialState_CONF),this.m_arrCmd.push("AgentQuery"),this.m_arrCmdIndex.push(APSP_AgentQuery_CONF),this.m_arrCmd.push("IvrQuery"),this.m_arrCmdIndex.push(APSP_IvrQuery_CONF),this.m_arrCmd.push("TrunkQuery"),this.m_arrCmdIndex.push(APSP_TrunkQuery_CONF),this.m_arrCmd.push("TelQuery"),this.m_arrCmdIndex.push(APSP_TelQuery_CONF),this.m_arrCmd.push("ServiceQuery"),this.m_arrCmdIndex.push(APSP_ServiceQuery_CONF),this.m_arrCmd.push("TaskQuery"),this.m_arrCmdIndex.push(APSP_TaskQuery_CONF),this.m_arrCmd.push("StartNotification"),this.m_arrCmdIndex.push(APSP_StartNotification_CONF),this.m_arrCmd.push("EndNotification"),this.m_arrCmdIndex.push(APSP_EndNotification_CONF),this.m_arrCmd.push("GetTaskSummary"),this.m_arrCmdIndex.push(APSP_GetTaskSummary_CONF),this.m_arrCmd.push("CallReportQuery"),this.m_arrCmdIndex.push(APSP_CallReportQuery_CONF),this.m_arrCmd.push("QueryCTIInfo"),this.m_arrCmdIndex.push(APSP_QueryCTIInfo_CONF),this.m_arrCmd.push("CallQueueQuery"),this.m_arrCmdIndex.push(APSP_CallQueueQuery_CONF),this.m_arrCmd.push("SetCTIInfo"),this.m_arrCmdIndex.push(APSP_SetCTIInfo_CONF),this.m_arrCmd.push("QueryMonitorSumInfo"),this.m_arrCmdIndex.push(APSP_QueryMonitorSumInfo_CONF),this.m_arrCmd.push("SendWeiboMsg"),this.m_arrCmdIndex.push(APSP_SendWeiboMsg_CONF),this.m_arrCmd.push("SendIMMessageMsg"),this.m_arrCmdIndex.push(APSP_SendIMMessage_CONF),this.m_arrCmd.push("SendWeChatMsg"),this.m_arrCmdIndex.push(APSP_SendWeChatMsg_CONF),this.m_arrCmd.push("QueryWeChatData"),this.m_arrCmdIndex.push(APSP_QueryWeChatData_CONF),this.m_arrCmd.push("QueryWeChatHistory"),this.m_arrCmdIndex.push(APSP_QueryWeChatHistory_CONF),this.m_arrCmd.push("UploadFileToMMS"),this.m_arrCmdIndex.push(APSP_UploadFileToMMS_CONF),this.m_arrCmd.push("DownFileFromMMS"),this.m_arrCmdIndex.push(APSP_DownFileFromMMS_CONF),this.m_arrCmd.push("GetWeChatParam"),this.m_arrCmdIndex.push(APSP_GetWeChatParam_CONF),this.m_arrCmd.push("TransferCallQueue"),this.m_arrCmdIndex.push(APSP_TransferCallQueue_CONF),this.m_arrCmd.push("SendIMMessageMsg2"),this.m_arrCmdIndex.push(APSP_SendIMMessage2_CONF),this.m_arrCmd.push("WinCap"),this.m_arrCmdIndex.push(APSP_WinCap_CONF),this.m_arrCmd.push("PopDLG"),this.m_arrCmdIndex.push(APSP_PopDLG_CONF),this.m_arrCmd.push("ComingCall"),this.m_arrCmdIndex.push(APSP_ComingCall_EVENT),this.m_arrCmd.push("RecordFileUpLoaded"),this.m_arrCmdIndex.push(APSP_RecordFileUpLoaded_EVENT),this.m_arrCmd.push("AnswerCall"),this.m_arrCmdIndex.push(APSP_AnswerCall_EVENT),this.m_arrCmd.push("OnPrompt"),this.m_arrCmdIndex.push(APSP_OnPrompt_EVENT),this.m_arrCmd.push("ReportBtnStatus"),this.m_arrCmdIndex.push(APSP_OnReportBtnStatus_EVENT),this.m_arrCmd.push("OnTelephoneStatusChanged"),this.m_arrCmdIndex.push(APSP_OnTelephoneStatusChanged_EVENT),this.m_arrCmd.push("OnAgentStatusChanged"),this.m_arrCmdIndex.push(APSP_OnAgentStatusChanged_EVENT),this.m_arrCmd.push("OnQueueStatusChanged"),this.m_arrCmdIndex.push(APSP_OnQueueStatusChanged_EVENT),this.m_arrCmd.push("OnlockStatusReport"),this.m_arrCmdIndex.push(APSP_OnlockStatusReport_EVENT),this.m_arrCmd.push("OnInitalSuccess"),this.m_arrCmdIndex.push(APSP_OnInitalSuccess_EVENT),this.m_arrCmd.push("OnShortCutKey"),this.m_arrCmdIndex.push(APSP_OnShortCutKey_EVENT),this.m_arrCmd.push("OnIVRStatusChanged"),this.m_arrCmdIndex.push(APSP_OnIVRStatusChanged_EVENT),this.m_arrCmd.push("OnEventPrompt"),this.m_arrCmdIndex.push(APSP_OnEventPrompt_EVENT),this.m_arrCmd.push("OnAgentWorkReport"),this.m_arrCmdIndex.push(APSP_OnAgentWorkReport_EVENT),this.m_arrCmd.push("OnInitalFailure"),this.m_arrCmdIndex.push(APSP_OnInitalFailure_EVENT),this.m_arrCmd.push("OnCallEnd"),this.m_arrCmdIndex.push(APSP_OnCallEnd_EVENT),this.m_arrCmd.push("OnAgentReport"),this.m_arrCmdIndex.push(APSP_OnAgentReport_EVENT),this.m_arrCmd.push("OnIvrReport"),this.m_arrCmdIndex.push(APSP_OnIvrReport_EVENT),this.m_arrCmd.push("OnTelReport"),this.m_arrCmdIndex.push(APSP_OnTelReport_EVENT),this.m_arrCmd.push("OnServiceReport"),this.m_arrCmdIndex.push(APSP_OnServiceReport_EVENT),this.m_arrCmd.push("OnTaskReport"),this.m_arrCmdIndex.push(APSP_OnTaskReport_EVENT),this.m_arrCmd.push("OutboundReport"),this.m_arrCmdIndex.push(APSP_OutboundReport_EVENT),this.m_arrCmd.push("CallReportInfo"),this.m_arrCmdIndex.push(APSP_CallReportInfo_EVENT),this.m_arrCmd.push("QueryMonitorSumReport"),this.m_arrCmdIndex.push(APSP_QueryMonitorSumReport_EVENT),this.m_arrCmd.push("OnCallRing"),this.m_arrCmdIndex.push(APSP_OnCallRing_EVENT),this.m_arrCmd.push("OnHeatBeat"),this.m_arrCmdIndex.push(APSP_OnHeatBeat_EVENT),this.m_arrCmd.push("OnBarExit"),this.m_arrCmdIndex.push(APSP_OnBarExit_EVENT),this.m_arrCmd.push("OnSystemBusy"),this.m_arrCmdIndex.push(APSP_OnSystemBusy_EVENT),this.m_arrCmd.push("OnCallQueueQuery"),this.m_arrCmdIndex.push(APSP_OnCallQueueQuery_EVENT),this.m_arrCmd.push("OnQueueReport"),this.m_arrCmdIndex.push(APSP_OnQueueReport_EVENT),this.m_arrCmd.push("OnSystemMessage"),this.m_arrCmdIndex.push(APSP_OnSystemMessage_EVENT),this.m_arrCmd.push("OnRecvWeiboMsg"),this.m_arrCmdIndex.push(APSP_OnRecvWeiboMsg_EVENT),this.m_arrCmd.push("OnIMNoticsMsg"),this.m_arrCmdIndex.push(APSP_OnIMNoticsMsg_EVENT),this.m_arrCmd.push("OnIMTextMsg"),this.m_arrCmdIndex.push(APSP_OnIMTextMsg_EVENT),this.m_arrCmd.push("OnWallServiceReport"),this.m_arrCmdIndex.push(APSP_OnWallServiceReport_EVENT),this.m_arrCmd.push("OnWallQueueReport"),this.m_arrCmdIndex.push(APSP_OnWallQueueReport_EVENT),this.m_arrCmd.push("OnStaticInfoReport"),this.m_arrCmdIndex.push(APSP_OnStaticInfoReport_EVENT),this.m_arrCmd.push("OnRecvWeChatMsg"),this.m_arrCmdIndex.push(APSP_OnRecvWeChatMsg_EVENT),this.m_arrCmd.push("OnServiceStaticReport"),this.m_arrCmdIndex.push(APSP_OnServiceStaticReport_EVENT),this.m_arrCmd.push("OnAgentStaticReport"),this.m_arrCmdIndex.push(APSP_OnAgentStaticReport_EVENT),this.m_arrCmd.push("OnTrunkReport"),this.m_arrCmdIndex.push(APSP_OnTrunkReport_EVENT),this.m_arrCmd.push("OnTrunkSumReport"),this.m_arrCmdIndex.push(APSP_OnTrunkSumReport_EVENT),this.m_arrCmd.push("OnUploadFileToMMSReport"),this.m_arrCmdIndex.push(APSP_OnUploadFileToMMSReport_EVENT),this.m_arrCmd.push("OnDownloadFileToMMSReport"),this.m_arrCmdIndex.push(APSP_OnDownloadFileToMMSReport_EVENT),this.m_arrCmd.push("OnSendWeChatMsgReport"),this.m_arrCmdIndex.push(APSP_OnSendWeChatMsgReport_EVENT),this.m_arrCmd.push("OnAQueryCTIInfo"),this.m_arrCmdIndex.push(APSP_OnAQueryCTIInfo_EVENT),this.m_arrCmd.push("OnAgentBusyReason"),this.m_arrCmdIndex.push(APSP_OnAgentBusyReason_EVENT),this.m_arrCmd.push("OnAsrEventReport"),this.m_arrCmdIndex.push(APSP_OnAsrEventReport_EVENT),this.m_arrCmd.push("OnAction"),this.m_arrCmdIndex.push(APSP_OnAction_EVENT),this.m_arrCmd.push("OnSetDlgStatusText"),this.m_arrCmdIndex.push(APSP_OnSetDlgStatusText_EVENT),this.m_arrCmd.push("OnChangeBtnSerial"),this.m_arrCmdIndex.push(APSP_OnChangeBtnSerial_EVENT),this.m_arrCmd.push("Test"),this.m_arrCmdIndex.push(APSP_Test_CONF))};this.GetCmdName=function(a){for(var c=0;c<this.m_arrCmd.length;c++)if(this.m_arrCmdIndex[c]==a)return this.m_arrCmd[c];return""};this.GetCmdIndex=function(a){for(var c=0;c<this.m_arrCmd.length;c++)if(this.m_arrCmd[c]==a)return this.m_arrCmdIndex[c];return-1};this._APSPInit()}function JVccBarAssist(){this.oBarBtnControl=new JBarBtnControl;this.oBarAgentStatus=new JBarAgentStatus;return this}function JBarBtnControl(){this._arrCmd=[];this._arrCmdIndex=[];this._type=0;this._getCmdID=function(a){for(var b=0;b<this._arrCmdIndex.length;b++)if(this._arrCmdIndex[b]==a)return this._arrCmd[b];return""};this._ChangeObject=function(a,b){1==a?0==this._type?b.disabled=!1:b.style.display="":0==this._type?b.disabled=!0:b.style.display="none"};this.AttachBtnByUIID=function(a,b){this._arrCmd.push(a);this._arrCmdIndex.push(b)};this.UpdateUI=function(a){a=a.split("|");for(var b=0;b<this._arrCmdIndex.length;b++){for(var c=this._arrCmdIndex[b],d=!1,e=0;e<a.length;e++)if(parseInt(a[e])==c){d=!0;break}c=this._getCmdID(c);""!=c&&(c=document.getElementById(c),null!=c&&this._ChangeObject(d,c))}};this.SetUpdateType=function(a){this._type=a};return this}function BarBeginAgentStatusTimer(){null==application.oVccBarAssist.oBarAgentStatus._timer&&(application.oVccBarAssist.oBarAgentStatus._timer=setInterval(BarAgentStatusTimeSum,1E3))}function BarStopAgentStatusTimer(){null!=application.oVccBarAssist.oBarAgentStatus._timer&&(clearInterval(application.oVccBarAssist.oBarAgentStatus._timer),application.oVccBarAssist.oBarAgentStatus._timer=null)}function BarAgentStatusTimeSum(){application.oVccBarAssist.oBarAgentStatus.AgentStatusTimeSum()}function JBarAgentStatus(){this._busySubStatusSelectedItem="";this._timerCount=this._agentStatus=0;this._timer=null;this._arrSubBusyIndex=[];this._arrSubBusyText=[];this.SetSubBusyStatus=function(a){this._arrSubBusyIndex.length=0;this._arrSubBusyText.length=0;a=a.split("$");for(var b=0;b<a.length;b++){var c=a[b].split("|");2==c.length&&(this._arrSubBusyIndex.push(parseInt(c[0])),this._arrSubBusyText.push(c[1]))}};this.SetAgentStatus=function(a){if(this._agentStatus!=a||3==this._agentStatus)this._agentStatus=a,this._timerCount=0,0<this._agentStatus?BarBeginAgentStatusTimer():BarStopAgentStatusTimer()};this.OnAgentStatusTime=function(a,b,c){};this.AgentStatusTimeSum=function(){this._timerCount+=1;this._showAgentStatusTimer()};this._getSubStatusText=function(){var a=application.oJVccBar.GetAgentSubBusyStatus();if(-1==a)this._busySubStatusSelectedItem="";else for(var b=0;b<this._arrSubBusyIndex.length;b++)if(this._arrSubBusyIndex[b]==a){this._busySubStatusSelectedItem=this._arrSubBusyText[b];break}};this._getTimerString=function(a){if(0==a)return"";var b=parseInt(a/3600),b=10>b?"0"+b:b,b="00"==b?"":b+":",c=parseInt(a%3600/60);a%=60;return b.toString()+(10>c?"0"+c:c).toString()+":"+(10>a?"0"+a:a).toString()};this._getTextByStatus=function(){return 1==this._agentStatus?(this._getSubStatusText(),""!=this._busySubStatusSelectedItem?this._busySubStatusSelectedItem:"\u5fd9\u788c"):2==this._agentStatus?"\u5c31\u7eea":3==this._agentStatus?"\u901a\u8bdd\u4e2d":4==this._agentStatus?"\u540e\u7eed\u6001":"\u672a\u767b\u5f55"};this._showAgentStatusTimer=function(){this.OnAgentStatusTime(this._agentStatus,this._getTextByStatus(),this._getTimerString(this._timerCount))};return this}function JWeChatMessageItem(){this.direction=0;this.msgseq=-1;this.timeStamp=this.data=this.title=this.eventKey=this.Event=this.recongnition=this.sessionUrl=this.content=this.msgType="";this.code=this.needMmcOpenData=0;this.sender=this.des="";return this}function JWechChatSession(){this.type="00";this.userNickName=this.sessionId="";this.sex="0";this.vccName=this.vccPublicId=this.userId=this.country=this.city=this.province="";this.msgSession=[];this.status=1;this.AddMessageItem=function(a,b,c,d,e,f,g,m,h,r,w,l){var k=this.GetMessageIndex(b);return-1==k?(k=new JWeChatMessageItem,k.sender=a,k.direction=k.sender==this.userId?0:1,k.msgseq=b,k.msgType=c,k.content=d,k.sessionUrl=e,k.recongnition=f,k.Event=g,k.eventKey=m,k.title=h,k.data=r,k.timeStamp=w,k.needMmcOpenData=l,this.msgSession.push(k),k):this.msgSession[k]};this.GetMessageCount=function(){return this.msgSession.length};this.GetMessageItemByIndex=function(a){return 0>a||a>=this.msgSession.length?null:this.msgSession[a]};this.GetMessageItem=function(a){a=this.GetMessageIndex(a);return-1==a?null:this.msgSession[a]};this.GetLastSendItem=function(){for(var a=this.msgSession.length-1;0<a;a--)if(this.msgSession[a].sender==this.vccPublicId&&1==this.msgSession[a].direction)return this.msgSession[a];return null};this.GetMessageIndex=function(a){for(var b=0;b<this.msgSession.length;b++)if(this.msgSession[b].msgseq==a)return b;return-1}}function JWechChatManager(){this._currentSession="";this.weChatSessions=[];this.arrSendFileName=[];this.arrSendFileSessionID=[];this.arrRecvFileName=[];this.arrRecvFileSessionID=[];this.arrRecvFileMsgseq=[];this.GetSessionIndexBySessionID=function(a){for(var b=0;b<this.weChatSessions.length;b++)if(this.weChatSessions[b].sessionId==a)return b;return-1};this.GetSessionIndexByUserId=function(a){for(var b=0;b<this.weChatSessions.length;b++)if(this.weChatSessions[b].userId==a)return b;return-1};this.SetUserInfo=function(a){a=a.split("|");if(6==a.length){var b=this.GetSessionItemByUserId(a[0]);null!=b&&(b.userNickName=GetGBKFromBase64(a[1]),b.sex=a[2],b.province=GetGBKFromBase64(a[3]),b.city=GetGBKFromBase64(a[4]),b.country=GetGBKFromBase64(a[5]),this.OnBeginSession(b.sessionId))}};this.GetSessionItemByUserId=function(a){a=this.GetSessionIndexByUserId(a);return-1==a?null:this.weChatSessions[a]};this.AddSessionItem=function(a,b,c,d){if(-1==this.GetSessionIndexBySessionID(a,c,d)){var e=new JWechChatSession;e.type=b;e.sessionId=a;e.userId=c;e.vccPublicId=d;this.weChatSessions.push(e);return e}return null};this.OnSaveRecvMessageReport=function(a,b,c,d,e,f,g,m,h,r,w,l,k,p){r=this.GetSessionItemBySessionID(a);null==r&&(this._currentSession=a,r=this.AddSessionItem(a,c,d,e));null!=r&&(r.AddMessageItem(d,b,f,g,m,h,Event,w,l,k,p,0),"begin"==f?application.oJVccBar.GetJVccBarType()==vccBarTypeHTML5?application.oJVccBar.GetWeChatParam(d):this.SetUserInfo(application.oJVccBar.GetWeChatParam(d)):"end"==f?this.OnEndSession(a):this.OnRecvMessage(a,b))};this.OnSaveSendMessageReport=function(a,b,c,d,e,f){a=this.GetSessionItemBySessionID(b);null!=a&&(a=a.GetLastSendItem(),null!=a&&(a.code=d,a.des=e,a.timeStamp=f,a.msgseq=c,this.OnSendMessageReport(b,c)))};this.SaveSendMessage=function(a,b,c,d,e,f,g,m,h,r){a=this.GetSessionItemBySessionID(a);null!=a&&a.AddMessageItem(d,-1,e,f,g,"","","",m,h,"",r)};this.OnInvokeUploadFileToMMSReport=function(a,b,c){if(1==b||2==b)for(var d=0;d<this.arrSendFileName.length;d++)if(this.arrSendFileName[d]==a){this.OnUploadFileStatus(this.arrSendFileSessionID[d],b,c);this.arrSendFileSessionID.slice(d,1);this.arrSendFileName.slice(d,1);break}};this.OnInvokeDownFileFromMMSReport=function(a,b,c,d){if(1==b||2==b)for(var e=0;e<this.arrRecvFileName.length;e++)if(this.arrRecvFileName[e]==a&&this.arrRecvFileMsgseq[e]==d){this.OnDowndFileStatus(this.arrRecvFileSessionID[e],this.arrRecvFileMsgseq[e],b,c);this.arrRecvFileSessionID.slice(e,1);this.arrRecvFileName.slice(e,1);this.arrRecvFileMsgseq.slice(e,1);break}};this.SendTextMessage=function(a,b){""==a&&(a=this._currentSession);var c=this.GetSessionItemBySessionID(a);null!=c&&application.oJVccBar.SendWeChatMsg(a,c.type,c.userId,c.vccPublicId,"text",b,"","","",0)};this.SendImageMessage=function(a,b){""==a&&(a=this._currentSession);var c=this.GetSessionItemBySessionID(a);null!=c&&application.oJVccBar.SendWeChatMsg(a,c.type,c.userId,c.vccPublicId,"image","",b,"","",0)};this.SendVoiceMessage=function(a,b){""==a&&(a=this._currentSession);var c=this.GetSessionItemBySessionID(a);null!=c&&application.oJVccBar.SendWeChatMsg(a,c.type,c.userId,c.vccPublicId,"voice","",b,"","",0)};this.SendVedioMessage=function(a,b,c){""==a&&(a=this._currentSession);var d=this.GetSessionItemBySessionID(a);null!=d&&application.oJVccBar.SendWeChatMsg(a,d.type,d.userId,d.vccPublicId,"vedio","",b,c,"",0)};this.SendFormatMessage=function(a,b,c,d){""==a&&(a=this._currentSession);var e=this.GetSessionItemBySessionID(a);null!=e&&application.oJVccBar.SendWeChatMsg(a,e.type,e.userId,e.vccPublicId,"notice","","",b,c,d)};this.EndMessage=function(a){""==a&&(a=this._currentSession);var b=this.GetSessionItemBySessionID(a);null!=b&&application.oJVccBar.SendWeChatMsg(a,b.type,b.userId,b.vccPublicId,"end","","","","",0)};this.UploadFileToMMS=function(a,b){if(""==b)return 0;""==a&&(a=this._currentSession);var c=this.GetSessionItemBySessionID(a);null!=c&&(this.arrSendFileName.push(b),this.arrSendFileSessionID.push(a),application.oJVccBar.UploadFileToMMS(b,c.userId,c.vccPublicId));return 0};this.DownFileFromMMS=function(a,b,c){if(""==c)return 0;""==a&&(a=this._currentSession);var d=this.GetSessionItemBySessionID(a);null!=d&&(this.arrRecvFileName.push(c),this.arrRecvFileSessionID.push(a),this.arrRecvFileMsgseq.push(b),application.oJVccBar.DownFileFromMMS(c,d.userId,d.vccPublicId,a,b));return 0};this.GetSessionItemBySessionID=function(a){a=this.GetSessionIndexBySessionID(a);return-1==a?null:this.weChatSessions[a]};this.GetSessionItem=function(a,b){var c=this.GetSessionItemBySessionID(a);if(null!=c)for(var d=0;d<c.GetMessageCount();d++){var e=c.GetMessageItemByIndex(d);if(e.msgseq==b)return e}return null};this.OnBeginSession=function(a){};this.OnEndSession=function(a){};this.OnRecvMessage=function(a,b){};this.OnSendMessageReport=function(a,b){};this.OnUploadFileStatus=function(a,b,c){};this.OnDowndFileStatus=function(a,b,c,d){}}var eventOnCallRing=0,eventOnAnswerCall=1,eventOnCallEnd=2,eventOnPrompt=3,eventOnReportBtnStatus=4,eventOnInitalSuccess=5,eventOnInitalFailure=6,eventOnEventPrompt=7,eventOnAgentWorkReport=8,eventOnCallDataChanged=9,eventOnBarExit=10,eventOnCallQueueQuery=11,eventOnQueryGroupAgentStatus=12,eventOnSystemMessage=13,eventOnRecvWeiboMsg=14,eventOnIMMessage=15,eventOnRecvWeChatMessage=16,eventOnSendWeChatMsgReport=17,eventOnUploadFileToMMSReport=18,eventOnDownloadFileToMMSReport=19,eventOnServiceStaticReport=20,eventOnAQueryCTIInfoReport=21,eventOnAgentBusyReasonReport=22,eventOnAgentLogUploadReport=23,eventOnAsrEventReport=24,eventOnGetVersionReport=25,eventOnAgentReport=eventOnGetVersionReport+1,eventOnTelReport=eventOnAgentReport+1,eventOnServiceReport=eventOnAgentReport+2,eventOnIvrReport=eventOnAgentReport+3,eventOnTaskReport=eventOnAgentReport+4,eventOnOutboundReport=eventOnAgentReport+5,eventOnCallReportInfo=eventOnAgentReport+6,eventOnQueueReport=eventOnAgentReport+7,eventOnQueryMonitorSumReport=eventOnAgentReport+8,eventOnWallServiceReport=eventOnAgentReport+9,eventOnWallQueueReport=eventOnAgentReport+10,eventOnWorkStaticInfoReport=eventOnAgentReport+11,eventOnAgentStaticReport=eventOnAgentReport+13,eventOnTrunkReport=eventOnAgentReport+14,eventOnTrunkSumReport=eventOnAgentReport+15,eventOnWebsocketSocket=60,lg_zhcn="zh-cn",lg_english="en-us",g_JsVersion="1.0.0.19",g_JsVersionTimer="20180904";function GetLanguageItem(a,b,c){return a==lg_zhcn?b:c}function CErrorItem(){this.code=0;this.description="";this.level=0;this.engshDes="";return this}function CHtmlBarControl(a){this._language=a;this._arrErrorInfo=[];this._loadErrorInfo=function(){this._addItem(2100,0,"\u6d88\u606f\u672a\u5b9a\u4e49","message not defined");this._addItem(2101,2,"\u6d88\u606f\u53c2\u6570\u5f02\u5e38","parameter error");this._addItem(2102,2,"\u6d88\u606f\u53d1\u9001\u5931\u8d25","send message failure");this._addItem(2110,2,"\u5ea7\u5e2d\u4e0d\u5b58\u5728","agent not exist");this._addItem(2111,2,"\u5ea7\u5e2d\u6682\u505c\u4f7f\u7528","agent unusefull temporary");this._addItem(2112,2,"\u5ea7\u5e2d\u5bc6\u7801\u9a8c\u8bc1\u9519\u8bef","wrong agent password");this._addItem(2113,2,"\u5ea7\u5e2d\u5bc6\u7801\u672a\u751f\u6548","agent password uneffective");this._addItem(2114,2,"\u5ea7\u5e2d\u5bc6\u7801\u5df2\u8fc7\u671f","agent password overdue");this._addItem(2115,2,"\u5ea7\u5e2d\u5df2\u9501\u5b9a","agent locked");this._addItem(2116,2,"\u5ea7\u5e2d\u65f6\u95f4\u6233\u4e0d\u5339\u914d","agent timestamp mismatching");this._addItem(2117,2,"\u5ea7\u5e2d\u767b\u5f55\u5206\u673a\u548c\u7ed1\u5b9a\u5206\u673a\u4e0d\u5339\u914d","agent'd device is mismatching with binded device");this._addItem(2118,2,"\u5ea7\u5e2d\u6240\u7528\u5206\u673a\u5df2\u88ab\u5176\u4ed6\u5ea7\u5e2d\u767b\u5f55","agent'd device is used by other");this._addItem(2119,1,"\u5ea7\u5e2d\u5df2\u767b\u5f55","agent signined");this._addItem(2120,2,"\u5ea7\u5e2d\u4e0d\u5141\u8bb8\u88ab\u66ff\u4ee3","agent can't be replaced");this._addItem(2121,1,"\u5ea7\u5e2d\u672a\u767b\u5f55","agent have not been signined");this._addItem(2122,1,"\u5ea7\u5e2d\u5fd9","agent busy");this._addItem(2123,2,"\u767b\u5f55\u5931\u8d25\uff1a\u6b64\u5ea7\u5e2d\u5df2\u5728\u5176\u4ed6\u5730\u65b9\u767b\u5f55\u4e14\u6b63\u5728\u901a\u8bdd\u4e2d","signing failuer:this agent is called by other");this._addItem(2124,2,"\u767b\u5f55\u5931\u8d25\uff1a\u6b64\u5ea7\u5e2d\u5df2\u5728\u5176\u4ed6\u5730\u65b9\u767b\u5f55\u4e14\u540e\u5904\u7406\u4e2d","signing failuer:this agent is wrapup by other");this._addItem(2125,1,"\u5ea7\u5e2d\u672a\u7a7a\u95f2","agent not idle");this._addItem(2126,1,"\u5ea7\u5e2d\u672a\u63a5\u901a","agent not connected");this._addItem(2130,2,"\u5bf9\u65b9\u5ea7\u5e2d\u4e0d\u5b58\u5728","opponent agent not exist");this._addItem(2131,2,"\u5bf9\u65b9\u5ea7\u5e2d\u6682\u505c\u4f7f\u7528","opponent agent unusefull temporary");this._addItem(2132,2,"\u5bf9\u65b9\u5ea7\u5e2d\u5df2\u9501\u5b9a","opponent agent locked");this._addItem(2133,2,"\u5bf9\u65b9\u5ea7\u5e2d\u5206\u673a\u672a\u8bbe\u7f6e","opponent agent's device not set");this._addItem(2134,1,"\u5bf9\u65b9\u5ea7\u5e2d\u672a\u767b\u5f55","opponent agent not signin");this._addItem(2135,1,"\u5bf9\u65b9\u5ea7\u5e2d\u5fd9","opponent agent busy");this._addItem(2136,1,"\u5bf9\u65b9\u5ea7\u5e2d\u901a\u8bdd\u4e2d","opponent agent calling");this._addItem(2137,1,"\u5bf9\u65b9\u5ea7\u5e2d\u540e\u5904\u7406\u4e2d","opponent agent wrapup");this._addItem(2138,1,"\u5bf9\u65b9\u5ea7\u5e2d\u7a7a\u95f2","opponent agent idle");this._addItem(2140,1,"\u5206\u673a\u901a\u8bdd\u4e2d","agent'device calling");this._addItem(2141,2,"\u5206\u673a\u672a\u8bbe\u7f6eIVR\u670d\u52a1","device not set IVR service");this._addItem(2142,2,"\u4f01\u4e1a\u5df2\u6682\u505c\u6216\u65e0\u6b64\u4f01\u4e1a","department invalid");this._addItem(2143,2,"\u5ea7\u5e2d\u767b\u5f55\u8fbe\u5230\u6700\u5927\u9650\u5236","signined agent count over limit");this._addItem(2144,2,"\u5ea7\u5e2d\u5206\u673a\u4e0d\u662fcti\u53d7\u63a7","agent'device don't control by cti");this._addItem(2150,2,"\u5ea7\u5e2d\u5df2\u88ab\u9009\u4e2d","agent already selected");this._addItem(2151,2,"\u5ea7\u5e2d\u88ab\u8d28\u68c0\u5458\u5f3a\u5236\u7b7e\u51fa","agent forceouted by monitor agent");this._addItem(2152,2,"\u5ea7\u5e2d\u56e0\u632f\u94c3\u8d85\u65f6\u88ab\u5f3a\u5236\u7b7e\u51fa","agent forceouted for alerting out of time");this._addItem(2153,2,"\u5ea7\u5e2d\u88ab\u8bdd\u673a\u547d\u4ee4\u5f3a\u5236\u7b7e\u51fa","agent forceouted by phone command");this._addItem(2160,2,"\u5ea7\u5e2d\u5fc3\u8df3\u8d85\u65f6cti\u53d1\u9001OnSignOuted\u4e8b\u4ef6","cti send OnSignOuted to agent for heartbeat overtime");this._addItem(2161,2,"\u5ea7\u5e2d\u6536\u5230AgentReport\u53d1\u73b0\u5750\u5e2d\u7b7e\u51facti\u53d1\u9001OnSignOuted\u4e8b\u4ef6","cti send OnSignOuted to agent for AgentReport message");this._addItem(2162,2,"\u5ea7\u5e2d\u4e0d\u5728\u5916\u547c\u4efb\u52a1\u4e2d\u9884\u8bbe\u5ea7\u5e2d\u5217\u8868\u4e2d","This agent is not in outtask's pre-setting agent list!");this._addItem(2300,2,"\u5ea7\u5e2d\u767b\u5f55\u8d28\u68c0\u670d\u52a1\u9a8c\u8bc1\u9519\u8bef","monitor login failure for wrong password");this._addItem(websocket_guard_connecting,2,"\u6b63\u5728\u8fde\u63a5\u7535\u8bdd\u6761\u536b\u58eb\u3010{0}:{1}\u3011...\u7b2c\u3010{2}\u3011\u6b21","connecting CINGuard [{0}:{1}]...times:[{2}]");this._addItem(websocket_guard_connected,2,"\u8fde\u63a5\u7535\u8bdd\u6761\u536b\u58eb\u6210\u529f","connect CINGurad success");this._addItem(websocket_guard_colsed,2,"\u7535\u8bdd\u6761\u536b\u58eb\u8054\u7cfb\u65ad\u5f00","disconnected to CINGurad");this._addItem(websocket_guard_remoteserver_disconnected,2,"\u7535\u8bdd\u6761\u536b\u58eb\u548c\u5ea7\u5e2d\u65ad\u5f00","ie client and CINGuard disconnected");this._addItem(websocket_connecting,2,"\u6b63\u5728\u8fde\u63a5\u7535\u8bdd\u6761\u670d\u52a1\u3010{0}:{1}\u3011...\u7b2c\u3010{2}\u3011\u6b21","connecting Maccard [{0}:{1}]...times:[{2}]");this._addItem(websocket_connected,2,"\u8fde\u63a5\u7535\u8bdd\u6761\u670d\u52a1\u6210\u529f","connect Maccard success");this._addItem(websocket_closed,2,"\u65ad\u5f00\u7535\u8bdd\u6761\u670d\u52a1\u6210\u529f!","close Maccard success");this._addItem(websocket_remoteserver_disconnected,2,"\u548c\u7535\u8bdd\u6761\u670d\u52a1\u4e4b\u95f4\u8fde\u63a5\u65ad\u5f00\uff01","disconnect Maccard success");this._addItem(4E3,2,"\u521b\u5efaA\u670d\u52a1\u7c7b\u5931\u8d25","create AClass failuer");this._addItem(4001,2,"CTI Interface\u670d\u52a1\u5668\u65e0\u6cd5\u8bbf\u95ee!","Can not Connect to CTI Interface server");this._addItem(4002,2,"\u65e0\u6cd5\u8fde\u63a5CTI\u670d\u52a1\u5668!","Can not connect to CTI server");this._addItem(4003,2,"CTI Interface\u7684Initail\u65b9\u6cd5\u8c03\u7528\u5931\u8d25!","invoke Initial failure in CTI Interface");this._addItem(4004,2,"\u767b\u5f55CTI\u670d\u52a1\u5668\u5931\u8d25,\u786e\u8ba4CTI\u53ef\u7528\u6216\u8005\u914d\u7f6e\u4fe1\u606f\u662f\u5426\u6210\u529f!","login cti failure,be sure cti server is ok and congfiguration is right");this._addItem(4005,2,"\u7531\u4e8e\u7f51\u7edc\u539f\u56e0\u5ea7\u5e2d\u548cCTI\u65ad\u5f00\uff0c\u8bf7\u4e0d\u8981\u6302\u673a\uff0c3S\u540e\u91cd\u65b0\u8fde\u63a5!","agent disconnect temporary cause by network,it will be reconnect after ten seconds");this._addItem(4006,2,"\u5ea7\u5e2d\u6b63\u5728\u91cd\u8fde...","agent reconnecting ...");this._addItem(4007,0,"\u91cd\u8fde\u6210\u529f,\u5ea7\u5e2d\u5c31\u7eea\u53ef\u4ee5\u91cd\u65b0\u4f7f\u7528!","reconnected success! the agent is already ok");this._addItem(4008,2,"\u7531\u4e8e\u67d0\u4e9b\u539f\u56e0\u7f51\u7edc\u4e2d\u65ad,\u5bfc\u81f4\u5ea7\u5e2d\u548cCTI\u670d\u52a1\u5668\u65ad\u5f00,\u8bf7\u548c\u7ba1\u7406\u5458\u8054\u7cfb!","agent is signout from cti cause of network,please get help for administrator");this._addItem(4009,2,"\u5fc3\u8df3\u68c0\u6d4b\u5230CTI\u4e2d\u5ea7\u5e2d\u5df2\u7ecf\u9000\u51fa!","agent is signout by heartbeat checking");this._addItem(4010,1,"\u5ea7\u5e2d\u8bbe\u7f6e\u7684phoneType\u7c7b\u578b\u548c\u670d\u52a1\u5668\u7aef\u8bbe\u7f6e\u4e0d\u4e00\u6837\uff0c\u4f7f\u7528\u670d\u52a1\u5668\u7aef\u8bbe\u7f6e\u7684\u7535\u8bdd\u7c7b\u578b","phoneType mismatch with server's,using server's setting");this._addItem(4011,2,"\u7f51\u7edc\u4e0d\u7a33\u5b9a\uff0c\u5ea7\u5e2d\u4fee\u590d\u4e2d...","net error agent repairing ...");this._addItem(4012,2,"UC\u5e73\u53f0\u5bf9\u5e94[TaskId:{0}]\u914d\u7f6e\u53c2\u6570\u4e3a\u7a7a","Unified platform param is empty of [taskID:{0}]");this._addItem(4013,2,"UC CTI Interface\u670d\u52a1\u5668\u65e0\u6cd5\u8bbf\u95ee!","Cannot access to UC CTI Interface server");this._addItem(4014,2,"\u65e0\u6cd5\u8fde\u63a5UC CTI\u670d\u52a1\u5668!","Cannot access to UC CTI server");this._addItem(4015,2,"UC CTI Interface\u7684Initail\u65b9\u6cd5\u8c03\u7528\u5931\u8d25!","The UC CTI interface\u2019s initial method is failed");this._addItem(4300,2,"A\u63a5\u53e3\u63a7\u4ef6\u6ca1\u6709\u6ce8\u518c\u6216\u8005\u8def\u5f84\u4e0d\u5bf9!","CINNGCCA not register");this._addItem(4301,2,"PA\u63a7\u4ef6\u6ca1\u6709\u6ce8\u518c\u6216\u8005\u8def\u5f84\u4e0d\u5bf9!","PA not register");this._addItem(4302,2,"M\u63a7\u4ef6\u6ca1\u6709\u6ce8\u518c\u6216\u8005\u8def\u5f84\u4e0d\u5bf9!","CINMonitor not register");this._addItem(4303,2,"CTI\u670d\u52a1\u5668\u65ad\u5f00,\u8bf7\u4e0e\u7ba1\u7406\u5458\u8054\u7cfb!","disconnect from cti,please get help for administrator");this._addItem(4305,2,"\u672c\u5ea7\u5e2d\u88ab\u5176\u4ed6\u7ec8\u7aef\u6240\u66ff\u4ee3!","agent replaced by other");this._addItem(4309,2,"\u7535\u8bdd\u6ce8\u518c\u5931\u8d25!","sipphone register failure");this._addItem(4310,2,"\u8bf7\u521d\u59cb\u5316\u63a7\u4ef6!","please initial the ocx");this._addItem(4311,2,"\u547d\u4ee4\u4e0d\u53ef\u7528,\u65e0\u6cd5\u6267\u884c!","method disanble,can't execute");this._addItem(4312,2,"\u76ee\u6807\u53f7\u7801\u4e0d\u80fd\u4e3a\u7a7a!","target number can't be empty");this._addItem(4313,2,"\u76ee\u6807\u53f7\u7801\u4e0d\u5408\u6cd5!","target number unvalidated ");this._addItem(4314,2,"\u76ee\u6807\u53f7\u7801\u4e0d\u80fd\u8d85\u8fc764\u4f4d","target number can't be more then 64 character");this._addItem(4315,2,"\u5ea7\u5e2d\u88abUnInitial","agent is UnInitialed");this._addItem(4316,1,"sip\u6ce8\u518c\u9519\u8bef\u7801:","sip error code:");this._addItem(4360,0,"\u6b63\u5728\u6ce8\u518cSip\u7535\u8bdd...","sipphone regsitering...");this._addItem(4361,0,"\u7535\u8bdd\u6ce8\u518c\u6210\u529f!","sipphone regsitered success");this._addItem(4362,0,"\u6b63\u5728\u68c0\u6d4b\u5230\u5ea7\u5e2d\u5361...","checking agent card...");this._addItem(4363,2,"\u6ca1\u6709\u68c0\u6d4b\u5230\u5ea7\u5e2d\u5361!","ageng card not checked");this._addItem(4364,1,"\u8bbe\u7f6eftp\u670d\u52a1\u5668\u4fe1\u606f\u5931\u8d25!","ftp config wrong");this._addItem(4400,0,"\u7b7e\u5165CTI\u670d\u52a1\u5668\u6210\u529f!","agent signin success");this._addItem(4401,2,"\u7b7e\u5165CTI\u670d\u52a1\u5668\u5931\u8d25!","agent signin failure");this._addItem(4402,0,"\u7b7e\u51faCTI\u670d\u52a1\u5668\u6210\u529f!","agent signout success");this._addItem(4403,0,"\u7b7e\u51faCTI\u670d\u52a1\u5668\u5931\u8d25!","agent signout failure");this._addItem(4404,2,"\u5ea7\u5e2d\u88ab\u5f3a\u5236\u8fc1\u51fa!","agent force signout");this._addItem(4405,2,"\u5ea7\u5e2d\u5df2\u7ecf\u88ab\u9501\u5b9a,\u8bf7\u8054\u7cfb\u8d28\u68c0\u5e2d\u89e3\u9501!","agent locked,please contact with monitor agent");this._addItem(4407,1,"\u6b63\u5728\u5411CTI\u670d\u52a1\u5668\u6ce8\u518c...","sigining to cti server...");this._addItem(4408,0,"\u6b63\u5728\u5411Monitor\u670d\u52a1\u5668\u6ce8\u518c...","logining to monitor server...");this._addItem(4409,0,"\u6ce8\u518cMonitor\u6210\u529f!","login monitor server success");this._addItem(4410,0,"\u7535\u8bdd\u6761\u521d\u59cb\u5316\u6210\u529f!","cinvccbar initial success");this._addItem(4411,2,"\u7535\u8bdd\u6761\u521d\u59cb\u5316\u5931\u8d25!","cinvccbar initial failure");this._addItem(4412,0,"\u6b63\u5728\u5411\u5907\u7528CTI\u670d\u52a1\u5668\u6ce8\u518c...","sigining to backup cti server...");this._addItem(4413,0,"\u6b63\u5728\u5411\u5907\u7528Monitor\u670d\u52a1\u5668\u6ce8\u518c...","logining to backup monitor server...");this._addItem(4415,1,"\u7f51\u7edc\u4e0d\u7a33\u5b9a\uff0c\u7535\u8bdd\u6761\u4fee\u590d\u6210\u529f!","net error and agent repaired");this._addItem(4416,0,"\u5ea7\u5e2d\u7b7e\u5165\u4e2d...","agent is signing ...");this._addItem(4417,2,"\u60a8\u5df2\u7ecf\u542f\u52a8\u767b\u5f55\u4e00\u4e2a\u5ea7\u5e2d\u4e86\uff0c\u7981\u6b62\u767b\u5f55\u53e6\u4e00\u4e2a\u4e0d\u540c\u8d26\u53f7\u7684\u5ea7\u5e2d!","only one agent can be used in one computer!");this._addItem(4418,0,"CINScreenRecord.exe\u4e0d\u5b58\u5728,\u65e0\u6cd5\u5f55\u5c4f!","CINScreenRecord.exe not exist,can not record screen!");this._addItem(4419,0,"\u6b63\u5728\u5f55\u5c4f...","recording screen...");this._addItem(4420,0,"\u7ed3\u675f\u5f55\u5c4f,\u6b63\u5728\u4e0a\u4f20\u6587\u4ef6...","stop record screen,upload the record file...");this._addItem(4421,0,"\u4e0a\u4f20\u5f55\u5c4f\u6587\u4ef6\u6210\u529f!","upload the record file success!");this._addItem(4422,0,"\u4e0a\u4f20\u5f55\u5c4f\u6587\u4ef6\u5931\u8d25,\u7f13\u5b58\u7eed\u4f20!","upload the record file failure,cache for upload again!");this._addItem(4450,0,"\u5ea7\u5e2d\u5df2\u7ecf\u88ab\u62e6\u622a!","agent intercepted");this._addItem(4451,1,"\u6ca1\u6709\u8981\u88ab\u63a5\u56de\u7684\u5bf9\u8c61!","have no retrieved line");this._addItem(4452,1,"\u5916\u547c\u5fc5\u987b\u5fd9\u788c\u4e0b\u624d\u80fd\u8fdb\u884c!","makeout must be use in busy");this._addItem(4453,1,"\u6ca1\u6709\u901a\u8bdd,\u4e0d\u80fd\u8f6c\u79fb...","can't transfer out of call");this._addItem(4454,1,"\u53ea\u6709\u4e24\u4e2a\u4eba\u901a\u8bdd\u7684\u65f6\u5019\u624d\u80fd\u6267\u884c\u6b64\u547d\u4ee4...","can only be executed in tow line");this._addItem(4455,1,"\u666e\u901a\u72b6\u6001\u4e0b,\u4e8c\u6b21\u62e8\u53f7\u7801\u5fc5\u987b\u57280-15\u4e4b\u95f4!","the code must be from 0 to 15 in senddtmf");this._addItem(4456,1,"\u7528\u6237\u5df2\u6302\u673a","user have been out of call");this._addItem(4457,1,"\u8bf7\u5feb\u70b9\u670d\u52a1,\u6240\u6709\u5750\u5e2d\u90fd\u5fd9\u788c!","hurry! all agents are busy");this._addItem(4458,1,"Mute\u5fc5\u987b\u901a\u8bdd\u4e0b\u624d\u80fd\u8fdb\u884c!","mute can only be execute in call");this._addItem(4459,2,"\u5ba2\u6237\u7aef\u63a5\u901ayealink\u8bdd\u673a\u7684\u5931\u8d25!","yealink phone pickup failure in client type");this._addItem(4460,1,"\u4f1a\u8bae\u6216\u8005\u54a8\u8be2\u65f6\u4e0d\u80fd\u6302\u65ad\u4e3b\u63a7\u5ea7\u5e2d!","the master agent can't be disconnect in conferece or consult scene");this._addItem(4600,2,"\u521b\u5efaM\u670d\u52a1\u7c7b\u5931\u8d25!","create M class failure");this._addItem(4601,2,"Monitor Interface\u7684Initail\u65b9\u6cd5\u8c03\u7528\u5931\u8d25!","Initail to Monitor Interface failure");this._addItem(4602,2,"Monitor\u670d\u52a1\u5668\u5730\u5740\u9519\u8bef\u6216\u8005\u6ca1\u6709\u542f\u52a8!","Monitor server  can't be use");this._addItem(4603,2,"Monitor Interface\u670d\u52a1\u5668\u5730\u5740\u9519\u8bef\u6216\u8005\u6ca1\u6709\u542f\u52a8!","Monitor Interface  can't be use");this._addItem(4604,2,"\u767b\u5f55(Login)Monitor\u670d\u52a1\u5668\u5931\u8d25!","login in Monitor server failure");this._addItem(4605,2,"\u7531\u4e8e\u67d0\u4e9b\u539f\u56e0\u7f51\u7edc\u4e2d\u65ad,\u5bfc\u81f4Monitor\u548c\u670d\u52a1\u5668\u65ad\u5f00,5\u540e\u91cd\u65b0\u8fde\u63a5....","agent disconnect from monitor server by network,will reconnect in 5 minutes");this._addItem(4606,2,"Monitor\u6b63\u5728\u548c\u670d\u52a1\u5668\u91cd\u65b0\u8fde\u63a5....","monitor is reconnecting...");this._addItem(4607,2,"\u7531\u4e8e\u67d0\u4e9b\u539f\u56e0\u7f51\u7edc\u4e2d\u65ad,\u5bfc\u81f4Monitor\u548c\u670d\u52a1\u5668\u65ad\u5f00,\u8bf7\u548c\u7ba1\u7406\u5458\u8054\u7cfb!","monitor can't be connected with server by network,please contact to admin");this._addItem(4608,2,"Monitor\u91cd\u8fde\u6210\u529f,\u76d1\u63a7\u5ea7\u5e2d\u5c31\u7eea\u53ef\u4ee5\u91cd\u65b0\u4f7f\u7528!","monitor reconnect success,it works")};this._addItem=function(a,c,d,e){var f=new CErrorItem;f.code=a;f.level=c;f.description=d;f.engshDes=e;this._arrErrorInfo.push(f)};this.GetErrorItemDes=function(a){for(var c=0;c<this._arrErrorInfo.length;c++)if(this._arrErrorInfo[c].code==a)return this._language==lg_zhcn?this._arrErrorInfo[c].description:this._arrErrorInfo[c].engshDes;return""};this._loadErrorInfo();return this}var emInitNull=-1,emInitParamError=emInitNull+1,emInitSuccess=emInitNull+2,emInitSIPError=emInitNull+3,emInitMaccardError=emInitNull+4,emInitCTIError=emInitNull+5,emInitMonitorError=emInitNull+6,emCmdLogout=emInitNull+7,emCTIDisconneted=emInitNull+8,emMonitorDisconneted=emInitNull+9,emSipDisconneted=emInitNull+10,emServerDisconnected=emInitNull+11,emClientDisconnected=emInitNull+12,emExChangeAgentDisconnected=emInitNull+13,em_Bar_Unitial=0,em_Bar_Initialing=em_Bar_Unitial+1,em_Bar_Initialed=em_Bar_Unitial+2,em_Bar_Reconnecting=em_Bar_Unitial+3,emBtnWrapUp=0,emBtnSetBusy=emBtnWrapUp+1,emBtnSetIdle=emBtnWrapUp+2,emBtnMakeCall=emBtnWrapUp+3,emBtnHold=emBtnWrapUp+4,emBtnRetrieve=emBtnWrapUp+5,emBtnEndCall=emBtnWrapUp+6,emBtnTransfer=emBtnWrapUp+7,emBtnConference=emBtnWrapUp+8,emBtnPickUp=emBtnWrapUp+9,emBtnTransferOut=emBtnWrapUp+10,emBtnConsult=emBtnWrapUp+11,emBtnSendDtmf=emBtnWrapUp+12,emBtnBridge=emBtnWrapUp+13,emBtnAlterNate=emBtnWrapUp+14,emBtnConfig=emBtnWrapUp+15,emBtnForceReset=emBtnWrapUp+16,emBtnRecord=emBtnWrapUp+17,emBtnStopRecord=emBtnWrapUp+18,emBtnListen=emBtnWrapUp+19,emBtnInsert=emBtnWrapUp+20,emBtnIntercept=emBtnWrapUp+21,emBtnForceRelease=emBtnWrapUp+22,emBtnBeginPlay=emBtnWrapUp+23,emBtnStopPlay=emBtnWrapUp+24,emBtnLock=emBtnWrapUp+25,emBtnUnLock=emBtnWrapUp+26,emBtnMute=emBtnWrapUp+27,emBtnCallBack=emBtnWrapUp+28,emBtnReCall=emBtnWrapUp+29,emBtnHelp=emBtnWrapUp+30,CD_IVR_CALLIN=0,CD_SERVRE_EXACT_CALLOUT=1,CD_PREVIEW_CALLOUT=2,CD_AGENT_OUTSIDE_CALLOUT=3,CD_IVR_CALLOUT=4,CD_AGENT_INSIDE_CALLOUT=5,CD_CONSULT_CALLOUT=6,CD_SINGLE_CALLOUT=6,CD_BRIDGE_CALLOUT=8,CD_MONITOR_CALLIN=9,CD_INTERCEPT_CALLIN=10,CD_INSERT_CALLIN=11,CD_STEPBYSTEP_CALLOUT=12,CD_FORECAST_CALLOUT=13,CD_HELP_CALLIN=19,PORT_COUNT=5,barStatus_Null=0,barStatus_AgentConnecting=5,barStatus_AgentConnected=6,barStatus_AgentDisconnecting=7,barStatus_AgentDisconnected=8,RECONNECT_AGENT_TIME_ID=10,SETAGENTSTATUS_AGENT_TIME_ID=12;function JHTML5Ctrl(){this.oGuardCtrl=this.responseCallBack=this.eventCallBack=this.oApspWS=this.oAgentInfo=null;this._connectCount=0;this._arrBtnStatus=[];this._oTimer=null;this._load=function(){this.oAgentInfo=new JAgentInfo;this.oAgentInfo.loadFromLocal();this.oApspWS=new JAPSPWebSocket("MacCard");this.oApspWS.oParent=this;this.oApspWS.SetMsgCallBack(this.apspCallback);this.oGuardCtrl=new JGuardCtrl(this.oAgentInfo._localserver,this.oAgentInfo._localGuardPort);this.oGuardCtrl.oParent=this;this.oGuardCtrl.SetCallBack(this.guardCallback);this._oTimer=new JTimer;this._oTimer.oParent=this;this._oTimer.SetTimerCallBack(this._OnTimerEvent);this._oTimer.Start();for(var a=0;a<emBtnHelp+1;a++)this._arrBtnStatus.push(0);this._arrBtnStatus[emBtnWrapUp]=1;this._arrBtnStatus[emBtnConfig]=1};this._IsNeedReConnected=function(){var a;return a=(a=(a=!this.oAgentInfo._isConnected)||!this.oAgentInfo._isInitial)||this.oAgentInfo._barStatus!=em_Bar_Initialing&&this.oAgentInfo._isReConnect};this._OnTimerEvent=function(a){var b=this.oParent;a==RECONNECT_AGENT_TIME_ID&&(DisplayLog(VccBar_Log_Info,"--------ReconnectAgent-------"),b._IsNeedReConnected()&&b.Initial());a==SETAGENTSTATUS_AGENT_TIME_ID&&(b._oTimer.KillTimer(a),b.oAgentInfo._isConnected&&(1==b.oAgentInfo._agentOldStatus&&b.SetBusy(0),2==b.oAgentInfo._agentOldStatus&&b.SetIdle(),4==b.oAgentInfo._agentOldStatus&&b.SetWrapUp()),b.oAgentInfo._agentOldStatus=-2)};this._ResetBtn=function(){for(var a=0;a<emBtnHelp+1;a++)this._arrBtnStatus[a]=0};this._invokeEvent=function(a,b){null!=this.eventCallBack&&(DisplayLog(VccBar_Log_Info,"JHTML5Ctrl:_invokeEvent(cmdIndex\x3d"+a+"  param\x3d"+b+")"),this.eventCallBack(a,b),a==eventOnInitalSuccess&&this._InvokeMethod(APSP_GetConfiguration_CONF,""))};this._getPartenerNum=function(a){var b="";a=a.split("|");switch(parseInt(a[5])){case CD_IVR_CALLIN:case CD_SERVRE_EXACT_CALLOUT:case CD_SINGLE_CALLOUT:case CD_STEPBYSTEP_CALLOUT:case CD_FORECAST_CALLOUT:case CD_CONSULT_CALLOUT:b=a[0];break;case CD_PREVIEW_CALLOUT:case CD_AGENT_OUTSIDE_CALLOUT:case CD_AGENT_INSIDE_CALLOUT:case CD_MONITOR_CALLIN:case CD_INTERCEPT_CALLIN:case CD_INSERT_CALLIN:b=a[2];break;case CD_HELP_CALLIN:b=a[2];break;case CD_IVR_CALLOUT:case CD_BRIDGE_CALLOUT:b=a[0]}return b};this.connectToService=function(a,b){this.oApspWS.WSConnect(a,b);getLocalLanguage();this.oAgentInfo._ctrlStatus==barStatus_AgentConnecting&&this._invokeEvent(eventOnWebsocketSocket,stringFormat("{0}|{1}|{2}|{3}",websocket_connecting,a,b,this._connectCount));this._connectCount+=1};this._InvokeMethod=function(a,b){var c=this.oApspWS.GetCmdName(a);if(""==c)return-1;a==APSP_GetLocalPort_CONF?b=this.oAgentInfo._localPort+"|"+this.oAgentInfo._killMaccard:a==APSP_Initial_CONF&&(b=this.oAgentInfo.getInitialParam());DisplayLog(VccBar_Log_Info,"JHTML5Ctrl:_InvokeMethod(cmdName\x3d"+c+",param\x3d"+b+")");return this.oApspWS.WSSendMsg(buildApspMsg(c,b))};this.IsInitial=function(){DisplayLog(VccBar_Log_Info,"JHTML5Ctrl:IsInitial("+this.oAgentInfo._isInitial+")");return this.oAgentInfo._isInitial};this.IsMethodUserFull=function(a,b){if(1==this._arrBtnStatus[a])return!0;this._gfOnPrompt(4311,"\u547d\u4ee4["+b+"]\u4e0d\u53ef\u7528,\u65e0\u6cd5\u6267\u884c!");return!1};this.ResetThisCtrl=function(){this.oAgentInfo._isConnected=!1;this.oAgentInfo._isInitial=!1;this.oAgentInfo._ctrlStatus=barStatus_Null;this.oAgentInfo._localPort=4520;this.oAgentInfo._localGuardPort=4510;this._connectCount=0};this.GetBtnStatuIDs=function(){for(var a="",b=0;b<this.oAgentInfo._arrUserBtn.length;b++){var c=parseInt(this.oAgentInfo._arrUserBtn[b]);1==this._arrBtnStatus[c]&&(a=""==a?this.oAgentInfo._arrUserBtn[b]:a+"|"+this.oAgentInfo._arrUserBtn[b])}return a};this.SetLogoutStatus=function(){this._ResetBtn();this._arrBtnStatus[emBtnWrapUp]=1;this._arrBtnStatus[emBtnConfig]=1;this._invokeEvent(eventOnReportBtnStatus,this.GetBtnStatuIDs())};this._gfOnPrompt=function(a,b){"undefined"==typeof b&&(b="");this._invokeEvent(eventOnPrompt,a+"|"+b)};this.attachEventfun=function(a){this.eventCallBack=a};this.attachResponsefun=function(a){this.responseCallBack=a};this.GetBarCtrl=function(){return this};this.SetCtrlAttribute=function(a,b){"MainIP"==a?this.oAgentInfo._mainIP=b:"BackIP"==a?this.oAgentInfo._backIP=b:"MainPortID"==a?this.oAgentInfo._mainPortID=b:"BackPortID"==a?this.oAgentInfo._backPortID=b:"AgentID"==a?this.oAgentInfo._agentID=b:"Dn"==a?this.oAgentInfo._dn=b:"PassWord"==a?this.oAgentInfo._passWord=b:"MediaFlag"==a?this.oAgentInfo._vccId=b:"PhonType"==a?this.oAgentInfo._phoneType=b:"AppType"==a?this.oAgentInfo._appType=b:"SipServerIP"==a?this.oAgentInfo._sipIp=b:"SipServerPort"==a?this.oAgentInfo._sipServerPort=b:"SipProtocol"==a?this.oAgentInfo._sipProtocol=b:"SipDn"==a?this.oAgentInfo._sipDn=b:"SipAuthType"!=a&&("SipDomain"==a?this.oAgentInfo._sipDomain=b:"SipPassWord"==a?this.oAgentInfo._sipPassWord=b:"SipBackServerIP"==a?this.oAgentInfo._sipBackIp=b:"SipBackServerPort"==a?this.oAgentInfo._sipBackServerPort=b:"SipBackProtocol"==a?this.oAgentInfo._sipBackProtocol=b:"SipBackAuthType"==a?this.oAgentInfo._sipBackAuthType=b:"SipBackDomain"==a?this.oAgentInfo._sipBackDomain=b:"SipBackPassWord"==a?this.oAgentInfo._sipBackPassWord=b:"MonitorIP"==a?this.oAgentInfo._monitorIp=b:"MonitorPort"==a?this.oAgentInfo._monitorPor=b:"WeChatServer"==a?this.oAgentInfo._weChatServerIp=b:"SelfPrompt"==a?this.oAgentInfo._selfPrompt=b:"MinotorVersion"==a?this.oAgentInfo._minotorVersion=b:"TaskID"==a?this.oAgentInfo._taskID=b:"AutoUpdateURL"==a?(this.oAgentInfo._autoUpdateUrl=b,""!=b&&this.CheckVesion(b,"check")):"SipPassWdCryptType"==a?this.oAgentInfo._sipPassWdCryptType=b:"PassWdCryptType"==a?this.oAgentInfo._passWdCryptType=b:"AutoSelectAgent"==a?this.oAgentInfo._autoSelectAgent=b:"VersionType"==a?this.oAgentInfo._versionType=b:"IsAllTimeRecord"==a?this.oAgentInfo._allTimeRecord=b:"RecordType"==a?this.oAgentInfo._recordType=b:"AgentName"==a?this.oAgentInfo._agentName=b:"msgFlag"==a?this.oAgentInfo._msgFlag=b:"AgentType"==a?this.oAgentInfo._agentType=b:"LocalPort"==a?this.oAgentInfo._localPort=b:"ServiceLists"!=a&&"TimeOut"!=a&&("ftpServerIP"==a?this.oAgentInfo._ftpIp=b:"ftpServerPort"==a?this.oAgentInfo._ftpPort=b:"ftpUser"==a?this.oAgentInfo._ftpUser=b:"ftpPassWord"==a?this.oAgentInfo._ftpPassWord=b:"ftpDirectory"==a?this.oAgentInfo._ftpDirectory=b:"forceEndProcess"==a?this.oAgentInfo._killMaccard=b:DisplayLog(VccBar_Log_Error,"bad attribute name:"+a)))};this.GetCtrlAttribute=function(a){if("MainIP"==a)return this.oAgentInfo._mainIP;if("BackIP"==a)return this.oAgentInfo._backIP;if("MainPortID"==a)return this.oAgentInfo._mainPortID;if("BackPortID"==a)return this.oAgentInfo._backPortID;if("AgentID"==a)return this.oAgentInfo._agentID;if("Dn"==a)return this.oAgentInfo._dn;if("PassWord"==a)return this.oAgentInfo._passWord;if("MediaFlag"==a)return this.oAgentInfo._vccId;if("PhonType"==a)return this.oAgentInfo._phoneType;if("AppType"==a)return this.oAgentInfo._appType;if("SipServerIP"==a)return this.oAgentInfo._sipIp;if("SipServerPort"==a)return this.oAgentInfo._sipServerPort;if("SipProtocol"==a)return this.oAgentInfo._sipProtocol;if("SipDn"==a)return this.oAgentInfo._sipDn;if("SipAuthType"==a)return this.oAgentInfo._sipAuthType;if("SipDomain"==a)return this.oAgentInfo._sipDomain;if("SipPassWord"==a)return this.oAgentInfo._sipPassWord;if("SipBackServerIP"==a)return this.oAgentInfo._sipBackIp;if("SipBackServerPort"==a)return this.oAgentInfo._sipBackServerPort;if("SipBackProtocol"==a)return this.oAgentInfo._sipBackProtocol;if("SipBackAuthType"==a)return this.oAgentInfo._sipBackAuthType;if("SipBackDomain"==a)return this.oAgentInfo._sipBackDomain;if("SipBackPassWord"==a)return this.oAgentInfo._sipBackPassWord;if("MonitorIP"==a)return this.oAgentInfo._monitorIp;if("MonitorPort"==a)return this.oAgentInfo._monitorPor;if("WeChatServer"==a)return this.oAgentInfo._weChatServerIp;if("SelfPrompt"==a)return this.oAgentInfo._selfPrompt;if("MinotorVersion"==a)return this.oAgentInfo._minotorVersion;if("TaskID"==a)return this.oAgentInfo._taskID;if("AutoUpdateURL"==a)return this.oAgentInfo._autoUpdateUrl;if("SipPassWdCryptType"==a)return this.oAgentInfo._sipPassWdCryptType;if("PassWdCryptType"==a)return this.oAgentInfo._passWdCryptType;if("AutoSelectAgent"==a)return this.oAgentInfo._autoSelectAgent;if("VersionType"==a)return this.oAgentInfo._versionType;if("IsAllTimeRecord"==a)return this.oAgentInfo._allTimeRecord;if("RecordType"==a)return this.oAgentInfo._recordType;if("AgentName"==a)return this.oAgentInfo._agentName;if("msgFlag"==a)return this.oAgentInfo._msgFlag;if("AgentType"==a)return this.oAgentInfo._agentType;if("LocalPort"==a)return this.oAgentInfo._localPort;if("ServiceLists"==a||"TimeOut"==a)return"";if("ftpServerIP"==a)return this.oAgentInfo._ftpIp;if("ftpServerPort"==a)return this.oAgentInfo._ftpPort;if("ftpUser"==a)return this.oAgentInfo._ftpUser;if("ftpPassWord"==a)return this.oAgentInfo._ftpPassWord;if("ftpDirectory"==a)return this.oAgentInfo._ftpDirectory;if("localHttpServer"==a)return this.oAgentInfo._localHttpPort;DisplayLog(VccBar_Log_Error,"bad attribute name:"+a);return""};this.GetBarType=function(){return vccBarTypeHTML5};this.CheckVesion=function(a,b){this.oGuardCtrl.exeGuardCmd(cmd_GuardType_UpdateSetup,a,b);return 0};this.Initial=function(){if(1==this.oAgentInfo._isConnected)if(this.oAgentInfo._ctrlStatus==barStatus_AgentConnected)this._IsNeedReConnected()&&(this._InvokeMethod(APSP_Initial_CONF,""),this.oAgentInfo._barStatus=em_Bar_Initialing);else return-1;else this.oAgentInfo._ctrlStatus==barStatus_Null&&(getLocalLanguage()==lg_english?this.oGuardCtrl.exeGuardCmd(cmd_GuardType_GetLocalPort,this.oAgentInfo._localPort+"|"+this.oAgentInfo._killMaccard+"|english",""):this.oGuardCtrl.exeGuardCmd(cmd_GuardType_GetLocalPort,this.oAgentInfo._localPort+"|"+this.oAgentInfo._killMaccard,""));return 0};this.SerialBtn=function(a,b){"undefined"==typeof b&&(b="");this.oAgentInfo.InitSerialBtn(a,b);return this._InvokeMethod(APSP_SerialBtn_CONF,GetApspParam(a))};this.GetBtnStatus=function(a){return 1!=this.IsInitial()?this.GetBtnStatuIDs():this._InvokeMethod(APSP_GetBtnStatus_CONF,GetApspParam(a))};this.stringToInt=function(a,b){"undefined"==typeof a&&(a="");return""==a?b:parseInt(a)};this.Configurate=function(a){"undefined"==typeof a&&(a="");var b=a.split("|");if("PopWin"==a.substr(0,6)){if(this.IsInitial())return this._InvokeMethod(APSP_Configurate_CONF,a)}else if(1!=b.length||""!=a)if(5==b.length)this.oAgentInfo._autoAnswer=this.stringToInt(b[0],this.oAgentInfo._autoAnswer),this.oAgentInfo._idleStatus=this.stringToInt(b[1],this.oAgentInfo._idleStatus),this.oAgentInfo._callIn=this.stringToInt(b[2],this.oAgentInfo._callIn),this.oAgentInfo._warn=this.stringToInt(b[3],this.oAgentInfo._warn),this.oAgentInfo._sipAlert=this.stringToInt(b[4],this.oAgentInfo._sipAlert);else if(7==b.length)this.oAgentInfo._autoAnswer=this.stringToInt(b[0],this.oAgentInfo._autoAnswer),this.oAgentInfo._idleStatus=this.stringToInt(b[1],this.oAgentInfo._idleStatus),this.oAgentInfo._callIn=this.stringToInt(b[2],this.oAgentInfo._callIn),this.oAgentInfo._warn=this.stringToInt(b[3],this.oAgentInfo._warn),this.oAgentInfo._sipAlert=this.stringToInt(b[4],this.oAgentInfo._sipAlert),this.oAgentInfo._recvNs=this.stringToInt(b[5],this.oAgentInfo._recvNs),this.oAgentInfo._sendNs=this.stringToInt(b[6],this.oAgentInfo._sendNs);else if(10==b.length)this.oAgentInfo._autoAnswer=this.stringToInt(b[0],this.oAgentInfo._autoAnswer),this.oAgentInfo._idleStatus=this.stringToInt(b[1],this.oAgentInfo._idleStatus),this.oAgentInfo._callIn=this.stringToInt(b[2],this.oAgentInfo._callIn),this.oAgentInfo._warn=this.stringToInt(b[3],this.oAgentInfo._warn),this.oAgentInfo._sipAlert=this.stringToInt(b[4],this.oAgentInfo._sipAlert),this.oAgentInfo._recvNs=this.stringToInt(b[5],this.oAgentInfo._recvNs),this.oAgentInfo._sendNs=this.stringToInt(b[6],this.oAgentInfo._sendNs),this.oAgentInfo._recvAgc=this.stringToInt(b[7],this.oAgentInfo._recvAgc),this.oAgentInfo._sendAgc=this.stringToInt(b[8],this.oAgentInfo._sendAgc),this.oAgentInfo._sendEc=this.stringToInt(b[9],this.oAgentInfo._sendEc);else if(11==b.length)this.oAgentInfo._autoAnswer=this.stringToInt(b[0],this.oAgentInfo._autoAnswer),this.oAgentInfo._idleStatus=this.stringToInt(b[1],this.oAgentInfo._idleStatus),this.oAgentInfo._callIn=this.stringToInt(b[2],this.oAgentInfo._callIn),this.oAgentInfo._warn=this.stringToInt(b[3],this.oAgentInfo._warn),this.oAgentInfo._sipAlert=this.stringToInt(b[4],this.oAgentInfo._sipAlert),this.oAgentInfo._registInterVal=this.stringToInt(b[5],this.oAgentInfo._registInterVal),this.oAgentInfo._vedioWnd=this.stringToInt(b[6],this.oAgentInfo._vedioWnd),this.oAgentInfo._bandWidth=this.stringToInt(b[7],this.oAgentInfo._bandWidth),this.oAgentInfo._frameRate=this.stringToInt(b[8],this.oAgentInfo._frameRate),this.oAgentInfo._vedioFormat=this.stringToInt(b[9],this.oAgentInfo._vedioFormat),this.oAgentInfo._defaultIP=b[10];else if(12==b.length)this.oAgentInfo._autoAnswer=this.stringToInt(b[0],this.oAgentInfo._autoAnswer),this.oAgentInfo._idleStatus=this.stringToInt(b[1],this.oAgentInfo._idleStatus),this.oAgentInfo._callIn=this.stringToInt(b[2],this.oAgentInfo._callIn),this.oAgentInfo._warn=this.stringToInt(b[3],this.oAgentInfo._warn),this.oAgentInfo._sipAlert=this.stringToInt(b[4],this.oAgentInfo._sipAlert),this.oAgentInfo._registInterVal=this.stringToInt(b[5],this.oAgentInfo._registInterVal),this.oAgentInfo._vedioWnd=this.stringToInt(b[6],this.oAgentInfo._vedioWnd),this.oAgentInfo._bandWidth=this.stringToInt(b[7],this.oAgentInfo._bandWidth),this.oAgentInfo._frameRate=this.stringToInt(b[8],this.oAgentInfo._frameRate),this.oAgentInfo._vedioFormat=this.stringToInt(b[9],this.oAgentInfo._vedioFormat),this.oAgentInfo._defaultIP=b[10],this.oAgentInfo._pingFlag=this.stringToInt(b[11],this.oAgentInfo._pingFlag);else if(16==b.length)this.oAgentInfo._autoAnswer=this.stringToInt(b[0],this.oAgentInfo._autoAnswer),this.oAgentInfo._idleStatus=this.stringToInt(b[1],this.oAgentInfo._idleStatus),this.oAgentInfo._callIn=this.stringToInt(b[2],this.oAgentInfo._callIn),this.oAgentInfo._warn=this.stringToInt(b[3],this.oAgentInfo._warn),this.oAgentInfo._sipAlert=this.stringToInt(b[4],this.oAgentInfo._sipAlert),this.oAgentInfo._registInterVal=this.stringToInt(b[5],this.oAgentInfo._registInterVal),this.oAgentInfo._vedioWnd=this.stringToInt(b[6],this.oAgentInfo._vedioWnd),this.oAgentInfo._bandWidth=this.stringToInt(b[7],this.oAgentInfo._bandWidth),this.oAgentInfo._frameRate=this.stringToInt(b[8],this.oAgentInfo._frameRate),this.oAgentInfo._vedioFormat=this.stringToInt(b[9],this.oAgentInfo._vedioFormat),this.oAgentInfo._defaultIP=b[10],this.oAgentInfo._capType=this.stringToInt(b[11],this.oAgentInfo._capType),this.oAgentInfo._minMediaPort=this.stringToInt(b[12],this.oAgentInfo._minMediaPort),this.oAgentInfo._maxMediaPort=this.stringToInt(b[13],this.oAgentInfo._maxMediaPort),this.oAgentInfo._ecDelaySize=this.stringToInt(b[14],this.oAgentInfo._ecDelaySize),this.oAgentInfo._popAlert=this.stringToInt(b[15],this.oAgentInfo._popAlert);else if(17==b.length)this.oAgentInfo._autoAnswer=this.stringToInt(b[0],this.oAgentInfo._autoAnswer),this.oAgentInfo._idleStatus=this.stringToInt(b[1],this.oAgentInfo._idleStatus),this.oAgentInfo._callIn=this.stringToInt(b[2],this.oAgentInfo._callIn),this.oAgentInfo._warn=this.stringToInt(b[3],this.oAgentInfo._warn),this.oAgentInfo._sipAlert=this.stringToInt(b[4],this.oAgentInfo._sipAlert),this.oAgentInfo._registInterVal=this.stringToInt(b[5],this.oAgentInfo._registInterVal),this.oAgentInfo._vedioWnd=this.stringToInt(b[6],this.oAgentInfo._vedioWnd),this.oAgentInfo._bandWidth=this.stringToInt(b[7],this.oAgentInfo._bandWidth),this.oAgentInfo._frameRate=this.stringToInt(b[8],this.oAgentInfo._frameRate),this.oAgentInfo._vedioFormat=this.stringToInt(b[9],this.oAgentInfo._vedioFormat),this.oAgentInfo._defaultIP=b[10],this.oAgentInfo._capType=this.stringToInt(b[11],this.oAgentInfo._capType),this.oAgentInfo._minMediaPort=this.stringToInt(b[12],this.oAgentInfo._minMediaPort),this.oAgentInfo._maxMediaPort=this.stringToInt(b[13],this.oAgentInfo._maxMediaPort),this.oAgentInfo._ecDelaySize=this.stringToInt(b[14],this.oAgentInfo._ecDelaySize),this.oAgentInfo._popAlert=this.stringToInt(b[15],this.oAgentInfo._popAlert);else if(18==b.length)this.oAgentInfo._autoAnswer=this.stringToInt(b[0],this.oAgentInfo._autoAnswer),this.oAgentInfo._idleStatus=this.stringToInt(b[1],this.oAgentInfo._idleStatus),this.oAgentInfo._callIn=this.stringToInt(b[2],this.oAgentInfo._callIn),this.oAgentInfo._warn=this.stringToInt(b[3],this.oAgentInfo._warn),this.oAgentInfo._sipAlert=this.stringToInt(b[4],this.oAgentInfo._sipAlert),this.oAgentInfo._registInterVal=this.stringToInt(b[5],this.oAgentInfo._registInterVal),this.oAgentInfo._vedioWnd=this.stringToInt(b[6],this.oAgentInfo._vedioWnd),this.oAgentInfo._bandWidth=this.stringToInt(b[7],this.oAgentInfo._bandWidth),this.oAgentInfo._frameRate=this.stringToInt(b[8],this.oAgentInfo._frameRate),this.oAgentInfo._vedioFormat=this.stringToInt(b[9],this.oAgentInfo._vedioFormat),this.oAgentInfo._defaultIP=b[10],this.oAgentInfo._capType=this.stringToInt(b[11],this.oAgentInfo._capType),this.oAgentInfo._minMediaPort=this.stringToInt(b[12],this.oAgentInfo._minMediaPort),this.oAgentInfo._maxMediaPort=this.stringToInt(b[13],this.oAgentInfo._maxMediaPort),this.oAgentInfo._ecDelaySize=this.stringToInt(b[14],this.oAgentInfo._ecDelaySize),this.oAgentInfo._popAlert=this.stringToInt(b[15],this.oAgentInfo._popAlert),this.oAgentInfo._sipHeartBeatType=this.stringToInt(b[17],this.oAgentInfo._sipHeartBeatType);else return getLocalLanguage()==lg_zhcn?alert("Configurate\u8bbe\u7f6e\u53c2\u6570\u4e0d\u6b63\u786e"):alert("bad Configurate parameter"),-1;this.oAgentInfo.saveToLocal();return this.IsInitial()?this._InvokeMethod(APSP_Configurate_CONF,this.oAgentInfo.getConfigParam()):-1};this.GetConfiguration=function(){return this.oAgentInfo.getConfiguration()};this.UnInitial=function(a){return this.IsInitial()?("undefined"==typeof a&&(a="0"),this.oAgentInfo._barExitCode=a,this._InvokeMethod(APSP_UnInitial_CONF,a)):-1};this.SetUIStyle=function(a){getLocalLanguage()==lg_zhcn?alert("\u6b64\u65b9\u6cd5\u65e0\u6548"):alert("invalidate Method")};this.GetVersion=function(){""==this.oAgentInfo._version&&this.oGuardCtrl.exeGuardCmd(cmd_GuardType_GetVersion,"","");return this.oAgentInfo._version};this.SetBusy=function(a){if(!this.IsInitial()||!this.IsMethodUserFull(emBtnSetBusy,"SetBusy"))return-1;a=getDefaultParam(a);""==a&&(a=0);this.oAgentInfo._agentBusySubStatus=a;return this._InvokeMethod(APSP_SetBusy_CONF,a)};this.SetIdle=function(){return this.IsInitial()&&this.IsMethodUserFull(emBtnSetIdle,"SetIdle")?this._InvokeMethod(APSP_SetIdle_CONF,""):-1};this.SetWrapUp=function(){return this.IsMethodUserFull(emBtnSetIdle,"SetIdle")||this.IsMethodUserFull(emBtnSetBusy,"SetBusy")?this._InvokeMethod(APSP_SetWrapUp_CONF,""):-1};this.SetCTICalloutTask=function(a){this.oAgentInfo._taskID=a;return this._InvokeMethod(APSP_SetCTICalloutTask_CONF,a)};this.GetCTICalloutTask=function(){return this._InvokeMethod(APSP_GetCTICalloutTask_CONF,"")};this.GetCallData=function(a){return this._InvokeMethod(APSP_GetCallData_CONF,GetApspParam(a))};this.SetCallData=function(a,b){return this._InvokeMethod(APSP_SetCallData_CONF,GetApspParam(a,b))};this.GetTransfer=function(){return this._InvokeMethod(APSP_GetTransfer_CONF,"")};this.SetTransfer=function(a,b,c){return this._InvokeMethod(APSP_SetTransfer_CONF,GetApspParam(a,b,c))};this.ChangeCallQueue=function(a,b,c){return this._InvokeMethod(APSP_ChangeCallQueue_CONF,GetApspParam(a,b,c))};this.GetCallID=function(){return this._InvokeMethod(APSP_GetCallID_CONF,"")};this.QuerySPGroupList=function(a,b,c,d,e,f){"undefined"==typeof c&&(c="9");"undefined"==typeof d&&(d="0");this.oAgentInfo._realMethodName="QuerySPGroupList";return this._InvokeMethod(APSP_QueryCTIInfo_CONF,GetApspParam(c,a,b,d,e,f))};this.GetCallInfo=function(){return this._InvokeMethod(APSP_GetCallInfo_CONF,"")};this.SetTransparentParameter=function(a){return this._InvokeMethod(APSP_SetTransparentParameter_CONF,a)};this.GetAgentStatus=function(){return this.oAgentInfo._agentStatus};this.GetAgentSubBusyStatus=function(){return 1==this.oAgentInfo._agentStatus?this.oAgentInfo._agentBusySubStatus:-1};this.GetBusySubStatus=function(){return this.oAgentInfo._strBusySubStatus};this.SetDisplayNumber=function(a){this.oAgentInfo._realMethodName="SetDisplayNumber";return this._InvokeMethod(APSP_SetCTIInfo_CONF,GetApspParam("8",a))};this.GetDisplayNumber=function(){this.oAgentInfo._realMethodName="GetDisplayNumber";return this._InvokeMethod(APSP_QueryCTIInfo_CONF,"21|")};this.CallQueueQuery=function(a,b,c){return this._InvokeMethod(APSP_CallQueueQuery_CONF,GetApspParam(a,b,c))};this.QueryGroupAgentStatus=function(a,b,c,d){this.oAgentInfo._realMethodName="QueryGroupAgentStatus";return this._InvokeMethod(APSP_QueryCTIInfo_CONF,GetApspParam("22",a,b,c,d))};this.QueryPreViewCallOutNumbers=function(a,b,c,d){this.oAgentInfo._realMethodName="QueryPreViewCallOutNumbers";return this._InvokeMethod(APSP_QueryCTIInfo_CONF,GetApspParam("23",a,b,c,d))};this.GetBase64Data=function(a){return GetBase64FromGBK(a)};this.GetDataFromBase64=function(a){return GetGBKFromBase64(a)};this.SetWeChatQueueFlag=function(a){this.oAgentInfo._realMethodName="SetWeChatQueueFlag";return this._InvokeMethod(APSP_SetCTIInfo_CONF,GetApspParam("30",a))};this.GetWeChatQueueFlag=function(){this.oAgentInfo._realMethodName="GetWeChatQueueFlag";return this._InvokeMethod(APSP_QueryCTIInfo_CONF,GetApspParam("30",""))};this.TransferCallQueue=function(a,b,c){return this._InvokeMethod(APSP_TransferCallQueue_CONF,GetApspParam(a,b,c))};this.SetActiveService=function(a){this.oAgentInfo._realMethodName="SetActiveService";return this._InvokeMethod(APSP_SetCTIInfo_CONF,GetApspParam("26",a))};this.GetActiveService=function(){this.oAgentInfo._realMethodName="GetActiveService";return this._InvokeMethod(APSP_QueryCTIInfo_CONF,GetApspParam("26",""))};this.GetExitCause=function(){return this.oAgentInfo._strExitCause};this.SetForwardNumber=function(a,b){this.oAgentInfo._realMethodName="SetForwardNumber";return this._InvokeMethod(APSP_SetCTIInfo_CONF,GetApspParam("25",a,b))};this.GetForwardNumber=function(){this.oAgentInfo._realMethodName="GetForwardNumber";return this._InvokeMethod(APSP_QueryCTIInfo_CONF,GetApspParam("25",""))};this.SetAgentReservedStatus=function(a,b){this.oAgentInfo._realMethodName="SetAgentReservedStatus";return this._InvokeMethod(APSP_SetCTIInfo_CONF,GetApspParam("31",a,b))};this.SetMMService=function(a,b){this.oAgentInfo._realMethodName="SetMMService";return this._InvokeMethod(APSP_SetCTIInfo_CONF,GetApspParam("34",a,b))};this.GetAgentLogFile=function(a,b,c){this.oAgentInfo._realMethodName="GetAgentLogFile";return this._InvokeMethod(APSP_SetCTIInfo_CONF,GetApspParam("32",this.oAgentInfo._agentID,a,b,c))};this.GetMonitorOffSetTime=function(){return this.oAgentInfo._ampOffSetTime};this.MakeCall=function(a,b,c,d,e,f,g,m){if(!this.IsInitial()||!this.IsMethodUserFull(emBtnMakeCall,"MakeCall"))return-1;if(""==a)return this._gfOnPrompt(4312),-1;"undefined"==typeof g&&(g=0);if(0==g&&(a=formatCallNum(a),!isPhoneNum(a,!0)))return this._gfOnPrompt(4313),-1;b=getDefaultParam(b);""==b&&(b=CD_PREVIEW_CALLOUT);"undefined"==typeof c&&(c="");"undefined"==typeof d&&(d="");d=this.GetBase64Data(d);"undefined"==typeof e&&(e="");"undefined"==typeof f&&(f="");"undefined"==typeof m&&(m="");return this._InvokeMethod(APSP_MakeCall_CONF,GetApspParam(a,b,c,d,e,f,g,m))};this.CallIn=function(a,b,c,d){if(!this.IsInitial()||!this.IsMethodUserFull(emBtnMakeCall,"CallIn"))return-1;b=getDefaultParam(b);""==b&&(b=CD_AGENT_INSIDE_CALLOUT);"undefined"==typeof c&&(c="");"undefined"==typeof d&&(d="");d=this.GetBase64Data(d);return this._InvokeMethod(APSP_CallIn_CONF,GetApspParam(a,b,c,d))};this.TransferOut=function(a,b){return this.IsInitial()&&this.IsMethodUserFull(emBtnTransferOut,"TransferOut")?this._InvokeMethod(APSP_TransferOut_CONF,GetApspParam(a,b)):-1};this.Hold=function(){return this.IsInitial()&&this.IsMethodUserFull(emBtnHold,"Hold")?this._InvokeMethod(APSP_Hold_CONF,""):-1};this.RetrieveHold=function(){return this.IsInitial()&&this.IsMethodUserFull(emBtnRetrieve,"RetrieveHold")?this._InvokeMethod(APSP_RetrieveHold_CONF,""):-1};this.Disconnect=function(a){if(!this.IsInitial()||!this.IsMethodUserFull(emBtnEndCall,"Disconnect"))return-1;a=getDefaultParam(a);""==a&&(a=0);return this._InvokeMethod(APSP_Disconnect_CONF,0==a?4:3)};this.Answer=function(a){return this.IsInitial()&&this.IsMethodUserFull(emBtnPickUp,"Answer")?this._InvokeMethod(APSP_Answer_CONF,a):-1};this.Consult=function(a,b){return this.IsInitial()&&this.IsMethodUserFull(emBtnConsult,"Consult")?""==b?(this._gfOnPrompt(4312),-1):0==a||(b=formatCallNum(b),isPhoneNum(b))?this._InvokeMethod(APSP_Consult_CONF,GetApspParam(a,b)):(this._gfOnPrompt(4313),-1):-1};this.Transfer=function(){return this.IsInitial()&&this.IsMethodUserFull(emBtnTransfer,"Transfer")?this._InvokeMethod(APSP_Transfer_CONF,""):-1};this.Conference=function(){return this.IsInitial()&&this.IsMethodUserFull(emBtnConference,"Conference")?this._InvokeMethod(APSP_Conference_CONF,""):-1};this.SendDTMF=function(a){return this.IsInitial()&&this.IsMethodUserFull(emBtnSendDtmf,"SendDTMF")?this._InvokeMethod(APSP_SendDTMF_CONF,a):-1};this.Bridge=function(a,b){return this.IsInitial()&&this.IsMethodUserFull(emBtnBridge,"Bridge")?""==a?(this._gfOnPrompt(4312),-1):this._InvokeMethod(APSP_Bridge_CONF,GetApspParam(a,b)):-1};this.Mute=function(a){return this.IsInitial()&&this.IsMethodUserFull(emBtnMute,"Mute")?this._InvokeMethod(APSP_Mute_CONF,a):-1};this.ReleaseThirdOne=function(a){if(!this.IsInitial()||!this.IsMethodUserFull(emBtnEndCall,"ReleaseThirdOne"))return-1;"undefined"==typeof a&&(a=0);this.oAgentInfo._retrieveCall=a;return this._InvokeMethod(APSP_ReleaseThirdOne_CONF,"")};this.ForceReset=function(){return this.IsInitial()&&this.IsMethodUserFull(emBtnForceReset,"ForceReset")?this._InvokeMethod(APSP_ForceReset_CONF,""):-1};this.SendIMMessage=function(a,b,c,d,e,f){return this._InvokeMethod(APSP_SendIMMessage_CONF,GetApspParam(a,b,c,d,e,f))};this.BeginPlay=function(a,b,c,d,e){if(!this.IsInitial()||!this.IsMethodUserFull(emBtnBeginPlay,"BeginPlay"))return-1;d=d.replace(/\|/g,"\u3010");"undefined"==typeof e&&(e="");return this._InvokeMethod(APSP_BeginPlay_CONF,GetApspParam(a,b,c,d,e))};this.StopPlay=function(a,b){return this.IsInitial()&&this.IsMethodUserFull(emBtnStopPlay,"StopPlay")?this._InvokeMethod(APSP_StopPlay_CONF,GetApspParam(a,b)):-1};this.BeginCollect=function(a,b,c,d,e,f,g,m,h,r){if(!this.IsInitial()||!this.IsMethodUserFull(emBtnEndCall,"BeginCollect"))return-1;strFileName=strFileName.replace(/\|/g,"\u3010");return this._InvokeMethod(APSP_BeginCollect_CONF,GetApspParam(a,b,c,d,e,f,g,m,h,r))};this.StopCollect=function(a,b){return this.IsInitial()&&this.IsMethodUserFull(emBtnEndCall,"StopCollect")?this._InvokeMethod(APSP_StopCollect_CONF,GetApspParam(a,b)):-1};this.BeginRecord=function(a,b){return this.IsInitial()&&this.IsMethodUserFull(emBtnRecord,"BeginRecord")?this._InvokeMethod(APSP_BeginRecord_CONF,GetApspParam(a,b)):-1};this.StopRecord=function(a){return this.IsInitial()&&this.IsMethodUserFull(emBtnStopRecord,"StopRecord")?this._InvokeMethod(APSP_StopRecord_CONF,GetApspParam(a)):-1};this.AlterNate=function(a){return 0};this.CallBack=function(){return this.IsInitial()&&this.IsMethodUserFull(emBtnCallBack,"CallBack")?this._InvokeMethod(APSP_CallBack_CONF,GetApspParam()):-1};this.ReCall=function(){return this.IsInitial()&&this.IsMethodUserFull(emBtnReCall,"ReCall")?this._InvokeMethod(APSP_ReCall_CONF,GetApspParam()):-1};this.SMMsg=function(a,b){return this._InvokeMethod(APSP_SMMsg_CONF,GetApspParam(a,b))};this.SendIMMessage2=function(a,b,c){"undefined"==typeof c&&(c="");c=this.GetBase64Data(c);return this._InvokeMethod(APSP_SendIMMessage2_CONF,GetApspParam(a,b,c))};this.WinCap=function(a,b,c){if(!this.IsInitial())return-1;if("undefined"==typeof a||isNaN(a))a=1;"undefined"==typeof b&&(a=200);"undefined"==typeof c&&(c=1);return this._InvokeMethod(APSP_WinCap_CONF,GetApspParam(a,this.oAgentInfo._mainIP,b,c))};this.PopDlg=function(a,b,c,d){if(!this.IsInitial())return-1;"undefined"==typeof d&&(d="");var e=-1;if("CallOutDlg"==a)e=emBtnMakeCall,d=this.oAgentInfo._autoSelectAgent;else if("TransferOutDlg"==a)e=emBtnTransferOut;else if("ConsultDlg"==a)e=emBtnConsult;else if("SendDtmfDlg"==a)e=emBtnSendDtmf;else if("MainSettingDlg"==a)e=emBtnConfig,d=this.GetBase64Data(d);else return-2;if(!this.IsMethodUserFull(e,"PopDlg")||"undefined"==typeof a||""==a)return-1;if("undefined"==typeof b||isNaN(b))b=0;if("undefined"==typeof c||isNaN(c))c=0;return this._InvokeMethod(APSP_PopDLG_CONF,GetApspParam(a,b,c,d))};this.ForeReleaseCall=function(a,b){return this.IsInitial()&&this.IsMethodUserFull(emBtnForceRelease,"ForeReleaseCall")?""==a?(this._gfOnPrompt(4312),-1):this._InvokeMethod(APSP_ForeReleaseCall_CONF,GetApspParam(a,b)):-1};this.Insert=function(a,b,c){return this.IsInitial()&&this.IsMethodUserFull(emBtnInsert,"Insert")?this._InvokeMethod(APSP_Insert_CONF,GetApspParam(a,b,c)):-1};this.Listen=function(a,b,c){return this.IsInitial()&&this.IsMethodUserFull(emBtnListen,"Listen")?this._InvokeMethod(APSP_Listen_CONF,GetApspParam(a,b,c)):-1};this.Intercept=function(a,b,c){return this.IsInitial()&&this.IsMethodUserFull(emBtnIntercept,"Intercept")?this._InvokeMethod(APSP_Intercept_CONF,GetApspParam(a,b,c)):-1};this.Help=function(a,b,c){return this.IsInitial()&&this.IsMethodUserFull(emBtnHelp,"Help")?this._InvokeMethod(APSP_Help_CONF,GetApspParam(a,b,c)):-1};this.Lock=function(a){return this.IsInitial()&&this.IsMethodUserFull(emBtnLock,"Lock")?this._InvokeMethod.Lock(a):-1};this.UnLock=function(a){return this.IsInitial()&&this.IsMethodUserFull(emBtnUnLock,"UnLock")?this._InvokeMethod.UnLock(a):-1};this.ForceIdle=function(a){return this._InvokeMethod(APSP_ForceIdle_CONF,a)};this.ForceBusy=function(a){return this._InvokeMethod(APSP_ForceBusy_CONF,a)};this.ForceOut=function(a){return this._InvokeMethod(APSP_ForceOut_CONF,a)};this.InitialState=function(){return this._InvokeMethod(APSP_InitialState_CONF,this.oAgentInfo._minotorVersion)};this.AgentQuery=function(a,b){return this._InvokeMethod(APSP_AgentQuery_CONF,GetApspParam(a,b))};this.TelQuery=function(a,b){return this._InvokeMethod(APSP_TelQuery_CONF,GetApspParam(a,b))};this.IvrQuery=function(a,b){return this._InvokeMethod(APSP_IvrQuery_CONF,GetApspParam(a,b))};this.TrunkQuery=function(a,b){return this._InvokeMethod(APSP_TrunkQuery_CONF,GetApspParam(a,b))};this.ServiceQuery=function(a,b){return this._InvokeMethod(APSP_ServiceQuery_CONF,GetApspParam(a,b,""))};this.TaskQuery=function(a,b){return this._InvokeMethod(APSP_TaskQuery_CONF,GetApspParam(a,b))};this.CallReportQuery=function(a,b){return this._InvokeMethod(APSP_CallReportQuery_CONF,GetApspParam(a,b))};this.GetTaskSummary=function(a,b){return this._InvokeMethod(APSP_GetTaskSummary_CONF,GetApspParam(a,b))};this.QueryMonitorSumInfo=function(a,b){return this._InvokeMethod(APSP_QueryMonitorSumInfo_CONF,GetApspParam(a,b))};this.StartNotification=function(a,b,c){return this._InvokeMethod(APSP_StartNotification_CONF,GetApspParam(a,b,c))};this.EndNotification=function(a){return this._InvokeMethod(APSP_EndNotification_CONF,a)};this.SendWeiboMsg=function(a){return this._InvokeMethod(APSP_SendWeiboMsg_CONF,GetApspParam(a))};this.UploadFileToMMS=function(a,b,c,d){return this._InvokeMethod(APSP_UploadFileToMMS_CONF,GetApspParam(a,b,c,d))};this.DownFileFromMMS=function(a,b,c,d,e){return this._InvokeMethod(APSP_DownFileFromMMS_CONF,GetApspParam(a,b,c,d,e))};this.SendWeChatMsg=function(a,b,c,d,e,f,g,m,h,r){f=GetBase64FromGBK(f);m=GetBase64FromGBK(m);h=GetBase64FromGBK(h);return this._InvokeMethod(APSP_SendWeChatMsg_CONF,GetApspParam(a,b,c,d,e,f,g,m,h,r))};this.QueryWeChatData=function(a,b,c,d,e,f,g){return this._InvokeMethod(APSP_QueryWeChatData_CONF,GetApspParam(a,b,c,d,e,f,g))};this.QueryWeChatHistory=function(a,b,c,d,e,f,g){return this._InvokeMethod(APSP_QueryWeChatHistory_CONF,GetApspParam(a,b,c,d,e,f,g))};this.GetWeChatParam=function(a){return this._InvokeMethod(APSP_GetWeChatParam_CONF,GetApspParam(1,a))};this.guardCallback=function(a,b){var c=this.oParent;a==GuardEvent_WebSocket?c._invokeEvent(eventOnWebsocketSocket,b):a==GuardEvent_GetLocalPort?(c.oAgentInfo._localPort=b,c.oAgentInfo._ctrlStatus=barStatus_AgentConnecting,c.connectToService(c.oAgentInfo._localserver,c.oAgentInfo._localPort)):a!=GuardEvent_UpdateSetup&&(a==GuardEvent_GetVersion?c.oAgentInfo._version=b:a==GuardEvent_GetVersionOK&&c._invokeEvent(eventOnGetVersionReport,b))};this.apspCallback=function(a,b,c){if(a==APSP_Type_Prompt)this.oParent.OnWebSocketEvent(b,c);else{DisplayLog(VccBar_Log_Info,"JHTML5Ctrl:apspCallback(cmdIndex("+this.oParent.oApspWS.GetCmdName(b)+")\x3d"+b+"  param\x3d"+c+")");if(a==APSP_Type_Event)return this.oParent.ReportEvent(b,c);if(a==APSP_Type_Action)return b==APSP_UnInitial_CONF&&(this.oParent.oAgentInfo._localPort=4520,this.oParent.oAgentInfo._isInitial="0"==c?!1:!0,DisplayLog(VccBar_Log_Info,"JHTML5Ctrl:UnInitial("+this.oParent.oAgentInfo._isInitial+")"),this.oParent.oAgentInfo._ctrlStatus=barStatus_AgentDisconnecting,0==this.oParent.oAgentInfo._isInitial&&(this.oParent.ReportEvent(eventOnBarExit,this.oParent.oAgentInfo._barExitCode+"|"),this.oParent.oAgentInfo._barExitCode="0"),this.oParent.ResetThisCtrl()),this.oParent.ReportResponse(b,c);this.oParent._invokeEvent(b,c)}};this.OnWebSocketEvent=function(a,b){if(a==APSP_WebSocket_Event){var c=parseInt(b);if(c==websocket_connected)this.oAgentInfo._ctrlStatus==barStatus_AgentConnecting&&(this.oAgentInfo._ctrlStatus=barStatus_AgentConnected,this.oAgentInfo._isConnected=!0,this._invokeEvent(eventOnWebsocketSocket,websocket_connected+"|"),this.Initial());else if(c==websocket_remoteserver_disconnected)this.oAgentInfo._ctrlStatus==barStatus_AgentConnecting&&(this._connectCount<PORT_COUNT?(this.oAgentInfo._localPort=this.oAgentInfo._localPort,this.connectToService(this.oAgentInfo._localserver,this.oAgentInfo._localPort)):(this.ResetThisCtrl(),this._invokeEvent(eventOnWebsocketSocket,websocket_remoteserver_disconnected+"|")));else if(c==websocket_closed)if(this.oAgentInfo._ctrlStatus==barStatus_AgentDisconnecting)this._invokeEvent(eventOnWebsocketSocket,websocket_closed+"|"),1==this.oAgentInfo._isInitial&&(this.ReportEvent(eventOnBarExit,this.oAgentInfo._barExitCode+"|"),this.oAgentInfo._barExitCode="0"),this.ResetThisCtrl();else if(this.oAgentInfo._ctrlStatus==barStatus_AgentConnected)if(this.oAgentInfo._isInitial){if(this.oAgentInfo._barStatus!=em_Bar_Initialing||1!=this.oAgentInfo._isReConnect)this.oAgentInfo._barStatus=em_Bar_Reconnecting,this._connectCount=0,this.oAgentInfo._isConnected=!1,this.oAgentInfo._ctrlStatus=barStatus_Null,this.oAgentInfo._isReConnect=1,this.oAgentInfo._agentOldStatus=this.GetAgentStatus(),DisplayLog(VccBar_Log_Info,"ReconnectMaccard"),this._oTimer.SetTimer(RECONNECT_AGENT_TIME_ID,5E3)}else this.ResetThisCtrl()}};this.ReportResponse=function(a,b){if(null!=this.responseCallBack)if(a==APSP_SetBusy_CONF&&("0"==b?this.oAgentInfo._agentBusySubStatus_old=this.oAgentInfo._agentBusySubStatus:this.oAgentInfo._agentBusySubStatus=this.oAgentInfo._agentBusySubStatus_old),a==APSP_GetConfiguration_CONF){var c=b.split("|");this.oAgentInfo._autoAnswer=parseInt(c[0]);this.oAgentInfo._idleStatus=parseInt(c[1]);this.oAgentInfo._callIn=parseInt(c[2]);this.oAgentInfo._warn=parseInt(c[3]);this.oAgentInfo._sipAlert=parseInt(c[4]);this.oAgentInfo._registInterVal=parseInt(c[5]);this.oAgentInfo._vedioWnd=parseInt(c[6]);this.oAgentInfo._bandWidth=parseInt(c[7]);this.oAgentInfo._frameRate=parseInt(c[8]);this.oAgentInfo._vedioFormat=parseInt(c[9]);this.oAgentInfo._capType=parseInt(c[10]);this.oAgentInfo._defaultIP=c[11]}else a==APSP_GetConfiguration_CONF&&this.oAgentInfo._barStatus==em_Bar_Initialing&&("0"!=b&&this.oAgentInfo._barStatus==em_Bar_Unitial,"-2"==b&&alert("\u7248\u672c\u5b89\u88c5\u4e0d\u6b63\u786e\uff0c\u8bf7\u91cd\u65b0\u66f4\u65b0\u7535\u8bdd\u6761\u7248\u672c!")),a==APSP_SetCTIInfo_CONF||a==APSP_QueryCTIInfo_CONF?this.responseCallBack(this.oAgentInfo._realMethodName,b):a!=APSP_PopDLG_CONF&&this.responseCallBack(this.oApspWS.GetCmdName(a),b)};this.ReportEvent=function(a,b){var c=b,d=b.split("|");switch(a){case APSP_ComingCall_EVENT:a=eventOnCallRing;var e=this._getPartenerNum(b),f="",g="",m="",h="";14<d.length&&(f=d[14]);15<d.length&&(g=d[15]);16<d.length&&(m=d[16]);17<d.length&&(h=d[17]);c=GetGBKFromBase64(d[3]);c=d[0]+"|"+d[1]+"|"+d[2]+"|"+c+"|"+d[4]+"|"+d[5]+"|"+d[6]+"|"+d[7]+"|"+d[8];c=c+"|"+e+"|"+this.oAgentInfo._dn+"|"+d[9]+"|"+d[11]+"|"+d[12]+"|"+d[13]+"|"+f+"|"+g;c=c+"|"+m+"|"+h;this._InvokeMethod(APSP_PopDLG_CONF,GetApspParam("PopRingDlg",0,0,GetBase64FromGBK(b)));break;case APSP_AnswerCall_EVENT:a=eventOnAnswerCall;break;case APSP_OnCallEnd_EVENT:a=eventOnCallEnd;this.oAgentInfo._retrieveCall=0;break;case APSP_OnPrompt_EVENT:a=eventOnPrompt;e=parseInt(d[0]);c="";f=!0;switch(e){case 4011:case 4005:this.SetLogoutStatus();break;case 4303:case 4008:case 4404:d="1"==d[1];if(this.oAgentInfo._barStatus==em_Bar_Initialing&&1==this.oAgentInfo._isReConnect)return;this.oAgentInfo._barStatus=em_Bar_Reconnecting;this.oAgentInfo._isReConnect=1;this.oAgentInfo._agentOldStatus=this.GetAgentStatus();d&&(DisplayLog(VccBar_Log_Info,"ReconnectMaccard"),this._oTimer.SetTimer(RECONNECT_AGENT_TIME_ID,5E3));f=!1;break;case 4009:f=!1;break;case 4316:c=d[1];break;case 4004:c=d[1]}if(4005==e||4006==e||4007==e)e=4011;c=e+"|"+c;f=f&&0==this.oAgentInfo._isReConnect||4011==e;if(!f)return;break;case APSP_OnReportBtnStatus_EVENT:a=eventOnReportBtnStatus;c=b.split("@");2==c.length&&(b=c[0],this.oAgentInfo._agentStatus=parseInt(c[1]),d=b.split("|"));this._ResetBtn();c="";for(e=0;e<d.length;e++)f=d[e],g=parseInt(f),100<=g?(this.oAgentInfo._agentStatus=g-100,f="0"):this._arrBtnStatus[g]=1,c=""==c?f:c+"|"+f;break;case APSP_OnInitalSuccess_EVENT:a=eventOnInitalSuccess;0<b.lastIndexOf("@")&&(d=b.split("@"),2==d.length?(this.oAgentInfo._phoneType=parseInt(d[1]),b=d[0]):3==d.length?(this.oAgentInfo._phoneType=parseInt(d[1]),b=d[0],this.oAgentInfo._strExitCause=d[2]):4==d.length?(this.oAgentInfo._phoneType=parseInt(d[1]),b=d[0],this.oAgentInfo._strExitCause=d[2],this.oAgentInfo._agentName=d[3]):5==d.length&&(this.oAgentInfo._phoneType=parseInt(d[1]),b=d[0],this.oAgentInfo._strExitCause=d[2],this.oAgentInfo._agentName=d[3],this.oAgentInfo._ampOffSetTime=parseInt(d[4])));this.oAgentInfo._strBusySubStatus=b;this.oAgentInfo._barStatus=em_Bar_Initialed;this.oAgentInfo._isReConnect=0;if(0==this.oAgentInfo._isInitial)this.oAgentInfo._isInitial=!0;else{this._oTimer.KillTimer(RECONNECT_AGENT_TIME_ID);DisplayLog(VccBar_Log_Info,"--- Kill Reconnect  Timer  ----");this.oAgentInfo._agentOldStatus==this.GetAgentStatus()&&this._oTimer.SetTimer(SETAGENTSTATUS_AGENT_TIME_ID,1E3);return}break;case APSP_OnInitalFailure_EVENT:a=eventOnInitalFailure;parseInt(d[0])==emCmdLogout&&(this.oAgentInfo._isInitial=!1);if(this.oAgentInfo._isReConnect){this.oAgentInfo._barStatus=em_Bar_Unitial;return}break;case APSP_OnEventPrompt_EVENT:a=eventOnEventPrompt;108==parseInt(d[0])&&this._invokeEvent(eventOnCallDataChanged,d[1]);break;case APSP_OnAgentWorkReport_EVENT:a=eventOnAgentWorkReport;14==parseInt(d[0])?1==this.oAgentInfo._retrieveCall&&(this.RetrieveHold(),this.oAgentInfo._retrieveCall=0):parseInt(d[0]);break;case APSP_OnBarExit_EVENT:this.oAgentInfo._isInitial=!1;1==this.oAgentInfo._isReConnect&&(this._oTimer.KillTimer(RECONNECT_AGENT_TIME_ID),this.oAgentInfo._isReConnect=0);a=eventOnBarExit;break;case APSP_OnCallQueueQuery_EVENT:a=eventOnCallQueueQuery;break;case APSP_OnQueueReport_EVENT:a=eventOnQueueReport;break;case APSP_OnSystemMessage_EVENT:d=b.split(",");if(2==d.length)switch(parseInt(d[0])){case 1:a=eventOnCallDataChanged;c=GetGBKFromBase64(d[1]);break;case 2:a=eventOnSystemMessage;c="2|"+d[1];break;case 5:a=eventOnAgentLogUploadReport;c=GetGBKFromBase64(d[1]);d=c.split("|");if(7!=d.length)return;c=d[1]+"|"+d[2]+"|"+d[3]+"|"+d[4]+"|"+d[5]+"|"+d[6];break;case 22:a=eventOnQueryGroupAgentStatus;c=d[1];break;case 23:a=eventOnSystemMessage;c="23|"+GetGBKFromBase64(d[1]);break;case 24:a=eventOnSystemMessage,c="24|"+GetGBKFromBase64(d[1])}break;case APSP_OnRecvWeiboMsg_EVENT:a=eventOnRecvWeiboMsg;break;case APSP_OnIMNoticsMsg_EVENT:a=eventOnIMMessage;c="0|"+c;break;case APSP_OnIMTextMsg_EVENT:a=eventOnIMMessage;c="1|"+c;break;case APSP_OnAction_EVENT:"RecordType"==d[0]&&(this.oAgentInfo._allTimeRecord=parseInt(d[1]));"LocalHttpPort"==d[0]&&(this.oAgentInfo._localHttpPort=parseInt(d[1]));return;case APSP_OnTaskReport_EVENT:a=eventOnTaskReport;break;case APSP_CallReportInfo_EVENT:a=eventOnCallReportInfo;break;case APSP_QueryMonitorSumReport_EVENT:a=eventOnQueryMonitorSumReport;break;case APSP_OutboundReport_EVENT:a=eventOnOutboundReport;break;case APSP_OnAgentReport_EVENT:a=eventOnAgentReport;break;case APSP_OnIvrReport_EVENT:a=eventOnIvrReport;break;case APSP_OnTelReport_EVENT:a=eventOnTelReport;break;case APSP_OnServiceReport_EVENT:a=eventOnServiceReport;break;case APSP_OnWallServiceReport_EVENT:a=eventOnWallServiceReport;break;case APSP_OnWallQueueReport_EVENT:a=eventOnWallQueueReport;break;case APSP_OnStaticInfoReport_EVENT:a=eventOnWorkStaticInfoReport;break;case APSP_OnServiceStaticReport_EVENT:a=eventOnServiceStaticReport;break;case APSP_OnAgentStaticReport_EVENT:a=eventOnAgentStaticReport;break;case APSP_OnTrunkReport_EVENT:a=eventOnTrunkReport;break;case APSP_OnTrunkSumReport_EVENT:a=eventOnTrunkSumReport;break;case APSP_OnRecvWeChatMsg_EVENT:c=d[0]+"|"+d[1]+"|"+d[2]+"|"+d[3]+"|"+d[4]+"|"+d[5]+"|"+GetGBKFromBase64(d[6])+"|"+d[7]+"|"+d[8];c=c+"|"+d[9]+"|"+d[10]+"|"+GetGBKFromBase64(d[11])+"|"+GetGBKFromBase64(d[12])+"|"+d[13];a=eventOnRecvWeChatMessage;break;case APSP_OnUploadFileToMMSReport_EVENT:a=eventOnUploadFileToMMSReport;break;case APSP_OnDownloadFileToMMSReport_EVENT:a=eventOnDownloadFileToMMSReport;break;case APSP_OnSendWeChatMsgReport_EVENT:a=eventOnSendWeChatMsgReport;break;case APSP_OnAQueryCTIInfo_EVENT:d=getSubString(b,"","|");if("8"==d||"9"==d||"10"==d)a=eventOnAQueryCTIInfoReport;else return;break;case APSP_OnAgentBusyReason_EVENT:a=eventOnAgentBusyReasonReport;this.oAgentInfo._agentBusySubStatus=parseInt(b);break;case APSP_OnAsrEventReport_EVENT:a=eventOnAsrEventReport,c=d[0]+"|"+d[1]+"|"+d[4]+"|"+d[5]}this._invokeEvent(a,c)};this._load()}function JAgentInfo(){this._agentID="";this._passWord="111111";this._agentType=0;this._backIP=this._mainIP=this._agentName="";this._backPortID=this._mainPortID=14800;this._version=this._vccId=this._dn="";this._passWdCryptType=0;this._isInitial=this._isConnected=!1;this._barStatus=em_Bar_Unitial;this._warn=this._callIn=this._autoSelectAgent=this._autoAnswer=this._idleStatus=this._isReConnect=0;this._sipAlert=1;this._registInterVal=3;this._ecDelaySize=0;this._fAudioGain=1;this._vedioWnd=this._setBusySupport0=this._popAlert=0;this._bandWidth=192;this._frameRate=30;this._vedioFormat=2;this._capType=0;this._defaultIP="";this._pingFlag=0;this._recordType;this._phoneType=1;this._allTimeRecord=0;this._ftpIp="";this._ftpPort=0;this._sipIp=this._sipDn=this._localDirectory=this._ftpDirectory=this._ftpPassWord=this._ftpUser="";this._sipServerPort=5060;this._sipProtocol="udp";this._sipPassWord="";this._sipDomain="bj.cincc.cn";this._sipAuthType=1;this._sipPassWdCryptType=0;this._sipBackIp="";this._sipBackServerPort=5060;this._sipBackProtocol="udp";this._sipBackPassWord="";this._sipBackDomain="bj.cincc.cn";this._sipBackAuthType=1;this._selfPrompt;this._monitorIp="";this._monitorPor=4502;this._monitorBackIp="";this._monitorBackPort=4502;this._msgFlag="";this._appType=0;this._minotorVersion="3.0";this._configDialogFlag=this._weChatServerIp=this._barPath=this._barStyle=this._autoUpdateUrl=this._taskID="";this._isSipRegisted=!1;this._minMediaPort=2E4;this._maxMediaPort=4E4;this._recvAgc=1;this._recvNs=0;this._sendEc=this._sendAgc=1;this._sipHeartBeatType=this._sendNs=0;this._updating=!1;this._btnIDS="0,1,2,3,4,5,6,7,8,9,10,11,12,13,15,16";this._btnMaskIDS="";this._localserver="127.0.0.1";this._localPort=4520;this._localGuardPort=4510;this._ctrlStatus=barStatus_Null;this._localHttpPort=-1;this._agentBusySubStatus_old=this._agentBusySubStatus=this._agentStatus=0;this._strExitCause=this._strBusySubStatus="";this._barExitCode="0";this._retrieveCall=0;this._realMethodName="";this._versionType=this._killMaccard=0;this._agentOldStatus=-2;this._ampOffSetTime=0;this._arrUserBtn=this._btnIDS.split(",");this.InitSerialBtn=function(a,b){this._btnIDS=a;this._btnMaskIDS=b;this._arrUserBtn=this._btnIDS.split(",")};this.getInitialParam=function(){""==this._sipBackPassWord&&(this._sipBackPassWord=this._sipPassWord);""==this._sipBackIp&&(this._sipBackIp=this._sipIp,this._sipBackProtocol=this._sipProtocol,this._sipBackDomain=this._sipDomain,this._sipBackServerPort=this._sipServerPort);""==this._monitorBackIp&&(this._monitorBackIp=this._backIP,this._monitorBackPort=this._monitorPor);var a=Array(38);a[0]=this._phoneType;a[1]=this._appType;a[2]=this._mainIP;a[3]=this._mainPortID;a[4]=this._backIP;a[5]=this._mainPortID;a[6]=this._agentID;a[7]=this._vccId;a[8]=this._passWord;a[9]=this._monitorIp;a[10]=this._monitorPor;a[11]=this._monitorBackIp;a[12]=this._monitorBackPort;a[13]=this._sipIp;a[14]=this._sipServerPort;a[15]=this._sipProtocol;a[16]=this._dn;a[17]=this._sipDomain;a[18]=this._sipPassWord;a[19]=this._sipAuthType;a[20]=this._sipBackIp;a[21]=this._sipBackServerPort;a[22]=this._sipBackProtocol;a[23]=this._sipBackDomain;a[24]=this._sipBackPassWord;a[25]=this._sipBackAuthType;a[26]=this._btnIDS;a[27]=0;a[28]=0;a[29]=this._taskID;a[30]=this._ftpIp;a[31]=this._ftpPort;a[32]=this._ftpUser;a[33]=this._ftpPassWord;a[34]=this._ftpDirectory;a[35]=this._sipDn;a[36]=this._weChatServerIp;a[37]=this._sipPassWdCryptType;a[38]=this._passWdCryptType;a[39]=this._versionType;a[40]=this._isReConnect;return a.join("|")};this.getIntCookieValue=function(a,b){var c=getCookie(a);return""==c?b:parseInt(c)};this.loadFromLocal=function(){this._autoAnswer=this.getIntCookieValue("AutoAnswer",0);this._idleStatus=this.getIntCookieValue("AutoIdle",0);this._callIn=this.getIntCookieValue("CallIn",0);this._warn=this.getIntCookieValue("Warn",0);this._sipAlert=this.getIntCookieValue("SipAlert",1);this._registInterVal=this.getIntCookieValue("RegistInterval",3);this._vedioWnd=this.getIntCookieValue("VedioWnd",0);this._bandWidth=this.getIntCookieValue("BandWidth",192);this._frameRate=this.getIntCookieValue("FrameRate",30);this._vedioFormat=this.getIntCookieValue("VedioFormat",2);this._capType=this.getIntCookieValue("CapType",0);this._defaultIP=getCookie("DefaultIP");this._minMediaPort=this.getIntCookieValue("MinMediaPort",2E4);this._maxMediaPort=this.getIntCookieValue("MaxMediaPort",4E4);this._ecDelaySize=this.getIntCookieValue("EchoCancelDelay",0);this._fAudioGain=this.getIntCookieValue("AudioGain",1);this._popAlert=this.getIntCookieValue("PopAlert",0);this._setBusySupport0=this.getIntCookieValue("SetBusySupport0",0);this._recvAgc=this.getIntCookieValue("RecvAgc",1);this._recvNs=this.getIntCookieValue("RecvNs",0);this._sendAgc=this.getIntCookieValue("SendAgc",1);this._sendEc=this.getIntCookieValue("SendEc",1);this._sendNs=this.getIntCookieValue("SendNs",0);this._sipHeartBeatType=this.getIntCookieValue("SipHeartBearType",0)};this.saveToLocal=function(){setCookie("AutoAnswer",this._autoAnswer,365);setCookie("AutoIdle",this._idleStatus,365);setCookie("CallIn",this._callIn,365);setCookie("Warn",this._warn,365);setCookie("SipAlert",this._sipAlert,365);setCookie("RegistInterval",this._registInterVal,365);setCookie("VedioWnd",this._vedioWnd,365);setCookie("BandWidth",this._bandWidth,365);setCookie("FrameRate",this._frameRate,365);setCookie("VedioFormat",this._vedioFormat,365);setCookie("CapType",this._capType,365);setCookie("DefaultIP",this._defaultIP,365);setCookie("MinMediaPort",this._minMediaPort,365);setCookie("MaxMediaPort",this._maxMediaPort,365);setCookie("EchoCancelDelay",this._ecDelaySize,365);setCookie("AudioGain",this._fAudioGain,365);setCookie("PopAlert",this._popAlert,365);setCookie("SetBusySupport0",this._setBusySupport0,365);setCookie("RecvAgc",this._recvAgc,365);setCookie("RecvNs",this._recvNs,365);setCookie("SendAgc",this._sendAgc,365);setCookie("SendEc",this._sendEc,365);setCookie("SipHeartBearType",this._sipHeartBeatType,365)};this.getConfigParam=function(){var a=Array(21);a[0]=this._autoAnswer;a[1]=this._idleStatus;a[2]=this._callIn;a[3]=this._warn;a[4]=this._sipAlert;a[5]=this._registInterVal;a[6]=this._vedioWnd;a[7]=this._bandWidth;a[8]=this._frameRate;a[9]=this._vedioFormat;a[10]=this._capType;a[11]=this._defaultIP;a[12]=this._minMediaPort;a[13]=this._maxMediaPort;a[14]=this._ecDelaySize;a[15]=this._fAudioGain;a[16]=this._recvAgc;a[17]=this._recvNs;a[18]=this._sendAgc;a[19]=this._sendEc;a[20]=this._sendNs;a[21]=this._sipHeartBeatType;a[22]=this._pingFlag;return a.join("|")};this.getConfiguration=function(){var a=Array(12);a[0]=this._autoAnswer;a[1]=this._idleStatus;a[2]=this._callIn;a[3]=this._warn;a[4]=this._sipAlert;a[5]=this._registInterVal;a[6]=this._vedioWnd;a[7]=this._bandWidth;a[8]=this._frameRate;a[9]=this._vedioFormat;a[10]=this._capType;a[11]=this._defaultIP;return a.join("|")}}var barStatus_GuardConnecting=1,barStatus_GuardConnected=2,barStatus_GuardDisconnecting=3,barStatus_GuardDisconnected=4,cmd_GuardType_Null=-1,cmd_GuardType_GetLocalPort=0,cmd_GuardType_UpdateSetup=1,cmd_GuardType_GetVersion=2,GuardEvent_WebSocket=0,GuardEvent_GetLocalPort=1,GuardEvent_UpdateSetup=2,GuardEvent_GetVersion=3,GuardEvent_GetVersionOK=4;function JGuardCtrl(a,b){this._oGuradWS=null;this._ctrlStatus=barStatus_Null;this._connectCount=0;this._cmdType=cmd_GuardType_Null;this._callBack=null;this._cmdParam2=this._cmdParam1="";this._localGuardIP=a;this._localGuardPort=b;this._IsGetVersion=!1;this._Create=function(){this._oGuradWS=new JAPSPWebSocket("CINGuard");this._oGuradWS.SetMsgCallBack(this.apspCallbackGurad);this._oGuradWS.oParent=this};this._ConnectToService=function(a,b){this._oGuradWS.WSConnect(a,b);this._ctrlStatus==barStatus_GuardConnecting&&this._cmdType!=cmd_GuardType_GetVersion&&this._OnFireEvent(GuardEvent_WebSocket,stringFormat("{0}|{1}|{2}|{3}",websocket_guard_connecting,a,b,this._connectCount));this._connectCount+=1};this._InvokeMethod=function(a,b){var e=this._oGuradWS.GetCmdName(a);if(""==e)return-1;DisplayLog(VccBar_Log_Info,"JGuardCtrl:_InvokeMethod(cmdName\x3d"+e+",param\x3d"+b+")");this._oGuradWS.WSSendMsg(buildApspMsg(e,b))};this._OnFireEvent=function(a,b){this._callBack&&this._callBack(a,b)};this.exeGuardCmd=function(a,b,e){this._cmdType=a;this._cmdParam1=b;this._cmdParam2=e;this._ctrlStatus==barStatus_Null&&(this._ctrlStatus=barStatus_GuardConnecting,this._ConnectToService(this._localGuardIP,this._localGuardPort));return 0};this.SetCallBack=function(a){this._callBack=a};this._OnGuardWebSocketEvent=function(a,b){if(a==APSP_WebSocket_Event){var e=parseInt(b);e==websocket_connected?(this._ctrlStatus=barStatus_GuardConnected,this._cmdType!=cmd_GuardType_GetVersion&&this._OnFireEvent(GuardEvent_WebSocket,websocket_guard_connected+"|"),this._cmdType==cmd_GuardType_GetLocalPort?this._InvokeMethod(APSP_GetLocalPort_CONF,this._cmdParam1):this._cmdType==cmd_GuardType_UpdateSetup?this._InvokeMethod(APSP_UpdateSetup_CONF,GetApspParam(this._cmdParam1,this._cmdParam2)):this._cmdType==cmd_GuardType_GetVersion&&this._InvokeMethod(APSP_GetVersion_CONF,"")):e==websocket_remoteserver_disconnected?this._ctrlStatus==barStatus_GuardConnecting&&(this._connectCount<PORT_COUNT?(this._localGuardPort+=10,this._ConnectToService(this._localGuardIP,this._localGuardPort)):(this._OnFireEvent(GuardEvent_WebSocket,websocket_guard_remoteserver_disconnected+"|"),getLocalLanguage()==lg_zhcn?alert("\u7535\u8bdd\u6761\u536b\u58eb\u6ca1\u6709\u542f\u52a8"):alert("CINGuard.exe not work"))):e==websocket_closed&&(this._ctrlStatus!=barStatus_GuardConnecting&&(this._ctrlStatus=barStatus_Null),this._IsGetVersion&&(this._OnFireEvent(GuardEvent_GetVersionOK,""),this._IsGetVersion=!1))}};this._OnGuardWebSocketActionEvent=function(a,b){if(a==APSP_GetLocalPort_CONF){if(this._ctrlStatus==barStatus_GuardConnected){this._oGuradWS.WSDisconnect();var e=parseInt(b);-1==e?getLocalLanguage()==lg_zhcn?alert("MacCard.exe\u4e0d\u5b58\u5728"):alert("MacCard.exe not exist"):-2==e?getLocalLanguage()==lg_zhcn?alert("\u7535\u8bdd\u6761\u5b89\u88c5\u5305\u5b89\u88c5\u4e0d\u6b63\u786e"):alert("CINVccBar package setup failure"):this._OnFireEvent(GuardEvent_GetLocalPort,e)}}else a==APSP_UpdateSetup_CONF?("-1"==b?getLocalLanguage()==lg_zhcn?alert("\u81ea\u52a8\u66f4\u65b0\u7a0b\u5e8f\u4e0d\u5b58\u5728!"):alert("Ccupdate not exist!"):"-2"==b?getLocalLanguage()==lg_zhcn?alert("\u7535\u8bdd\u6761\u5b89\u88c5\u5305\u5b89\u88c5\u4e0d\u6b63\u786e!"):alert("CINVccBar package setup failure!"):"-3"==b?getLocalLanguage()==lg_zhcn?alert("\u66f4\u65b0\u53c2\u6570\u4e0d\u6b63\u786e!"):alert("Bad ccupdate parameter!"):"1"==b?1==(getLocalLanguage()==lg_zhcn?confirm("\u68c0\u6d4b\u5230\u670d\u52a1\u5668\u4e0a\u6709\u65b0\u7684\u7248\u672c,\u786e\u8ba4\u4f60\u662f\u5426\u8981\u66f4\u65b0?"):confirm("There are a new version,would you like to update?"))&&(this._cmdParam2="update",this._InvokeMethod(APSP_UpdateSetup_CONF,GetApspParam(this._cmdParam1,this._cmdParam2))):"0"==b&&(getLocalLanguage()==lg_zhcn?alert("\u6ca1\u6709\u65b0\u7684\u7248\u672c\u9700\u8981\u66f4\u65b0!"):alert("There are no new version!")),this._oGuradWS.WSDisconnect()):a==APSP_GetVersion_CONF&&(this._OnFireEvent(GuardEvent_GetVersion,b),this._IsGetVersion=!0,this._oGuradWS.WSDisconnect());this._ctrlStatus==barStatus_GuardDisconnecting;this._cmdType=cmd_GuardType_Null;this._cmdParam2=this._cmdParam1="";this._connectCount=0};this.apspCallbackGurad=function(a,b,e){a==APSP_Type_Prompt?this.oParent._OnGuardWebSocketEvent(b,e):a==APSP_Type_Action&&this.oParent._OnGuardWebSocketActionEvent(b,e)};this._Create();return this}var g_oAsynTimer=null;function AsynOnMethodResponseEvent(a,b){application.oJVccBar.GetBarCtrl()._invokeAsynMethodReturn(a,b);null!=g_oAsynTimer&&(clearTimeout(g_oAsynTimer),g_oAsynTimer=null)}function AsynOnMethodResponseEvent2(){if(null!=application.oJVccBar&&null!=application.oJVccBar.GetBarCtrl()){var a=application.oJVccBar.GetBarCtrl().oAsynMothmod.getHeadItem();null!=a&&application.oJVccBar.GetBarCtrl()._invokeAsynMethodReturn(a.cmdName,a.param)}}function BeginAsynFunctionTimer(a){null==application.oJVccBar.GetBarCtrl()._asynMethodTimerID&&(application.oJVccBar.GetBarCtrl()._asynMethodTimerID=setInterval(function(){application.oJVccBar.GetBarCtrl().PopAsynResponseEvent()},a))}function EndAsynFunctionTimer(){null!=application.oJVccBar.GetBarCtrl()._asynMethodTimerID&&(clearInterval(application.oJVccBar.GetBarCtrl()._asynMethodTimerID),application.oJVccBar.GetBarCtrl()._asynMethodTimerID=null)}function JAsynFunctionItem(a,b){this.cmdName=a;this.param=b;return this}function JAsynFunctionManeger(){this.arrFunction=[];this._timerBgn=!1;this._timerID=null;this.getHeadItem=function(){return 0<this.arrFunction.length?this.arrFunction[0]:null};this.addNewItem=function(a,b){this.arrFunction.push(new JAsynFunctionItem(a,b))};this.removeHeadItem=function(){0<this.arrFunction.length&&this.arrFunction.splice(0,1)}}function JOcxCtrl(a,b,c,d,e,f){this.left=a;this.top=b;this.width=c;this.height=d;this.showFlag=e;this._contentWindow=null==f?window:f;this.id="oBar_"+Math.ceil(100*Math.random());this.name=this.id+"_Ctrl";this.isUnderMsie11="msie"==application.oBrowserSys.os&&11>application.oBrowserSys.version;this.oATL_BarShow=this.oBarShow=null;this._agentSubBusyStatus=-1;this.oEvent={};this.errDescription="";this.methodCallBack=this.eventCallBack=null;this.asynExecuteMethod=1;this._asynMethodTimerID=null;this.oAsynMothmod=new JAsynFunctionManeger;this._createObject=function(){this.oBarShow=this._contentWindow.document.createElement("DIV");this.oBarShow.style.cursor="move";this.oBarShow.style.position="absolute";this.oBarShow.style.padding="5px";this.oBarShow.style.border="1px";this.oBarShow.style.left=this.left+"px";this.oBarShow.style.top=this.top+"px";this._contentWindow.document.body.appendChild(this.oBarShow);try{1==this.isUnderMsie11?(this.oBarShow.innerHTML='\x3cOBJECT height\x3d"'+this.height+'" width\x3d"'+this.width+'" classid\x3d"clsid:3E006E71-9408-4F24-9F6D-69C81BD5682F" \x3e\x3c/OBJECT\x3e',this.oATL_BarShow=this.oBarShow.firstChild,this.oATL_BarShow.id="oATL_BarShow_Ctrl_"+this.id,this._attachOCXEvents()):(this.oBarShow.innerHTML='\x3cOBJECT height\x3d"'+this.height+'" width\x3d"'+this.width+'" classid\x3d"clsid:3E006E71-9408-4F24-9F6D-69C81BD5682F" \x3e\x3c/OBJECT\x3e',this.oATL_BarShow=this.oBarShow.firstChild,this.oATL_BarShow.id="oATL_BarShow_Ctrl_"+this.id,this._attachFOCXEvents()),this.Display(this.showFlag)}catch(a){alert("\u521b\u5efaOCX\u7535\u8bdd\u6761\u51fa\u9519:\u3010"+a.message+"\u3011")}};this._forEvent=function(a,b){var h=document.createElement("script");h.language="javascript";h.setAttribute("for",this.oATL_BarShow.id);h.event=a;h.text=b;document.body.appendChild(h)};this._attachFOCXEvents=function(){this._forEvent("OnCallRing(CallingNo,CalledNo,OrgCalledNo,CallData,SerialID,ServiceDirect,CallID,UserParam,TaskID,UserDn,AgentDn,AreaCode,filename,networkInfo,queueTime,opAgentID,ringTime,projectID,serverName)","altEventOnCallRing(CallingNo,CalledNo,OrgCalledNo,CallData,SerialID,ServiceDirect,CallID,UserParam,TaskID,UserDn,AgentDn,AreaCode,filename,networkInfo,queueTime,opAgentID,ringTime,projectID,serverName);");this._forEvent("AnswerCall(UserNo,AnswerTime,SerialID,ServiceDirect,CallID,UserParam,TaskID)","altEventOnAnswerCall(UserNo,AnswerTime,SerialID,ServiceDirect,CallID,UserParam,TaskID);");this._forEvent("OnCallEnd(CallID,SerialID,ServiceDirect,UserNo,BgnTime,EndTime,AgentAlertTime,UserAlertTime,FileName,Directory,DisconnectType,UserParam,TaskID,serverName,networkInfo)","altEventOnCallEnd(CallID,SerialID,ServiceDirect,UserNo,BgnTime,EndTime,AgentAlertTime,UserAlertTime,FileName,Directory,DisconnectType,UserParam,TaskID,serverName,networkInfo);");this._forEvent("OnPrompt(code,description)","altEventOnPrompt(code,description);");this._forEvent("ReportBtnStatus(btnIDS)","altEventOnReportBtnStatus(btnIDS);");this._forEvent("OnInitalSuccess()","altEventOnInitalSuccess();");this._forEvent("OnInitalFailure(code,description)","altEventOnInitalFailure(code,description);");this._forEvent("OnEventPrompt(eventIndex,eventParam)","altEventOnEventPrompt(eventIndex,eventParam);");this._forEvent("OnAgentWorkReport(workStatus,description)","altEventOnAgentWorkReport(workStatus,description);");this._forEvent("OnCallDataChanged(callData)","altEventOnCallDataChanged(callData);");this._forEvent("OnBarExit(code,description)","altEventOnBarExit(code,description);");this._forEvent("OnCallQueueQuery(QueueInfo)","altEventOnCallQueueQuery(QueueInfo);");this._forEvent("OnQueryGroupAgentStatus(QueryInfo,type)","altEventOnQueryGroupAgentStatus(QueryInfo,type);");this._forEvent("OnSystemMessage(code,description)","altEventOnSystemMessage(code,description);");this._forEvent("OnRecvWeiboMsg(message)","altEventOnRecvWeiboMsg(message);");this._forEvent("OnIMMessage(msgType,message)","altEventOnIMMessage(msgType,message);");this._forEvent("OnRecvWeChatMessage(sessionId,msgseq,type,userId,vccPublicId,msgType,content,sessionUrl,recongnition,msgevent,eventKey,title,data,timeStamp)","altEventOnRecvWeChatMessage(sessionId,msgseq,type,userId,vccPublicId,msgType,content,sessionUrl,recongnition,msgevent,eventKey,title,data,timeStamp);");this._forEvent("OnSendWeChatMsgReport(sessionId,msgseq,code,des,timeStamp)","altEventOnSendWeChatMsgReport(sessionId,msgseq,code,des,timeStamp);");this._forEvent("OnUploadFileToMMSReport(strFileName,status,strUrl,sessionId,userId,vccPublicId)","altEventOnUploadFileToMMSReport(strFileName,status,strUrl,sessionId,userId,vccPublicId);");this._forEvent("OnDownloadFileToMMSReport(strUrl,status,strFileName,msgSeq)","altEventOnDownloadFileToMMSReport(strUrl,status,strFileName,msgSeq);");this._forEvent("OnServiceStaticReport(staticInfo)","altEventOnServiceStaticReport(staticInfo);");this._forEvent("OnQuerySPGroupList(type,ctiInfo)","altEventOnQuerySPGroupList(type,ctiInfo);");this._forEvent("OnAgentBusyReason(type,des)","altEventOnAgentBusyReason(type,des);");this._forEvent("OnAgentLogUpload(destAgent,urlType,uploadServer,fileName,code,des)","altEventOnAgentLogUpload(destAgent,urlType,uploadServer,fileName,code,des);");this._forEvent("OnAsrEventReport(seq,timeStamp,lineNum,text)","altEventOnAsrEventReport(seq,timeStamp,lineNum,text);");this._forEvent("OnAgentReport(AgentReportInfo)","altEventOnAgentReport(AgentReportInfo);");this._forEvent("OnTelReport(TelReportInfo)","altEventOnTelReport(TelReportInfo);");this._forEvent("OnServiceReport(ServiceReportInfo)","altEventOnServiceReport(ServiceReportInfo);");this._forEvent("OnIvrReport(IvrReportInfo)","altEventOnIvrReport(IvrReportInfo);");this._forEvent("OnTaskReport(TaskReportInfo)","altEventOnTaskReport(TaskReportInfo);");this._forEvent("OnOutboundReport(TaskInfo)","altEventOnOutboundReport(TaskInfo);");this._forEvent("OnCallReportInfo(CallInfo)","altEventOnCallReportInfo(CallInfo);");this._forEvent("OnQueueReport(ServiceReportInfo)","altEventOnQueueReport(ServiceReportInfo);");this._forEvent("OnQueryMonitorSumReport(cmdName,reportInfo)","altEventOnQueryMonitorSumReport(cmdName,reportInfo);");this._forEvent("OnWallServiceReport(serviceReportInfo)","altEventOnWallServiceReport(serviceReportInfo);");this._forEvent("OnWallQueueReport(queueInfo)","altEventOnWallQueueReport(queueInfo);");this._forEvent("OnWorkStaticInfoReport(staticInfo)","altEventOnWorkStaticInfoReport(staticInfo);");this._forEvent("OnAgentStaticReport(staticInfo)","altEventOnAgentStaticReport(staticInfo);");this._forEvent("OnTrunkReport(trunkInfo)","altEventOnTrunkReport(trunkInfo);");this._forEvent("OnTrunkSumReport(trunkInfo)","altEventOnTrunkSumReport(trunkInfo);")};this._attachOCXEvents=function(){this.oATL_BarShow.attachEvent("OnCallRing",altEventOnCallRing);this.oATL_BarShow.attachEvent("AnswerCall",altEventOnAnswerCall);this.oATL_BarShow.attachEvent("OnCallEnd",altEventOnCallEnd);this.oATL_BarShow.attachEvent("OnPrompt",altEventOnPrompt);this.oATL_BarShow.attachEvent("ReportBtnStatus",altEventOnReportBtnStatus);this.oATL_BarShow.attachEvent("OnInitalSuccess",altEventOnInitalSuccess);this.oATL_BarShow.attachEvent("OnInitalFailure",altEventOnInitalFailure);this.oATL_BarShow.attachEvent("OnEventPrompt",altEventOnEventPrompt);this.oATL_BarShow.attachEvent("OnAgentWorkReport",altEventOnAgentWorkReport);this.oATL_BarShow.attachEvent("OnCallDataChanged",altEventOnCallDataChanged);this.oATL_BarShow.attachEvent("OnBarExit",altEventOnBarExit);this.oATL_BarShow.attachEvent("OnCallQueueQuery",altEventOnCallQueueQuery);this.oATL_BarShow.attachEvent("OnQueryGroupAgentStatus",altEventOnQueryGroupAgentStatus);this.oATL_BarShow.attachEvent("OnSystemMessage",altEventOnSystemMessage);this.oATL_BarShow.attachEvent("OnRecvWeiboMsg",altEventOnRecvWeiboMsg);this.oATL_BarShow.attachEvent("OnIMMessage",altEventOnIMMessage);this.oATL_BarShow.attachEvent("OnRecvWeChatMessage",altEventOnRecvWeChatMessage);this.oATL_BarShow.attachEvent("OnSendWeChatMsgReport",altEventOnSendWeChatMsgReport);this.oATL_BarShow.attachEvent("OnUploadFileToMMSReport",altEventOnUploadFileToMMSReport);this.oATL_BarShow.attachEvent("OnDownloadFileToMMSReport",altEventOnDownloadFileToMMSReport);this.oATL_BarShow.attachEvent("OnServiceStaticReport",altEventOnServiceStaticReport);this.oATL_BarShow.attachEvent("OnQuerySPGroupList",altEventOnQuerySPGroupList);this.oATL_BarShow.attachEvent("OnAgentBusyReason",altEventOnAgentBusyReason);this.oATL_BarShow.attachEvent("OnAgentLogUpload",altEventOnAgentLogUpload);this.oATL_BarShow.attachEvent("OnAsrEventReport",altEventOnAsrEventReport);this.oATL_BarShow.attachEvent("OnAgentReport",altEventOnAgentReport);this.oATL_BarShow.attachEvent("OnTelReport",altEventOnTelReport);this.oATL_BarShow.attachEvent("OnServiceReport",altEventOnServiceReport);this.oATL_BarShow.attachEvent("OnIvrReport",altEventOnIvrReport);this.oATL_BarShow.attachEvent("OnTaskReport",altEventOnTaskReport);this.oATL_BarShow.attachEvent("OnOutboundReport",altEventOnOutboundReport);this.oATL_BarShow.attachEvent("OnCallReportInfo",altEventOnCallReportInfo);this.oATL_BarShow.attachEvent("OnQueueReport",altEventOnQueueReport);this.oATL_BarShow.attachEvent("OnQueryMonitorSumReport",altEventOnQueryMonitorSumReport);this.oATL_BarShow.attachEvent("OnWallServiceReport",altEventOnWallServiceReport);this.oATL_BarShow.attachEvent("OnWallQueueReport",altEventOnWallQueueReport);this.oATL_BarShow.attachEvent("OnWorkStaticInfoReport",altEventOnWorkStaticInfoReport);this.oATL_BarShow.attachEvent("OnAgentStaticReport",altEventOnAgentStaticReport);this.oATL_BarShow.attachEvent("OnTrunkReport",altEventOnTrunkReport);this.oATL_BarShow.attachEvent("OnTrunkSumReport",altEventOnTrunkSumReport)};this._invokeEvent=function(a,b){null!=this.eventCallBack&&this.eventCallBack(a,b)};this._OnCallRing=function(a,b,h,c,d,e,f,p,n,q,t,u,v,x,y,z,A,B,C){this._invokeEvent(eventOnCallRing,GetApspParam(a,b,h,c,d,e,f,p,n,q,t,u,v,x,y,z,A,B,C))};this._OnAnswerCall=function(a,b,h,c,d,e,f){this._invokeEvent(eventOnAnswerCall,GetApspParam(a,b,h,c,d,e,f))};this._OnCallEnd=function(a,b,h,c,d,e,f,p,n,q,t,u,v,x,y){this._invokeEvent(eventOnCallEnd,GetApspParam(a,b,h,c,d,e,f,p,n,q,t,u,v,x,y))};this._OnPrompt=function(a,b){this._invokeEvent(eventOnPrompt,GetApspParam(a,b))};this._OnReportBtnStatus=function(a){this._invokeEvent(eventOnReportBtnStatus,a)};this._OnInitalSuccess=function(){this._invokeEvent(eventOnInitalSuccess,GetApspParam())};this._OnInitalFailure=function(a,b){this._invokeEvent(eventOnInitalFailure,GetApspParam(a,b))};this._OnEventPrompt=function(a,b){this._invokeEvent(eventOnEventPrompt,GetApspParam(a,b))};this._OnAgentWorkReport=function(a,b){this._invokeEvent(eventOnAgentWorkReport,GetApspParam(a,b))};this._OnCallDataChanged=function(a){this._invokeEvent(eventOnCallDataChanged,a)};this._OnBarExit=function(a,b){this._invokeEvent(eventOnBarExit,GetApspParam(a,b))};this._OnCallQueueQuery=function(a){this._invokeEvent(eventOnCallQueueQuery,a)};this._OnQuerySPGroupList=function(a,b){this._invokeEvent(eventOnAQueryCTIInfoReport,GetApspParam(a,b))};this._OnAgentBusyReason=function(a,b){this._invokeEvent(eventOnAgentBusyReasonReport,GetApspParam(a,b))};this._OnAgentLogUpload=function(a,b,h,c,d,e){this._invokeEvent(eventOnAgentLogUploadReport,GetApspParam(a,b,h,c,d,e))};this._OnQueryGroupAgentStatus=function(a,b){"undefined"==typeof b&&(b=0);this._invokeEvent(eventOnQueryGroupAgentStatus,a+"@"+b)};this._OnSystemMessage=function(a,b){this._invokeEvent(eventOnSystemMessage,GetApspParam(a,b))};this._OnRecvWeiboMsg=function(a){this._invokeEvent(eventOnRecvWeiboMsg,a)};this._OnIMMessage=function(a,b){this._invokeEvent(eventOnIMMessage,GetApspParam(a,b))};this._OnRecvWeChatMessage=function(a,b,h,c,d,e,f,p,n,q,t,u,v,x){this._invokeEvent(eventOnRecvWeChatMessage,GetApspParam(a,b,h,c,d,e,f,p,n,q,t,u,v,x))};this._OnSendWeChatMsgReport=function(a,b,h,c,d){this._invokeEvent(eventOnSendWeChatMsgReport,GetApspParam(a,b,h,c,d))};this._OnUploadFileToMMSReport=function(a,b,h,c,d,e){this._invokeEvent(eventOnUploadFileToMMSReport,GetApspParam(a,b,h,c,d,e))};this._OnDownloadFileToMMSReport=function(a,b,h,c){this._invokeEvent(eventOnDownloadFileToMMSReport,GetApspParam(a,b,h,c))};this._OnWorkStaticInfoReport=function(a){this._invokeEvent(eventOnWorkStaticInfoReport,a)};this._OnQueueReport=function(a){this._invokeEvent(eventOnQueueReport,a)};this._OnAsrEventReport=function(a,b,h,c){this._invokeEvent(eventOnAsrEventReport,GetApspParam(a,b,h,c))};this._OnAgentReport=function(a){this._invokeEvent(eventOnAgentReport,a)};this._OnTelReport=function(a){this._invokeEvent(eventOnTelReport,a)};this._OnServiceReport=function(a){this._invokeEvent(eventOnServiceReport,a)};this._OnIvrReport=function(a){this._invokeEvent(eventOnIvrReport,a)};this._OnTaskReport=function(a){this._invokeEvent(eventOnTaskReport,a)};this._OnOutboundReport=function(a){this._invokeEvent(eventOnOutboundReport,a)};this._OnCallReportInfo=function(a){this._invokeEvent(eventOnCallReportInfo,a)};this._OnQueryMonitorSumReport=function(a,b){this._invokeEvent(eventOnQueryMonitorSumReport,GetApspParam(a,b))};this._OnWallServiceReport=function(a){this._invokeEvent(eventOnWallServiceReport,a)};this._OnWallQueueReport=function(a){this._invokeEvent(eventOnWallQueueReport,a)};this._OnServiceStaticReport=function(a){this._invokeEvent(eventOnServiceStaticReport,a)};this._OnAgentStaticReport=function(a){this._invokeEvent(eventOnAgentStaticReport,a)};this._OnTrunkReport=function(a){this._invokeEvent(eventOnTrunkReport,a)};this._OnTrunkSumReport=function(a){this._invokeEvent(eventOnTrunkSumReport,a)};this.PopAsynResponseEvent=function(){var a=this.oAsynMothmod.getHeadItem();null!=a&&(this._invokeAsynMethodReturn(a.cmdName,a.param),DisplayLog(VccBar_Log_Debug,"JOCXBar:PopAsynResponseEvent(cmdName:\u3010"+a.cmdName+"\u3011 param: \u3010"+a.param+"\u3011)"),this.oAsynMothmod.removeHeadItem())};this._invokeAsynMethodReturn=function(a,b){null!=this.methodCallBack&&this.methodCallBack(a,b)};this.AsynInvokeMechod=function(a,b){return 1==this.asynExecuteMethod?(BeginAsynFunctionTimer(500),DisplayLog(VccBar_Log_Debug,"JOCXBar:AsynInvokeMechod(cmdName:\u3010"+a+"\u3011 param: \u3010"+b+"\u3011)"),this.oAsynMothmod.addNewItem(a,b),0):b};this.GetBarType=function(){return vccBarTypeOCX};this.Initial=function(){return this.AsynInvokeMechod("Initial",this.oATL_BarShow.Initial())};this.SerialBtn=function(a,b){return this.AsynInvokeMechod("SerialBtn",this.oATL_BarShow.SerialBtn(a,b))};this.GetBtnStatus=function(a){return this.AsynInvokeMechod("GetBtnStatus",this.oATL_BarShow.GetBtnStatus(a))};this.Configurate=function(a){return this.AsynInvokeMechod("Configurate",this.oATL_BarShow.Configurate(a))};this.GetConfiguration=function(){return this.AsynInvokeMechod("GetConfiguration",this.oATL_BarShow.GetConfiguration())};this.UnInitial=function(a){return this.AsynInvokeMechod("UnInitial",this.oATL_BarShow.UnInitial(a))};this.SetUIStyle=function(a){return this.AsynInvokeMechod("SetUIStyle",this.oATL_BarShow.SetUIStyle(a))};this.GetVersion=function(){return this.oATL_BarShow.GetVersion()};this.SetBusy=function(a){var b=this.oATL_BarShow.SetBusy(a);0==b&&(this._agentSubBusyStatus=a);return b=this.AsynInvokeMechod("SetBusy",b)};this.SetIdle=function(){return this.AsynInvokeMechod("SetIdle",this.oATL_BarShow.SetIdle())};this.SetWrapUp=function(){return this.AsynInvokeMechod("SetWrapUp",this.oATL_BarShow.SetWrapUp())};this.SetCTICalloutTask=function(a){return this.AsynInvokeMechod("SetCTICalloutTask",this.oATL_BarShow.SetCTICalloutTask(a))};this.GetCTICalloutTask=function(){return this.AsynInvokeMechod("GetCTICalloutTask",this.oATL_BarShow.GetCTICalloutTask())};this.GetCallData=function(a){return this.AsynInvokeMechod("GetCallData",this.oATL_BarShow.GetCallData(a))};this.SetCallData=function(a,b){return this.AsynInvokeMechod("SetCallData",this.oATL_BarShow.SetCallData(a,b))};this.GetTransfer=function(){return this.AsynInvokeMechod("GetTransfer",this.oATL_BarShow.GetTransfer())};this.SetTransfer=function(a,b,h){return this.AsynInvokeMechod("SetTransfer",this.oATL_BarShow.SetTransfer(a,b,h))};this.ChangeCallQueue=function(a,b,h){return this.AsynInvokeMechod("ChangeCallQueue",this.oATL_BarShow.ChangeCallQueue(a,b,h))};this.GetCallID=function(){return this.AsynInvokeMechod("GetCallID",this.oATL_BarShow.GetCallID())};this.QuerySPGroupList=function(a,b,h,c,d,e){return this.AsynInvokeMechod("QuerySPGroupList",this.oATL_BarShow.QuerySPGroupList(a,b,h,c,d,e))};this.GetCallInfo=function(){return this.AsynInvokeMechod("GetCallInfo",this.oATL_BarShow.GetCallInfo())};this.SetTransparentParameter=function(a){return this.AsynInvokeMechod("SetTransparentParameter",this.oATL_BarShow.SetTransparentParameter(a))};this.GetAgentStatus=function(){return this.oATL_BarShow.GetAgentStatus()};this.GetAgentSubBusyStatus=function(){return 1==this.oATL_BarShow.GetAgentStatus()?this._agentSubBusyStatus:-1};this.GetBusySubStatus=function(){return this.oATL_BarShow.GetBusySubStatus()};this.SetDisplayNumber=function(a){return this.AsynInvokeMechod("SetDisplayNumber",this.oATL_BarShow.SetDisplayNumber(a))};this.GetDisplayNumber=function(){return this.AsynInvokeMechod("GetDisplayNumber",this.oATL_BarShow.GetDisplayNumber())};this.CallQueueQuery=function(a,b,h){return this.AsynInvokeMechod("CallQueueQuery",this.oATL_BarShow.CallQueueQuery(a,b,h))};this.QueryGroupAgentStatus=function(a,b,h,c){return this.AsynInvokeMechod("QueryGroupAgentStatus",this.oATL_BarShow.QueryGroupAgentStatus(a,b,h,c))};this.QueryPreViewCallOutNumbers=function(a,b,h,c){return this.AsynInvokeMechod("QueryPreViewCallOutNumbers",this.oATL_BarShow.QueryPreViewCallOutNumbers(a,b,h,c))};this.QueryMonitorSumInfo=function(a,b){return this.AsynInvokeMechod("QueryMonitorSumInfo",this.oATL_BarShow.QueryMonitorSumInfo(a,b))};this.GetBase64Data=function(a){return this.oATL_BarShow.GetBase64Data(a)};this.GetDataFromBase64=function(a){return this.oATL_BarShow.GetDataFromBase64(a)};this.SetWeChatQueueFlag=function(a){return this.AsynInvokeMechod("SetWeChatQueueFlag",this.oATL_BarShow.SetWeChatQueueFlag(a))};this.GetWeChatQueueFlag=function(){return this.AsynInvokeMechod("GetWeChatQueueFlag",this.oATL_BarShow.GetWeChatQueueFlag())};this.TransferCallQueue=function(a,b,h){return this.AsynInvokeMechod("TransferCallQueue",this.oATL_BarShow.TransferCallQueue(a,b,h))};this.SetActiveService=function(a){return this.AsynInvokeMechod("SetActiveService",this.oATL_BarShow.SetActiveService(a))};this.GetActiveService=function(){return this.AsynInvokeMechod("GetActiveService",this.oATL_BarShow.GetActiveService())};this.GetExitCause=function(){return this.oATL_BarShow.GetExitCause()};this.SetForwardNumber=function(a,b){return this.AsynInvokeMechod("SetForwardNumber",this.oATL_BarShow.SetForwardNumber(a,b))};this.GetForwardNumber=function(){return this.AsynInvokeMechod("GetForwardNumber",this.oATL_BarShow.GetForwardNumber())};this.SetAgentReservedStatus=function(a,b){return this.AsynInvokeMechod("SetAgentReservedStatus",this.oATL_BarShow.SetAgentReservedStatus(a,b))};this.GetAgentLogFile=function(a,b,h){return this.AsynInvokeMechod("GetAgentLogFile",this.oATL_BarShow.GetAgentLogFile(a,b,h))};this.GetMonitorOffSetTime=function(){return this.oATL_BarShow.GetMonitorOffSetTime()};this.SetMMService=function(a,b){return this.AsynInvokeMechod("SetMMService",this.oATL_BarShow.SetMMService(a,b))};this.MakeCall=function(a,b,h,c,d,e,f,p){return this.AsynInvokeMechod("MakeCall",this.oATL_BarShow.MakeCall(a,b,h,c,d,e,f,p))};this.CallIn=function(a,b,h,c){return this.AsynInvokeMechod("CallIn",this.oATL_BarShow.CallIn(a,b,h,c))};this.TransferOut=function(a,b){return this.AsynInvokeMechod("TransferOut",this.oATL_BarShow.TransferOut(a,b))};this.Hold=function(){return this.AsynInvokeMechod("Hold",this.oATL_BarShow.Hold())};this.RetrieveHold=function(){return this.AsynInvokeMechod("RetrieveHold",this.oATL_BarShow.RetrieveHold())};this.Disconnect=function(a){return this.AsynInvokeMechod("Disconnect",this.oATL_BarShow.Disconnect(a))};this.Answer=function(a){return this.AsynInvokeMechod("Answer",this.oATL_BarShow.Answer(a))};this.Consult=function(a,b){return this.AsynInvokeMechod("Consult",this.oATL_BarShow.Consult(a,b))};this.Transfer=function(){return this.AsynInvokeMechod("Transfer",this.oATL_BarShow.Transfer())};this.Conference=function(){return this.AsynInvokeMechod("Conference",this.oATL_BarShow.Conference())};this.SendDTMF=function(a){return this.AsynInvokeMechod("SendDTMF",this.oATL_BarShow.SendDTMF(a))};this.Bridge=function(a,b){return this.AsynInvokeMechod("Bridge",this.oATL_BarShow.Bridge(a,b))};this.Mute=function(a){return this.AsynInvokeMechod("Mute",this.oATL_BarShow.Mute(a))};this.ReleaseThirdOne=function(a){return this.AsynInvokeMechod("ReleaseThirdOne",this.oATL_BarShow.ReleaseThirdOne(a))};this.ForceReset=function(){return this.AsynInvokeMechod("ForceReset",this.oATL_BarShow.ForceReset())};this.SendIMMessage=function(a,b,h,c,d,e){return this.AsynInvokeMechod("SendIMMessage",this.oATL_BarShow.SendIMMessage(a,b,h,c,d,e))};this.SendIMMessage2=function(a,b,h){return this.AsynInvokeMechod("SendIMMessage2",this.oATL_BarShow.SendIMMessage2(a,b,h))};this.WinCap=function(a,b,h){return this.AsynInvokeMechod("WinCap",this.oATL_BarShow.WinCap(a,b,h))};this.BeginPlay=function(a,b,h,c,d){return this.AsynInvokeMechod("BeginPlay",this.oATL_BarShow.BeginPlay(a,b,h,c,d))};this.StopPlay=function(a,b){return this.AsynInvokeMechod("StopPlay",this.oATL_BarShow.StopPlay(a,b))};this.BeginCollect=function(a,b,h,c,d,e,f,p,n,q){return this.AsynInvokeMechod("BeginCollect",this.oATL_BarShow.BeginCollect(a,b,h,c,d,e,f,p,n,q))};this.StopCollect=function(a,b){return this.AsynInvokeMechod("StopCollect",this.oATL_BarShow.StopCollect(a,b))};this.BeginRecord=function(a,b){return this.AsynInvokeMechod("BeginRecord",this.oATL_BarShow.BeginRecord(a,b))};this.StopRecord=function(a){return this.AsynInvokeMechod("StopRecord",this.oATL_BarShow.StopRecord(a))};this.AlterNate=function(a){return this.AsynInvokeMechod("AlterNate",this.oATL_BarShow.AlterNate(a))};this.CallBack=function(){return this.AsynInvokeMechod("CallBack",this.oATL_BarShow.CallBack())};this.ReCall=function(){return this.AsynInvokeMechod("ReCall",this.oATL_BarShow.ReCall())};this.SMMsg=function(a,b){return this.AsynInvokeMechod("SMMsg",this.oATL_BarShow.SMMsg(a,b))};this.ForeReleaseCall=function(a,b){return this.AsynInvokeMechod("ForeReleaseCall",this.oATL_BarShow.ForeReleaseCall(a,b))};this.Insert=function(a,b,c){return this.AsynInvokeMechod("Insert",this.oATL_BarShow.Insert(a,b,c))};this.Listen=function(a,b,c){return this.AsynInvokeMechod("Listen",this.oATL_BarShow.Listen(a,b,c))};this.Intercept=function(a,b,c){return this.AsynInvokeMechod("Intercept",this.oATL_BarShow.Intercept(a,b,c))};this.Help=function(a,b,c){return this.AsynInvokeMechod("Help",this.oATL_BarShow.Help(a,b,c))};this.Lock=function(a){return this.AsynInvokeMechod("Lock",this.oATL_BarShow.Lock(a))};this.UnLock=function(a){return this.AsynInvokeMechod("UnLock",this.oATL_BarShow.UnLock(a))};this.ForceIdle=function(a){return this.AsynInvokeMechod("ForceIdle",this.oATL_BarShow.ForceIdle(a))};this.ForceBusy=function(a){return this.AsynInvokeMechod("ForceBusy",this.oATL_BarShow.ForceBusy(a))};this.ForceOut=function(a){return this.AsynInvokeMechod("ForceOut",this.oATL_BarShow.ForceOut(a))};this.InitialState=function(){return this.AsynInvokeMechod("InitialState",this.oATL_BarShow.InitialState())};this.AgentQuery=function(a,b){return this.AsynInvokeMechod("AgentQuery",this.oATL_BarShow.AgentQuery(a,b))};this.TelQuery=function(a,b){return this.AsynInvokeMechod("TelQuery",this.oATL_BarShow.TelQuery(a,b))};this.IvrQuery=function(a,b){return this.AsynInvokeMechod("IvrQuery",this.oATL_BarShow.IvrQuery(a,b))};this.TrunkQuery=function(a,b){return this.AsynInvokeMechod("TrunkQuery",this.oATL_BarShow.TrunkQuery(a,b))};this.ServiceQuery=function(a,b){return this.AsynInvokeMechod("ServiceQuery",this.oATL_BarShow.ServiceQuery(a,b))};this.TaskQuery=function(a,b){return this.AsynInvokeMechod("TaskQuery",this.oATL_BarShow.TaskQuery(a,b))};this.CallReportQuery=function(a,b){return this.AsynInvokeMechod("CallReportQuery",this.oATL_BarShow.CallReportQuery(a,b))};this.GetTaskSummary=function(a,b){return this.AsynInvokeMechod("GetTaskSummary",this.oATL_BarShow.GetTaskSummary(a,b))};this.StartNotification=function(a,b,c){return this.AsynInvokeMechod("StartNotification",this.oATL_BarShow.StartNotification(a,b,c))};this.EndNotification=function(a){return this.AsynInvokeMechod("EndNotification",this.oATL_BarShow.EndNotification(a))};this.SendWeiboMsg=function(a){return this.AsynInvokeMechod("SendWeiboMsg",this.oATL_BarShow.SendWeiboMsg(a))};this.UploadFileToMMS=function(a,b,c,d){return this.AsynInvokeMechod("UploadFileToMMS",this.oATL_BarShow.UploadFileToMMS(a,b,c,d))};this.DownFileFromMMS=function(a,b,c,d,e){return this.AsynInvokeMechod("DownFileFromMMS",this.oATL_BarShow.DownFileFromMMS(a,b,c,d,e))};this.SendWeChatMsg=function(a,b,c,d,e,f,k,p,n,q){return this.AsynInvokeMechod("SendWeChatMsg",this.oATL_BarShow.SendWeChatMsg(a,b,c,d,e,f,k,p,n,q))};this.QueryWeChatData=function(a,b,c,d,e,f,k){return this.AsynInvokeMechod("QueryWeChatData",this.oATL_BarShow.QueryWeChatData(a,b,c,d,e,f,k))};this.QueryWeChatHistory=function(a,b,c,d,e,f,k){return this.AsynInvokeMechod("QueryWeChatHistory",this.oATL_BarShow.QueryWeChatHistory(a,b,c,d,e,f,k))};this.GetWeChatParam=function(a){return this.AsynInvokeMechod("GetWeChatParam",this.oATL_BarShow.GetWeChatParam(a))};this.SetCtrlAttribute=function(a,b){"MainIP"==a?this.oATL_BarShow.MainIP=b:"BackIP"==a?this.oATL_BarShow.BackIP=b:"MainPortID"==a?this.oATL_BarShow.MainPortID=b:"BackPortID"==a?this.oATL_BarShow.BackPortID=b:"AgentID"==a?this.oATL_BarShow.AgentID=b:"Dn"==a?this.oATL_BarShow.Dn=b:"PassWord"==a?this.oATL_BarShow.PassWord=b:"MediaFlag"==a?this.oATL_BarShow.MediaFlag=b:"PhonType"==a?this.oATL_BarShow.PhonType=b:"AppType"==a?this.oATL_BarShow.AppType=b:"SipServerIP"==a?this.oATL_BarShow.SipServerIP=b:"SipServerPort"==a?this.oATL_BarShow.SipServerPort=b:"SipProtocol"==a?this.oATL_BarShow.SipProtocol=b:"SipDn"==a?this.oATL_BarShow.SipDn=b:"SipAuthType"==a?this.oATL_BarShow.SipAuthType=b:"SipDomain"==a?this.oATL_BarShow.SipDomain=b:"SipPassWord"==a?this.oATL_BarShow.SipPassWord=b:"SipBackServerIP"==a?this.oATL_BarShow.SipBackServerIP=b:"SipBackServerPort"==a?this.oATL_BarShow.SipBackServerPort=b:"SipBackProtocol"==a?this.oATL_BarShow.SipBackProtocol=b:"SipBackAuthType"==a?this.oATL_BarShow.SipBackAuthType=b:"SipBackDomain"==a?this.oATL_BarShow.SipBackDomain=b:"SipBackPassWord"==a?this.oATL_BarShow.SipBackPassWord=b:"MonitorIP"==a?this.oATL_BarShow.MonitorIP=b:"MonitorPort"==a?this.oATL_BarShow.MonitorPort=b:"WeChatServer"==a?this.oATL_BarShow.WeChatServer=b:"SelfPrompt"==a?this.oATL_BarShow.SelfPrompt=b:"MinotorVersion"==a?this.oATL_BarShow.MinotorVersion=b:"TaskID"==a?this.oATL_BarShow.TaskID=b:"AutoUpdateURL"==a?this.oATL_BarShow.AutoUpdateURL=b:"SipPassWdCryptType"==a?this.oATL_BarShow.SipPassWdCryptType=b:"PassWdCryptType"==a?this.oATL_BarShow.PassWdCryptType=b:"AutoSelectAgent"==a?this.oATL_BarShow.AutoSelectAgent=b:"VersionType"==a?this.oATL_BarShow.VersionType=b:"IsAllTimeRecord"==a?this.oATL_BarShow.IsAllTimeRecord=b:"RecordType"==a?this.oATL_BarShow.RecordType=b:"AgentName"==a?this.oATL_BarShow.AgentName=b:"msgFlag"==a?this.oATL_BarShow.msgFlag=b:"AgentType"==a?this.oATL_BarShow.AgentType=b:"LocalPort"==a?this.oATL_BarShow.LocalPort=b:"ServiceLists"==a?this.oATL_BarShow.ServiceLists=b:"TimeOut"==a?this.oATL_BarShow.TimeOut=b:"ftpServerIP"==a?this.oATL_BarShow.ftpServerIP=b:"ftpServerPort"==a?this.oATL_BarShow.ftpServerPort=b:"ftpUser"==a?this.oATL_BarShow.ftpUser=b:"ftpPassWord"==a?this.oATL_BarShow.ftpPassWord=b:"ftpDirectory"==a?this.oATL_BarShow.ftpDirectory=b:"forceEndProcess"!=a&&DisplayLog(VccBar_Log_Error,"bad attribute name:"+a)};this.GetCtrlAttribute=function(a){if("MainIP"==a)return this.oATL_BarShow.MainIP;if("BackIP"==a)return this.oATL_BarShow.BackIP;if("MainPortID"==a)return this.oATL_BarShow.MainPortID;if("BackPortID"==a)return this.oATL_BarShow.BackPortID;if("AgentID"==a)return this.oATL_BarShow.AgentID;if("Dn"==a)return this.oATL_BarShow.Dn;if("PassWord"==a)return this.oATL_BarShow.PassWord;if("MediaFlag"==a)return this.oATL_BarShow.MediaFlag;if("PhonType"==a)return this.oATL_BarShow.PhonType;if("AppType"==a)return this.oATL_BarShow.AppType;if("SipServerIP"==a)return this.oATL_BarShow.SipServerIP;if("SipServerPort"==a)return this.oATL_BarShow.SipServerPort;if("SipProtocol"==a)return this.oATL_BarShow.SipProtocol;if("SipDn"==a)return this.oATL_BarShow.SipDn;if("SipAuthType"==a)return this.oATL_BarShow.SipAuthType;if("SipDomain"==a)return this.oATL_BarShow.SipDomain;if("SipPassWord"==a)return this.oATL_BarShow.SipPassWord;if("SipBackServerIP"==a)return this.oATL_BarShow.SipBackServerIP;if("SipBackServerPort"==a)return this.oATL_BarShow.SipBackServerPort;if("SipBackProtocol"==a)return this.oATL_BarShow.SipBackProtocol;if("SipBackAuthType"==a)return this.oATL_BarShow.SipBackAuthType;if("SipBackDomain"==a)return this.oATL_BarShow.SipBackDomain;if("SipBackPassWord"==a)return this.oATL_BarShow.SipBackPassWord;if("MonitorIP"==a)return this.oATL_BarShow.MonitorIP;if("MonitorPort"==a)return this.oATL_BarShow.MonitorPort;if("WeChatServer"==a)return this.oATL_BarShow.WeChatServer;if("SelfPrompt"==a)return this.oATL_BarShow.SelfPrompt;if("MinotorVersion"==a)return this.oATL_BarShow.MinotorVersion;if("TaskID"==a)return this.oATL_BarShow.TaskID;if("AutoUpdateURL"==a)return this.oATL_BarShow.AutoUpdateURL;if("PassWdCryptType"==a)return this.oATL_BarShow.SipPassWdCryptType;if("SipPassWdCryptType"==a)return this.oATL_BarShow.PassWdCryptType;if("AutoSelectAgent"==a)return this.oATL_BarShow.AutoSelectAgent;if("VersionType"==a)return this.oATL_BarShow.VersionType;if("IsAllTimeRecord"==a)return this.oATL_BarShow.IsAllTimeRecord;if("RecordType"==a)return this.oATL_BarShow.RecordType;if("AgentName"==a)return this.oATL_BarShow.AgentName;if("msgFlag"==a)return this.oATL_BarShow.msgFlag;if("AgentType"==a)return this.oATL_BarShow.AgentType;if("LocalPort"==a)return this.oATL_BarShow.LocalPort;if("ServiceLists"==a)return this.oATL_BarShow.ServiceLists;if("TimeOut"==a)return this.oATL_BarShow.TimeOut;if("ftpServerIP"==a)return this.oATL_BarShow.ftpServerIP;if("ftpServerPort"==a)return this.oATL_BarShow.ftpServerPort;if("ftpUser"==a)return this.oATL_BarShow.ftpUser;if("ftpPassWord"==a)return this.oATL_BarShow.ftpPassWord;if("ftpDirectory"==a)return this.oATL_BarShow.ftpDirectory;"forceEndProcess"!=a&&DisplayLog(VccBar_Log_Error,"bad attribute name:"+a);return""};this.GetBarCtrl=function(){return this};this.GetOCXCtrl=function(){return this.oATL_BarShow};this.Display=function(a){this.oBarShow.style.display=1==a?"":"none"};this.attachEventfun=function(a){this.eventCallBack=a};this.attachResponsefun=function(a){this.methodCallBack=a};this.SetAsysMode=function(a){this.asynExecuteMethod=a;1==this.asynExecuteMethod?BeginAsynFunctionTimer(500):EndAsynFunctionTimer()};this.GetAsysMode=function(){return this.asynExecuteMethod};this.show=function(){this.oATL_BarShow&&(this.oATL_BarShow.style.left=this.left,this.oATL_BarShow.style.top=this.top,this.oATL_BarShow.style.width=this.width,this.oATL_BarShow.style.height=this.height);this.resize(this.left,this.top,this.width,this.height)};this.resize=function(a,b,c,d){this.left="number"==typeof a?a:0;this.top="number"==typeof b?b:0;this.width=0<c?c:100;this.height=0<d?d:100;with(this.oBarShow.style)pixelWidth=this.width,pixelHeight=this.height,pixelLeft=this.left,pixelTop=this.top;this.oATL_BarShow.style.width=this.width;this.oATL_BarShow.style.height=this.height};this._createObject();return this}function altEventOnCallRing(a,b,c,d,e,f,g,m,h,r,w,l,k,p,n,q,t,u,v){application.oJVccBar.GetBarCtrl()._OnCallRing(a,b,c,d,e,f,g,m,h,r,w,l,k,p,n,q,t,u,v)}function altEventOnAnswerCall(a,b,c,d,e,f,g){application.oJVccBar.GetBarCtrl()._OnAnswerCall(a,b,c,d,e,f,g)}function altEventOnCallEnd(a,b,c,d,e,f,g,m,h,r,w,l,k,p,n){application.oJVccBar.GetBarCtrl()._OnCallEnd(a,b,c,d,e,f,g,m,h,r,w,l,k,p,n)}function altEventOnPrompt(a,b){application.oJVccBar.GetBarCtrl()._OnPrompt(a,b)}function altEventOnReportBtnStatus(a){application.oJVccBar.GetBarCtrl()._OnReportBtnStatus(a)}function altEventOnInitalSuccess(){application.oJVccBar.GetBarCtrl()._OnInitalSuccess()}function altEventOnInitalFailure(a,b){application.oJVccBar.GetBarCtrl()._OnInitalFailure(a,b)}function altEventOnEventPrompt(a,b){application.oJVccBar.GetBarCtrl()._OnEventPrompt(a,b)}function altEventOnAgentWorkReport(a,b){application.oJVccBar.GetBarCtrl()._OnAgentWorkReport(a,b)}function altEventOnCallDataChanged(a){application.oJVccBar.GetBarCtrl()._OnCallDataChanged(a)}function altEventOnBarExit(a,b){application.oJVccBar.GetBarCtrl()._OnBarExit(a,b)}function altEventOnCallQueueQuery(a){application.oJVccBar.GetBarCtrl()._OnCallQueueQuery(a)}function altEventOnQueryGroupAgentStatus(a,b){application.oJVccBar.GetBarCtrl()._OnQueryGroupAgentStatus(a,b)}function altEventOnSystemMessage(a,b){application.oJVccBar.GetBarCtrl()._OnSystemMessage(a,b)}function altEventOnRecvWeiboMsg(a){application.oJVccBar.GetBarCtrl()._invokeEvent(eventOnRecvWeiboMsg,a)}function altEventOnIMMessage(a,b){application.oJVccBar.GetBarCtrl()._OnRecvWeiboMsg(a,b)}function altEventOnRecvWeChatMessage(a,b,c,d,e,f,g,m,h,r,w,l,k,p){application.oJVccBar.GetBarCtrl()._OnRecvWeChatMessage(a,b,c,d,e,f,g,m,h,r,w,l,k,p)}function altEventOnSendWeChatMsgReport(a,b,c,d,e){application.oJVccBar.GetBarCtrl()._OnSendWeChatMsgReport(a,b,c,d,e)}function altEventOnUploadFileToMMSReport(a,b,c,d,e,f){application.oJVccBar.GetBarCtrl()._OnUploadFileToMMSReport(a,b,c,d,e,f)}function altEventOnDownloadFileToMMSReport(a,b,c,d){application.oJVccBar.GetBarCtrl()._OnDownloadFileToMMSReport(a,b,c,d)}function altEventOnWorkStaticInfoReport(a){application.oJVccBar.GetBarCtrl()._OnWorkStaticInfoReport(a)}function altEventOnQuerySPGroupList(a,b){application.oJVccBar.GetBarCtrl()._OnQuerySPGroupList(a,b)}function altEventOnAgentBusyReason(a,b){application.oJVccBar.GetBarCtrl()._OnAgentBusyReason(a,b)}function altEventOnAgentLogUpload(a,b,c,d,e,f){application.oJVccBar.GetBarCtrl()._OnAgentLogUpload(a,b,c,d,e,f)}function altEventOnAsrEventReport(a,b,c,d){application.oJVccBar.GetBarCtrl()._OnAsrEventReport(a,b,c,d)}function altEventOnAgentReport(a){application.oJVccBar.GetBarCtrl()._OnAgentReport(a)}function altEventOnTelReport(a){application.oJVccBar.GetBarCtrl()._OnTelReport(a)}function altEventOnServiceReport(a){application.oJVccBar.GetBarCtrl()._OnServiceReport(a)}function altEventOnIvrReport(a){application.oJVccBar.GetBarCtrl()._OnIvrReport(a)}function altEventOnTaskReport(a){application.oJVccBar.GetBarCtrl()._OnTaskReport(a)}function altEventOnOutboundReport(a){application.oJVccBar.GetBarCtrl()._OnOutboundReport(a)}function altEventOnCallReportInfo(a){application.oJVccBar.GetBarCtrl()._OnCallReportInfo(a)}function altEventOnQueueReport(a){application.oJVccBar.GetBarCtrl()._OnQueueReport(a)}function altEventOnQueryMonitorSumReport(a,b){application.oJVccBar.GetBarCtrl()._OnQueryMonitorSumReport(a,b)}function altEventOnWallServiceReport(a){application.oJVccBar.GetBarCtrl()._OnWallServiceReport(a)}function altEventOnWallQueueReport(a){application.oJVccBar.GetBarCtrl()._OnWallQueueReport(a)}function altEventOnServiceStaticReport(a){application.oJVccBar.GetBarCtrl()._OnServiceStaticReport(a)}function altEventOnAgentStaticReport(a){application.oJVccBar.GetBarCtrl()._OnAgentStaticReport(a)}function altEventOnTrunkReport(a){application.oJVccBar.GetBarCtrl()._OnTrunkReport(a)}function altEventOnTrunkSumReport(a){application.oJVccBar.GetBarCtrl()._OnTrunkSumReport(a)}var VccBar_Log_None=0,VccBar_Log_Error=1,VccBar_Log_Warn=2,VccBar_Log_Debug=4,VccBar_Log_Info=8,VccBar_Log_Protocol=16,MAXCALLNUMLEN=64,g_DebugFlag=1,gLogType=VccBar_Log_None;function LeafOutMuchMessage(a,b){return 0<=b.indexOf("OnStaticInfoReport")||0<=b.indexOf("OnQueueReport")?!1:!0}function DisplayLog(a,b){if(LeafOutMuchMessage(a,b)&&a&gLogType){var c="";a==VccBar_Log_Error&&(c="\u3010\u9519\u8bef\u3011\u3010"+getTimeString()+"\u3011");a==VccBar_Log_Warn&&(c="\u3010\u8b66\u544a\u3011\u3010"+getTimeString()+"\u3011");a==VccBar_Log_Debug&&(c="\u3010\u8c03\u8bd5\u3011\u3010"+getTimeString()+"\u3011");a==VccBar_Log_Info&&(c="\u3010\u4fe1\u606f\u3011\u3010"+getTimeString()+"\u3011");a==VccBar_Log_Protocol&&(c="\u3010\u534f\u8bae\u3011\u3010"+getTimeString()+"\u3011");b=c+b;a==VccBar_Log_Protocol&&(b+="\r\n");application.Log(b)}}function getSubString(a,b,c){if(""==b&&""==c)return a;var d="";if(""==b)d=a;else{d=a.indexOf(b);if(0>d)return"";d+=b.length;d=a.substr(d,a.length)}a=d;if(""==c)d=a;else{b=a.indexOf(c);if(0>b)return"";d=a.substr(0,b)}return d}function getRelatedIntArrayValue(a,b,c){for(var d=0;d<a.length;d++)if(a[d]==c)return b[d];return-1}function getRelatedStringArrayValue(a,b,c){for(var d=0;d<a.length;d++)if(a[d]==c)return b[d];return""}function trimStr(a){return a.replace(/(^\s*)|(\s*$)/g,"")}function trimLeftStr(a){return a.replace(/(^\s*)/g,"")}function trimRightStr(a){return a.replace(/(\s*$)/g,"")}function getDefaultParam(a){return"undefined"==typeof a?"":a}function getDefaultParamValue(a,b){return"undefined"==typeof a?getDefaultParam(b):a}function getTimeString(){var a=new Date,b=a.getFullYear(),c=a.getMonth()+1,c=10>c?"0"+c:c,d=a.getDate(),d=10>d?"0"+d:d,e=a.getHours(),e=10>e?"0"+e:e,f=a.getMinutes(),f=10>f?"0"+f:f,g=a.getSeconds(),g=10>g?"0"+g:g,a=a.getMilliseconds();return b.toString()+":"+c.toString()+":"+d.toString()+" "+e.toString()+":"+f.toString()+":"+g.toString()+"  "+a.toString()}function stringFormat(){if(0==arguments.length)return"";for(var a=arguments[0],b=1;b<arguments.length;b++)a=a.replace(new RegExp("\\{"+(b-1)+"\\}","gm"),arguments[b]);return a}function formatCallNum(a){for(var b="",c=0,d=0;d<a.length;d++)" "!=a[d]&&"-"!=a[d]&&(b+=a[d],c++);return b}function isPhoneNum(a,b){return!0}function $$(a){return window.document.getElementById(a)}function arrayEmpty(a){a.splice(0,a.length)}function arrayRemoveItem(a,b){for(var c=0;c<a;c++)if(a[c]==b)return c;-1!=c&&a.splice(index,1)}function stringToInt(a,b){return""==a||null==a||"undefined"==typeof a?b:parseInt(a)}function getArrayIndex(a,b){if(0>=a.length)return-1;for(var c=0;c<a.length;c++)if(a[c]==b)return c;return-1}function getStringTimerInterval(a,b){var c=StringToDate(a),d=StringToDate(b);if(0==c||0==d)return 0;c=d.getTime()-c.getTime();return Math.round(c/1E3)}function getAcpTimeString(a){var b=new Date,c=b.getFullYear(),d=b.getMonth()+1,d=10>d?"0"+d:d,e=b.getDate(),e=10>e?"0"+e:e,f=b.getHours(),f=10>f?"0"+f:f,g=b.getMinutes(),g=10>g?"0"+g:g,m=b.getSeconds(),m=10>m?"0"+m:m,b=b.getMilliseconds();return(a=getDefaultParamValue(a,!0))?stringFormat("{0}:{1}:{2} {3}:{4}:{5} {6}",c.toString(),d.toString(),e.toString(),f.toString(),g.toString(),m.toString(),b.toString()):stringFormat("{0}{1}{2}{3}{4}{5}",c.toString(),d.toString(),e.toString(),f.toString(),g.toString(),m.toString())}function StringToDate(a){if(""==a||"undefined"==typeof a||14!=a.length)return 0;var b=new Date;b.setYear(parseInt(a.substr(0,4)));b.setMonth(parseInt(a.substr(4,2)));b.setDate(parseInt(a.substr(6,2)));b.setHours(parseInt(a.substr(8,2)));b.setMinutes(parseInt(a.substr(10,2)));b.setSeconds(parseInt(a.substr(12,2)));return b}function CXmlParse(){this.oXmlDoc=null;this.nType=-1;this.loadXMLFile=function(a){try{this.oXmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.nType=1}catch(b){try{this.oXmlDoc=document.implementation.createDocument("","",null),this.nType=0}catch(c){return alert(c.message),this.nType=-1,!1}}try{this.oXmlDoc.async=!1,this.oXmlDoc.load(a),alert(a)}catch(b){return alert(b.message),this.nType=-1,!1}return!0};this.loadXml=function(a){try{this.oXmlDoc=(new DOMParser).parseFromString(a,"text/xml"),this.nType=0}catch(b){try{this.oXmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.nType=1,this.oXmlDoc.async=!1,this.oXmlDoc.loadXML(a)}catch(c){return this.nType=-1,!1}}return!0};this.queryNodes=function(a){return-1==this.nType?null:0==this.nType?this.oXmlDoc.getElementsByTagName(a):this.oXmlDoc.selectNodes(a)};this.queryNode=function(a){return-1==this.nType?null:0==this.nType?(a=this.oXmlDoc.getElementsByTagName(a),0<a.length?a[0]:null):this.oXmlDoc.selectSingleNode(a)};this.queryNodeValue=function(a){return-1==this.nType?"":0==this.nType?null==a?"":a.childNodes[0].nodeValue:null!=a?a.text:""};this.queryNodeValueByPath=function(a){return-1==this.nType?"":this.queryNodeValue(this.queryNode(a))};this.queryNodeAttribute=function(a,b){if(-1==this.nType)return"";if(0==this.nType)return null==a?"":a.getAttribute(b);try{if(!a||!a.attributes)return"";if(null!=a.attributes[b])return a.attributes[b].value;if(null!=a.attributes.getNamedItem(b))return a.attributes.getNamedItem(b).value}catch(c){}return""};this.queryNodeAttributeByPath=function(a,b){return-1==this.nType?"":this.queryNodeAttribute(this.queryNode(a),b)};this.close=function(){this.nType=this.oXmlDoc=null};return this}function xmlTest(){getSubString('\x3capspMessage ver\x3d"2.0.0" time\x3d"2014:05:09 18:05:07 546"\x3e\x3cheader\x3e\x3csessionID\x3eWUSHENGJUN\x3c/sessionID\x3e\x3c/header\x3e\x3cbody type\x3d"event" name\x3d"OnPrompt"\x3e\x3cpaspparam\x3e4407||0\x3c/paspparam\x3e\x3c/body\x3e\x3c/apspMessage\x3e','type\x3d"','"');getSubString('\x3capspMessage ver\x3d"2.0.0" time\x3d"2014:05:09 18:05:07 546"\x3e\x3cheader\x3e\x3csessionID\x3eWUSHENGJUN\x3c/sessionID\x3e\x3c/header\x3e\x3cbody type\x3d"event" name\x3d"OnPrompt"\x3e\x3cpaspparam\x3e4407||0\x3c/paspparam\x3e\x3c/body\x3e\x3c/apspMessage\x3e','name\x3d"','"');getSubString('\x3capspMessage ver\x3d"2.0.0" time\x3d"2014:05:09 18:05:07 546"\x3e\x3cheader\x3e\x3csessionID\x3eWUSHENGJUN\x3c/sessionID\x3e\x3c/header\x3e\x3cbody type\x3d"event" name\x3d"OnPrompt"\x3e\x3cpaspparam\x3e4407||0\x3c/paspparam\x3e\x3c/body\x3e\x3c/apspMessage\x3e',"\x3cpaspparam\x3e","\x3c/paspparam\x3e");var a=new CXmlParse;a.loadXml('\x3capspMessage ver\x3d"2.0.0" time\x3d"2014:05:09 18:05:07 546"\x3e\x3cheader\x3e\x3csessionID\x3eWUSHENGJUN\x3c/sessionID\x3e\x3c/header\x3e\x3cbody type\x3d"event" name\x3d"OnPrompt"\x3e\x3cpaspparam\x3e4407||0\x3c/paspparam\x3e\x3c/body\x3e\x3c/apspMessage\x3e')&&(1==a.nType?alert("IE:"+a.queryNodeAttributeByPath("apspMessage/body","name")):alert(a.queryNodeAttributeByPath("body","name")),1==a.nType?alert("IE:"+a.queryNodeValueByPath("apspMessage/header/sessionID")):alert(a.queryNodeValueByPath("sessionID")))}var base64EncodeChars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",base64DecodeChars=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];function base64encode(a){var b,c,d,e,f,g;d=a.length;c=0;for(b="";c<d;){e=a.charCodeAt(c++)&255;if(c==d){b+=base64EncodeChars.charAt(e>>2);b+=base64EncodeChars.charAt((e&3)<<4);b+="\x3d\x3d";break}f=a.charCodeAt(c++);if(c==d){b+=base64EncodeChars.charAt(e>>2);b+=base64EncodeChars.charAt((e&3)<<4|(f&240)>>4);b+=base64EncodeChars.charAt((f&15)<<2);b+="\x3d";break}g=a.charCodeAt(c++);b+=base64EncodeChars.charAt(e>>2);b+=base64EncodeChars.charAt((e&3)<<4|(f&240)>>4);b+=base64EncodeChars.charAt((f&15)<<2|(g&192)>>6);b+=base64EncodeChars.charAt(g&63)}return b}function base64decode(a){var b,c,d,e,f;e=a.length;d=0;for(f="";d<e;){do b=base64DecodeChars[a.charCodeAt(d++)&255];while(d<e&&-1==b);if(-1==b)break;do c=base64DecodeChars[a.charCodeAt(d++)&255];while(d<e&&-1==c);if(-1==c)break;f+=String.fromCharCode(b<<2|(c&48)>>4);do{b=a.charCodeAt(d++)&255;if(61==b)return f;b=base64DecodeChars[b]}while(d<e&&-1==b);if(-1==b)break;f+=String.fromCharCode((c&15)<<4|(b&60)>>2);do{c=a.charCodeAt(d++)&255;if(61==c)return f;c=base64DecodeChars[c]}while(d<e&&-1==c);if(-1==c)break;f+=String.fromCharCode((b&3)<<6|c)}return f}function utf16to8(a){var b,c,d,e;b="";d=a.length;for(c=0;c<d;c++)e=a.charCodeAt(c),1<=e&&127>=e?b+=a.charAt(c):(2047<e?(b+=String.fromCharCode(224|e>>12&15),b+=String.fromCharCode(128|e>>6&63)):b+=String.fromCharCode(192|e>>6&31),b+=String.fromCharCode(128|e>>0&63));return b}function utf8to16(a){var b,c,d,e,f,g;b="";d=a.length;for(c=0;c<d;)switch(e=a.charCodeAt(c++),e>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:b+=a.charAt(c-1);break;case 12:case 13:f=a.charCodeAt(c++);b+=String.fromCharCode((e&31)<<6|f&63);break;case 14:f=a.charCodeAt(c++),g=a.charCodeAt(c++),b+=String.fromCharCode((e&15)<<12|(f&63)<<6|(g&63)<<0)}return b}function GetBase64FromGBK(a){return"undefined"==typeof a?"":base64encode(utf16to8(a))}function GetGBKFromBase64(a){return"undefined"==typeof a?"":utf8to16(base64decode(a))}function CharToHex(a){var b,c,d,e;b="";d=a.length;for(c=0;c<d;)e=a.charCodeAt(c++),e=e.toString(16),2>e.length&&(e="0"+e),b+="\\x"+e+" ",0<c&&0==c%8&&(b+="\r\n");return b}function getCookie(a){return 0<document.cookie.length&&(c_start=document.cookie.indexOf(a+"\x3d"),-1!=c_start)?(c_start=c_start+a.length+1,c_end=document.cookie.indexOf(";",c_start),-1==c_end&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))):""}function setCookie(a,b,c){var d=new Date;d.setDate(d.getDate()+c);a=a+"\x3d"+escape(b)+(null==c?"":";expires\x3d"+d.toGMTString());document.cookie=a}function GetCABVersion(){return"1.0.0.6"==g_JsVersion?"|20.150101":"1.0.0.7"==g_JsVersion?"20.150101|20.150401":"1.0.0.8"==g_JsVersion?"20.150401|20.150101":""}var TIMER_AUTO=0,TIMER_HANDLE=1,g_oJTimer=null;function JTimeItem(){this.id=-1;this.intervalMax=this.interval=0;this.intervalCount=-1;return this}function JTimer(a){"undefined"==typeof a&&(a=100);if(null!=g_oJTimer)return g_oJTimer._cellInterVal=a,g_oJTimer;this._cellInterVal=a;this._bStart=!1;this._onTimerCallBackEvent=null;this._timers=[];this._timerType=TIMER_AUTO;this._timerID=null;this.SetTimerCallBack=function(a){this._onTimerCallBackEvent=a};this.IsProcess=function(){return this._bStart};this.OnTimer=function(){if(null!=this._onTimerCallBackEvent)for(var a=0;a<this._timers.length;a++)-1!=this._timers[a].intervalMax&&(this._timers[a].intervalCount++,this._timers[a].intervalCount>=this._timers[a].intervalMax&&-1!=this._timers[a].intervalMax&&(this._timers[a].intervalCount=0,this._onTimerCallBackEvent(this._timers[a].id)))};this.Start=function(){this._bStart||(this._timerType==TIMER_AUTO&&null==g_oJTimer._timerID&&(g_oJTimer._timerID=setInterval(function(){g_oJTimer.OnTimer()},g_oJTimer._cellInterVal)),this._bStart=!0)};this.Stop=function(){this._bStart&&(null!=g_oJTimer._timerID&&(clearInterval(g_oJTimer._timerID),g_oJTimer._timerID=null),this._bStart=!1)};this.SetTimer=function(a,c){if(0>a||0>=c)return-1;if(-1!=this._getTimerIndex(a))return this.Reset(a),-3;var d=new JTimeItem;d.id=a;d.interval=c;d.intervalMax=c/this._cellInterVal;this._timers.push(d);return this._timers.length-1};this.KillTimer=function(a){a=this._getTimerIndex(a);-1!=a&&this._timers.splice(a,1)};this.Reset=function(a){a=this._getTimerIndex(a);-1!=a&&(this._timers[a].intervalCount=0)};this._getTimerIndex=function(a){for(var c=0;c<this._timers.length;c++)if(this._timers[c].id==a)return c;return-1};g_oJTimer=this;return this}var G_oSiverlightCtrl=null;function JSilverLightCtrl(a,b,c,d,e,f,g){this.left=a;this.top=b;this.width=c;this.height=d;g="undefined"==typeof g?null:g;this._window=null==g?window:g;this._contentWindow=null==f?window:f;this.id="oSiverLight_"+Math.ceil(100*Math.random());this.name=this.id+"_Ctrl";this.oSilverlight=this.oSL_MonShow=this.oMonitorShow=null;this._realMethodName="";G_oSiverlightCtrl=this;this._relationPath="undefined"==typeof e?"":e;this._createObject=function(){this.oMonitorShow=this._window.document.createElement("DIV");this.oMonitorShow.style.cursor="move";this.oMonitorShow.style.position="absolute";this.oMonitorShow.style.border="1px solid #828282";this.oMonitorShow.style.left=this.left+"px";this.oMonitorShow.style.top=this.top+"px";this.oMonitorShow.style.width=this.width+"px";this.oMonitorShow.style.height=this.height+"px";this.oMonitorShow.style.textAlign="center";this.oMonitorShow.id="silverlightControlBarHost";this._contentWindow==this._window?this._contentWindow.document.body.appendChild(this.oMonitorShow):this._contentWindow.appendChild(this.oMonitorShow);this.oMonitorShow.innerHTML=this._getMSLHtml();this.oSL_MonShow=this.oMonitorShow.firstChild};this._getMSLHtml=function(){var a;a='\x3cobject id\x3d"objsilverlightBarControl" data\x3d"data:application/x-silverlight-2," type\x3d"application/x-silverlight-2" width\x3d"100%" height\x3d"100%" \x3e\x3cparam name\x3d"source" value\x3d"'+this._relationPath+'CCVccBar.xap"/\x3e';a+='\x3cparam name\x3d"onError" value\x3d"onSilverlightBarError" /\x3e';a+='\x3cparam name\x3d"background" value\x3d"white" /\x3e';a+='\x3cparam name\x3d"minRuntimeVersion" value\x3d"4.0.50826.0" /\x3e';a+='\x3cparam name\x3d"autoUpgrade" value\x3d"true" /\x3e';a+='\x3cparam name\x3d"onLoad" value\x3d"SilverlightPluginBarLoaded" /\x3e';a+='\x3ca href\x3d"http://go.microsoft.com/fwlink/?LinkID\x3d149156\x26v\x3d5.0.61118.0" style\x3d"text-decoration:none"\x3e';a+='\x3cimg src\x3d"http://go.microsoft.com/fwlink/?LinkId\x3d161376" alt\x3d"Get Microsoft Silverlight" style\x3d"border-style:none"/\x3e';a+="\x3c/a\x3e";return a+="\x3c/object\x3e"};this._createObject();this._GetAppMainPage=function(){null!=this.oSL_MonShow&&null==this.oSilverlight&&(this.oSilverlight=this.oSL_MonShow.Content.MainApp,this.oSilverlight.RegisterEventFun("OnSLEventFunction"),this.oSilverlight.RegisterResponseFun("OnSLResponseFunction"),this.SetCtrlAttribute("AgentType",0),this.SetCtrlAttribute("PassWord","111111"),this.SetCtrlAttribute("MainPortID",14800),this.SetCtrlAttribute("BackPortID",14800),this.SetCtrlAttribute("TaskID","0"),this.SetCtrlAttribute("MonitorPort",4502),this.SetCtrlAttribute("AppType",0),this.SetCtrlAttribute("SipServerPort",5060),this.SetCtrlAttribute("SipPassWord","00000000"),this.SetCtrlAttribute("SipProtocol","UDP"),this.SetCtrlAttribute("SipPassWdCryptType",0),this.SetCtrlAttribute("SipAuthType",1),this.SetCtrlAttribute("PhonType",0),this.SetCtrlAttribute("SelfPrompt",0),this.SetCtrlAttribute("forceEndProcess",g_DebugFlag),this.OnMonitorControlLoad())};this._invokeEventReport=function(a,b){null!=this.eventCallBack&&(DisplayLog(VccBar_Log_Info,"JSilverLightCtrl:_invokeEventReport(cmdIndex\x3d"+a+"  param\x3d"+b+")"),this.eventCallBack(a,b))};this._invokeResponseReport=function(a,b){null!=this.responseCallBack&&("SetCTIInfo"==a||"QueryCTIInfo"==a?(DisplayLog(VccBar_Log_Info,"JSilverLightCtrl:_invokeResponseReport(cmdName\x3d"+this._realMethodName+"  param\x3d"+b+")"),this.responseCallBack(this._realMethodName,b)):(DisplayLog(VccBar_Log_Info,"JSilverLightCtrl:_invokeResponseReport(cmdName\x3d"+a+"  param\x3d"+b+")"),this.responseCallBack(a,b)))};this._InvokeMethod=function(a,b){if(""==a)return-1;DisplayLog(VccBar_Log_Debug,"JSilverLightCtrl:_InvokeMethod(cmdName\x3d"+a+",param\x3d"+b+")");return null!=this.oSilverlight?this.oSilverlight.InvokeExecuteMethod(a,b):-1};this._InvokeQueryMethod=function(a,b){return""==a?"":null!=this.oSilverlight?this.oSilverlight.InvokeReturnMethod(a,b):""};this.attachEventfun=function(a){this.eventCallBack=a};this.attachResponsefun=function(a){this.responseCallBack=a};this.GetBarCtrl=function(){return this};this.SetCtrlAttribute=function(a,b){DisplayLog(VccBar_Log_Debug,"JVccBar:SetCtrlAttribute(aName\x3d"+a+",aValue\x3d"+b+")");null!=this.oSilverlight&&(DisplayLog(VccBar_Log_Debug,"JVccBar:SetAttribute(aName\x3d"+a+",aValue\x3d"+b+")"),this.oSilverlight.SetAttribute(a,b))};this.GetCtrlAttribute=function(a){return null!=this.oSilverlight?this.oSilverlight.GetAttribute(a):""};this.GetBarType=function(){return vccBarTypeSILVERLIGHT};this._gfOnPrompt=function(a,b){"undefined"==typeof b&&(b="");this._invokeEventReport(eventOnPrompt,a+"|"+b)};this.Initial=function(){return this._InvokeMethod("Initial",getLocalLanguage())};this.SerialBtn=function(a,b){return this._InvokeMethod("SerialBtn",GetApspParam(a,b))};this.GetBtnStatus=function(a){return this._InvokeQueryMethod("GetBtnStatus",GetApspParam(a))};this.Configurate=function(a){return this._InvokeMethod("Configurate",GetApspParam(a))};this.GetConfiguration=function(){return this._InvokeQueryMethod("GetConfiguration","")};this.UnInitial=function(a){return this._InvokeMethod("UnInitial",a)};this.SetUIStyle=function(a){getLocalLanguage()==lg_zhcn?alert("\u6b64\u65b9\u6cd5\u65e0\u6548"):alert("invalidate Method")};this.GetVersion=function(){return this._InvokeQueryMethod("GetVersion","")};this.SetBusy=function(a){"undefined"==typeof a&&(a=0);return this._InvokeMethod("SetBusy",GetApspParam(a))};this.SetIdle=function(){return this._InvokeMethod("SetIdle","")};this.SetWrapUp=function(){return this._InvokeMethod("SetWrapUp","")};this.SetCTICalloutTask=function(a){return this._InvokeMethod("SetCTICalloutTask",GetApspParam(a))};this.GetCTICalloutTask=function(){return this._InvokeMethod("GetCTICalloutTask","")};this.GetCallData=function(a){return this._InvokeMethod("GetCallData",GetApspParam(a))};this.SetCallData=function(a,b){return this._InvokeMethod("SetCallData",GetApspParam(a,b))};this.GetTransfer=function(){return this._InvokeMethod("GetTransfer","")};this.SetTransfer=function(a,b,c){return this._InvokeMethod("SetTransfer",GetApspParam(a,b,c))};this.ChangeCallQueue=function(a,b,c){return this._InvokeMethod("ChangeCallQueue",GetApspParam(a,b,c))};this.GetCallID=function(){return this._InvokeMethod("GetCallID","")};this.QuerySPGroupList=function(a,b,c,g,d,e){"undefined"==typeof c&&(c="9");"undefined"==typeof g&&(g="0");this._realMethodName="QuerySPGroupList";return this._InvokeMethod("QueryCTIInfo",GetApspParam(c,a,b,g,d,e))};this.GetCallInfo=function(){return this._InvokeMethod("GetCallInfo","")};this.SetTransparentParameter=function(a){return this._InvokeMethod("SetTransparentParameter",GetApspParam(a))};this.GetAgentStatus=function(){return this._InvokeQueryMethod("GetAgentStatus","")};this.GetAgentSubBusyStatus=function(){return this._InvokeQueryMethod("GetAgentSubBusyStatus","")};this.GetBusySubStatus=function(){return this._InvokeQueryMethod("GetBusySubStatus","")};this.SetDisplayNumber=function(a){this._realMethodName="SetDisplayNumber";return this._InvokeMethod("SetCTIInfo",GetApspParam("8",a))};this.GetDisplayNumber=function(){this._realMethodName="GetDisplayNumber";return this._InvokeMethod("QueryCTIInfo",GetApspParam("21",""))};this.CallQueueQuery=function(a,b,c){return this._InvokeMethod("CallQueueQuery",GetApspParam(a,b,c))};this.QueryGroupAgentStatus=function(a,b,c,g){this._realMethodName="QueryGroupAgentStatus";return this._InvokeMethod("QueryCTIInfo",GetApspParam("22",a,b,c,g))};this.QueryPreViewCallOutNumbers=function(a,b,c,g){this._realMethodName="QueryGroupAgentStatus";return this._InvokeMethod("QueryCTIInfo",GetApspParam("23",a,b,c,g))};this.QueryMonitorSumInfo=function(a,b){return this._InvokeMethod("QueryMonitorSumInfo",GetApspParam(a,b))};this.GetBase64Data=function(a){return GetBase64FromGBK(a)};this.GetDataFromBase64=function(a){return GetGBKFromBase64(a)};this.SetWeChatQueueFlag=function(a){this._realMethodName="SetWeChatQueueFlag";return this._InvokeMethod("SetCTIInfo",GetApspParam("30",a))};this.GetWeChatQueueFlag=function(){this._realMethodName="SetWeChatQueueFlag";return this._InvokeMethod("QueryCTIInfo",GetApspParam("30",""))};this.TransferCallQueue=function(a,b,c){return this._InvokeMethod("TransferCallQueue",GetApspParam(a,b,c))};this.SetActiveService=function(a){this._realMethodName="SetActiveService";return this._InvokeMethod("SetCTIInfo",GetApspParam("26",a))};this.GetActiveService=function(){this._realMethodName="GetActiveService";return this._InvokeMethod("QueryCTIInfo",GetApspParam("26",""))};this.GetExitCause=function(){return this._InvokeQueryMethod("GetExitCause","")};this.SetForwardNumber=function(a,b){this._realMethodName="SetForwardNumber";return this._InvokeMethod("SetCTIInfo",GetApspParam("25",a,b))};this.GetForwardNumber=function(){this._realMethodName="GetForwardNumber";return this._InvokeMethod("QueryCTIInfo",GetApspParam("25",""))};this.SetAgentReservedStatus=function(a,b){this._realMethodName="SetAgentReservedStatus";return this._InvokeMethod("SetCTIInfo",GetApspParam("31",a,b))};this.SetMMService=function(a,b){this._realMethodName="SetMMService";return this._InvokeMethod("SetCTIInfo",GetApspParam("34",a,b))};this.GetAgentLogFile=function(a,b,c){this._realMethodName="GetAgentLogFile";return this._InvokeMethod("SetCTIInfo",GetApspParam("32",this.GetCtrlAttribute("AgentID"),a,b,c))};this.GetMonitorOffSetTime=function(){return parseInt(this._InvokeQueryMethod("GetMonitorOffSetTime",""))};this.MakeCall=function(a,b,c,g,d,e,f,n){b=getDefaultParam(b);""==b&&(b=CD_PREVIEW_CALLOUT);"undefined"==typeof c&&(c="");"undefined"==typeof g&&(g="");g=this.GetBase64Data(g);"undefined"==typeof d&&(d="");"undefined"==typeof e&&(e="");"undefined"==typeof f&&(f=0);if(""==a)return this._gfOnPrompt(4312),-1;"undefined"==typeof f&&(f=0);if(0==f&&(a=formatCallNum(a),!isPhoneNum(a,!0)))return this._gfOnPrompt(4313),-1;"undefined"==typeof n&&(n="");return this._InvokeMethod("MakeCall",GetApspParam(a,b,c,g,d,e,f,n))};this.CallIn=function(a,b,c,g){b=getDefaultParam(b);""==b&&(b=CD_AGENT_INSIDE_CALLOUT);"undefined"==typeof c&&(c="");"undefined"==typeof g&&(g="");g=this.GetBase64Data(g);return this._InvokeMethod("CallIn",GetApspParam(a,b,c,g))};this.TransferOut=function(a,b){return this._InvokeMethod("TransferOut",GetApspParam(a,b))};this.Hold=function(){return this._InvokeMethod("Hold","")};this.RetrieveHold=function(){return this._InvokeMethod("RetrieveHold","")};this.Disconnect=function(a){return this._InvokeMethod("Disconnect",GetApspParam(a))};this.Answer=function(a){return this._InvokeMethod("Answer",GetApspParam(a))};this.Consult=function(a,b){return this._InvokeMethod("Consult",GetApspParam(a,b))};this.Transfer=function(){return this._InvokeMethod("Transfer","")};this.Conference=function(){return this._InvokeMethod("Conference","")};this.SendDTMF=function(a){return this._InvokeMethod("SendDTMF",GetApspParam(a))};this.Bridge=function(a,b){return this._InvokeMethod("Bridge",GetApspParam(a,b))};this.Mute=function(a){return this._InvokeMethod("Mute",GetApspParam(a))};this.ReleaseThirdOne=function(a){return this._InvokeMethod("ReleaseThirdOne",GetApspParam(a))};this.ForceReset=function(){return this._InvokeMethod("ForceReset","")};this.SendIMMessage=function(a,b,c,g,d,e){return this._InvokeMethod("SendIMMessage",GetApspParam(a,b,c,g,d,e))};this.BeginPlay=function(a,b,c,g,d){return this._InvokeMethod("BeginPlay",GetApspParam(a,b,c,g,d))};this.StopPlay=function(a,b){return this._InvokeMethod("StopPlay",GetApspParam(a,b))};this.BeginCollect=function(a,b,c,g,d,e,f,n,q,t){return this._InvokeMethod("BeginCollect",GetApspParam(a,b,c,g,d,e,f,n,q,t))};this.StopCollect=function(a,b){return this._InvokeMethod("StopCollect",GetApspParam(a,b))};this.SendIMMessage2=function(a,b,c){"undefined"==typeof c&&(c="");c=this.GetBase64Data(c);return this._InvokeMethod("SendIMMessage2",GetApspParam(a,b,c))};this.WinCap=function(a,b,c){if("undefined"==typeof a||isNaN(a))a=1;"undefined"==typeof b&&(a=200);"undefined"==typeof c&&(c=1);return this._InvokeMethod("WinCap",GetApspParam(a,this.GetCtrlAttribute("MainIP"),b,c))};this.PopDlg=function(a,b,c,g){if("undefined"==typeof a||""==a)return-1;if("undefined"==typeof b||isNaN(b))b=0;if("undefined"==typeof c||isNaN(c))c=0;"undefined"==typeof g&&(g="");"MainSettingDlg"==a&&(g=this.GetBase64Data(g));return this._InvokeMethod("PopDLG",GetApspParam(a,b,c,g))};this.BeginRecord=function(a,b){return this._InvokeMethod("BeginRecord",GetApspParam(a,b))};this.StopRecord=function(a){return this._InvokeMethod("StopRecord",GetApspParam(a))};this.AlterNate=function(a){return this._InvokeMethod("AlterNate",GetApspParam(a))};this.CallBack=function(){return this._InvokeMethod("CallBack","")};this.ReCall=function(){return this._InvokeMethod("ReCall","")};this.SMMsg=function(a,b){return this._InvokeMethod("SMMsg",GetApspParam(a,b))};this.ForeReleaseCall=function(a,b){return this._InvokeMethod("ForeReleaseCall",GetApspParam(a,b))};this.Insert=function(a,b,c){return this._InvokeMethod("Insert",GetApspParam(a,b,c))};this.Listen=function(a,b,c){return this._InvokeMethod("Listen",GetApspParam(a,b,c))};this.Intercept=function(a,b,c){return this._InvokeMethod("Intercept",GetApspParam(a,b,c))};this.Help=function(a,b,c){return this._InvokeMethod("Help",GetApspParam(a,b,c))};this.Lock=function(a){return this._InvokeMethod("Lock",GetApspParam(a))};this.UnLock=function(a){return this._InvokeMethod("UnLock",GetApspParam(a))};this.ForceIdle=function(a){return this._InvokeMethod("ForceIdle",GetApspParam(a))};this.ForceBusy=function(a){return this._InvokeMethod("ForceBusy",GetApspParam(a))};this.ForceOut=function(a){return this._InvokeMethod("ForceOut",GetApspParam(a))};this.InitialState=function(){return this._InvokeMethod("InitialState","")};this.AgentQuery=function(a,b){return this._InvokeMethod("AgentQuery",GetApspParam(a,b))};this.TelQuery=function(a,b){return this._InvokeMethod("TelQuery",GetApspParam(a,b))};this.IvrQuery=function(a,b){return this._InvokeMethod("IvrQuery",GetApspParam(a,b))};this.TrunkQuery=function(a,b){return this._InvokeMethod("TrunkQuery",GetApspParam(a,b))};this.ServiceQuery=function(a,b){return this._InvokeMethod("ServiceQuery",GetApspParam(a,b,""))};this.TaskQuery=function(a,b){return this._InvokeMethod("TaskQuery",GetApspParam(a,b))};this.CallReportQuery=function(a,b){return this._InvokeMethod("CallReportQuery",GetApspParam(a,b))};this.GetTaskSummary=function(a,b){return this._InvokeMethod("GetTaskSummary",GetApspParam(a,b))};this.StartNotification=function(a,b,c){return this._InvokeMethod("StartNotification",GetApspParam(a,b,c))};this.EndNotification=function(a){return this._InvokeMethod("EndNotification",GetApspParam(a))};this.SendWeiboMsg=function(a){return this._InvokeMethod("SendWeiboMsg",GetApspParam(a))};this.UploadFileToMMS=function(a,b,c,g){return this._InvokeMethod("UploadFileToMMS",GetApspParam(a,b,c,g))};this.DownFileFromMMS=function(a,b,c,g,d){return this._InvokeMethod("DownFileFromMMS",GetApspParam(a,b,c,g,d))};this.SendWeChatMsg=function(a,b,c,g,d,e,f,n,q,t){e=GetBase64FromGBK(e);n=GetBase64FromGBK(n);q=GetBase64FromGBK(q);return this._InvokeMethod("SendWeChatMsg",GetApspParam(a,b,c,g,d,e,f,n,q,t))};this.QueryWeChatData=function(a,b,c,g,d,e,f){return this._InvokeMethod("QueryWeChatData",GetApspParam(a,b,c,g,d,e,f))};this.QueryWeChatHistory=function(a,b,c,g,d,e,f){return this._InvokeMethod("QueryWeChatHistory",GetApspParam(a,b,c,g,d,e,f))};this.GetWeChatParam=function(a){return this._InvokeMethod("GetWeChatParam",GetApspParam(a))};this.OnMonitorControlLoad=function(){};this.OnMethodResponseEvent=function(a,b){};this.Destory=function(){this._contentWindow==this._window?this._contentWindow.document.body.removeChild(this.oMonitorShow):this._contentWindow.removeChild(this.oMonitorShow)};this.Display=function(a){1==a?this.Refresh():(this.oMonitorShow.style.left="0px",this.oMonitorShow.style.top="0px",this.oMonitorShow.style.width="0px",this.oMonitorShow.style.height="0px")};this.Refresh=function(){null!=this.oSL_MonShow&&(this.oSL_MonShow.style.left=this.left,this.oSL_MonShow.style.top=this.top,this.oSL_MonShow.style.width=this.width,this.oSL_MonShow.style.height=this.height);this.Resize(this.left,this.top,this.width,this.height)};this.Resize=function(a,b,c,g){this.left="number"==typeof a?a:0;this.top="number"==typeof b?b:0;this.width=0<=c?c:100;this.height=0<=g?g:100;this.oMonitorShow.style.left=this.left+"px";this.oMonitorShow.style.top=this.top+"px";this.oMonitorShow.style.width=this.width+"px";this.oMonitorShow.style.height=this.height+"px"};return this}function onSilverlightBarError(a,b){var c="";null!=a&&0!=a&&(c=a.getHost().Source);var d=b.ErrorType,e=b.ErrorCode;if("ImageError"!=d&&"MediaError"!=d)throw c="Unhandled Error in Silverlight Application "+c+"\n"+("Code: "+e+"    \n"),c+="Category: "+d+"       \n",c+="Message: "+b.ErrorMessage+"     \n","ParserError"==d?(c+="File: "+b.xamlFile+"     \n",c+="Line: "+b.lineNumber+"     \n",c+="Position: "+b.charPosition+"     \n"):"RuntimeError"==d&&(0!=b.lineNumber&&(c+="Line: "+b.lineNumber+"     \n",c+="Position: "+b.charPosition+"     \n"),c+="MethodName: "+b.methodName+"     \n"),Error(c);}function SilverlightPluginBarLoaded(){null!=G_oSiverlightCtrl&&G_oSiverlightCtrl._GetAppMainPage()}function OnSLEventFunction(a,b){null!=G_oSiverlightCtrl&&G_oSiverlightCtrl._invokeEventReport(a,b)}function OnSLResponseFunction(a,b){null!=G_oSiverlightCtrl&&G_oSiverlightCtrl._invokeResponseReport(a,b)}function JVccBar(a,b,c,d,e,f){this.left=a;this.top=b;this.width=c;this.height=d;this.showstyle=e;this._contentWindow=null==f?window:f;this.id="oBar_"+Math.ceil(100*Math.random());this.name=this.id+"_Ctrl";this.oMonitorDataManager=this.oBarControl=null;this.userBtnIds="";this.workStatus=-1;this.oMonitorCtrl=this.oBarCtrl=this.oBarShow=null;this.errDescription="";this._appType=-1;this._createObject=function(){null==this.oBarControl&&(this.oBarControl=new CHtmlBarControl(getLocalLanguage()));switch(this.showstyle){case showStyleOCX:"msie"!=application.oBrowserSys.os&&alert("\u53ea\u6709IE\u6d4f\u89c8\u5668\u624d\u80fd\u4f7f\u7528OCX\u63a7\u4ef6!");this.oBarCtrl=new JOcxCtrl(this.left,this.top,this.width,this.height,1,this._contentWindow);this.oBarCtrl.oParent=this;break;case showStyleSL:this.height=this.width=0;this.oBarCtrl=new JSilverLightCtrl(this.left,this.top,this.width,this.height,application.GetRelationPath()+"cab/",this._contentWindow);break;case showStyleJS:this.oBarCtrl=new JHTML5Ctrl;break;default:application.IsSurpportWebSocket()?this.oBarCtrl=new JHTML5Ctrl:(this.height=this.width=0,this.oBarCtrl=new JSilverLightCtrl(this.left,this.top,this.width,this.height,application.GetRelationPath()+"cab/",this._contentWindow))}this.SetAttribute("AgentType",0);this.SetAttribute("PassWord","111111");this.SetAttribute("MainPortID",14800);this.SetAttribute("BackPortID",14800);this.SetAttribute("TaskID","0");this.SetAttribute("MonitorPort",4502);this.SetAttribute("AppType",0);this.SetAttribute("SipServerPort",5060);this.SetAttribute("SipPassWord","00000000");this.SetAttribute("SipProtocol","UDP");this.SetAttribute("SipPassWdCryptType",0);this.SetAttribute("SipAuthType",1);this.SetAttribute("PhonType",0);this.SetAttribute("SelfPrompt",0);this.SetAttribute("forceEndProcess",g_DebugFlag);this.SetAttribute("LocalPort",4520);this.oBarCtrl.oParent=this;this.oBarCtrl.attachEventfun(this._eventFunction);this.oBarCtrl.attachResponsefun(this._responseFunction)};this._responseFunction=function(a,b){DisplayLog(VccBar_Log_Debug,"JVccBar:OnMethodResponseEvent(cmdName:\u3010"+a+"\u3011 param: \u3010"+b+"\u3011)");"GetWeChatParam"==a?null!=application.oWechatManager&&application.oWechatManager.SetUserInfo(b):"Initial"==a&&"-2"==b&&(getLocalLanguage()==lg_zhcn?alert("\u7248\u672c\u4e0d\u5339\u914d\uff0c\u8bf7\u66f4\u65b0\u7248\u672c\u518d\u4f7f\u7528!"):alert("dismatch version\uff0cplease update new version!"));application.oJVccBar.OnMethodResponseEvent(a,b);var c=this.oParent;null!=c.oMonitorDataManager&&("InitialState"!=a&&"AgentQuery"!=a&&"TelQuery"!=a&&"IvrQuery"!=a&&"TrunkQuery"!=a&&"ServiceQuery"!=a&&"TaskQuery"!=a&&"CallReportQuery"!=a&&"GetTaskSummary"!=a&&"QueryMonitorSumInfo"!=a&&"StartNotification"!=a&&"EndNotification"!=a||c.oMonitorDataManager.__OnMonitorMethodResponseEvent(a,b))};this._eventFunction=function(a,b){var c=this.oParent;if(null==b||"undefined"==typeof b)b="";var d;try{d=b.split("|")}catch(e){}DisplayLog(VccBar_Log_Debug,"JVccBar:_eventFunction(cmdIndex\x3d"+a+",param\x3d"+b+")");switch(a){case eventOnCallRing:null!=c.oBarShow&&c.oBarShow.SetRingFlag(1);application.oJVccBar.OnCallRing(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],d[9],d[10],d[11],d[12],d[13],d[14],d[15],d[16],getDefaultParamValue(d[17],""),getDefaultParamValue(d[18],""));break;case eventOnAnswerCall:null!=c.oBarShow&&c.oBarShow.SetRingFlag(0);application.oJVccBar.AnswerCall(d[0],d[1],d[2],d[3],d[4],d[5],d[6]);break;case eventOnCallEnd:null!=c.oBarShow&&c.oBarShow.SetRingFlag(0);application.oJVccBar.OnCallEnd(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],d[9],d[10],d[11],d[12],d[13],d[14]);break;case eventOnPrompt:var f=d[0],l=d[1];4316==f&&(l=c.oBarControl.GetErrorItemDes(f)+l);4004==f&&(l=l+":"+c.oBarControl.GetErrorItemDes(l));""==l&&(l=c.oBarControl.GetErrorItemDes(f));4012==f&&(l=stringFormat(l,c.GetAttribute("TaskID")));1==c.GetAttribute("SelfPrompt")&&null!=application.oJVccBar.oBarShow?c.oBarShow.ShowSelfPrompt(f,l):4411==f?c.OnPrompt(f,l+c.errDescription):c.OnPrompt(f,l);4409==f&&null!=c.oMonitorDataManager&&c.oMonitorDataManager.__OnAgentMonitorSignIn();if(4001==f||4002==f||4003==f||4013==f||4014==f||4015==f||4012==f)getLocalLanguage()==lg_zhcn?c.errDescription=" \u539f\u56e0\uff1a"+f+":"+l:c.errDescription=" cause\uff1a"+f+":"+l;4004==f&&(getLocalLanguage()==lg_zhcn?c.errDescription=" \u539f\u56e0\uff1a"+l:c.errDescription=" cause\uff1a"+l);4316==f&&(getLocalLanguage()==lg_zhcn?c.errDescription=" \u539f\u56e0\uff1a"+l:c.errDescription=" cause\uff1a"+l);break;case eventOnReportBtnStatus:c.userBtnIds=b;null!=c.oBarShow&&(c.oBarShow.ChangeBtnStatus(b),c.oBarShow.SetAgentStatus(c.GetAgentStatus()));null!=c.oMonitorCtrl&&c.oMonitorCtrl.SetReportBtnStatus(b,c.GetAgentStatus());c.OnReportBtnStatus(b);c.OnAgentStatus(c.GetAgentStatus());break;case eventOnInitalSuccess:null!=c.oBarShow&&(c.oBarShow.SetSubBusyStatus(c.GetBusySubStatus()),c.oBarShow.SetSubBusySelectedItem(c.GetAgentSubBusyStatus()));c.OnInitalSuccess();break;case eventOnInitalFailure:c.OnInitalFailure(d[0],d[1]+c.errDescription);c.errDescription="";break;case eventOnEventPrompt:c.OnEventPrompt(d[0],d[1]);break;case eventOnAgentWorkReport:c.workStatus=parseInt(d[0]);"-1"==d[0]&&null!=c.oBarShow&&(c.oBarShow.SetSubBusyStatus(""),c.oBarShow.SetAgentStatus(c.GetAgentStatus()));null!=c.oMonitorCtrl&&c.oMonitorCtrl.SetAgentWorkReport(c.GetAttribute("AgentID"),c.GetAgentStatus(),parseInt(d[0]));c.OnAgentWorkReport(d[0],d[1]);break;case eventOnCallDataChanged:c.OnCallDataChanged(b);break;case eventOnBarExit:l=c.oBarControl.GetErrorItemDes(d[0]);""==l&&(l=d[1]);c.OnBarExit(d[0],l);null!=c.oMonitorDataManager&&c.oMonitorDataManager.__OnAgentMonitorSignOut("");break;case eventOnCallQueueQuery:c.OnCallQueueQuery(b);break;case eventOnQueryGroupAgentStatus:d=b.split("@");f="0";1<d.length&&(f=d[1]);c.OnQueryGroupAgentStatus(d[0],f);break;case eventOnSystemMessage:c.OnSystemMessage(d[0],getSubString(b,"|",""));break;case eventOnRecvWeiboMsg:c.OnRecvWeiboMsg(b);break;case eventOnIMMessage:c.OnIMMessage(d[0],d[1]);break;case eventOnRecvWeChatMessage:null!=application.oWechatManager&&application.oWechatManager.OnSaveRecvMessageReport(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],d[9],d[10],d[11],d[12],d[13]);c.OnRecvWeChatMessage(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],d[9],d[10],d[11],d[12],d[13]);break;case eventOnSendWeChatMsgReport:null!=application.oWechatManager&&application.oWechatManager.OnSaveSendMessageReport(d[0],d[1],d[2],d[3],d[4],d[5]);c.OnSendWeChatMsgReport(d[0],d[1],d[2],d[3],d[4],d[5]);break;case eventOnUploadFileToMMSReport:null!=application.oWechatManager&&application.oWechatManager.OnInvokeUploadFileToMMSReport(d[0],d[1],d[2]);c.OnUploadFileToMMSReport(d[0],d[1],d[2],d[3],d[4],d[5]);break;case eventOnDownloadFileToMMSReport:null!=application.oWechatManager&&application.oWechatManager.OnInvokeDownFileFromMMSReport(d[0],d[1],d[2],d[3]);c.OnDownloadFileToMMSReport(d[0],d[1],d[2],d[3]);break;case eventOnWorkStaticInfoReport:c.OnWorkStaticInfoReport(b);break;case eventOnAQueryCTIInfoReport:c.OnQuerySPGroupList(d[0],getSubString(b,"|",""));break;case eventOnAgentBusyReasonReport:null!=c.oBarShow&&c.oBarShow.SetSubBusySelectedItem(c.GetAgentSubBusyStatus());c.OnAgentBusyReason(d[0],getSubString(b,"|",""));break;case eventOnAgentLogUploadReport:c.OnAgentLogUpload(d[0],d[1],d[2],d[3],d[4],d[5]);break;case eventOnAgentReport:c.OnAgentReport(b);null!=c.oMonitorDataManager&&c.oMonitorDataManager.__OnAgentReport(b);break;case eventOnTelReport:c.OnTelReport(b);null!=c.oMonitorDataManager&&c.oMonitorDataManager.__OnTelReport(b);break;case eventOnServiceReport:c.OnServiceReport(b);null!=c.oMonitorDataManager&&c.oMonitorDataManager.__OnServiceReport(b);break;case eventOnIvrReport:c.OnIvrReport(b);null!=c.oMonitorDataManager&&c.oMonitorDataManager.__OnIvrReport(b);break;case eventOnTaskReport:c.OnTaskReport(b);null!=c.oMonitorDataManager&&c.oMonitorDataManager.__OnTaskReport(b);break;case eventOnOutboundReport:c.OnOutboundReport(b);null!=c.oMonitorDataManager&&c.oMonitorDataManager.__OnOutboundReport(b);break;case eventOnCallReportInfo:c.OnCallReportInfo(b);null!=c.oMonitorDataManager&&c.oMonitorDataManager.__OnCallReportInfo(b);break;case eventOnQueueReport:c.OnQueueReport(b);break;case eventOnAsrEventReport:c.OnAsrEventReport(d[0],d[1],d[2],d[3]);break;case eventOnQueryMonitorSumReport:c.OnQueryMonitorSumReport(d[0],d[1]);null!=c.oMonitorDataManager&&c.oMonitorDataManager.__OnQueryMonitorSumReport(d[0],d[1]);break;case eventOnWallServiceReport:c.OnWallServiceReport(b);null!=c.oMonitorDataManager&&c.oMonitorDataManager.__OnWallServiceReport(b);break;case eventOnWallQueueReport:c.OnWallQueueReport(b);null!=c.oMonitorDataManager&&c.oMonitorDataManager.__OnWallQueueReport(b);break;case eventOnServiceStaticReport:c.OnServiceStaticReport(b);null!=c.oMonitorDataManager&&c.oMonitorDataManager.__OnServiceStaticReport(b);break;case eventOnAgentStaticReport:c.OnAgentStaticReport(b);null!=c.oMonitorDataManager&&c.oMonitorDataManager.__OnAgentStaticReport(b);break;case eventOnTrunkReport:c.OnTrunkReport(b);null!=c.oMonitorDataManager&&c.oMonitorDataManager.__OnTrunkReport(b);break;case eventOnTrunkSumReport:c.OnTrunkSumReport(b);null!=c.oMonitorDataManager&&c.oMonitorDataManager.__OnTrunkSumReport(b);break;case eventOnGetVersionReport:c.OnGetVersionReport(c.GetVersion());break;case eventOnWebsocketSocket:this.GetBarType()==vccBarTypeSILVERLIGHT?(f=d[0],1==f?DisplayLog(VccBar_Log_Protocol,d[1]):2==f?DisplayLog(VccBar_Log_Info,d[1]):4==f?DisplayLog(VccBar_Log_Warn,d[1]):8==f?DisplayLog(VccBar_Log_Error,d[1]):c._inlineOnPrompt(d)):c._inlineOnPrompt(d)}};this._inlineOnPrompt=function(a){var b=a[0],c=a[1];"3000"==a[0]||"3100"==a[0]?c=stringFormat(this.oBarControl.GetErrorItemDes(a[0]),a[1],a[2],a[3]):""==c&&(c=this.oBarControl.GetErrorItemDes(a[0]));1==this.GetAttribute("SelfPrompt")&&null!=this.oBarShow?this.oBarShow.ShowSelfPrompt(b,c):this.OnPrompt(b,c)};this.SetAttribute=function(a,b){"AppType"==a?this._appType=b:"AutoUpdateURL"==a&&""!=b&&(b="/"==b.charAt(b.length-1)?b+"JVccBar/version/update":b+"/JVccBar/version/update");this.oBarCtrl.SetCtrlAttribute(a,b)};this.GetAttribute=function(a){return this.oBarCtrl.GetCtrlAttribute(a)};this.Initial=function(){return 0==this._appType?this.oBarCtrl.Initial():1==this._appType?(alert("\u5355\u72ec\u76d1\u63a7\u8bf7\u4e0d\u8981\u4f7f\u7528\u7535\u8bdd\u6761\u65b9\u5f0f!"),0):2==this._appType?this.oBarCtrl.Initial():-1};this.SerialBtn=function(a,b){null!=this.oBarShow&&this.oBarShow.SerialBtn(a,b);return this.oBarCtrl.SerialBtn(a,b)};this.GetBtnStatus=function(a){return this.userBtnIds};this.Configurate=function(a){return this.oBarCtrl.Configurate(a)};this.GetConfiguration=function(){return this.oBarCtrl.GetConfiguration()};this.UnInitial=function(a){"undefined"==typeof a&&(a=0);return this.oBarCtrl.UnInitial(a)};this.SetUIStyle=function(a){return this.oBarCtrl.SetUIStyle(a)};this.GetVersion=function(){return g_JsVersion+"."+g_JsVersionTimer+"("+this.oBarCtrl.GetVersion()+")"};this.SetBusy=function(a){return this.oBarCtrl.SetBusy(a)};this.SetIdle=function(){return this.oBarCtrl.SetIdle()};this.SetWrapUp=function(){var a=this.GetAgentStatus();return 1==a||2==a?this.oBarCtrl.SetWrapUp():-1};this.SetCTICalloutTask=function(a){return this.oBarCtrl.SetCTICalloutTask(a)};this.GetCTICalloutTask=function(){return this.oBarCtrl.GetCTICalloutTask()};this.GetCallData=function(a){return this.oBarCtrl.GetCallData(a)};this.SetCallData=function(a,b){return this.oBarCtrl.SetCallData(a,b)};this.GetTransfer=function(){return this.oBarCtrl.GetTransfer()};this.SetTransfer=function(a,b,c){return this.oBarCtrl.SetTransfer(a,b,c)};this.ChangeCallQueue=function(a,b,c){return this.oBarCtrl.ChangeCallQueue(a,b,c)};this.GetCallID=function(){return this.oBarCtrl.GetCallID()};this.QuerySPGroupList=function(a,b,c,d,e,f){"undefined"==typeof e&&(e=2);"undefined"==typeof f&&(f=0);return this.oBarCtrl.QuerySPGroupList(a,b,c,d,e,f)};this.GetCallInfo=function(){return this.oBarCtrl.GetCallInfo()};this.SetTransparentParameter=function(a){return this.oBarCtrl.SetTransparentParameter(a)};this.GetAgentStatus=function(){return this.oBarCtrl.GetAgentStatus()};this.GetAgentSubBusyStatus=function(){return this.oBarCtrl.GetAgentSubBusyStatus()};this.GetBusySubStatus=function(){return this.oBarCtrl.GetBusySubStatus()};this.SetDisplayNumber=function(a){return this.oBarCtrl.SetDisplayNumber(a)};this.GetDisplayNumber=function(){return this.oBarCtrl.GetDisplayNumber()};this.CallQueueQuery=function(a,b,c){"undefined"==typeof b&&(b=2);"undefined"==typeof c&&(c=0);return this.oBarCtrl.CallQueueQuery(a,b,c)};this.QueryGroupAgentStatus=function(a,b,c,d){"undefined"==typeof d&&(d=0);return this.oBarCtrl.QueryGroupAgentStatus(a,b,c,d)};this.QueryPreViewCallOutNumbers=function(a,b,c,d){return this.oBarCtrl.QueryPreViewCallOutNumbers(a,b,c,d)};this.GetBase64Data=function(a){return this.oBarCtrl.GetBase64Data(a)};this.GetDataFromBase64=function(a){return this.oBarCtrl.GetDataFromBase64(a)};this.SetWeChatQueueFlag=function(a){return this.oBarCtrl.SetWeChatQueueFlag(a)};this.GetWeChatQueueFlag=function(){return this.oBarCtrl.GetWeChatQueueFlag()};this.TransferCallQueue=function(a,b,c){return this.oBarCtrl.TransferCallQueue(a,b,c)};this.SetActiveService=function(a){return this.oBarCtrl.SetActiveService(a)};this.GetActiveService=function(){return this.oBarCtrl.GetActiveService()};this.GetExitCause=function(){return this.oBarCtrl.GetExitCause()};this.SetForwardNumber=function(a,b){return this.oBarCtrl.SetForwardNumber(a,b)};this.GetForwardNumber=function(){return this.oBarCtrl.GetForwardNumber()};this.SetAgentReservedStatus=function(a,b){return this.oBarCtrl.SetAgentReservedStatus(a,b)};this.SetMMService=function(a,b){return this.oBarCtrl.SetMMService(a,b)};this.GetAgentWorkStatus=function(){return this.workStatus};this.GetMonitorStatus=function(){return 2==this._appType||1==this._appType?-1!=this.GetAgentWorkStatus():!1};this.GetMonitorTimeOffSet=function(){return this.oBarCtrl.GetMonitorOffSetTime()};this.GetAgentLogFile=function(a,b,c){a=getDefaultParam(a);if(""==a)return-1;"undefined"==typeof c&&(c=0);b=getDefaultParam(b);return this.oBarCtrl.GetAgentLogFile(a,c,b)};this.MakeCall=function(a,b,c,d,e,f,k,p){return this.oBarCtrl.MakeCall(a,b,c,d,e,f,k,p)};this.CallIn=function(a,b,c,d){return this.oBarCtrl.CallIn(a,b,c,d)};this.TransferOut=function(a,b){return this.oBarCtrl.TransferOut(a,b)};this.Hold=function(){return this.oBarCtrl.Hold()};this.RetrieveHold=function(){return this.oBarCtrl.RetrieveHold()};this.Disconnect=function(a){return this.oBarCtrl.Disconnect(a)};this.Answer=function(a){"undefined"==typeof a&&(a=0);return this.oBarCtrl.Answer(a)};this.Consult=function(a,b){return this.oBarCtrl.Consult(a,b)};this.Transfer=function(){return this.oBarCtrl.Transfer()};this.Conference=function(){return this.oBarCtrl.Conference()};this.SendDTMF=function(a){return this.oBarCtrl.SendDTMF(a)};this.BeginRecord=function(a,b){return this.oBarCtrl.BeginRecord(a,b)};this.StopRecord=function(a){return this.oBarCtrl.StopRecord(a)};this.BeginPlay=function(a,b,c,d,e){return this.oBarCtrl.BeginPlay(a,b,c,d,e)};this.StopPlay=function(a,b){return this.oBarCtrl.StopPlay(a,b)};this.Bridge=function(a,b){return this.oBarCtrl.Bridge(a,b)};this.Mute=function(a){return this.oBarCtrl.Mute(a)};this.AlterNate=function(a){return this.oBarCtrl.AlterNate(a)};this.CallBack=function(){return this.oBarCtrl.CallBack()};this.ReCall=function(){return this.oBarCtrl.ReCall()};this.SMMsg=function(a,b){return this.oBarCtrl.SMMsg(a,b)};this.ReleaseThirdOne=function(a){return this.oBarCtrl.ReleaseThirdOne(a)};this.BeginCollect=function(a,b,c,d,e,f,k,p,n,q){return this.oBarCtrl.BeginCollect(a,b,c,d,e,f,k,p,n,q)};this.StopCollect=function(a,b){return this.oBarCtrl.StopCollect(a,b)};this.ForceReset=function(){return this.oBarCtrl.ForceReset()};this.SendIMMessage=function(a,b,c,d,e,f){return this.oBarCtrl.SendIMMessage(a,b,c,d,e,f)};this.SendIMMessage2=function(a,b,c){return this.oBarCtrl.SendIMMessage2(a,b,c)};this.WinCap=function(a,b,c){return this.oBarCtrl.WinCap(a,b,c)};this.PopDlg=function(a,b,c,d){return this.GetJVccBarType()!=vccBarTypeOCX?this.oBarCtrl.PopDlg(a,b,c,d):-1};this.ForeReleaseCall=function(a,b){return this.oBarCtrl.ForeReleaseCall(a,b)};this.Insert=function(a,b,c){"undefined"==typeof b&&(b=0);"undefined"==typeof c&&(c="");return this.oBarCtrl.Insert(a,b,c)};this.Listen=function(a,b,c){"undefined"==typeof b&&(b=0);"undefined"==typeof c&&(c="");return this.oBarCtrl.Listen(a,b,c)};this.Intercept=function(a,b,c){"undefined"==typeof b&&(b=0);"undefined"==typeof c&&(c="");return this.oBarCtrl.Intercept(a,b,c)};this.Lock=function(a){return this.oBarCtrl.Lock(a)};this.UnLock=function(a){return this.oBarCtrl.UnLock(a)};this.ForceIdle=function(a){return this.oBarCtrl.ForceIdle(a)};this.ForceBusy=function(a){return this.oBarCtrl.ForceBusy(a)};this.ForceOut=function(a){return this.oBarCtrl.ForceOut(a)};this.Help=function(a,b,c){"undefined"==typeof b&&(b=0);"undefined"==typeof c&&(c="");return this.oBarCtrl.Help(a,b,c)};this.InitialState=function(){return this.oBarCtrl.InitialState()};this.AgentQuery=function(a,b){return this.oBarCtrl.AgentQuery(a,b)};this.TelQuery=function(a,b){return this.oBarCtrl.TelQuery(a,b)};this.IvrQuery=function(a,b){return this.oBarCtrl.IvrQuery(a,b)};this.ServiceQuery=function(a,b){return this.oBarCtrl.ServiceQuery(a,b)};this.TaskQuery=function(a,b){return this.oBarCtrl.TaskQuery(a,b)};this.CallReportQuery=function(a,b){return this.oBarCtrl.CallReportQuery(a,b)};this.GetTaskSummary=function(a,b){return this.oBarCtrl.GetTaskSummary(a,b)};this.QueryMonitorSumInfo=function(a,b){return this.oBarCtrl.QueryMonitorSumInfo(a,b)};this.StartNotification=function(a,b,c){return this.oBarCtrl.StartNotification(a,b,c)};this.EndNotification=function(a){return this.oBarCtrl.EndNotification(a)};this.TrunkQuery=function(a,b){return this.oBarCtrl.TrunkQuery(a,b)};this.SendWeiboMsg=function(a){return this.oBarCtrl.SendWeiboMsg(a)};this.UploadFileToMMS=function(a,b,c,d){return this.oBarCtrl.UploadFileToMMS(a,b,c,d)};this.DownFileFromMMS=function(a,b,c,d,e){return this.oBarCtrl.DownFileFromMMS(a,b,c,d,e)};this.SendWeChatMsg=function(a,b,c,d,e,f,k,p,n,q){null!=application.oWechatManager&&application.oWechatManager.SaveSendMessage(a,b,c,d,e,f,k,p,n,q);return this.oBarCtrl.SendWeChatMsg(a,b,c,d,e,f,k,p,n,q)};this.QueryWeChatData=function(a,b,c,d,e,f,k){return this.oBarCtrl.QueryWeChatData(a,b,c,d,e,f,k)};this.QueryWeChatHistory=function(a,b,c,d,e,f,k){return this.oBarCtrl.QueryWeChatHistory(a,b,c,d,e,f,k)};this.GetWeChatParam=function(a){return this.oBarCtrl.GetWeChatParam(a)};this.OnCallRing=function(a,b,c,d,e,f,k,p,n,q,t,u,v,x,y,z,A,B,C){};this.AnswerCall=function(a,b,c,d,e,f,k){};this.OnCallEnd=function(a,b,c,d,e,f,k,p,n,q,t,u,v,x,y){};this.OnPrompt=function(a,b){};this.OnReportBtnStatus=function(a){};this.OnInitalSuccess=function(){};this.OnInitalFailure=function(a,b){};this.OnEventPrompt=function(a,b){};this.OnAgentWorkReport=function(a,b){};this.OnCallDataChanged=function(a){};this.OnBarExit=function(a,b){};this.OnCallQueueQuery=function(a){};this.OnQueryGroupAgentStatus=function(a,b){};this.OnSystemMessage=function(a,b){};this.OnRecvWeiboMsg=function(a){};this.OnIMMessage=function(a,b){};this.OnRecvWeChatMessage=function(a,b,c,d,e,f,k,p,n,q,t,u,v,x){};this.OnSendWeChatMsgReport=function(a,b,c,d,e,f){};this.OnUploadFileToMMSReport=function(a,b,c,d,e,f){};this.OnDownloadFileToMMSReport=function(a,b,c,d){};this.OnWorkStaticInfoReport=function(a){};this.OnQueueReport=function(a){};this.OnQuerySPGroupList=function(a,b){};this.OnAgentBusyReason=function(a,b){};this.OnAgentStatus=function(a){};this.OnAgentLogUpload=function(a,b,c,d,e,f){};this.OnAsrEventReport=function(a,b,c,d){};this.OnGetVersionReport=function(a){};this.OnAgentReport=function(a){};this.OnTelReport=function(a){};this.OnServiceReport=function(a){};this.OnIvrReport=function(a){};this.OnTaskReport=function(a){};this.OnOutboundReport=function(a){};this.OnCallReportInfo=function(a){};this.OnQueryMonitorSumReport=function(a,b){};this.OnWallServiceReport=function(a){};this.OnWallQueueReport=function(a){};this.OnServiceStaticReport=function(a){};this.OnAgentStaticReport=function(a){};this.OnTrunkReport=function(a){};this.OnTrunkSumReport=function(a){};this.OnMethodResponseEvent=function(a,b){};this.SetInlineShowBar=function(a){this.oBarShow=a;null!=this.oBarShow&&this.oBarCtrl.SerialBtn(this.oBarShow._btnIDs)};this.SetMonitorCtrl=function(a){this.oMonitorCtrl=a};this.SetMonitorData=function(a){this.oMonitorDataManager=a};this.SetAsynMethod=function(a){this.GetJVccBarType()==vccBarTypeOCX&&this.oBarCtrl.GetBarCtrl().SetAsysMode(a)};this.GetAsynMethod=function(){return this.GetJVccBarType()!=vccBarTypeHTML5?this.oBarCtrl.GetBarCtrl().GetAsysMode():1};this.GetBarCtrl=function(){return this.oBarCtrl.GetBarCtrl()};this.GetJVccBarType=function(){return this.oBarCtrl.GetBarType()};this.GetCloneParam=function(){var a=Array(16);a[0]=this.GetAttribute("MainIP");a[1]=this.GetAttribute("MainPortID");a[2]=this.GetAttribute("BackIP");a[3]=this.GetAttribute("BackPortID");a[4]=this.GetAttribute("MonitorIP");a[5]=this.GetAttribute("MonitorPort");a[6]=this.GetAttribute("SipServerIP");a[7]=this.GetAttribute("SipServerPort");a[8]=this.GetAttribute("SipProtocol");a[9]=this.GetAttribute("SipPassWord");a[10]=this.GetAttribute("PhonType");a[11]=this.GetAttribute("AppType");a[12]=this.GetAttribute("PassWord");a[13]=this.GetAttribute("MediaFlag");a[14]=this.GetAttribute("AgentID");a[15]=this.GetAttribute("Dn");return a.join("|")};this.SetCloneParam=function(a){a=a.split("|");return 16==a.length?(this.SetAttribute("MainIP",a[0]),this.SetAttribute("MainPortID",parseInt(a[1])),this.SetAttribute("BackIP",a[2]),this.SetAttribute("BackPortID",parseInt(a[3])),this.SetAttribute("MonitorIP",a[4]),this.SetAttribute("MonitorPort",parseInt(a[5])),this.SetAttribute("SipServerIP",a[6]),this.SetAttribute("SipServerPort",parseInt(a[7])),this.SetAttribute("SipProtocol",a[8]),this.SetAttribute("SipPassWord",a[9]),this.SetAttribute("PhonType",parseInt(a[10])),this.SetAttribute("AppType",parseInt(a[11])),this.SetAttribute("PassWord",a[12]),this.SetAttribute("MediaFlag",a[13]),this.SetAttribute("AgentID",a[14]),this.SetAttribute("Dn",a[15]),!0):!1};this.Display=function(a){null!=this.oBarShow&&(this.oBarShow.style.display=1==a?"block":"none")};this._createObject();return this}var appVccBar=null;function applicationUILoad(a,b,c,d,e,f){null==appVccBar&&("undefined"==typeof e&&(e=""),"undefined"==typeof f&&(f=null),loadJCssFile(e+"scripts/ui/css/lightgreen/vccbar.css","VCCBAR_CSS"),setTimeout(function(){createVccBar(a,b,c,d,f)},1E3))}function createVccBar(a,b,c,d,e){appVccBar=new JVccBarCtrl(a,b,c,d,"appVccBar",window);e&&e()}function SetUIStyle(a,b){loadJCssFile(a+"scripts/ui/css/"+b+"/vccbar.css","VCCBAR_CSS");appVccBar.SetUIStyle(b)}function loadJCssFile(a,b){var c=document.getElementsByTagName("HEAD").item(0);if(null!=c){var d=document.getElementById(b);null!=d?d.setAttribute("href",a):(d=document.createElement("link"),d.setAttribute("rel","stylesheet"),d.setAttribute("type","text/css"),d.setAttribute("href",a),d.setAttribute("id",b),c.appendChild(d))}}var application=null,showStyleNONE=0,showStyleOCX=1,showStyleJS=2,showStyleAUTTO=3,showStyleSL=4,vccBarTypeOCX=0,vccBarTypeHTML5=1,vccBarTypeSILVERLIGHT=2,vccBarTypePUREJS=3;function applicationLoad(a,b,c,d,e,f,g){null==application&&("undefined"==typeof f&&(f=""),application=new JApplication(a,b,c,d,e,f),application.onLoad=g,setTimeout(createBar,1E3))}function applicationUnLoad(a){null!=application&&(null!=application.oJVccBar&&application.oJVccBar.UnInitial(a),null!=application.oJMonitor&&(delete application.oJMonitor,application.oJMonitor=null),null!=application.oJBarDisplayer&&(delete application.oJBarDisplayer,application.oJBarDisplayer=null),delete application,application=null)}function createBar(){application.oJVccBar=new JVccBar(application.left,application.top,application.width,application.height,application.showstyle,null);application.CreateBarDisplay();application.oJVccBar.SetInlineShowBar(application.oJBarDisplayer);application.InitAssist();if(application.onLoad)application.onLoad()}function JApplication(a,b,c,d,e,f){this.oBrowserSys=this.onLoad=this.oVccBarAssist=this.oWechatManager=this.oJMonitorData=this.oWecharCtrl=this.oJBarDisplayer=this.oJMonitor=this.oJVccBar=null;this.RelationPath=f;this.left=a;this.top=b;this.width=c;this.height=d;this.showstyle=e;this.surpportWebsocket=!1;this._contentWindow=window;this.CreateBarDisplay=function(){if(this.showstyle==showStyleJS||this.showstyle==showStyleAUTTO)this.IsSurpportWebSocket(),this.oJBarDisplayer=new JVccBarEasyUICtrl(this.left,this.top,this.width,this.height,this._contentWindow)};this.InitAssist=function(){this.oWechatManager=new JWechChatManager;this.oVccBarAssist=new JVccBarAssist};this.InitMonitorDataManager=function(){this.oJMonitorData=new JcmMonitorManager(application.oJVccBar)};this.BindMonitorBarToEachOther=function(a){try{a="undefined"==typeof a?this.oJMonitor:a,null==a?alert("\u76d1\u63a7\u63a7\u4ef6\u6ca1\u6709\u521d\u59cb\u5316!"):(a.SetVccBarCtrl(this.oJVccBar),this.oJVccBar.SetMonitorCtrl(a))}catch(b){alert(b.message)}};this.GetRelationPath=function(){return this.RelationPath};this.IsSurpportWebSocket=function(){return this.surpportWebsocket};this.Log=function(a){this.OnDebug(a)};this.DislayLog=function(a){gLogType=getDefaultParamValue(a,VccBar_Log_None)};this.OnDebug=function(a){};this.OnLoad=function(){};this._Create=function(){this.surpportWebsocket=IsWebSocketValid();this.oBrowserSys=this._GetBrowerSys()};this._GetBrowerSys=function(){this.version=this.os="";var a=navigator.userAgent.toLowerCase();if(0<a.indexOf("msie"))this.os="msie",this.version=a.match(/msie ([\d.]+)/)[1];else if(0<a.lastIndexOf("firefox"))this.os="firefox",this.version=a.match(/firefox\/([\d.]+)/)[1];else if(0<a.lastIndexOf("chrome"))this.os="chrome",this.version=a.match(/chrome\/([\d.]+)/)[1];else{var b=GetIEVersion();-1==b?(this.os=a,this.version=""):(this.os="msie",this.version=b)}"zh-cn"==getLocalLanguage()?this.expression="ua:\u3010"+a+"\u3011\r\nos:\u3010"+this.os+"\u3011 version:\u3010"+this.version+"\u3011\r\nwebsocket:\u3010"+(1==this.surpportWebsocket?"\u652f\u6301":"\u4e0d\u652f\u6301")+"\u3011":this.expression="ua:["+a+"]\r\nos:["+this.os+"] version:["+this.version+"]\r\nwebsocket:["+(1==this.surpportWebsocket?"surpport":"unsurpport")+"]";return this};this._Create()}function loadHeadMeta(){var a=document.getElementsByTagName("HEAD").item(0),b=document.createElement("meta");b.setAttribute("http-equiv","X-UA-Compatible");b.setAttribute("content","IE\x3d10");a.appendChild(b)}function IsWebSocketValid(){!window.WebSocket&&window.MozWebSocket&&(window.WebSocket=window.MozWebSocket);return window.WebSocket?!0:!1}function isIE(){try{return window.ActiveXObject||"ActiveXObject"in window?!0:!1}catch(a){return!1}}function getLocalLanguage(){var a="",a="Netscape"==navigator.appName?navigator.language:navigator.userLanguage;return a.toLowerCase()}function isUnderIe8(){var a=navigator.userAgent.toLowerCase();return 0<a.indexOf("msie")&&(a=a.match(/msie ([\d.]+)/)[1],8>=parseInt(a))?!0:!1}function GetIEVersion(){var a=navigator.userAgent,b=-1<a.indexOf("compatible")&&-1<a.indexOf("MSIE"),c=-1<a.indexOf("Edge")&&!b,d=-1<a.indexOf("Trident")&&-1<a.indexOf("rv:11.0");return b?(/MSIE (\d+\.\d+);/.test(a),a=parseFloat(RegExp.$1),7==a?7:8==a?8:9==a?9:10==a?10:6):c?"edge":d?11:-1};